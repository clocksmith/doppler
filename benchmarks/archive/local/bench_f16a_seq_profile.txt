[progress] browser launching WebGPU harness...
[progress] browser resolved modelUrl=/models/local/gemma-3-1b-it
[browser:error] Failed to load resource: the server responded with a status of 404 (Not Found)
[browser:log] [217.0ms][OPFSCache] Cache hit: "gemma-3-1b-it"
[browser:log] [GPU] apple metal-3, f16/subgroups, 4.0GB
[browser:log] [229.9ms][Config] Using manifest-first config (source of truth)
[browser:log] [230.6ms][Pipeline] KernelPath: gemma3-f16-f16a (15 decode steps, 10 kernels, source=config)
[browser:log] [230.7ms][Pipeline] 26L/1152H/4heads (256dim), kernelPath=gemma3-f16-f16a
[browser:log] [230.9ms][Tokenizer] Loading bundled tokenizer from tokenizer.json
[browser:log] [373.2ms][Tokenizer] HuggingFace model.type="BPE", using type="bpe"
[browser:log] [598.1ms][Tokenizer] Loaded HuggingFace 262145 tokens (bpe), 9 special patterns, 514906 merges
[browser:log] [598.1ms][Pipeline] Tokenizer vocabSize=262145 differs from model=262144, using model size
[browser:log] [598.8ms][Loader] Initializing...
[browser:log] [631.1ms][HeapManager] Allocated segment 0: 1024MB
[browser:log] [631.2ms][HeapManager] Segmented heap: 1GB per segment
[browser:log] [631.3ms][HeapManager] Initialized with strategy: SEGMENTED
[browser:log] [631.4ms][Loader] Initialized (f16, subgroups, unified)
[browser:log] [631.6ms][Loader] Loading: gemma-3-1b-it
[browser:log] [631.9ms][Loader] [0.0s] Memory (start): | Heap=2.05 GB/2.05 GB (limit=4.00 GB) | GPU=0 B (0 active, 0 pooled, peak=0 B) | ShardCache=0 B (0 shards) | Layers=0, GPUBuffers=0
[browser:log] [2517.9ms][Loader] Embeddings tensor loaded: name=model.embed_tokens.weight, hasShape=true, shape=[262144,1152], isWeightBuffer=true
[browser:log] [2518.1ms][Loader] Layers: 0-25
[browser:log] [3402.8ms][Loader] Layers: 26 complete (0.88s)
[browser:warning] [3407.6ms][Loader] [FinalNorm] Falling back to role-only final norm selection because tensor groups are missing in manifest.
[browser:log] [3408.8ms][Loader] Complete: 0 B in 1.29s (0 B/s)
[browser:log] [3409.0ms][Loader] [2.8s] Memory (complete): | Heap=1.14 GB/1.14 GB (limit=4.00 GB) | GPU=2.04 GB (340 active, 0 pooled, peak=2.04 GB) | ShardCache=0 B (0 shards) | Layers=26, GPUBuffers=340
[browser:log] [3568.4ms][Pipeline] Model loaded successfully
[browser:warning] [3569.6ms][CommandRecorder] maxQuerySetSize unavailable; using fallback 4096
[browser:log] [3581.4ms][KernelSelect] matmul variant=f16 reason=path_override_adaptive_fallback
[browser:log] [3585.3ms][KernelSelect] attention variant=prefill_streaming_f16 reason=path_override:streaming
[browser:warning] [3718.7ms][Profile] Prefill (prefill):
[browser:warning] [3719.0ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                       22.83    21.2
matmul:lm_head                  19.38    18.0
matmul:ffn_down:L0               2.60     2.4
matmul:ffn_up:L0                 2.11     2.0
matmul:ffn_gate:L0               2.11     2.0
rmsnorm                          1.23     1.1
matmul:ffn_up:L24                1.14     1.1
matmul:ffn_down:L23              1.01     0.9
matmul:ffn_down:L2               0.95     0.9
matmul:ffn_down:L13              0.94     0.9
matmul:ffn_down:L1               0.91     0.8
matmul:ffn_gate:L1               0.80     0.7
gelu                             0.74     0.7
matmul:ffn_down:L24              0.71     0.7
matmul:ffn_down:L6               0.69     0.6
matmul:ffn_down:L9               0.69     0.6
matmul:ffn_down:L22              0.68     0.6
matmul:ffn_down:L12              0.68     0.6
matmul:ffn_down:L4               0.68     0.6
matmul:ffn_down:L14              0.68     0.6
matmul:ffn_down:L11              0.68     0.6
matmul:ffn_down:L5               0.67     0.6
matmul:ffn_down:L10              0.67     0.6
matmul:ffn_down:L18              0.67     0.6
matmul:ffn_down:L15              0.67     0.6
matmul:ffn_down:L7               0.67     0.6
matmul:ffn_down:L21              0.67     0.6
matmul:ffn_down:L19              0.67     0.6
matmul:ffn_down:L20              0.67     0.6
matmul:ffn_down:L8               0.67     0.6
matmul:ffn_down:L16              0.67     0.6
matmul:ffn_down:L17              0.67     0.6
matmul:ffn_down:L3               0.67     0.6
matmul:ffn_down:L25              0.67     0.6
matmul:ffn_gate:L13              0.59     0.5
matmul:ffn_up:L22                0.58     0.5
matmul:ffn_up:L13                0.58     0.5
matmul:ffn_gate:L2               0.57     0.5
matmul:ffn_up:L2                 0.57     0.5
matmul:ffn_gate:L24              0.56     0.5
matmul:o_proj:L2                 0.55     0.5
matmul:ffn_gate:L22              0.54     0.5
matmul:ffn_up:L4                 0.54     0.5
matmul:ffn_up:L1                 0.54     0.5
matmul:ffn_up:L5                 0.54     0.5
matmul:ffn_gate:L20              0.54     0.5
matmul:ffn_gate:L7               0.54     0.5
matmul:ffn_up:L8                 0.54     0.5
matmul:ffn_gate:L21              0.54     0.5
matmul:ffn_gate:L5               0.54     0.5
matmul:ffn_up:L23                0.54     0.5
matmul:ffn_gate:L17              0.54     0.5
matmul:ffn_up:L7                 0.54     0.5
matmul:ffn_gate:L25              0.54     0.5
matmul:ffn_gate:L12              0.54     0.5
matmul:ffn_gate:L11              0.54     0.5
matmul:ffn_gate:L15              0.54     0.5
matmul:ffn_up:L12                0.54     0.5
matmul:ffn_gate:L10              0.54     0.5
matmul:ffn_up:L20                0.54     0.5
matmul:ffn_up:L15                0.54     0.5
matmul:ffn_up:L10                0.54     0.5
matmul:ffn_up:L21                0.54     0.5
matmul:ffn_gate:L19              0.54     0.5
matmul:ffn_up:L11                0.54     0.5
matmul:ffn_up:L25                0.54     0.5
matmul:ffn_up:L19                0.54     0.5
matmul:ffn_gate:L23              0.54     0.5
matmul:ffn_up:L17                0.54     0.5
matmul:ffn_gate:L9               0.54     0.5
matmul:ffn_gate:L16              0.54     0.5
matmul:ffn_gate:L4               0.54     0.5
matmul:ffn_gate:L18              0.54     0.5
matmul:ffn_up:L18                0.54     0.5
matmul:ffn_gate:L8               0.53     0.5
matmul:ffn_gate:L3               0.53     0.5
matmul:ffn_gate:L14              0.53     0.5
matmul:ffn_gate:L6               0.53     0.5
matmul:ffn_up:L9                 0.53     0.5
matmul:ffn_up:L3                 0.53     0.5
matmul:ffn_up:L6                 0.53     0.5
matmul:ffn_up:L16                0.53     0.5
matmul:ffn_up:L14                0.53     0.5
matmul:q_proj:L0                 0.40     0.4
matmul:o_proj:L0                 0.39     0.4
matmul:q_proj:L1                 0.39     0.4
matmul:o_proj:L1                 0.38     0.4
rope                             0.25     0.2
matmul:q_proj:L2                 0.19     0.2
matmul:k_proj:L0                 0.18     0.2
matmul:v_proj:L0                 0.18     0.2
matmul:v_proj:L1                 0.17     0.2
matmul:k_proj:L1                 0.17     0.2
matmul:q_proj:L24                0.15     0.1
matmul:o_proj:L13                0.15     0.1
matmul:o_proj:L24                0.13     0.1
matmul:q_proj:L14                0.13     0.1
matmul:k_proj:L2                 0.12     0.1
matmul:v_proj:L24                0.12     0.1
matmul:k_proj:L24                0.11     0.1
matmul:o_proj:L16                0.11     0.1
matmul:v_proj:L14                0.11     0.1
matmul:o_proj:L22                0.11     0.1
matmul:k_proj:L14                0.11     0.1
matmul:v_proj:L2                 0.11     0.1
matmul:q_proj:L13                0.11     0.1
matmul:o_proj:L4                 0.10     0.1
matmul:q_proj:L10                0.10     0.1
matmul:o_proj:L5                 0.10     0.1
matmul:o_proj:L3                 0.10     0.1
matmul:q_proj:L20                0.10     0.1
matmul:o_proj:L15                0.10     0.1
matmul:q_proj:L7                 0.10     0.1
matmul:o_proj:L6                 0.10     0.1
matmul:q_proj:L11                0.10     0.1
matmul:o_proj:L18                0.10     0.1
matmul:q_proj:L3                 0.10     0.1
matmul:q_proj:L25                0.10     0.1
matmul:q_proj:L12                0.10     0.1
matmul:q_proj:L4                 0.10     0.1
matmul:q_proj:L22                0.10     0.1
matmul:q_proj:L23                0.10     0.1
matmul:o_proj:L14                0.10     0.1
matmul:q_proj:L5                 0.10     0.1
matmul:o_proj:L12                0.10     0.1
matmul:q_proj:L16                0.10     0.1
matmul:o_proj:L21                0.10     0.1
matmul:q_proj:L21                0.10     0.1
matmul:q_proj:L9                 0.10     0.1
matmul:q_proj:L6                 0.10     0.1
matmul:q_proj:L8                 0.10     0.1
matmul:o_proj:L10                0.10     0.1
matmul:q_proj:L15                0.10     0.1
matmul:q_proj:L19                0.10     0.1
matmul:o_proj:L9                 0.10     0.1
matmul:q_proj:L18                0.10     0.1
matmul:o_proj:L19                0.10     0.1
matmul:o_proj:L17                0.10     0.1
matmul:o_proj:L11                0.10     0.1
matmul:q_proj:L17                0.10     0.1
matmul:o_proj:L20                0.10     0.1
matmul:o_proj:L23                0.10     0.1
matmul:o_proj:L8                 0.10     0.1
matmul:o_proj:L7                 0.10     0.1
matmul:o_proj:L25                0.10     0.1
matmul:k_proj:L10                0.06     0.1
matmul:v_proj:L10                0.06     0.1
matmul:v_proj:L13                0.05     0.0
matmul:k_proj:L13                0.05     0.0
matmul:k_proj:L3                 0.05     0.0
matmul:k_proj:L11                0.05     0.0
matmul:v_proj:L21                0.05     0.0
matmul:k_proj:L15                0.05     0.0
matmul:v_proj:L5                 0.05     0.0
matmul:v_proj:L11                0.05     0.0
matmul:v_proj:L23                0.05     0.0
matmul:k_proj:L22                0.05     0.0
matmul:v_proj:L22                0.05     0.0
matmul:k_proj:L21                0.05     0.0
matmul:k_proj:L12                0.05     0.0
matmul:v_proj:L7                 0.05     0.0
matmul:k_proj:L20                0.05     0.0
matmul:k_proj:L23                0.05     0.0
matmul:v_proj:L3                 0.05     0.0
matmul:v_proj:L20                0.05     0.0
matmul:k_proj:L17                0.05     0.0
matmul:k_proj:L25                0.05     0.0
matmul:k_proj:L6                 0.05     0.0
matmul:k_proj:L7                 0.05     0.0
matmul:k_proj:L5                 0.05     0.0
matmul:v_proj:L15                0.05     0.0
matmul:k_proj:L9                 0.05     0.0
matmul:k_proj:L4                 0.05     0.0
matmul:k_proj:L8                 0.05     0.0
matmul:k_proj:L19                0.05     0.0
matmul:v_proj:L12                0.05     0.0
matmul:k_proj:L16                0.05     0.0
matmul:v_proj:L17                0.05     0.0
matmul:v_proj:L25                0.05     0.0
matmul:v_proj:L9                 0.05     0.0
matmul:v_proj:L4                 0.05     0.0
matmul:v_proj:L8                 0.05     0.0
matmul:v_proj:L18                0.05     0.0
matmul:v_proj:L19                0.05     0.0
matmul:k_proj:L18                0.05     0.0
matmul:v_proj:L6                 0.05     0.0
matmul:v_proj:L16                0.05     0.0
gather                           0.01     0.0
scale                            0.01     0.0
──────────────────────────────────────────────────
TOTAL                          107.87   100.0

[browser:log] [3838.7ms][KernelSelect] matmul variant=gemv_subgroup_vec4_f16a reason=path_override
[browser:log] [3841.1ms][KernelSelect] attention variant=decode_chunked_f16 reason=path_override:tiled_large
[browser:log] [3858.0ms][KernelSelect] matmul variant=gemv_subgroup_multicol_f16a reason=path_override
[browser:warning] [4284.9ms][Profile] Batch decode (N=4):
[browser:warning] [4285.2ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
fused_ffn                       43.28    11.9
matmul:lm_head                  33.39     9.2
attention                       20.63     5.7
matmul_rmsnorm_fused:L6.ffn_down       11.00     3.0
matmul_rmsnorm_fused:L25.ffn_down       10.91     3.0
matmul_rmsnorm_fused:L4.ffn_down       10.71     2.9
matmul_rmsnorm_fused:L1.ffn_down       10.65     2.9
matmul_rmsnorm_fused:L16.ffn_down       10.63     2.9
matmul_rmsnorm_fused:L19.ffn_down       10.49     2.9
matmul_rmsnorm_fused:L22.ffn_down       10.45     2.9
matmul_rmsnorm_fused:L15.ffn_down       10.24     2.8
matmul_rmsnorm_fused:L11.ffn_down       10.05     2.8
matmul_rmsnorm_fused:L8.ffn_down        9.63     2.6
matmul_rmsnorm_fused:L9.ffn_down        9.51     2.6
matmul_rmsnorm_fused:L0.ffn_down        9.43     2.6
matmul_rmsnorm_fused:L14.ffn_down        9.03     2.5
matmul_rmsnorm_fused:L12.ffn_down        8.99     2.5
matmul_rmsnorm_fused:L2.ffn_down        8.95     2.5
matmul_rmsnorm_fused:L20.ffn_down        8.92     2.5
matmul_rmsnorm_fused:L18.ffn_down        8.91     2.5
matmul_rmsnorm_fused:L17.ffn_down        8.88     2.4
matmul_rmsnorm_fused:L13.ffn_down        8.84     2.4
matmul_rmsnorm_fused:L21.ffn_down        8.83     2.4
matmul_rmsnorm_fused:L10.ffn_down        8.81     2.4
matmul_rmsnorm_fused:L5.ffn_down        8.79     2.4
matmul_rmsnorm_fused:L23.ffn_down        8.79     2.4
matmul_rmsnorm_fused:L7.ffn_down        8.75     2.4
matmul_rmsnorm_fused:L3.ffn_down        8.73     2.4
matmul_rmsnorm_fused:L24.ffn_down        8.72     2.4
rmsnorm                          3.51     1.0
sample_phase2                    3.31     0.9
rope                             0.76     0.2
matmul:q_proj:L0                 0.21     0.1
matmul:o_proj:L0                 0.19     0.1
matmul:o_proj:L1                 0.18     0.1
matmul:q_proj:L1                 0.18     0.0
matmul:q_proj:L9                 0.18     0.0
matmul:q_proj:L15                0.18     0.0
matmul:o_proj:L20                0.18     0.0
matmul:o_proj:L9                 0.17     0.0
matmul:o_proj:L15                0.17     0.0
matmul:o_proj:L6                 0.17     0.0
matmul:o_proj:L11                0.17     0.0
matmul:q_proj:L22                0.16     0.0
matmul:q_proj:L17                0.16     0.0
matmul:q_proj:L23                0.16     0.0
matmul:q_proj:L20                0.16     0.0
matmul:q_proj:L2                 0.16     0.0
matmul:q_proj:L14                0.16     0.0
matmul:o_proj:L2                 0.16     0.0
matmul:o_proj:L22                0.16     0.0
matmul:o_proj:L12                0.15     0.0
matmul:q_proj:L3                 0.15     0.0
matmul:q_proj:L10                0.15     0.0
matmul:q_proj:L11                0.15     0.0
matmul:q_proj:L18                0.15     0.0
matmul:o_proj:L3                 0.15     0.0
matmul:o_proj:L17                0.15     0.0
matmul:q_proj:L4                 0.15     0.0
matmul:q_proj:L12                0.14     0.0
matmul:o_proj:L10                0.14     0.0
matmul:o_proj:L18                0.14     0.0
matmul:q_proj:L5                 0.14     0.0
matmul:o_proj:L8                 0.14     0.0
matmul:o_proj:L4                 0.14     0.0
matmul:o_proj:L23                0.14     0.0
matmul:q_proj:L8                 0.14     0.0
matmul:o_proj:L14                0.14     0.0
matmul:o_proj:L7                 0.14     0.0
matmul:q_proj:L19                0.14     0.0
matmul:q_proj:L6                 0.14     0.0
matmul:q_proj:L7                 0.13     0.0
matmul:o_proj:L5                 0.13     0.0
matmul:q_proj:L21                0.13     0.0
matmul:o_proj:L21                0.13     0.0
matmul:o_proj:L24                0.13     0.0
matmul:q_proj:L24                0.13     0.0
matmul:o_proj:L19                0.13     0.0
matmul:o_proj:L25                0.13     0.0
matmul:o_proj:L16                0.13     0.0
matmul:o_proj:L13                0.13     0.0
matmul:q_proj:L16                0.13     0.0
matmul:q_proj:L25                0.13     0.0
matmul:q_proj:L13                0.13     0.0
sample_phase1                    0.10     0.0
matmul:k_proj:L15                0.08     0.0
matmul:k_proj:L0                 0.07     0.0
matmul:v_proj:L15                0.07     0.0
matmul:v_proj:L0                 0.07     0.0
matmul:k_proj:L9                 0.07     0.0
matmul:v_proj:L9                 0.06     0.0
matmul:k_proj:L17                0.06     0.0
matmul:k_proj:L20                0.06     0.0
matmul:v_proj:L22                0.06     0.0
matmul:k_proj:L1                 0.06     0.0
matmul:v_proj:L17                0.06     0.0
matmul:v_proj:L20                0.06     0.0
matmul:v_proj:L5                 0.05     0.0
matmul:k_proj:L11                0.05     0.0
matmul:k_proj:L5                 0.05     0.0
sample_phase3                    0.05     0.0
matmul:k_proj:L22                0.05     0.0
matmul:v_proj:L1                 0.05     0.0
matmul:k_proj:L12                0.05     0.0
matmul:k_proj:L10                0.05     0.0
matmul:k_proj:L2                 0.05     0.0
matmul:v_proj:L14                0.05     0.0
matmul:v_proj:L12                0.05     0.0
matmul:k_proj:L3                 0.05     0.0
matmul:v_proj:L11                0.05     0.0
matmul:v_proj:L10                0.05     0.0
matmul:v_proj:L2                 0.05     0.0
matmul:k_proj:L6                 0.05     0.0
matmul:k_proj:L4                 0.05     0.0
matmul:k_proj:L18                0.05     0.0
matmul:k_proj:L14                0.05     0.0
matmul:k_proj:L23                0.05     0.0
matmul:v_proj:L18                0.05     0.0
matmul:v_proj:L3                 0.05     0.0
matmul:v_proj:L23                0.05     0.0
matmul:k_proj:L7                 0.05     0.0
matmul:v_proj:L6                 0.05     0.0
matmul:v_proj:L4                 0.05     0.0
matmul:k_proj:L25                0.05     0.0
matmul:k_proj:L21                0.05     0.0
matmul:v_proj:L7                 0.05     0.0
matmul:k_proj:L16                0.05     0.0
matmul:k_proj:L8                 0.05     0.0
matmul:v_proj:L8                 0.05     0.0
matmul:v_proj:L19                0.05     0.0
matmul:v_proj:L25                0.05     0.0
matmul:v_proj:L21                0.05     0.0
matmul:k_proj:L19                0.04     0.0
matmul:k_proj:L13                0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:v_proj:L16                0.04     0.0
matmul:v_proj:L24                0.04     0.0
matmul:k_proj:L24                0.04     0.0
gather                           0.03     0.0
scale                            0.02     0.0
──────────────────────────────────────────────────
TOTAL                          363.27   100.0

[browser:warning] [4720.6ms][Profile] Batch decode (N=4):
[browser:warning] [4720.8ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
fused_ffn                       41.59    11.5
matmul:lm_head                  30.98     8.6
attention                       27.71     7.7
matmul_rmsnorm_fused:L23.ffn_down       11.00     3.0
matmul_rmsnorm_fused:L7.ffn_down       10.55     2.9
matmul_rmsnorm_fused:L15.ffn_down       10.41     2.9
matmul_rmsnorm_fused:L25.ffn_down       10.22     2.8
matmul_rmsnorm_fused:L2.ffn_down       10.11     2.8
matmul_rmsnorm_fused:L17.ffn_down        9.91     2.7
matmul_rmsnorm_fused:L21.ffn_down        9.76     2.7
matmul_rmsnorm_fused:L0.ffn_down        9.73     2.7
matmul_rmsnorm_fused:L4.ffn_down        9.69     2.7
matmul_rmsnorm_fused:L13.ffn_down        9.54     2.6
matmul_rmsnorm_fused:L10.ffn_down        9.39     2.6
matmul_rmsnorm_fused:L22.ffn_down        9.39     2.6
matmul_rmsnorm_fused:L11.ffn_down        9.30     2.6
matmul_rmsnorm_fused:L3.ffn_down        9.10     2.5
matmul_rmsnorm_fused:L12.ffn_down        8.95     2.5
matmul_rmsnorm_fused:L1.ffn_down        8.88     2.5
matmul_rmsnorm_fused:L18.ffn_down        8.85     2.5
matmul_rmsnorm_fused:L24.ffn_down        8.81     2.4
matmul_rmsnorm_fused:L20.ffn_down        8.71     2.4
matmul_rmsnorm_fused:L19.ffn_down        8.71     2.4
matmul_rmsnorm_fused:L8.ffn_down        8.70     2.4
matmul_rmsnorm_fused:L16.ffn_down        8.69     2.4
matmul_rmsnorm_fused:L14.ffn_down        8.66     2.4
matmul_rmsnorm_fused:L9.ffn_down        8.66     2.4
matmul_rmsnorm_fused:L6.ffn_down        8.65     2.4
matmul_rmsnorm_fused:L5.ffn_down        8.65     2.4
rmsnorm                          3.34     0.9
sample_phase2                    3.28     0.9
rope                             0.87     0.2
matmul:o_proj:L0                 0.78     0.2
matmul:q_proj:L0                 0.22     0.1
matmul:q_proj:L23                0.17     0.0
matmul:q_proj:L22                0.17     0.0
matmul:o_proj:L11                0.17     0.0
matmul:q_proj:L2                 0.16     0.0
matmul:o_proj:L15                0.16     0.0
matmul:o_proj:L23                0.15     0.0
matmul:q_proj:L11                0.15     0.0
matmul:o_proj:L4                 0.15     0.0
matmul:o_proj:L22                0.15     0.0
matmul:o_proj:L13                0.15     0.0
matmul:q_proj:L4                 0.15     0.0
matmul:o_proj:L25                0.15     0.0
matmul:q_proj:L13                0.15     0.0
matmul:q_proj:L1                 0.14     0.0
matmul:o_proj:L2                 0.14     0.0
matmul:o_proj:L18                0.14     0.0
matmul:o_proj:L1                 0.14     0.0
matmul:q_proj:L18                0.14     0.0
matmul:q_proj:L25                0.13     0.0
matmul:q_proj:L24                0.13     0.0
matmul:q_proj:L7                 0.13     0.0
matmul:o_proj:L3                 0.13     0.0
matmul:o_proj:L19                0.13     0.0
matmul:o_proj:L21                0.13     0.0
matmul:o_proj:L24                0.13     0.0
matmul:o_proj:L16                0.13     0.0
matmul:o_proj:L12                0.13     0.0
matmul:q_proj:L16                0.13     0.0
matmul:q_proj:L15                0.13     0.0
matmul:q_proj:L3                 0.13     0.0
matmul:q_proj:L14                0.13     0.0
matmul:q_proj:L12                0.13     0.0
matmul:q_proj:L21                0.13     0.0
matmul:q_proj:L8                 0.13     0.0
matmul:o_proj:L6                 0.13     0.0
matmul:q_proj:L20                0.13     0.0
matmul:q_proj:L9                 0.13     0.0
matmul:o_proj:L20                0.13     0.0
matmul:o_proj:L17                0.13     0.0
matmul:o_proj:L7                 0.13     0.0
matmul:q_proj:L5                 0.13     0.0
matmul:o_proj:L8                 0.13     0.0
matmul:o_proj:L5                 0.13     0.0
matmul:q_proj:L10                0.13     0.0
matmul:q_proj:L19                0.12     0.0
matmul:o_proj:L14                0.12     0.0
matmul:o_proj:L10                0.12     0.0
matmul:o_proj:L9                 0.12     0.0
matmul:q_proj:L17                0.12     0.0
matmul:q_proj:L6                 0.12     0.0
matmul:v_proj:L0                 0.08     0.0
matmul:k_proj:L0                 0.08     0.0
sample_phase1                    0.07     0.0
matmul:k_proj:L15                0.07     0.0
matmul:k_proj:L22                0.06     0.0
matmul:v_proj:L22                0.06     0.0
matmul:v_proj:L15                0.06     0.0
matmul:k_proj:L23                0.06     0.0
matmul:k_proj:L4                 0.06     0.0
matmul:k_proj:L2                 0.06     0.0
matmul:v_proj:L11                0.06     0.0
matmul:k_proj:L13                0.06     0.0
matmul:v_proj:L4                 0.06     0.0
matmul:k_proj:L11                0.06     0.0
matmul:k_proj:L18                0.05     0.0
matmul:v_proj:L13                0.05     0.0
matmul:v_proj:L2                 0.05     0.0
matmul:v_proj:L18                0.05     0.0
sample_phase3                    0.05     0.0
matmul:k_proj:L7                 0.05     0.0
matmul:k_proj:L1                 0.05     0.0
matmul:v_proj:L23                0.05     0.0
matmul:k_proj:L25                0.05     0.0
matmul:k_proj:L24                0.05     0.0
matmul:v_proj:L25                0.05     0.0
matmul:k_proj:L21                0.05     0.0
matmul:v_proj:L24                0.05     0.0
matmul:k_proj:L16                0.05     0.0
matmul:v_proj:L7                 0.05     0.0
matmul:k_proj:L3                 0.05     0.0
matmul:v_proj:L1                 0.05     0.0
matmul:k_proj:L19                0.05     0.0
matmul:k_proj:L10                0.05     0.0
matmul:k_proj:L12                0.05     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:k_proj:L17                0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:v_proj:L5                 0.04     0.0
matmul:k_proj:L14                0.04     0.0
matmul:v_proj:L16                0.04     0.0
matmul:k_proj:L20                0.04     0.0
matmul:k_proj:L5                 0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:v_proj:L14                0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:v_proj:L19                0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:v_proj:L17                0.04     0.0
gather                           0.03     0.0
scale                            0.02     0.0
──────────────────────────────────────────────────
TOTAL                          361.38   100.0

[browser:warning] [5152.4ms][Profile] Batch decode (N=4):
[browser:warning] [5152.7ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
fused_ffn                       41.23    11.2
attention                       34.54     9.4
matmul:lm_head                  30.83     8.4
matmul_rmsnorm_fused:L0.ffn_down       11.04     3.0
matmul_rmsnorm_fused:L9.ffn_down       10.61     2.9
matmul_rmsnorm_fused:L22.ffn_down       10.42     2.8
matmul_rmsnorm_fused:L19.ffn_down       10.42     2.8
matmul_rmsnorm_fused:L4.ffn_down       10.33     2.8
matmul_rmsnorm_fused:L11.ffn_down       10.31     2.8
matmul_rmsnorm_fused:L25.ffn_down       10.12     2.8
matmul_rmsnorm_fused:L17.ffn_down        9.79     2.7
matmul_rmsnorm_fused:L6.ffn_down        9.78     2.7
matmul_rmsnorm_fused:L15.ffn_down        9.59     2.6
matmul_rmsnorm_fused:L14.ffn_down        9.17     2.5
matmul_rmsnorm_fused:L7.ffn_down        9.09     2.5
matmul_rmsnorm_fused:L16.ffn_down        8.93     2.4
matmul_rmsnorm_fused:L21.ffn_down        8.80     2.4
matmul_rmsnorm_fused:L1.ffn_down        8.74     2.4
matmul_rmsnorm_fused:L2.ffn_down        8.74     2.4
matmul_rmsnorm_fused:L10.ffn_down        8.71     2.4
matmul_rmsnorm_fused:L18.ffn_down        8.70     2.4
matmul_rmsnorm_fused:L23.ffn_down        8.70     2.4
matmul_rmsnorm_fused:L24.ffn_down        8.69     2.4
matmul_rmsnorm_fused:L8.ffn_down        8.66     2.4
matmul_rmsnorm_fused:L12.ffn_down        8.66     2.4
matmul_rmsnorm_fused:L5.ffn_down        8.64     2.4
matmul_rmsnorm_fused:L3.ffn_down        8.64     2.4
matmul_rmsnorm_fused:L13.ffn_down        8.63     2.4
matmul_rmsnorm_fused:L20.ffn_down        8.63     2.4
rmsnorm                          3.43     0.9
sample_phase2                    3.30     0.9
rope                             0.75     0.2
sample_phase1                    0.68     0.2
matmul:q_proj:L0                 0.21     0.1
matmul:o_proj:L0                 0.19     0.1
matmul:q_proj:L17                0.16     0.0
matmul:o_proj:L19                0.16     0.0
matmul:o_proj:L15                0.16     0.0
matmul:o_proj:L25                0.16     0.0
matmul:o_proj:L17                0.15     0.0
matmul:o_proj:L11                0.15     0.0
matmul:q_proj:L7                 0.15     0.0
matmul:q_proj:L15                0.14     0.0
matmul:o_proj:L9                 0.14     0.0
matmul:q_proj:L19                0.14     0.0
matmul:o_proj:L7                 0.14     0.0
matmul:o_proj:L16                0.14     0.0
matmul:o_proj:L3                 0.14     0.0
matmul:o_proj:L12                0.13     0.0
matmul:o_proj:L14                0.13     0.0
matmul:o_proj:L4                 0.13     0.0
matmul:o_proj:L2                 0.13     0.0
matmul:q_proj:L11                0.13     0.0
matmul:q_proj:L12                0.13     0.0
matmul:q_proj:L1                 0.13     0.0
matmul:o_proj:L10                0.13     0.0
matmul:o_proj:L24                0.13     0.0
matmul:q_proj:L23                0.13     0.0
matmul:o_proj:L13                0.13     0.0
matmul:q_proj:L16                0.13     0.0
matmul:q_proj:L2                 0.13     0.0
matmul:q_proj:L4                 0.13     0.0
matmul:q_proj:L22                0.13     0.0
matmul:q_proj:L5                 0.13     0.0
matmul:o_proj:L20                0.13     0.0
matmul:o_proj:L1                 0.13     0.0
matmul:q_proj:L10                0.13     0.0
matmul:o_proj:L23                0.13     0.0
matmul:q_proj:L14                0.13     0.0
matmul:o_proj:L18                0.13     0.0
matmul:q_proj:L8                 0.13     0.0
matmul:q_proj:L9                 0.13     0.0
matmul:q_proj:L3                 0.13     0.0
matmul:q_proj:L25                0.13     0.0
matmul:o_proj:L6                 0.13     0.0
matmul:o_proj:L22                0.13     0.0
matmul:o_proj:L5                 0.13     0.0
matmul:o_proj:L21                0.13     0.0
matmul:o_proj:L8                 0.12     0.0
matmul:q_proj:L6                 0.12     0.0
matmul:q_proj:L20                0.12     0.0
matmul:q_proj:L24                0.12     0.0
matmul:q_proj:L13                0.12     0.0
matmul:q_proj:L18                0.12     0.0
matmul:q_proj:L21                0.12     0.0
matmul:k_proj:L0                 0.08     0.0
matmul:v_proj:L0                 0.07     0.0
matmul:k_proj:L17                0.06     0.0
matmul:k_proj:L25                0.06     0.0
matmul:v_proj:L25                0.06     0.0
matmul:v_proj:L17                0.06     0.0
matmul:k_proj:L15                0.06     0.0
matmul:v_proj:L15                0.06     0.0
matmul:v_proj:L7                 0.06     0.0
sample_phase3                    0.05     0.0
matmul:k_proj:L7                 0.05     0.0
matmul:k_proj:L11                0.05     0.0
matmul:k_proj:L19                0.05     0.0
matmul:k_proj:L21                0.05     0.0
matmul:k_proj:L3                 0.05     0.0
matmul:v_proj:L5                 0.05     0.0
matmul:k_proj:L12                0.05     0.0
matmul:k_proj:L4                 0.05     0.0
matmul:k_proj:L2                 0.05     0.0
matmul:v_proj:L19                0.05     0.0
matmul:k_proj:L16                0.05     0.0
matmul:v_proj:L11                0.05     0.0
matmul:k_proj:L10                0.05     0.0
matmul:k_proj:L1                 0.05     0.0
matmul:k_proj:L23                0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:k_proj:L13                0.04     0.0
matmul:k_proj:L5                 0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:k_proj:L22                0.04     0.0
matmul:v_proj:L22                0.04     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:k_proj:L14                0.04     0.0
matmul:v_proj:L16                0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:k_proj:L20                0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:k_proj:L24                0.04     0.0
matmul:v_proj:L18                0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:k_proj:L18                0.04     0.0
matmul:v_proj:L24                0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:v_proj:L14                0.04     0.0
matmul:v_proj:L21                0.04     0.0
gather                           0.03     0.0
scale                            0.02     0.0
──────────────────────────────────────────────────
TOTAL                          366.88   100.0

[browser:warning] [5584.5ms][Profile] Batch decode (N=4):
[browser:warning] [5584.7ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                       41.93    11.3
fused_ffn                       39.79    10.7
matmul:lm_head                  30.79     8.3
matmul_rmsnorm_fused:L19.ffn_down       10.63     2.9
matmul_rmsnorm_fused:L9.ffn_down       10.49     2.8
matmul_rmsnorm_fused:L15.ffn_down       10.35     2.8
matmul_rmsnorm_fused:L5.ffn_down       10.25     2.8
matmul_rmsnorm_fused:L7.ffn_down        9.93     2.7
matmul_rmsnorm_fused:L25.ffn_down        9.82     2.6
matmul_rmsnorm_fused:L0.ffn_down        9.76     2.6
matmul_rmsnorm_fused:L10.ffn_down        9.64     2.6
matmul_rmsnorm_fused:L17.ffn_down        9.60     2.6
matmul_rmsnorm_fused:L21.ffn_down        9.35     2.5
matmul_rmsnorm_fused:L20.ffn_down        9.33     2.5
matmul_rmsnorm_fused:L1.ffn_down        9.26     2.5
matmul_rmsnorm_fused:L18.ffn_down        9.08     2.4
matmul_rmsnorm_fused:L11.ffn_down        8.99     2.4
matmul_rmsnorm_fused:L6.ffn_down        8.75     2.4
matmul_rmsnorm_fused:L16.ffn_down        8.69     2.3
matmul_rmsnorm_fused:L23.ffn_down        8.67     2.3
matmul_rmsnorm_fused:L22.ffn_down        8.67     2.3
matmul_rmsnorm_fused:L2.ffn_down        8.66     2.3
matmul_rmsnorm_fused:L24.ffn_down        8.66     2.3
matmul_rmsnorm_fused:L14.ffn_down        8.66     2.3
matmul_rmsnorm_fused:L8.ffn_down        8.65     2.3
matmul_rmsnorm_fused:L3.ffn_down        8.65     2.3
matmul_rmsnorm_fused:L4.ffn_down        8.64     2.3
matmul_rmsnorm_fused:L12.ffn_down        8.62     2.3
matmul_rmsnorm_fused:L13.ffn_down        8.62     2.3
sample_phase2                    3.31     0.9
rmsnorm                          3.08     0.8
rope                             0.79     0.2
sample_phase1                    0.67     0.2
matmul:o_proj:L18                0.62     0.2
matmul:o_proj:L11                0.55     0.1
matmul:q_proj:L0                 0.21     0.1
matmul:o_proj:L0                 0.17     0.0
matmul:o_proj:L1                 0.16     0.0
matmul:q_proj:L18                0.16     0.0
matmul:q_proj:L21                0.15     0.0
matmul:q_proj:L11                0.15     0.0
matmul:o_proj:L7                 0.15     0.0
matmul:q_proj:L7                 0.15     0.0
matmul:q_proj:L1                 0.14     0.0
matmul:o_proj:L9                 0.14     0.0
matmul:o_proj:L5                 0.14     0.0
matmul:q_proj:L10                0.14     0.0
matmul:o_proj:L21                0.13     0.0
matmul:o_proj:L15                0.13     0.0
matmul:o_proj:L19                0.13     0.0
matmul:q_proj:L16                0.13     0.0
matmul:o_proj:L16                0.13     0.0
matmul:q_proj:L20                0.13     0.0
matmul:o_proj:L3                 0.13     0.0
matmul:o_proj:L13                0.13     0.0
matmul:q_proj:L8                 0.13     0.0
matmul:q_proj:L6                 0.13     0.0
matmul:o_proj:L10                0.13     0.0
matmul:o_proj:L24                0.13     0.0
matmul:o_proj:L25                0.13     0.0
matmul:o_proj:L6                 0.13     0.0
matmul:q_proj:L5                 0.13     0.0
matmul:q_proj:L13                0.13     0.0
matmul:o_proj:L8                 0.13     0.0
matmul:o_proj:L20                0.13     0.0
matmul:q_proj:L19                0.12     0.0
matmul:q_proj:L9                 0.12     0.0
matmul:o_proj:L17                0.12     0.0
matmul:o_proj:L22                0.12     0.0
matmul:o_proj:L4                 0.12     0.0
matmul:o_proj:L12                0.12     0.0
matmul:o_proj:L2                 0.12     0.0
matmul:q_proj:L17                0.12     0.0
matmul:q_proj:L4                 0.12     0.0
matmul:q_proj:L23                0.12     0.0
matmul:o_proj:L14                0.12     0.0
matmul:q_proj:L3                 0.12     0.0
matmul:q_proj:L14                0.12     0.0
matmul:q_proj:L15                0.12     0.0
matmul:q_proj:L25                0.12     0.0
matmul:q_proj:L24                0.12     0.0
matmul:q_proj:L22                0.12     0.0
matmul:q_proj:L12                0.12     0.0
matmul:q_proj:L2                 0.12     0.0
matmul:o_proj:L23                0.12     0.0
matmul:k_proj:L0                 0.09     0.0
matmul:v_proj:L18                0.07     0.0
matmul:k_proj:L21                0.06     0.0
matmul:v_proj:L0                 0.06     0.0
sample_phase3                    0.06     0.0
matmul:k_proj:L18                0.06     0.0
matmul:k_proj:L7                 0.06     0.0
matmul:v_proj:L11                0.06     0.0
matmul:k_proj:L1                 0.06     0.0
matmul:v_proj:L1                 0.06     0.0
matmul:k_proj:L11                0.06     0.0
matmul:v_proj:L7                 0.06     0.0
matmul:v_proj:L21                0.06     0.0
matmul:v_proj:L16                0.05     0.0
matmul:k_proj:L16                0.05     0.0
matmul:k_proj:L10                0.05     0.0
matmul:k_proj:L3                 0.05     0.0
matmul:k_proj:L4                 0.05     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:k_proj:L20                0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:k_proj:L23                0.04     0.0
matmul:k_proj:L17                0.04     0.0
matmul:k_proj:L5                 0.04     0.0
matmul:k_proj:L15                0.04     0.0
matmul:k_proj:L19                0.04     0.0
matmul:k_proj:L13                0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:k_proj:L2                 0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:v_proj:L5                 0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:k_proj:L22                0.04     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:k_proj:L12                0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:v_proj:L24                0.04     0.0
matmul:v_proj:L19                0.04     0.0
matmul:k_proj:L24                0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:v_proj:L22                0.04     0.0
matmul:k_proj:L14                0.04     0.0
matmul:v_proj:L17                0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:v_proj:L14                0.04     0.0
gather                           0.04     0.0
scale                            0.03     0.0
──────────────────────────────────────────────────
TOTAL                          371.18   100.0

[browser:warning] [6010.7ms][Profile] Batch decode (N=4):
[browser:warning] [6010.8ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                       48.98    13.0
fused_ffn                       38.95    10.3
matmul:lm_head                  29.78     7.9
matmul_rmsnorm_fused:L10.ffn_down       10.44     2.8
matmul_rmsnorm_fused:L2.ffn_down       10.43     2.8
matmul_rmsnorm_fused:L23.ffn_down       10.42     2.8
matmul_rmsnorm_fused:L12.ffn_down       10.26     2.7
matmul_rmsnorm_fused:L3.ffn_down       10.21     2.7
matmul_rmsnorm_fused:L20.ffn_down       10.15     2.7
matmul_rmsnorm_fused:L1.ffn_down        9.98     2.6
matmul_rmsnorm_fused:L19.ffn_down        9.98     2.6
matmul_rmsnorm_fused:L13.ffn_down        9.75     2.6
matmul_rmsnorm_fused:L9.ffn_down        9.65     2.6
matmul_rmsnorm_fused:L21.ffn_down        9.46     2.5
matmul_rmsnorm_fused:L22.ffn_down        9.40     2.5
matmul_rmsnorm_fused:L11.ffn_down        8.95     2.4
matmul_rmsnorm_fused:L14.ffn_down        8.94     2.4
matmul_rmsnorm_fused:L0.ffn_down        8.72     2.3
matmul_rmsnorm_fused:L18.ffn_down        8.70     2.3
matmul_rmsnorm_fused:L17.ffn_down        8.67     2.3
matmul_rmsnorm_fused:L6.ffn_down        8.67     2.3
matmul_rmsnorm_fused:L16.ffn_down        8.67     2.3
matmul_rmsnorm_fused:L8.ffn_down        8.66     2.3
matmul_rmsnorm_fused:L15.ffn_down        8.65     2.3
matmul_rmsnorm_fused:L7.ffn_down        8.63     2.3
matmul_rmsnorm_fused:L25.ffn_down        8.63     2.3
matmul_rmsnorm_fused:L24.ffn_down        8.62     2.3
matmul_rmsnorm_fused:L5.ffn_down        8.59     2.3
matmul_rmsnorm_fused:L4.ffn_down        8.58     2.3
rmsnorm                          4.09     1.1
sample_phase2                    3.26     0.9
rope                             0.81     0.2
matmul:o_proj:L20                0.73     0.2
matmul:o_proj:L10                0.17     0.0
matmul:q_proj:L10                0.16     0.0
matmul:o_proj:L22                0.16     0.0
matmul:o_proj:L0                 0.16     0.0
matmul:q_proj:L22                0.15     0.0
matmul:o_proj:L4                 0.15     0.0
matmul:o_proj:L12                0.15     0.0
matmul:o_proj:L1                 0.15     0.0
matmul:q_proj:L14                0.15     0.0
matmul:q_proj:L1                 0.15     0.0
matmul:o_proj:L13                0.15     0.0
matmul:o_proj:L21                0.14     0.0
matmul:q_proj:L0                 0.14     0.0
matmul:q_proj:L20                0.14     0.0
matmul:o_proj:L3                 0.14     0.0
matmul:o_proj:L23                0.14     0.0
matmul:q_proj:L13                0.14     0.0
matmul:o_proj:L11                0.14     0.0
matmul:q_proj:L21                0.14     0.0
matmul:q_proj:L11                0.14     0.0
matmul:q_proj:L4                 0.13     0.0
matmul:o_proj:L16                0.13     0.0
matmul:q_proj:L12                0.13     0.0
matmul:q_proj:L2                 0.13     0.0
matmul:o_proj:L9                 0.13     0.0
matmul:o_proj:L14                0.13     0.0
matmul:o_proj:L19                0.13     0.0
matmul:o_proj:L2                 0.13     0.0
matmul:o_proj:L18                0.13     0.0
matmul:q_proj:L24                0.13     0.0
matmul:q_proj:L23                0.13     0.0
matmul:o_proj:L8                 0.12     0.0
matmul:q_proj:L19                0.12     0.0
matmul:q_proj:L9                 0.12     0.0
matmul:q_proj:L18                0.12     0.0
matmul:q_proj:L3                 0.12     0.0
matmul:q_proj:L8                 0.12     0.0
matmul:o_proj:L7                 0.12     0.0
matmul:o_proj:L17                0.12     0.0
matmul:q_proj:L7                 0.12     0.0
matmul:q_proj:L17                0.12     0.0
matmul:o_proj:L15                0.12     0.0
matmul:o_proj:L5                 0.12     0.0
matmul:o_proj:L24                0.12     0.0
matmul:o_proj:L25                0.12     0.0
matmul:o_proj:L6                 0.12     0.0
matmul:q_proj:L25                0.12     0.0
matmul:q_proj:L16                0.12     0.0
matmul:q_proj:L6                 0.12     0.0
matmul:q_proj:L5                 0.12     0.0
matmul:q_proj:L15                0.12     0.0
sample_phase1                    0.07     0.0
matmul:k_proj:L10                0.06     0.0
matmul:v_proj:L1                 0.06     0.0
matmul:k_proj:L22                0.06     0.0
matmul:k_proj:L14                0.06     0.0
matmul:k_proj:L1                 0.06     0.0
matmul:v_proj:L10                0.06     0.0
matmul:v_proj:L14                0.06     0.0
matmul:v_proj:L22                0.06     0.0
matmul:k_proj:L21                0.05     0.0
matmul:v_proj:L20                0.05     0.0
matmul:v_proj:L21                0.05     0.0
matmul:k_proj:L11                0.05     0.0
sample_phase3                    0.05     0.0
matmul:v_proj:L11                0.05     0.0
matmul:k_proj:L4                 0.05     0.0
matmul:k_proj:L20                0.05     0.0
matmul:k_proj:L0                 0.05     0.0
matmul:v_proj:L4                 0.05     0.0
matmul:v_proj:L0                 0.05     0.0
matmul:k_proj:L13                0.05     0.0
matmul:v_proj:L12                0.05     0.0
matmul:k_proj:L2                 0.05     0.0
matmul:k_proj:L15                0.05     0.0
matmul:v_proj:L13                0.05     0.0
matmul:k_proj:L12                0.05     0.0
matmul:k_proj:L23                0.05     0.0
matmul:k_proj:L3                 0.05     0.0
matmul:k_proj:L19                0.04     0.0
matmul:v_proj:L24                0.04     0.0
matmul:k_proj:L7                 0.04     0.0
matmul:k_proj:L17                0.04     0.0
matmul:k_proj:L24                0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:v_proj:L19                0.04     0.0
matmul:k_proj:L16                0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:k_proj:L18                0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:v_proj:L5                 0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:v_proj:L16                0.04     0.0
matmul:v_proj:L18                0.04     0.0
matmul:v_proj:L17                0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:k_proj:L5                 0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:v_proj:L6                 0.04     0.0
gather                           0.02     0.0
scale                            0.02     0.0
──────────────────────────────────────────────────
TOTAL                          377.84   100.0

[browser:warning] [6450.9ms][Profile] Batch decode (N=4):
[browser:warning] [6451.3ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                       55.83    14.4
fused_ffn                       40.00    10.3
matmul:lm_head                  30.28     7.8
matmul_rmsnorm_fused:L14.ffn_down       11.91     3.1
matmul_rmsnorm_fused:L3.ffn_down       11.23     2.9
matmul_rmsnorm_fused:L11.ffn_down       11.08     2.9
matmul_rmsnorm_fused:L22.ffn_down       10.54     2.7
matmul_rmsnorm_fused:L24.ffn_down       10.48     2.7
matmul_rmsnorm_fused:L21.ffn_down       10.20     2.6
matmul_rmsnorm_fused:L2.ffn_down        9.98     2.6
matmul_rmsnorm_fused:L4.ffn_down        9.55     2.5
matmul_rmsnorm_fused:L23.ffn_down        9.39     2.4
matmul_rmsnorm_fused:L12.ffn_down        9.38     2.4
matmul_rmsnorm_fused:L5.ffn_down        9.11     2.4
matmul_rmsnorm_fused:L13.ffn_down        8.83     2.3
matmul_rmsnorm_fused:L1.ffn_down        8.73     2.3
matmul_rmsnorm_fused:L10.ffn_down        8.72     2.3
matmul_rmsnorm_fused:L20.ffn_down        8.71     2.2
matmul_rmsnorm_fused:L19.ffn_down        8.71     2.2
matmul_rmsnorm_fused:L9.ffn_down        8.69     2.2
matmul_rmsnorm_fused:L16.ffn_down        8.69     2.2
matmul_rmsnorm_fused:L25.ffn_down        8.68     2.2
matmul_rmsnorm_fused:L7.ffn_down        8.67     2.2
matmul_rmsnorm_fused:L17.ffn_down        8.66     2.2
matmul_rmsnorm_fused:L15.ffn_down        8.66     2.2
matmul_rmsnorm_fused:L6.ffn_down        8.66     2.2
matmul_rmsnorm_fused:L18.ffn_down        8.66     2.2
matmul_rmsnorm_fused:L0.ffn_down        8.65     2.2
matmul_rmsnorm_fused:L8.ffn_down        8.60     2.2
rmsnorm                          3.41     0.9
sample_phase2                    3.26     0.8
rope                             0.76     0.2
matmul:v_proj:L3                 0.71     0.2
matmul:o_proj:L14                0.50     0.1
matmul:o_proj:L24                0.18     0.0
matmul:q_proj:L12                0.17     0.0
matmul:o_proj:L3                 0.16     0.0
matmul:o_proj:L2                 0.16     0.0
matmul:o_proj:L22                0.15     0.0
matmul:q_proj:L5                 0.15     0.0
matmul:q_proj:L24                0.15     0.0
matmul:o_proj:L21                0.15     0.0
matmul:o_proj:L0                 0.15     0.0
matmul:o_proj:L12                0.14     0.0
matmul:o_proj:L13                0.14     0.0
matmul:q_proj:L4                 0.14     0.0
matmul:q_proj:L22                0.14     0.0
matmul:q_proj:L0                 0.14     0.0
matmul:o_proj:L1                 0.14     0.0
matmul:q_proj:L2                 0.14     0.0
matmul:o_proj:L4                 0.13     0.0
matmul:q_proj:L3                 0.13     0.0
matmul:o_proj:L5                 0.13     0.0
matmul:o_proj:L23                0.13     0.0
matmul:o_proj:L11                0.13     0.0
matmul:o_proj:L10                0.13     0.0
matmul:q_proj:L13                0.13     0.0
matmul:q_proj:L21                0.13     0.0
matmul:q_proj:L23                0.13     0.0
matmul:o_proj:L9                 0.13     0.0
matmul:o_proj:L16                0.13     0.0
matmul:o_proj:L20                0.13     0.0
matmul:o_proj:L19                0.13     0.0
matmul:q_proj:L11                0.13     0.0
matmul:q_proj:L15                0.13     0.0
matmul:q_proj:L10                0.13     0.0
matmul:q_proj:L1                 0.13     0.0
matmul:q_proj:L14                0.13     0.0
matmul:q_proj:L6                 0.12     0.0
matmul:q_proj:L20                0.12     0.0
matmul:q_proj:L7                 0.12     0.0
matmul:o_proj:L17                0.12     0.0
matmul:o_proj:L15                0.12     0.0
matmul:q_proj:L16                0.12     0.0
matmul:o_proj:L6                 0.12     0.0
matmul:q_proj:L19                0.12     0.0
matmul:o_proj:L25                0.12     0.0
matmul:q_proj:L9                 0.12     0.0
matmul:q_proj:L17                0.12     0.0
matmul:q_proj:L8                 0.12     0.0
matmul:o_proj:L8                 0.12     0.0
matmul:q_proj:L25                0.12     0.0
matmul:o_proj:L7                 0.12     0.0
matmul:q_proj:L18                0.12     0.0
matmul:o_proj:L18                0.12     0.0
sample_phase1                    0.08     0.0
matmul:k_proj:L12                0.07     0.0
matmul:v_proj:L12                0.06     0.0
matmul:v_proj:L5                 0.06     0.0
matmul:k_proj:L5                 0.06     0.0
matmul:v_proj:L24                0.06     0.0
matmul:k_proj:L4                 0.06     0.0
matmul:k_proj:L24                0.06     0.0
matmul:v_proj:L4                 0.05     0.0
matmul:k_proj:L2                 0.05     0.0
matmul:k_proj:L7                 0.05     0.0
matmul:k_proj:L21                0.05     0.0
matmul:k_proj:L22                0.05     0.0
matmul:v_proj:L2                 0.05     0.0
matmul:k_proj:L3                 0.05     0.0
matmul:v_proj:L0                 0.05     0.0
matmul:k_proj:L23                0.05     0.0
matmul:k_proj:L1                 0.05     0.0
matmul:k_proj:L0                 0.05     0.0
matmul:k_proj:L13                0.05     0.0
matmul:k_proj:L11                0.05     0.0
matmul:v_proj:L22                0.05     0.0
matmul:k_proj:L6                 0.05     0.0
matmul:k_proj:L15                0.05     0.0
matmul:k_proj:L20                0.05     0.0
matmul:v_proj:L21                0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:k_proj:L10                0.04     0.0
matmul:k_proj:L14                0.04     0.0
matmul:k_proj:L19                0.04     0.0
matmul:k_proj:L16                0.04     0.0
matmul:k_proj:L17                0.04     0.0
sample_phase3                    0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:v_proj:L14                0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:v_proj:L19                0.04     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:v_proj:L16                0.04     0.0
matmul:v_proj:L17                0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:k_proj:L18                0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:v_proj:L18                0.04     0.0
gather                           0.01     0.0
scale                            0.01     0.0
──────────────────────────────────────────────────
TOTAL                          387.23   100.0

[browser:warning] [6918.0ms][Profile] Batch decode (N=4):
[browser:warning] [6918.1ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                       63.31    16.0
fused_ffn                       39.54    10.0
matmul:lm_head                  30.37     7.7
matmul_rmsnorm_fused:L2.ffn_down       14.69     3.7
matmul_rmsnorm_fused:L21.ffn_down       14.12     3.6
matmul_rmsnorm_fused:L11.ffn_down       12.09     3.1
matmul_rmsnorm_fused:L12.ffn_down       10.63     2.7
matmul_rmsnorm_fused:L20.ffn_down        9.48     2.4
matmul_rmsnorm_fused:L16.ffn_down        8.80     2.2
matmul_rmsnorm_fused:L22.ffn_down        8.80     2.2
matmul_rmsnorm_fused:L18.ffn_down        8.79     2.2
matmul_rmsnorm_fused:L9.ffn_down        8.79     2.2
matmul_rmsnorm_fused:L1.ffn_down        8.78     2.2
matmul_rmsnorm_fused:L19.ffn_down        8.77     2.2
matmul_rmsnorm_fused:L10.ffn_down        8.75     2.2
matmul_rmsnorm_fused:L6.ffn_down        8.72     2.2
matmul_rmsnorm_fused:L15.ffn_down        8.70     2.2
matmul_rmsnorm_fused:L23.ffn_down        8.69     2.2
matmul_rmsnorm_fused:L0.ffn_down        8.68     2.2
matmul_rmsnorm_fused:L14.ffn_down        8.66     2.2
matmul_rmsnorm_fused:L17.ffn_down        8.65     2.2
matmul_rmsnorm_fused:L25.ffn_down        8.63     2.2
matmul_rmsnorm_fused:L13.ffn_down        8.62     2.2
matmul_rmsnorm_fused:L8.ffn_down        8.62     2.2
matmul_rmsnorm_fused:L3.ffn_down        8.61     2.2
matmul_rmsnorm_fused:L4.ffn_down        8.60     2.2
matmul_rmsnorm_fused:L5.ffn_down        8.59     2.2
matmul_rmsnorm_fused:L7.ffn_down        8.59     2.2
matmul_rmsnorm_fused:L24.ffn_down        8.58     2.2
rmsnorm                          3.70     0.9
sample_phase2                    3.24     0.8
matmul:o_proj:L12                0.80     0.2
rope                             0.78     0.2
matmul:q_proj:L12                0.24     0.1
matmul:o_proj:L21                0.21     0.1
matmul:q_proj:L0                 0.18     0.0
matmul:o_proj:L2                 0.18     0.0
matmul:q_proj:L21                0.17     0.0
matmul:q_proj:L23                0.16     0.0
matmul:q_proj:L20                0.15     0.0
matmul:o_proj:L0                 0.15     0.0
matmul:q_proj:L3                 0.15     0.0
matmul:o_proj:L10                0.15     0.0
matmul:o_proj:L22                0.15     0.0
matmul:o_proj:L19                0.15     0.0
matmul:o_proj:L20                0.15     0.0
matmul:q_proj:L19                0.14     0.0
matmul:q_proj:L22                0.14     0.0
matmul:o_proj:L11                0.14     0.0
matmul:o_proj:L16                0.14     0.0
matmul:o_proj:L1                 0.14     0.0
matmul:o_proj:L23                0.14     0.0
matmul:o_proj:L3                 0.14     0.0
matmul:q_proj:L2                 0.14     0.0
matmul:q_proj:L7                 0.14     0.0
matmul:o_proj:L13                0.13     0.0
matmul:q_proj:L10                0.13     0.0
matmul:q_proj:L16                0.13     0.0
matmul:o_proj:L9                 0.13     0.0
matmul:q_proj:L17                0.13     0.0
matmul:q_proj:L11                0.13     0.0
matmul:q_proj:L1                 0.13     0.0
matmul:o_proj:L15                0.13     0.0
matmul:o_proj:L6                 0.12     0.0
matmul:q_proj:L13                0.12     0.0
matmul:o_proj:L7                 0.12     0.0
matmul:q_proj:L15                0.12     0.0
matmul:q_proj:L18                0.12     0.0
matmul:o_proj:L25                0.12     0.0
matmul:o_proj:L14                0.12     0.0
matmul:q_proj:L9                 0.12     0.0
matmul:o_proj:L24                0.12     0.0
matmul:o_proj:L8                 0.12     0.0
matmul:o_proj:L4                 0.12     0.0
matmul:o_proj:L18                0.12     0.0
matmul:o_proj:L17                0.12     0.0
matmul:o_proj:L5                 0.12     0.0
matmul:q_proj:L14                0.12     0.0
matmul:q_proj:L25                0.12     0.0
matmul:q_proj:L24                0.12     0.0
matmul:q_proj:L4                 0.12     0.0
matmul:q_proj:L6                 0.12     0.0
matmul:q_proj:L8                 0.12     0.0
matmul:q_proj:L5                 0.11     0.0
matmul:k_proj:L12                0.11     0.0
matmul:v_proj:L12                0.10     0.0
sample_phase1                    0.08     0.0
matmul:k_proj:L21                0.07     0.0
matmul:v_proj:L21                0.07     0.0
matmul:v_proj:L3                 0.06     0.0
matmul:k_proj:L3                 0.06     0.0
matmul:k_proj:L0                 0.06     0.0
matmul:v_proj:L0                 0.06     0.0
matmul:k_proj:L23                0.06     0.0
matmul:k_proj:L22                0.05     0.0
matmul:v_proj:L23                0.05     0.0
matmul:v_proj:L22                0.05     0.0
matmul:k_proj:L19                0.05     0.0
matmul:k_proj:L2                 0.05     0.0
matmul:k_proj:L13                0.05     0.0
matmul:v_proj:L20                0.05     0.0
matmul:k_proj:L24                0.05     0.0
matmul:k_proj:L20                0.05     0.0
matmul:v_proj:L19                0.05     0.0
sample_phase3                    0.05     0.0
matmul:k_proj:L10                0.05     0.0
matmul:k_proj:L16                0.05     0.0
matmul:v_proj:L2                 0.05     0.0
matmul:k_proj:L11                0.05     0.0
matmul:k_proj:L7                 0.05     0.0
matmul:k_proj:L17                0.05     0.0
matmul:v_proj:L8                 0.05     0.0
matmul:v_proj:L16                0.05     0.0
matmul:k_proj:L1                 0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:k_proj:L4                 0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:k_proj:L15                0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:v_proj:L17                0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:k_proj:L18                0.04     0.0
matmul:v_proj:L18                0.04     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:v_proj:L14                0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:v_proj:L24                0.04     0.0
matmul:k_proj:L14                0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:v_proj:L5                 0.04     0.0
matmul:k_proj:L5                 0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:v_proj:L25                0.04     0.0
gather                           0.01     0.0
scale                            0.01     0.0
──────────────────────────────────────────────────
TOTAL                          394.88   100.0

[browser:warning] [7363.7ms][Profile] Batch decode (N=4):
[browser:warning] [7363.8ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                       70.16    17.6
fused_ffn                       39.24     9.9
matmul:lm_head                  30.73     7.7
matmul_rmsnorm_fused:L18.ffn_down       13.82     3.5
matmul_rmsnorm_fused:L8.ffn_down       13.42     3.4
matmul_rmsnorm_fused:L9.ffn_down       10.42     2.6
matmul_rmsnorm_fused:L0.ffn_down       10.03     2.5
matmul_rmsnorm_fused:L17.ffn_down        9.72     2.4
matmul_rmsnorm_fused:L16.ffn_down        8.76     2.2
matmul_rmsnorm_fused:L7.ffn_down        8.71     2.2
matmul_rmsnorm_fused:L6.ffn_down        8.71     2.2
matmul_rmsnorm_fused:L25.ffn_down        8.70     2.2
matmul_rmsnorm_fused:L15.ffn_down        8.68     2.2
matmul_rmsnorm_fused:L1.ffn_down        8.66     2.2
matmul_rmsnorm_fused:L23.ffn_down        8.65     2.2
matmul_rmsnorm_fused:L19.ffn_down        8.65     2.2
matmul_rmsnorm_fused:L10.ffn_down        8.65     2.2
matmul_rmsnorm_fused:L2.ffn_down        8.64     2.2
matmul_rmsnorm_fused:L14.ffn_down        8.64     2.2
matmul_rmsnorm_fused:L21.ffn_down        8.64     2.2
matmul_rmsnorm_fused:L22.ffn_down        8.63     2.2
matmul_rmsnorm_fused:L12.ffn_down        8.63     2.2
matmul_rmsnorm_fused:L3.ffn_down        8.63     2.2
matmul_rmsnorm_fused:L24.ffn_down        8.62     2.2
matmul_rmsnorm_fused:L4.ffn_down        8.62     2.2
matmul_rmsnorm_fused:L11.ffn_down        8.61     2.2
matmul_rmsnorm_fused:L5.ffn_down        8.61     2.2
matmul_rmsnorm_fused:L13.ffn_down        8.60     2.2
matmul_rmsnorm_fused:L20.ffn_down        8.59     2.2
rmsnorm                          3.45     0.9
sample_phase2                    3.38     0.9
rope                             0.82     0.2
sample_phase1                    0.74     0.2
sample_phase3                    0.62     0.2
matmul:o_proj:L9                 0.31     0.1
matmul:o_proj:L19                0.26     0.1
matmul:o_proj:L0                 0.22     0.1
matmul:q_proj:L0                 0.22     0.1
matmul:q_proj:L9                 0.19     0.0
matmul:q_proj:L18                0.16     0.0
matmul:q_proj:L19                0.16     0.0
matmul:o_proj:L18                0.15     0.0
matmul:o_proj:L17                0.14     0.0
matmul:o_proj:L8                 0.14     0.0
matmul:o_proj:L7                 0.14     0.0
matmul:q_proj:L7                 0.14     0.0
matmul:o_proj:L16                0.13     0.0
matmul:o_proj:L25                0.13     0.0
matmul:q_proj:L17                0.13     0.0
matmul:q_proj:L8                 0.13     0.0
matmul:o_proj:L6                 0.13     0.0
matmul:o_proj:L15                0.13     0.0
matmul:q_proj:L16                0.13     0.0
matmul:o_proj:L2                 0.13     0.0
matmul:o_proj:L12                0.13     0.0
matmul:o_proj:L1                 0.13     0.0
matmul:q_proj:L10                0.12     0.0
matmul:o_proj:L11                0.12     0.0
matmul:q_proj:L25                0.12     0.0
matmul:o_proj:L13                0.12     0.0
matmul:q_proj:L1                 0.12     0.0
matmul:q_proj:L11                0.12     0.0
matmul:o_proj:L5                 0.12     0.0
matmul:o_proj:L23                0.12     0.0
matmul:q_proj:L21                0.12     0.0
matmul:o_proj:L22                0.12     0.0
matmul:o_proj:L3                 0.12     0.0
matmul:q_proj:L22                0.12     0.0
matmul:q_proj:L20                0.12     0.0
matmul:o_proj:L10                0.12     0.0
matmul:q_proj:L13                0.12     0.0
matmul:o_proj:L24                0.12     0.0
matmul:o_proj:L20                0.12     0.0
matmul:o_proj:L21                0.12     0.0
matmul:q_proj:L14                0.12     0.0
matmul:q_proj:L12                0.12     0.0
matmul:q_proj:L5                 0.12     0.0
matmul:q_proj:L24                0.12     0.0
matmul:q_proj:L15                0.12     0.0
matmul:q_proj:L2                 0.12     0.0
matmul:q_proj:L4                 0.12     0.0
matmul:o_proj:L14                0.12     0.0
matmul:q_proj:L3                 0.12     0.0
matmul:q_proj:L23                0.12     0.0
matmul:q_proj:L6                 0.12     0.0
matmul:o_proj:L4                 0.12     0.0
matmul:v_proj:L0                 0.10     0.0
matmul:k_proj:L0                 0.10     0.0
matmul:k_proj:L19                0.07     0.0
matmul:k_proj:L9                 0.07     0.0
gather                           0.07     0.0
matmul:v_proj:L19                0.07     0.0
matmul:v_proj:L9                 0.06     0.0
matmul:k_proj:L18                0.06     0.0
matmul:v_proj:L18                0.06     0.0
scale                            0.06     0.0
matmul:k_proj:L22                0.05     0.0
matmul:k_proj:L11                0.05     0.0
matmul:k_proj:L17                0.05     0.0
matmul:k_proj:L8                 0.05     0.0
matmul:k_proj:L16                0.05     0.0
matmul:k_proj:L7                 0.05     0.0
matmul:v_proj:L17                0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:v_proj:L16                0.04     0.0
matmul:k_proj:L10                0.04     0.0
matmul:k_proj:L24                0.04     0.0
matmul:k_proj:L21                0.04     0.0
matmul:k_proj:L5                 0.04     0.0
matmul:k_proj:L1                 0.04     0.0
matmul:k_proj:L3                 0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:k_proj:L15                0.04     0.0
matmul:k_proj:L4                 0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:k_proj:L12                0.04     0.0
matmul:k_proj:L23                0.04     0.0
matmul:k_proj:L13                0.04     0.0
matmul:k_proj:L2                 0.04     0.0
matmul:k_proj:L14                0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:k_proj:L20                0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:v_proj:L22                0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:v_proj:L5                 0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:v_proj:L24                0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:v_proj:L14                0.04     0.0
matmul:v_proj:L15                0.04     0.0
──────────────────────────────────────────────────
TOTAL                          397.92   100.0

[browser:warning] [7816.7ms][Profile] Batch decode (N=4):
[browser:warning] [7816.8ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                       77.10    19.0
fused_ffn                       39.53     9.7
matmul:lm_head                  30.07     7.4
matmul_rmsnorm_fused:L23.ffn_down       10.74     2.6
matmul_rmsnorm_fused:L15.ffn_down       10.50     2.6
matmul_rmsnorm_fused:L6.ffn_down       10.44     2.6
matmul_rmsnorm_fused:L22.ffn_down       10.38     2.6
matmul_rmsnorm_fused:L12.ffn_down       10.32     2.5
matmul_rmsnorm_fused:L13.ffn_down       10.27     2.5
matmul_rmsnorm_fused:L14.ffn_down       10.26     2.5
matmul_rmsnorm_fused:L4.ffn_down       10.15     2.5
matmul_rmsnorm_fused:L3.ffn_down       10.14     2.5
matmul_rmsnorm_fused:L24.ffn_down       10.01     2.5
matmul_rmsnorm_fused:L5.ffn_down        9.56     2.3
matmul_rmsnorm_fused:L21.ffn_down        8.93     2.2
matmul_rmsnorm_fused:L2.ffn_down        8.71     2.1
matmul_rmsnorm_fused:L10.ffn_down        8.68     2.1
matmul_rmsnorm_fused:L20.ffn_down        8.68     2.1
matmul_rmsnorm_fused:L11.ffn_down        8.68     2.1
matmul_rmsnorm_fused:L1.ffn_down        8.67     2.1
matmul_rmsnorm_fused:L16.ffn_down        8.67     2.1
matmul_rmsnorm_fused:L9.ffn_down        8.66     2.1
matmul_rmsnorm_fused:L19.ffn_down        8.66     2.1
matmul_rmsnorm_fused:L25.ffn_down        8.64     2.1
matmul_rmsnorm_fused:L17.ffn_down        8.64     2.1
matmul_rmsnorm_fused:L18.ffn_down        8.63     2.1
matmul_rmsnorm_fused:L0.ffn_down        8.62     2.1
matmul_rmsnorm_fused:L8.ffn_down        8.59     2.1
matmul_rmsnorm_fused:L7.ffn_down        8.58     2.1
rmsnorm                          3.61     0.9
sample_phase2                    3.24     0.8
rope                             0.82     0.2
matmul:o_proj:L22                0.33     0.1
matmul:q_proj:L5                 0.18     0.0
matmul:o_proj:L5                 0.17     0.0
matmul:q_proj:L23                0.16     0.0
matmul:o_proj:L25                0.16     0.0
matmul:q_proj:L22                0.15     0.0
matmul:o_proj:L12                0.15     0.0
matmul:o_proj:L23                0.15     0.0
matmul:o_proj:L13                0.14     0.0
matmul:o_proj:L7                 0.14     0.0
matmul:o_proj:L24                0.14     0.0
matmul:o_proj:L3                 0.14     0.0
matmul:q_proj:L7                 0.14     0.0
matmul:q_proj:L4                 0.14     0.0
matmul:o_proj:L6                 0.14     0.0
matmul:q_proj:L15                0.14     0.0
matmul:o_proj:L0                 0.14     0.0
matmul:o_proj:L4                 0.14     0.0
matmul:o_proj:L15                0.14     0.0
matmul:o_proj:L14                0.14     0.0
matmul:q_proj:L14                0.14     0.0
matmul:o_proj:L16                0.13     0.0
matmul:o_proj:L21                0.13     0.0
matmul:o_proj:L11                0.13     0.0
matmul:q_proj:L25                0.13     0.0
matmul:q_proj:L24                0.13     0.0
matmul:q_proj:L11                0.13     0.0
matmul:q_proj:L3                 0.13     0.0
matmul:q_proj:L13                0.13     0.0
matmul:o_proj:L2                 0.13     0.0
matmul:q_proj:L12                0.12     0.0
matmul:q_proj:L6                 0.12     0.0
matmul:o_proj:L20                0.12     0.0
matmul:q_proj:L1                 0.12     0.0
matmul:q_proj:L0                 0.12     0.0
matmul:o_proj:L19                0.12     0.0
matmul:q_proj:L16                0.12     0.0
matmul:o_proj:L1                 0.12     0.0
matmul:q_proj:L20                0.12     0.0
matmul:q_proj:L21                0.12     0.0
matmul:o_proj:L10                0.12     0.0
matmul:q_proj:L10                0.12     0.0
matmul:q_proj:L17                0.12     0.0
matmul:q_proj:L2                 0.12     0.0
matmul:o_proj:L9                 0.12     0.0
matmul:q_proj:L9                 0.12     0.0
matmul:q_proj:L18                0.12     0.0
matmul:q_proj:L8                 0.12     0.0
matmul:q_proj:L19                0.12     0.0
matmul:o_proj:L8                 0.11     0.0
matmul:o_proj:L18                0.11     0.0
matmul:o_proj:L17                0.11     0.0
sample_phase1                    0.07     0.0
matmul:k_proj:L22                0.07     0.0
matmul:k_proj:L5                 0.06     0.0
matmul:v_proj:L22                0.06     0.0
matmul:v_proj:L5                 0.06     0.0
matmul:k_proj:L23                0.06     0.0
matmul:v_proj:L23                0.06     0.0
matmul:k_proj:L7                 0.06     0.0
matmul:v_proj:L7                 0.06     0.0
matmul:k_proj:L14                0.06     0.0
matmul:k_proj:L4                 0.05     0.0
matmul:k_proj:L15                0.05     0.0
matmul:v_proj:L4                 0.05     0.0
matmul:v_proj:L15                0.05     0.0
sample_phase3                    0.05     0.0
matmul:v_proj:L14                0.05     0.0
matmul:k_proj:L16                0.05     0.0
matmul:k_proj:L24                0.05     0.0
matmul:k_proj:L13                0.05     0.0
matmul:k_proj:L12                0.05     0.0
matmul:k_proj:L11                0.05     0.0
matmul:k_proj:L25                0.05     0.0
matmul:k_proj:L3                 0.05     0.0
matmul:k_proj:L0                 0.04     0.0
matmul:v_proj:L24                0.04     0.0
matmul:k_proj:L21                0.04     0.0
matmul:k_proj:L1                 0.04     0.0
matmul:k_proj:L20                0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:v_proj:L0                 0.04     0.0
matmul:k_proj:L10                0.04     0.0
matmul:k_proj:L2                 0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:k_proj:L18                0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:k_proj:L19                0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:v_proj:L16                0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:k_proj:L17                0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:v_proj:L17                0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:v_proj:L18                0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:v_proj:L19                0.04     0.0
matmul:v_proj:L9                 0.04     0.0
gather                           0.02     0.0
scale                            0.01     0.0
──────────────────────────────────────────────────
TOTAL                          406.82   100.0

[browser:warning] [8279.6ms][Profile] Batch decode (N=4):
[browser:warning] [8279.7ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                       84.68    20.4
fused_ffn                       41.55    10.0
matmul:lm_head                  31.00     7.5
matmul_rmsnorm_fused:L6.ffn_down       10.48     2.5
matmul_rmsnorm_fused:L14.ffn_down       10.44     2.5
matmul_rmsnorm_fused:L15.ffn_down       10.38     2.5
matmul_rmsnorm_fused:L25.ffn_down       10.36     2.5
matmul_rmsnorm_fused:L7.ffn_down       10.25     2.5
matmul_rmsnorm_fused:L16.ffn_down       10.14     2.4
matmul_rmsnorm_fused:L18.ffn_down        9.80     2.4
matmul_rmsnorm_fused:L9.ffn_down        9.77     2.4
matmul_rmsnorm_fused:L22.ffn_down        9.47     2.3
matmul_rmsnorm_fused:L24.ffn_down        9.45     2.3
matmul_rmsnorm_fused:L4.ffn_down        9.18     2.2
matmul_rmsnorm_fused:L23.ffn_down        9.12     2.2
matmul_rmsnorm_fused:L5.ffn_down        8.97     2.2
matmul_rmsnorm_fused:L0.ffn_down        8.95     2.2
matmul_rmsnorm_fused:L21.ffn_down        8.76     2.1
matmul_rmsnorm_fused:L2.ffn_down        8.76     2.1
matmul_rmsnorm_fused:L13.ffn_down        8.73     2.1
matmul_rmsnorm_fused:L3.ffn_down        8.69     2.1
matmul_rmsnorm_fused:L17.ffn_down        8.68     2.1
matmul_rmsnorm_fused:L8.ffn_down        8.68     2.1
matmul_rmsnorm_fused:L12.ffn_down        8.66     2.1
matmul_rmsnorm_fused:L10.ffn_down        8.64     2.1
matmul_rmsnorm_fused:L20.ffn_down        8.63     2.1
matmul_rmsnorm_fused:L11.ffn_down        8.63     2.1
matmul_rmsnorm_fused:L1.ffn_down        8.62     2.1
matmul_rmsnorm_fused:L19.ffn_down        8.61     2.1
sample_phase2                    3.28     0.8
rmsnorm                          3.01     0.7
rope                             0.78     0.2
matmul:o_proj:L17                0.38     0.1
matmul:o_proj:L8                 0.26     0.1
matmul:q_proj:L0                 0.18     0.0
matmul:o_proj:L24                0.17     0.0
matmul:q_proj:L24                0.16     0.0
matmul:q_proj:L23                0.16     0.0
matmul:o_proj:L13                0.15     0.0
matmul:o_proj:L15                0.15     0.0
matmul:q_proj:L5                 0.15     0.0
matmul:o_proj:L9                 0.15     0.0
matmul:o_proj:L21                0.15     0.0
matmul:o_proj:L5                 0.15     0.0
matmul:o_proj:L23                0.15     0.0
matmul:o_proj:L0                 0.14     0.0
matmul:o_proj:L18                0.14     0.0
matmul:q_proj:L17                0.14     0.0
matmul:o_proj:L14                0.14     0.0
matmul:o_proj:L6                 0.13     0.0
matmul:o_proj:L25                0.13     0.0
matmul:o_proj:L22                0.13     0.0
matmul:o_proj:L7                 0.13     0.0
matmul:q_proj:L3                 0.13     0.0
matmul:o_proj:L3                 0.13     0.0
matmul:q_proj:L15                0.13     0.0
matmul:q_proj:L9                 0.13     0.0
matmul:q_proj:L7                 0.13     0.0
matmul:o_proj:L16                0.13     0.0
matmul:q_proj:L18                0.13     0.0
matmul:o_proj:L4                 0.13     0.0
matmul:q_proj:L16                0.13     0.0
matmul:q_proj:L14                0.12     0.0
matmul:q_proj:L22                0.12     0.0
matmul:q_proj:L8                 0.12     0.0
matmul:q_proj:L13                0.12     0.0
matmul:q_proj:L6                 0.12     0.0
matmul:o_proj:L2                 0.12     0.0
matmul:o_proj:L12                0.12     0.0
matmul:q_proj:L25                0.12     0.0
matmul:o_proj:L19                0.12     0.0
matmul:o_proj:L20                0.12     0.0
matmul:q_proj:L4                 0.12     0.0
matmul:o_proj:L1                 0.12     0.0
matmul:q_proj:L21                0.12     0.0
matmul:o_proj:L11                0.12     0.0
matmul:q_proj:L10                0.12     0.0
matmul:q_proj:L1                 0.12     0.0
matmul:o_proj:L10                0.12     0.0
matmul:q_proj:L19                0.12     0.0
matmul:q_proj:L11                0.12     0.0
matmul:q_proj:L2                 0.12     0.0
matmul:q_proj:L12                0.12     0.0
matmul:q_proj:L20                0.12     0.0
sample_phase3                    0.08     0.0
sample_phase1                    0.08     0.0
matmul:k_proj:L0                 0.08     0.0
matmul:v_proj:L23                0.07     0.0
matmul:v_proj:L0                 0.07     0.0
matmul:k_proj:L23                0.06     0.0
matmul:k_proj:L24                0.06     0.0
matmul:v_proj:L24                0.06     0.0
matmul:k_proj:L5                 0.06     0.0
matmul:v_proj:L5                 0.05     0.0
matmul:k_proj:L17                0.05     0.0
matmul:v_proj:L17                0.05     0.0
matmul:k_proj:L18                0.05     0.0
matmul:k_proj:L7                 0.05     0.0
matmul:k_proj:L15                0.05     0.0
matmul:k_proj:L3                 0.05     0.0
matmul:k_proj:L13                0.05     0.0
matmul:k_proj:L16                0.05     0.0
matmul:k_proj:L14                0.05     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:k_proj:L12                0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:k_proj:L4                 0.04     0.0
matmul:k_proj:L19                0.04     0.0
matmul:k_proj:L22                0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:k_proj:L10                0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:k_proj:L2                 0.04     0.0
matmul:v_proj:L16                0.04     0.0
matmul:k_proj:L1                 0.04     0.0
matmul:k_proj:L21                0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:v_proj:L18                0.04     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:k_proj:L20                0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:k_proj:L11                0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:v_proj:L22                0.04     0.0
matmul:v_proj:L14                0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:v_proj:L19                0.04     0.0
matmul:v_proj:L11                0.04     0.0
gather                           0.04     0.0
scale                            0.03     0.0
──────────────────────────────────────────────────
TOTAL                          415.08   100.0

[browser:warning] [8747.9ms][Profile] Batch decode (N=4):
[browser:warning] [8748.1ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                       91.22    21.6
fused_ffn                       39.82     9.4
matmul:lm_head                  31.24     7.4
matmul_rmsnorm_fused:L8.ffn_down       10.53     2.5
matmul_rmsnorm_fused:L17.ffn_down       10.48     2.5
matmul_rmsnorm_fused:L22.ffn_down       10.47     2.5
matmul_rmsnorm_fused:L24.ffn_down       10.46     2.5
matmul_rmsnorm_fused:L10.ffn_down       10.35     2.5
matmul_rmsnorm_fused:L13.ffn_down       10.19     2.4
matmul_rmsnorm_fused:L1.ffn_down       10.03     2.4
matmul_rmsnorm_fused:L15.ffn_down        9.91     2.3
matmul_rmsnorm_fused:L19.ffn_down        9.70     2.3
matmul_rmsnorm_fused:L6.ffn_down        9.51     2.3
matmul_rmsnorm_fused:L0.ffn_down        9.39     2.2
matmul_rmsnorm_fused:L5.ffn_down        9.19     2.2
matmul_rmsnorm_fused:L7.ffn_down        9.08     2.1
matmul_rmsnorm_fused:L4.ffn_down        8.96     2.1
matmul_rmsnorm_fused:L18.ffn_down        8.83     2.1
matmul_rmsnorm_fused:L16.ffn_down        8.80     2.1
matmul_rmsnorm_fused:L11.ffn_down        8.71     2.1
matmul_rmsnorm_fused:L23.ffn_down        8.70     2.1
matmul_rmsnorm_fused:L9.ffn_down        8.69     2.1
matmul_rmsnorm_fused:L2.ffn_down        8.68     2.1
matmul_rmsnorm_fused:L12.ffn_down        8.68     2.1
matmul_rmsnorm_fused:L25.ffn_down        8.68     2.1
matmul_rmsnorm_fused:L14.ffn_down        8.65     2.0
matmul_rmsnorm_fused:L21.ffn_down        8.64     2.0
matmul_rmsnorm_fused:L3.ffn_down        8.64     2.0
matmul_rmsnorm_fused:L20.ffn_down        8.63     2.0
sample_phase2                    3.31     0.8
rmsnorm                          3.25     0.8
rope                             0.84     0.2
matmul:o_proj:L5                 0.69     0.2
matmul:q_proj:L0                 0.22     0.1
matmul:o_proj:L0                 0.17     0.0
matmul:o_proj:L19                0.16     0.0
matmul:q_proj:L7                 0.15     0.0
matmul:o_proj:L18                0.15     0.0
matmul:o_proj:L10                0.15     0.0
matmul:o_proj:L1                 0.15     0.0
matmul:o_proj:L16                0.14     0.0
matmul:q_proj:L5                 0.14     0.0
matmul:q_proj:L23                0.14     0.0
matmul:o_proj:L17                0.14     0.0
matmul:o_proj:L7                 0.14     0.0
matmul:q_proj:L16                0.14     0.0
matmul:o_proj:L8                 0.14     0.0
matmul:q_proj:L14                0.14     0.0
matmul:q_proj:L11                0.14     0.0
matmul:q_proj:L25                0.13     0.0
matmul:o_proj:L21                0.13     0.0
matmul:q_proj:L19                0.13     0.0
matmul:o_proj:L14                0.13     0.0
matmul:q_proj:L18                0.13     0.0
matmul:o_proj:L3                 0.13     0.0
matmul:o_proj:L13                0.13     0.0
matmul:o_proj:L24                0.13     0.0
matmul:o_proj:L25                0.13     0.0
matmul:q_proj:L1                 0.13     0.0
matmul:q_proj:L9                 0.13     0.0
matmul:o_proj:L22                0.13     0.0
matmul:o_proj:L23                0.13     0.0
matmul:o_proj:L6                 0.13     0.0
matmul:o_proj:L9                 0.13     0.0
matmul:o_proj:L15                0.13     0.0
matmul:o_proj:L4                 0.13     0.0
matmul:o_proj:L2                 0.13     0.0
matmul:q_proj:L4                 0.12     0.0
matmul:o_proj:L11                0.12     0.0
matmul:q_proj:L10                0.12     0.0
matmul:q_proj:L22                0.12     0.0
matmul:q_proj:L2                 0.12     0.0
matmul:q_proj:L24                0.12     0.0
matmul:o_proj:L12                0.12     0.0
matmul:q_proj:L6                 0.12     0.0
matmul:q_proj:L17                0.12     0.0
matmul:q_proj:L8                 0.12     0.0
matmul:q_proj:L20                0.12     0.0
matmul:q_proj:L13                0.12     0.0
matmul:q_proj:L15                0.12     0.0
matmul:q_proj:L21                0.12     0.0
matmul:q_proj:L12                0.12     0.0
matmul:q_proj:L3                 0.12     0.0
matmul:o_proj:L20                0.12     0.0
sample_phase1                    0.09     0.0
matmul:k_proj:L0                 0.09     0.0
matmul:v_proj:L0                 0.08     0.0
sample_phase3                    0.07     0.0
matmul:v_proj:L7                 0.07     0.0
matmul:k_proj:L7                 0.06     0.0
matmul:k_proj:L19                0.06     0.0
matmul:v_proj:L19                0.06     0.0
matmul:v_proj:L16                0.06     0.0
matmul:k_proj:L16                0.06     0.0
matmul:k_proj:L23                0.06     0.0
matmul:v_proj:L5                 0.05     0.0
matmul:k_proj:L5                 0.05     0.0
matmul:k_proj:L25                0.05     0.0
matmul:k_proj:L14                0.05     0.0
matmul:v_proj:L23                0.05     0.0
matmul:v_proj:L25                0.05     0.0
matmul:v_proj:L14                0.05     0.0
matmul:k_proj:L2                 0.05     0.0
matmul:k_proj:L11                0.05     0.0
matmul:k_proj:L13                0.05     0.0
matmul:k_proj:L1                 0.05     0.0
matmul:k_proj:L18                0.05     0.0
matmul:v_proj:L6                 0.05     0.0
matmul:v_proj:L11                0.05     0.0
matmul:k_proj:L22                0.05     0.0
matmul:k_proj:L15                0.05     0.0
matmul:v_proj:L18                0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:k_proj:L3                 0.04     0.0
matmul:k_proj:L24                0.04     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:k_proj:L10                0.04     0.0
matmul:k_proj:L17                0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:k_proj:L21                0.04     0.0
matmul:k_proj:L12                0.04     0.0
matmul:k_proj:L20                0.04     0.0
matmul:v_proj:L22                0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:k_proj:L4                 0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:v_proj:L17                0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:v_proj:L24                0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:v_proj:L3                 0.04     0.0
gather                           0.04     0.0
scale                            0.03     0.0
──────────────────────────────────────────────────
TOTAL                          422.55   100.0

[browser:warning] [9224.7ms][Profile] Batch decode (N=4):
[browser:warning] [9224.7ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                       98.33    22.9
fused_ffn                       40.33     9.4
matmul:lm_head                  30.77     7.2
matmul_rmsnorm_fused:L9.ffn_down       10.55     2.5
matmul_rmsnorm_fused:L13.ffn_down       10.44     2.4
matmul_rmsnorm_fused:L11.ffn_down       10.35     2.4
matmul_rmsnorm_fused:L24.ffn_down       10.27     2.4
matmul_rmsnorm_fused:L0.ffn_down       10.26     2.4
matmul_rmsnorm_fused:L22.ffn_down       10.09     2.4
matmul_rmsnorm_fused:L7.ffn_down       10.01     2.3
matmul_rmsnorm_fused:L2.ffn_down        9.99     2.3
matmul_rmsnorm_fused:L15.ffn_down        9.98     2.3
matmul_rmsnorm_fused:L18.ffn_down        9.29     2.2
matmul_rmsnorm_fused:L17.ffn_down        9.22     2.1
matmul_rmsnorm_fused:L20.ffn_down        9.17     2.1
matmul_rmsnorm_fused:L4.ffn_down        9.17     2.1
matmul_rmsnorm_fused:L5.ffn_down        9.14     2.1
matmul_rmsnorm_fused:L19.ffn_down        8.91     2.1
matmul_rmsnorm_fused:L16.ffn_down        8.77     2.0
matmul_rmsnorm_fused:L23.ffn_down        8.69     2.0
matmul_rmsnorm_fused:L10.ffn_down        8.67     2.0
matmul_rmsnorm_fused:L12.ffn_down        8.67     2.0
matmul_rmsnorm_fused:L21.ffn_down        8.67     2.0
matmul_rmsnorm_fused:L6.ffn_down        8.66     2.0
matmul_rmsnorm_fused:L8.ffn_down        8.66     2.0
matmul_rmsnorm_fused:L1.ffn_down        8.66     2.0
matmul_rmsnorm_fused:L25.ffn_down        8.66     2.0
matmul_rmsnorm_fused:L14.ffn_down        8.65     2.0
matmul_rmsnorm_fused:L3.ffn_down        8.64     2.0
rmsnorm                          3.53     0.8
sample_phase2                    3.36     0.8
rope                             0.80     0.2
matmul:o_proj:L5                 0.34     0.1
matmul:q_proj:L0                 0.18     0.0
matmul:o_proj:L0                 0.17     0.0
matmul:o_proj:L20                0.16     0.0
matmul:q_proj:L18                0.15     0.0
matmul:o_proj:L16                0.15     0.0
matmul:o_proj:L22                0.15     0.0
matmul:o_proj:L18                0.15     0.0
matmul:q_proj:L20                0.15     0.0
matmul:o_proj:L11                0.15     0.0
matmul:o_proj:L9                 0.15     0.0
matmul:o_proj:L7                 0.14     0.0
matmul:q_proj:L5                 0.14     0.0
matmul:q_proj:L16                0.14     0.0
matmul:o_proj:L15                0.14     0.0
matmul:o_proj:L24                0.13     0.0
matmul:q_proj:L3                 0.13     0.0
matmul:q_proj:L14                0.13     0.0
matmul:o_proj:L3                 0.13     0.0
matmul:o_proj:L1                 0.13     0.0
matmul:q_proj:L17                0.13     0.0
matmul:o_proj:L25                0.13     0.0
matmul:q_proj:L24                0.13     0.0
matmul:o_proj:L2                 0.13     0.0
matmul:o_proj:L13                0.13     0.0
matmul:q_proj:L1                 0.13     0.0
matmul:o_proj:L14                0.13     0.0
matmul:o_proj:L4                 0.13     0.0
matmul:q_proj:L22                0.13     0.0
matmul:q_proj:L7                 0.13     0.0
matmul:q_proj:L10                0.13     0.0
matmul:q_proj:L9                 0.13     0.0
matmul:o_proj:L8                 0.13     0.0
matmul:q_proj:L23                0.13     0.0
matmul:o_proj:L12                0.13     0.0
matmul:q_proj:L12                0.13     0.0
matmul:q_proj:L25                0.13     0.0
matmul:o_proj:L19                0.13     0.0
matmul:o_proj:L10                0.13     0.0
matmul:o_proj:L21                0.13     0.0
matmul:o_proj:L6                 0.12     0.0
matmul:o_proj:L23                0.12     0.0
matmul:q_proj:L11                0.12     0.0
matmul:o_proj:L17                0.12     0.0
matmul:q_proj:L15                0.12     0.0
matmul:q_proj:L8                 0.12     0.0
matmul:q_proj:L2                 0.12     0.0
matmul:q_proj:L13                0.12     0.0
matmul:q_proj:L21                0.12     0.0
matmul:q_proj:L6                 0.12     0.0
matmul:q_proj:L19                0.12     0.0
matmul:q_proj:L4                 0.12     0.0
sample_phase1                    0.08     0.0
matmul:k_proj:L0                 0.08     0.0
matmul:v_proj:L0                 0.07     0.0
sample_phase3                    0.07     0.0
matmul:k_proj:L18                0.06     0.0
matmul:v_proj:L5                 0.06     0.0
matmul:v_proj:L18                0.06     0.0
matmul:k_proj:L20                0.06     0.0
matmul:v_proj:L20                0.05     0.0
matmul:k_proj:L5                 0.05     0.0
matmul:k_proj:L14                0.05     0.0
matmul:k_proj:L3                 0.05     0.0
matmul:k_proj:L16                0.05     0.0
matmul:v_proj:L16                0.05     0.0
matmul:v_proj:L3                 0.05     0.0
matmul:v_proj:L14                0.05     0.0
matmul:k_proj:L24                0.05     0.0
matmul:k_proj:L12                0.05     0.0
matmul:k_proj:L22                0.05     0.0
matmul:k_proj:L1                 0.05     0.0
matmul:k_proj:L23                0.05     0.0
matmul:k_proj:L7                 0.05     0.0
matmul:v_proj:L24                0.05     0.0
matmul:k_proj:L17                0.05     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:k_proj:L10                0.04     0.0
matmul:k_proj:L13                0.04     0.0
matmul:k_proj:L2                 0.04     0.0
matmul:k_proj:L15                0.04     0.0
matmul:k_proj:L21                0.04     0.0
matmul:v_proj:L22                0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:k_proj:L19                0.04     0.0
matmul:k_proj:L11                0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:k_proj:L4                 0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:v_proj:L19                0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:v_proj:L17                0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:v_proj:L6                 0.04     0.0
gather                           0.03     0.0
scale                            0.02     0.0
──────────────────────────────────────────────────
TOTAL                          429.16   100.0

[browser:warning] [9716.1ms][Profile] Batch decode (N=4):
[browser:warning] [9716.4ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      104.76    23.8
fused_ffn                       40.23     9.2
matmul:lm_head                  31.24     7.1
matmul_rmsnorm_fused:L15.ffn_down       11.64     2.6
matmul_rmsnorm_fused:L24.ffn_down       10.69     2.4
matmul_rmsnorm_fused:L1.ffn_down       10.64     2.4
matmul_rmsnorm_fused:L7.ffn_down       10.54     2.4
matmul_rmsnorm_fused:L12.ffn_down       10.50     2.4
matmul_rmsnorm_fused:L18.ffn_down       10.22     2.3
matmul_rmsnorm_fused:L20.ffn_down       10.15     2.3
matmul_rmsnorm_fused:L6.ffn_down        9.81     2.2
matmul_rmsnorm_fused:L4.ffn_down        9.67     2.2
matmul_rmsnorm_fused:L9.ffn_down        9.55     2.2
matmul_rmsnorm_fused:L23.ffn_down        9.25     2.1
matmul_rmsnorm_fused:L10.ffn_down        8.95     2.0
matmul_rmsnorm_fused:L0.ffn_down        8.92     2.0
matmul_rmsnorm_fused:L22.ffn_down        8.81     2.0
matmul_rmsnorm_fused:L19.ffn_down        8.75     2.0
matmul_rmsnorm_fused:L17.ffn_down        8.75     2.0
matmul_rmsnorm_fused:L16.ffn_down        8.74     2.0
matmul_rmsnorm_fused:L2.ffn_down        8.70     2.0
matmul_rmsnorm_fused:L14.ffn_down        8.69     2.0
matmul_rmsnorm_fused:L25.ffn_down        8.68     2.0
matmul_rmsnorm_fused:L21.ffn_down        8.67     2.0
matmul_rmsnorm_fused:L11.ffn_down        8.66     2.0
matmul_rmsnorm_fused:L13.ffn_down        8.66     2.0
matmul_rmsnorm_fused:L3.ffn_down        8.66     2.0
matmul_rmsnorm_fused:L5.ffn_down        8.65     2.0
matmul_rmsnorm_fused:L8.ffn_down        8.63     2.0
rmsnorm                          5.16     1.2
sample_phase2                    3.27     0.7
rope                             0.83     0.2
matmul:o_proj:L15                0.65     0.1
matmul:o_proj:L21                0.32     0.1
matmul:o_proj:L24                0.22     0.0
matmul:o_proj:L16                0.19     0.0
matmul:q_proj:L0                 0.18     0.0
matmul:o_proj:L4                 0.16     0.0
matmul:o_proj:L0                 0.15     0.0
matmul:q_proj:L24                0.15     0.0
matmul:q_proj:L16                0.15     0.0
matmul:q_proj:L7                 0.15     0.0
matmul:o_proj:L19                0.14     0.0
matmul:o_proj:L7                 0.14     0.0
matmul:o_proj:L10                0.14     0.0
matmul:q_proj:L19                0.14     0.0
matmul:q_proj:L8                 0.14     0.0
matmul:q_proj:L17                0.14     0.0
matmul:q_proj:L20                0.14     0.0
matmul:q_proj:L13                0.14     0.0
matmul:o_proj:L13                0.14     0.0
matmul:o_proj:L23                0.14     0.0
matmul:o_proj:L17                0.13     0.0
matmul:q_proj:L21                0.13     0.0
matmul:o_proj:L8                 0.13     0.0
matmul:q_proj:L10                0.13     0.0
matmul:o_proj:L1                 0.13     0.0
matmul:o_proj:L22                0.13     0.0
matmul:o_proj:L6                 0.13     0.0
matmul:q_proj:L15                0.13     0.0
matmul:o_proj:L14                0.13     0.0
matmul:q_proj:L4                 0.13     0.0
matmul:o_proj:L5                 0.13     0.0
matmul:o_proj:L3                 0.13     0.0
matmul:o_proj:L18                0.13     0.0
matmul:q_proj:L2                 0.13     0.0
matmul:q_proj:L18                0.13     0.0
matmul:o_proj:L25                0.13     0.0
matmul:q_proj:L9                 0.13     0.0
matmul:q_proj:L3                 0.13     0.0
matmul:o_proj:L11                0.13     0.0
matmul:o_proj:L2                 0.13     0.0
matmul:q_proj:L5                 0.13     0.0
matmul:q_proj:L6                 0.13     0.0
matmul:o_proj:L9                 0.13     0.0
matmul:o_proj:L20                0.12     0.0
matmul:q_proj:L23                0.12     0.0
matmul:q_proj:L25                0.12     0.0
matmul:q_proj:L14                0.12     0.0
matmul:q_proj:L1                 0.12     0.0
matmul:q_proj:L22                0.12     0.0
matmul:q_proj:L11                0.12     0.0
matmul:o_proj:L12                0.12     0.0
matmul:q_proj:L12                0.12     0.0
sample_phase1                    0.08     0.0
matmul:k_proj:L24                0.06     0.0
matmul:k_proj:L0                 0.06     0.0
matmul:v_proj:L0                 0.06     0.0
matmul:v_proj:L24                0.06     0.0
matmul:k_proj:L7                 0.06     0.0
sample_phase3                    0.06     0.0
matmul:k_proj:L10                0.06     0.0
matmul:v_proj:L7                 0.06     0.0
matmul:k_proj:L21                0.05     0.0
matmul:k_proj:L19                0.05     0.0
matmul:k_proj:L16                0.05     0.0
matmul:k_proj:L13                0.05     0.0
matmul:v_proj:L10                0.05     0.0
matmul:k_proj:L8                 0.05     0.0
matmul:v_proj:L21                0.05     0.0
matmul:v_proj:L16                0.05     0.0
matmul:v_proj:L19                0.05     0.0
matmul:v_proj:L8                 0.05     0.0
matmul:v_proj:L13                0.05     0.0
matmul:k_proj:L17                0.05     0.0
matmul:k_proj:L4                 0.05     0.0
matmul:k_proj:L20                0.05     0.0
matmul:k_proj:L15                0.05     0.0
matmul:k_proj:L2                 0.05     0.0
matmul:v_proj:L12                0.05     0.0
matmul:v_proj:L20                0.05     0.0
matmul:v_proj:L15                0.05     0.0
matmul:k_proj:L23                0.05     0.0
matmul:v_proj:L17                0.05     0.0
matmul:k_proj:L3                 0.05     0.0
matmul:v_proj:L4                 0.05     0.0
matmul:k_proj:L18                0.05     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:k_proj:L22                0.04     0.0
matmul:k_proj:L1                 0.04     0.0
matmul:k_proj:L14                0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:k_proj:L11                0.04     0.0
matmul:k_proj:L5                 0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:k_proj:L12                0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:v_proj:L22                0.04     0.0
matmul:v_proj:L5                 0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:v_proj:L18                0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:v_proj:L14                0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:v_proj:L9                 0.04     0.0
gather                           0.03     0.0
scale                            0.02     0.0
──────────────────────────────────────────────────
TOTAL                          439.53   100.0

[browser:warning] [10231.1ms][Profile] Batch decode (N=4):
[browser:warning] [10231.2ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      112.11    25.2
fused_ffn                       41.20     9.3
matmul:lm_head                  31.41     7.1
matmul_rmsnorm_fused:L19.ffn_down       10.54     2.4
matmul_rmsnorm_fused:L18.ffn_down       10.49     2.4
matmul_rmsnorm_fused:L16.ffn_down       10.49     2.4
matmul_rmsnorm_fused:L11.ffn_down       10.48     2.4
matmul_rmsnorm_fused:L10.ffn_down       10.29     2.3
matmul_rmsnorm_fused:L21.ffn_down       10.13     2.3
matmul_rmsnorm_fused:L13.ffn_down       10.12     2.3
matmul_rmsnorm_fused:L3.ffn_down        9.76     2.2
matmul_rmsnorm_fused:L8.ffn_down        9.71     2.2
matmul_rmsnorm_fused:L2.ffn_down        9.40     2.1
matmul_rmsnorm_fused:L24.ffn_down        9.14     2.1
matmul_rmsnorm_fused:L5.ffn_down        9.07     2.0
matmul_rmsnorm_fused:L0.ffn_down        9.02     2.0
matmul_rmsnorm_fused:L4.ffn_down        8.97     2.0
matmul_rmsnorm_fused:L25.ffn_down        8.94     2.0
matmul_rmsnorm_fused:L23.ffn_down        8.76     2.0
matmul_rmsnorm_fused:L17.ffn_down        8.71     2.0
matmul_rmsnorm_fused:L22.ffn_down        8.71     2.0
matmul_rmsnorm_fused:L1.ffn_down        8.70     2.0
matmul_rmsnorm_fused:L9.ffn_down        8.70     2.0
matmul_rmsnorm_fused:L6.ffn_down        8.69     2.0
matmul_rmsnorm_fused:L15.ffn_down        8.67     1.9
matmul_rmsnorm_fused:L12.ffn_down        8.66     1.9
matmul_rmsnorm_fused:L14.ffn_down        8.64     1.9
matmul_rmsnorm_fused:L7.ffn_down        8.64     1.9
matmul_rmsnorm_fused:L20.ffn_down        8.64     1.9
rmsnorm                          3.68     0.8
sample_phase2                    3.39     0.8
rope                             0.80     0.2
matmul:o_proj:L0                 0.70     0.2
matmul:q_proj:L0                 0.23     0.1
matmul:o_proj:L2                 0.18     0.0
matmul:q_proj:L12                0.17     0.0
matmul:q_proj:L5                 0.15     0.0
matmul:o_proj:L13                0.15     0.0
matmul:o_proj:L17                0.15     0.0
matmul:o_proj:L8                 0.15     0.0
matmul:q_proj:L25                0.15     0.0
matmul:o_proj:L21                0.15     0.0
matmul:q_proj:L3                 0.15     0.0
matmul:o_proj:L25                0.14     0.0
matmul:o_proj:L12                0.14     0.0
matmul:o_proj:L19                0.14     0.0
matmul:q_proj:L11                0.14     0.0
matmul:o_proj:L10                0.14     0.0
matmul:o_proj:L3                 0.14     0.0
matmul:q_proj:L19                0.14     0.0
matmul:o_proj:L5                 0.14     0.0
matmul:q_proj:L17                0.13     0.0
matmul:q_proj:L22                0.13     0.0
matmul:o_proj:L1                 0.13     0.0
matmul:q_proj:L8                 0.13     0.0
matmul:o_proj:L16                0.13     0.0
matmul:o_proj:L11                0.13     0.0
matmul:o_proj:L18                0.13     0.0
matmul:o_proj:L7                 0.13     0.0
matmul:o_proj:L23                0.13     0.0
matmul:o_proj:L9                 0.13     0.0
matmul:q_proj:L14                0.13     0.0
matmul:o_proj:L20                0.13     0.0
matmul:o_proj:L6                 0.13     0.0
matmul:o_proj:L14                0.13     0.0
matmul:o_proj:L22                0.13     0.0
matmul:q_proj:L20                0.13     0.0
matmul:q_proj:L9                 0.13     0.0
matmul:q_proj:L2                 0.13     0.0
matmul:q_proj:L7                 0.13     0.0
matmul:q_proj:L18                0.12     0.0
matmul:q_proj:L10                0.12     0.0
matmul:q_proj:L23                0.12     0.0
matmul:o_proj:L4                 0.12     0.0
matmul:q_proj:L15                0.12     0.0
matmul:o_proj:L24                0.12     0.0
matmul:q_proj:L13                0.12     0.0
matmul:q_proj:L16                0.12     0.0
matmul:q_proj:L6                 0.12     0.0
matmul:q_proj:L21                0.12     0.0
matmul:q_proj:L1                 0.12     0.0
matmul:o_proj:L15                0.12     0.0
matmul:q_proj:L24                0.12     0.0
matmul:q_proj:L4                 0.12     0.0
sample_phase1                    0.09     0.0
sample_phase3                    0.07     0.0
matmul:k_proj:L0                 0.07     0.0
matmul:v_proj:L0                 0.07     0.0
matmul:k_proj:L5                 0.07     0.0
matmul:k_proj:L2                 0.06     0.0
matmul:v_proj:L2                 0.06     0.0
matmul:k_proj:L25                0.06     0.0
matmul:k_proj:L3                 0.06     0.0
matmul:k_proj:L12                0.06     0.0
matmul:v_proj:L25                0.06     0.0
matmul:v_proj:L3                 0.06     0.0
matmul:v_proj:L5                 0.06     0.0
matmul:v_proj:L12                0.05     0.0
matmul:k_proj:L17                0.05     0.0
matmul:v_proj:L17                0.05     0.0
matmul:v_proj:L19                0.05     0.0
matmul:v_proj:L22                0.05     0.0
matmul:k_proj:L19                0.05     0.0
matmul:k_proj:L22                0.05     0.0
matmul:k_proj:L21                0.05     0.0
matmul:k_proj:L23                0.05     0.0
matmul:k_proj:L8                 0.05     0.0
matmul:k_proj:L11                0.05     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:k_proj:L15                0.04     0.0
matmul:k_proj:L7                 0.04     0.0
matmul:k_proj:L1                 0.04     0.0
matmul:k_proj:L13                0.04     0.0
matmul:k_proj:L10                0.04     0.0
matmul:k_proj:L18                0.04     0.0
matmul:k_proj:L16                0.04     0.0
matmul:k_proj:L4                 0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:k_proj:L20                0.04     0.0
matmul:k_proj:L14                0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:v_proj:L14                0.04     0.0
matmul:v_proj:L18                0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:v_proj:L16                0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:k_proj:L24                0.04     0.0
matmul:v_proj:L24                0.04     0.0
gather                           0.03     0.0
scale                            0.02     0.0
──────────────────────────────────────────────────
TOTAL                          445.00   100.0

[browser:warning] [10730.3ms][Profile] Batch decode (N=4):
[browser:warning] [10730.4ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      118.92    26.3
fused_ffn                       40.20     8.9
matmul:lm_head                  31.95     7.1
matmul_rmsnorm_fused:L6.ffn_down       10.47     2.3
matmul_rmsnorm_fused:L14.ffn_down       10.47     2.3
matmul_rmsnorm_fused:L9.ffn_down       10.47     2.3
matmul_rmsnorm_fused:L2.ffn_down       10.41     2.3
matmul_rmsnorm_fused:L1.ffn_down       10.27     2.3
matmul_rmsnorm_fused:L18.ffn_down       10.27     2.3
matmul_rmsnorm_fused:L22.ffn_down       10.15     2.2
matmul_rmsnorm_fused:L12.ffn_down       10.15     2.2
matmul_rmsnorm_fused:L21.ffn_down        9.96     2.2
matmul_rmsnorm_fused:L4.ffn_down        9.69     2.1
matmul_rmsnorm_fused:L10.ffn_down        9.68     2.1
matmul_rmsnorm_fused:L17.ffn_down        9.21     2.0
matmul_rmsnorm_fused:L25.ffn_down        8.84     2.0
matmul_rmsnorm_fused:L11.ffn_down        8.78     1.9
matmul_rmsnorm_fused:L16.ffn_down        8.75     1.9
matmul_rmsnorm_fused:L5.ffn_down        8.71     1.9
matmul_rmsnorm_fused:L20.ffn_down        8.70     1.9
matmul_rmsnorm_fused:L0.ffn_down        8.70     1.9
matmul_rmsnorm_fused:L8.ffn_down        8.66     1.9
matmul_rmsnorm_fused:L24.ffn_down        8.66     1.9
matmul_rmsnorm_fused:L23.ffn_down        8.66     1.9
matmul_rmsnorm_fused:L15.ffn_down        8.65     1.9
matmul_rmsnorm_fused:L3.ffn_down        8.65     1.9
matmul_rmsnorm_fused:L19.ffn_down        8.64     1.9
matmul_rmsnorm_fused:L13.ffn_down        8.63     1.9
matmul_rmsnorm_fused:L7.ffn_down        8.59     1.9
rmsnorm                          3.53     0.8
sample_phase2                    3.33     0.7
rope                             0.83     0.2
matmul:o_proj:L18                0.54     0.1
matmul:q_proj:L0                 0.22     0.0
matmul:o_proj:L21                0.17     0.0
matmul:o_proj:L2                 0.16     0.0
matmul:o_proj:L0                 0.15     0.0
matmul:q_proj:L5                 0.15     0.0
matmul:q_proj:L17                0.15     0.0
matmul:q_proj:L18                0.15     0.0
matmul:o_proj:L1                 0.14     0.0
matmul:o_proj:L16                0.14     0.0
matmul:o_proj:L5                 0.14     0.0
matmul:q_proj:L21                0.14     0.0
matmul:q_proj:L11                0.14     0.0
matmul:o_proj:L11                0.14     0.0
matmul:q_proj:L10                0.14     0.0
matmul:q_proj:L19                0.14     0.0
matmul:o_proj:L9                 0.14     0.0
matmul:o_proj:L17                0.14     0.0
matmul:q_proj:L3                 0.14     0.0
matmul:q_proj:L13                0.13     0.0
matmul:q_proj:L23                0.13     0.0
matmul:o_proj:L13                0.13     0.0
matmul:o_proj:L3                 0.13     0.0
matmul:o_proj:L19                0.13     0.0
matmul:o_proj:L25                0.13     0.0
matmul:q_proj:L15                0.13     0.0
matmul:o_proj:L12                0.13     0.0
matmul:q_proj:L2                 0.13     0.0
matmul:o_proj:L14                0.13     0.0
matmul:o_proj:L6                 0.13     0.0
matmul:o_proj:L20                0.13     0.0
matmul:o_proj:L4                 0.13     0.0
matmul:q_proj:L22                0.13     0.0
matmul:q_proj:L6                 0.13     0.0
matmul:q_proj:L1                 0.13     0.0
matmul:o_proj:L22                0.13     0.0
matmul:o_proj:L10                0.13     0.0
matmul:o_proj:L23                0.13     0.0
matmul:q_proj:L7                 0.13     0.0
matmul:q_proj:L16                0.13     0.0
matmul:o_proj:L8                 0.13     0.0
matmul:q_proj:L4                 0.12     0.0
matmul:o_proj:L24                0.12     0.0
matmul:q_proj:L12                0.12     0.0
matmul:q_proj:L9                 0.12     0.0
matmul:q_proj:L25                0.12     0.0
matmul:o_proj:L15                0.12     0.0
matmul:o_proj:L7                 0.12     0.0
matmul:q_proj:L20                0.12     0.0
matmul:q_proj:L8                 0.12     0.0
matmul:q_proj:L14                0.12     0.0
matmul:q_proj:L24                0.12     0.0
sample_phase1                    0.11     0.0
sample_phase3                    0.08     0.0
matmul:k_proj:L0                 0.08     0.0
matmul:v_proj:L0                 0.08     0.0
matmul:v_proj:L18                0.07     0.0
matmul:k_proj:L18                0.07     0.0
matmul:v_proj:L5                 0.07     0.0
matmul:k_proj:L5                 0.06     0.0
matmul:k_proj:L11                0.06     0.0
matmul:k_proj:L23                0.06     0.0
matmul:v_proj:L11                0.06     0.0
matmul:v_proj:L3                 0.05     0.0
matmul:k_proj:L15                0.05     0.0
matmul:k_proj:L10                0.05     0.0
matmul:k_proj:L13                0.05     0.0
matmul:v_proj:L23                0.05     0.0
matmul:k_proj:L3                 0.05     0.0
matmul:k_proj:L19                0.05     0.0
matmul:v_proj:L13                0.05     0.0
matmul:v_proj:L10                0.05     0.0
matmul:v_proj:L19                0.05     0.0
matmul:k_proj:L17                0.05     0.0
matmul:k_proj:L21                0.05     0.0
matmul:k_proj:L24                0.05     0.0
matmul:v_proj:L15                0.05     0.0
matmul:k_proj:L2                 0.05     0.0
matmul:v_proj:L17                0.05     0.0
matmul:k_proj:L9                 0.05     0.0
matmul:v_proj:L8                 0.05     0.0
matmul:k_proj:L6                 0.05     0.0
matmul:k_proj:L1                 0.05     0.0
matmul:k_proj:L7                 0.05     0.0
matmul:k_proj:L4                 0.04     0.0
matmul:k_proj:L16                0.04     0.0
matmul:k_proj:L22                0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:v_proj:L22                0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:k_proj:L20                0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:k_proj:L12                0.04     0.0
matmul:v_proj:L16                0.04     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:k_proj:L14                0.04     0.0
matmul:v_proj:L14                0.04     0.0
matmul:v_proj:L24                0.04     0.0
gather                           0.03     0.0
scale                            0.02     0.0
──────────────────────────────────────────────────
TOTAL                          451.79   100.0

[browser:warning] [11233.9ms][Profile] Batch decode (N=4):
[browser:warning] [11234.0ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      126.47    27.6
fused_ffn                       40.49     8.8
matmul:lm_head                  31.57     6.9
matmul_rmsnorm_fused:L1.ffn_down       11.35     2.5
matmul_rmsnorm_fused:L9.ffn_down       11.27     2.5
matmul_rmsnorm_fused:L5.ffn_down       11.20     2.4
matmul_rmsnorm_fused:L13.ffn_down       10.77     2.4
matmul_rmsnorm_fused:L21.ffn_down       10.53     2.3
matmul_rmsnorm_fused:L17.ffn_down       10.32     2.3
matmul_rmsnorm_fused:L25.ffn_down        9.35     2.0
matmul_rmsnorm_fused:L22.ffn_down        9.07     2.0
matmul_rmsnorm_fused:L2.ffn_down        9.00     2.0
matmul_rmsnorm_fused:L18.ffn_down        8.99     2.0
matmul_rmsnorm_fused:L14.ffn_down        8.96     2.0
matmul_rmsnorm_fused:L10.ffn_down        8.80     1.9
matmul_rmsnorm_fused:L16.ffn_down        8.71     1.9
matmul_rmsnorm_fused:L19.ffn_down        8.69     1.9
matmul_rmsnorm_fused:L12.ffn_down        8.68     1.9
matmul_rmsnorm_fused:L23.ffn_down        8.67     1.9
matmul_rmsnorm_fused:L20.ffn_down        8.67     1.9
matmul_rmsnorm_fused:L3.ffn_down        8.66     1.9
matmul_rmsnorm_fused:L15.ffn_down        8.66     1.9
matmul_rmsnorm_fused:L24.ffn_down        8.66     1.9
matmul_rmsnorm_fused:L11.ffn_down        8.65     1.9
matmul_rmsnorm_fused:L8.ffn_down        8.65     1.9
matmul_rmsnorm_fused:L0.ffn_down        8.65     1.9
matmul_rmsnorm_fused:L4.ffn_down        8.65     1.9
matmul_rmsnorm_fused:L6.ffn_down        8.64     1.9
matmul_rmsnorm_fused:L7.ffn_down        8.62     1.9
rmsnorm                          3.67     0.8
sample_phase2                    3.38     0.7
rope                             0.84     0.2
matmul:o_proj:L22                0.74     0.2
matmul:o_proj:L14                0.43     0.1
matmul:q_proj:L10                0.17     0.0
matmul:q_proj:L2                 0.16     0.0
matmul:o_proj:L13                0.15     0.0
matmul:o_proj:L1                 0.15     0.0
matmul:q_proj:L18                0.15     0.0
matmul:o_proj:L5                 0.15     0.0
matmul:q_proj:L0                 0.15     0.0
matmul:q_proj:L14                0.15     0.0
matmul:q_proj:L22                0.15     0.0
matmul:o_proj:L0                 0.14     0.0
matmul:o_proj:L18                0.14     0.0
matmul:o_proj:L2                 0.14     0.0
matmul:q_proj:L6                 0.14     0.0
matmul:o_proj:L21                0.14     0.0
matmul:o_proj:L10                0.14     0.0
matmul:o_proj:L17                0.13     0.0
matmul:o_proj:L20                0.13     0.0
matmul:q_proj:L13                0.13     0.0
matmul:o_proj:L12                0.13     0.0
matmul:o_proj:L16                0.13     0.0
matmul:o_proj:L8                 0.13     0.0
matmul:o_proj:L9                 0.13     0.0
matmul:o_proj:L4                 0.13     0.0
matmul:q_proj:L5                 0.13     0.0
matmul:o_proj:L24                0.13     0.0
matmul:o_proj:L6                 0.13     0.0
matmul:q_proj:L21                0.13     0.0
matmul:o_proj:L3                 0.13     0.0
matmul:o_proj:L25                0.13     0.0
matmul:q_proj:L17                0.13     0.0
matmul:q_proj:L20                0.12     0.0
matmul:q_proj:L1                 0.12     0.0
matmul:q_proj:L4                 0.12     0.0
matmul:q_proj:L12                0.12     0.0
matmul:q_proj:L9                 0.12     0.0
matmul:q_proj:L25                0.12     0.0
matmul:q_proj:L16                0.12     0.0
matmul:o_proj:L11                0.12     0.0
matmul:q_proj:L11                0.12     0.0
matmul:q_proj:L24                0.12     0.0
matmul:q_proj:L23                0.12     0.0
matmul:q_proj:L8                 0.12     0.0
matmul:o_proj:L7                 0.12     0.0
matmul:q_proj:L3                 0.12     0.0
matmul:o_proj:L15                0.12     0.0
matmul:q_proj:L7                 0.12     0.0
matmul:o_proj:L19                0.12     0.0
matmul:q_proj:L19                0.12     0.0
matmul:o_proj:L23                0.12     0.0
matmul:q_proj:L15                0.11     0.0
sample_phase1                    0.10     0.0
matmul:k_proj:L10                0.07     0.0
sample_phase3                    0.07     0.0
matmul:v_proj:L2                 0.07     0.0
matmul:v_proj:L10                0.07     0.0
matmul:k_proj:L2                 0.07     0.0
matmul:k_proj:L18                0.06     0.0
matmul:v_proj:L18                0.06     0.0
matmul:k_proj:L6                 0.06     0.0
matmul:v_proj:L0                 0.06     0.0
matmul:v_proj:L6                 0.06     0.0
matmul:k_proj:L14                0.06     0.0
matmul:v_proj:L22                0.06     0.0
matmul:k_proj:L22                0.05     0.0
matmul:v_proj:L14                0.05     0.0
matmul:k_proj:L0                 0.05     0.0
matmul:k_proj:L12                0.05     0.0
matmul:k_proj:L4                 0.05     0.0
matmul:k_proj:L3                 0.05     0.0
matmul:k_proj:L13                0.05     0.0
matmul:k_proj:L17                0.05     0.0
matmul:k_proj:L20                0.04     0.0
matmul:k_proj:L5                 0.04     0.0
matmul:k_proj:L16                0.04     0.0
matmul:k_proj:L1                 0.04     0.0
matmul:k_proj:L23                0.04     0.0
matmul:k_proj:L7                 0.04     0.0
matmul:k_proj:L24                0.04     0.0
matmul:k_proj:L21                0.04     0.0
matmul:k_proj:L11                0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:k_proj:L15                0.04     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:k_proj:L19                0.04     0.0
matmul:v_proj:L5                 0.04     0.0
matmul:v_proj:L17                0.04     0.0
matmul:v_proj:L16                0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:v_proj:L24                0.04     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:v_proj:L19                0.04     0.0
matmul:v_proj:L3                 0.04     0.0
gather                           0.02     0.0
scale                            0.02     0.0
──────────────────────────────────────────────────
TOTAL                          457.77   100.0

[browser:warning] [11744.3ms][Profile] Batch decode (N=4):
[browser:warning] [11744.5ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      133.47    28.7
fused_ffn                       41.14     8.9
matmul:lm_head                  30.50     6.6
matmul_rmsnorm_fused:L8.ffn_down       11.05     2.4
matmul_rmsnorm_fused:L12.ffn_down       10.57     2.3
matmul_rmsnorm_fused:L4.ffn_down       10.54     2.3
matmul_rmsnorm_fused:L20.ffn_down       10.46     2.3
matmul_rmsnorm_fused:L24.ffn_down       10.32     2.2
matmul_rmsnorm_fused:L15.ffn_down       10.31     2.2
matmul_rmsnorm_fused:L16.ffn_down       10.10     2.2
matmul_rmsnorm_fused:L23.ffn_down       10.07     2.2
matmul_rmsnorm_fused:L0.ffn_down        9.99     2.1
matmul_rmsnorm_fused:L19.ffn_down        9.15     2.0
matmul_rmsnorm_fused:L3.ffn_down        8.95     1.9
matmul_rmsnorm_fused:L11.ffn_down        8.83     1.9
matmul_rmsnorm_fused:L18.ffn_down        8.73     1.9
matmul_rmsnorm_fused:L25.ffn_down        8.71     1.9
matmul_rmsnorm_fused:L22.ffn_down        8.70     1.9
matmul_rmsnorm_fused:L10.ffn_down        8.69     1.9
matmul_rmsnorm_fused:L2.ffn_down        8.69     1.9
matmul_rmsnorm_fused:L7.ffn_down        8.68     1.9
matmul_rmsnorm_fused:L14.ffn_down        8.68     1.9
matmul_rmsnorm_fused:L6.ffn_down        8.66     1.9
matmul_rmsnorm_fused:L1.ffn_down        8.66     1.9
matmul_rmsnorm_fused:L21.ffn_down        8.65     1.9
matmul_rmsnorm_fused:L13.ffn_down        8.65     1.9
matmul_rmsnorm_fused:L9.ffn_down        8.65     1.9
matmul_rmsnorm_fused:L17.ffn_down        8.63     1.9
matmul_rmsnorm_fused:L5.ffn_down        8.63     1.9
rmsnorm                          3.46     0.7
sample_phase2                    3.27     0.7
matmul:o_proj:L8                 0.78     0.2
rope                             0.75     0.2
matmul:o_proj:L0                 0.21     0.0
matmul:o_proj:L12                0.19     0.0
matmul:q_proj:L0                 0.18     0.0
matmul:o_proj:L4                 0.17     0.0
matmul:o_proj:L20                0.16     0.0
matmul:q_proj:L20                0.16     0.0
matmul:o_proj:L16                0.15     0.0
matmul:o_proj:L24                0.15     0.0
matmul:o_proj:L14                0.15     0.0
matmul:q_proj:L12                0.14     0.0
matmul:q_proj:L4                 0.14     0.0
matmul:q_proj:L16                0.14     0.0
matmul:q_proj:L24                0.14     0.0
matmul:q_proj:L14                0.14     0.0
matmul:o_proj:L19                0.14     0.0
matmul:o_proj:L2                 0.13     0.0
matmul:o_proj:L23                0.13     0.0
matmul:o_proj:L15                0.13     0.0
matmul:q_proj:L19                0.13     0.0
matmul:q_proj:L21                0.13     0.0
matmul:o_proj:L9                 0.13     0.0
matmul:o_proj:L18                0.13     0.0
matmul:o_proj:L3                 0.13     0.0
matmul:o_proj:L10                0.13     0.0
matmul:o_proj:L11                0.13     0.0
matmul:o_proj:L7                 0.13     0.0
matmul:o_proj:L22                0.13     0.0
matmul:o_proj:L6                 0.13     0.0
matmul:q_proj:L8                 0.13     0.0
matmul:q_proj:L13                0.13     0.0
matmul:q_proj:L11                0.12     0.0
matmul:q_proj:L15                0.12     0.0
matmul:q_proj:L25                0.12     0.0
matmul:q_proj:L7                 0.12     0.0
matmul:q_proj:L3                 0.12     0.0
matmul:o_proj:L13                0.12     0.0
matmul:q_proj:L22                0.12     0.0
matmul:q_proj:L23                0.12     0.0
matmul:o_proj:L17                0.12     0.0
matmul:q_proj:L9                 0.12     0.0
matmul:q_proj:L5                 0.12     0.0
matmul:q_proj:L17                0.12     0.0
matmul:q_proj:L1                 0.12     0.0
matmul:o_proj:L25                0.12     0.0
matmul:q_proj:L2                 0.12     0.0
matmul:o_proj:L5                 0.12     0.0
matmul:q_proj:L6                 0.12     0.0
matmul:q_proj:L10                0.12     0.0
matmul:o_proj:L21                0.12     0.0
matmul:o_proj:L1                 0.12     0.0
matmul:q_proj:L18                0.12     0.0
sample_phase3                    0.08     0.0
sample_phase1                    0.07     0.0
matmul:v_proj:L20                0.07     0.0
matmul:k_proj:L0                 0.06     0.0
matmul:v_proj:L0                 0.06     0.0
matmul:k_proj:L4                 0.06     0.0
matmul:k_proj:L20                0.06     0.0
matmul:v_proj:L16                0.06     0.0
matmul:v_proj:L4                 0.06     0.0
matmul:k_proj:L16                0.05     0.0
matmul:v_proj:L24                0.05     0.0
matmul:k_proj:L24                0.05     0.0
matmul:k_proj:L10                0.05     0.0
matmul:k_proj:L14                0.05     0.0
matmul:k_proj:L12                0.05     0.0
matmul:k_proj:L23                0.05     0.0
matmul:k_proj:L22                0.05     0.0
matmul:k_proj:L8                 0.05     0.0
matmul:v_proj:L14                0.05     0.0
matmul:v_proj:L12                0.05     0.0
matmul:k_proj:L19                0.05     0.0
matmul:k_proj:L7                 0.05     0.0
matmul:k_proj:L25                0.05     0.0
matmul:k_proj:L21                0.05     0.0
matmul:k_proj:L13                0.05     0.0
matmul:k_proj:L11                0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:k_proj:L17                0.04     0.0
matmul:k_proj:L3                 0.04     0.0
matmul:k_proj:L5                 0.04     0.0
matmul:k_proj:L15                0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:k_proj:L18                0.04     0.0
matmul:k_proj:L1                 0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:k_proj:L2                 0.04     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:v_proj:L5                 0.04     0.0
matmul:v_proj:L22                0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:v_proj:L19                0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:v_proj:L18                0.04     0.0
matmul:v_proj:L17                0.04     0.0
gather                           0.03     0.0
scale                            0.02     0.0
──────────────────────────────────────────────────
TOTAL                          464.56   100.0

[browser:warning] [12261.7ms][Profile] Batch decode (N=4):
[browser:warning] [12261.8ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      140.75    29.9
fused_ffn                       39.98     8.5
matmul:lm_head                  30.06     6.4
matmul_rmsnorm_fused:L1.ffn_down       11.70     2.5
matmul_rmsnorm_fused:L8.ffn_down       10.48     2.2
matmul_rmsnorm_fused:L9.ffn_down       10.27     2.2
matmul_rmsnorm_fused:L19.ffn_down       10.22     2.2
matmul_rmsnorm_fused:L16.ffn_down        9.86     2.1
matmul_rmsnorm_fused:L24.ffn_down        9.56     2.0
matmul_rmsnorm_fused:L4.ffn_down        9.56     2.0
matmul_rmsnorm_fused:L21.ffn_down        9.45     2.0
matmul_rmsnorm_fused:L12.ffn_down        9.44     2.0
matmul_rmsnorm_fused:L11.ffn_down        9.34     2.0
matmul_rmsnorm_fused:L25.ffn_down        9.30     2.0
matmul_rmsnorm_fused:L13.ffn_down        9.20     2.0
matmul_rmsnorm_fused:L3.ffn_down        9.12     1.9
matmul_rmsnorm_fused:L17.ffn_down        9.07     1.9
matmul_rmsnorm_fused:L0.ffn_down        8.91     1.9
matmul_rmsnorm_fused:L5.ffn_down        8.88     1.9
matmul_rmsnorm_fused:L15.ffn_down        8.73     1.9
matmul_rmsnorm_fused:L23.ffn_down        8.72     1.9
matmul_rmsnorm_fused:L18.ffn_down        8.69     1.8
matmul_rmsnorm_fused:L20.ffn_down        8.69     1.8
matmul_rmsnorm_fused:L2.ffn_down        8.69     1.8
matmul_rmsnorm_fused:L10.ffn_down        8.68     1.8
matmul_rmsnorm_fused:L22.ffn_down        8.68     1.8
matmul_rmsnorm_fused:L14.ffn_down        8.67     1.8
matmul_rmsnorm_fused:L7.ffn_down        8.65     1.8
matmul_rmsnorm_fused:L6.ffn_down        8.64     1.8
sample_phase2                    3.28     0.7
rmsnorm                          3.21     0.7
rope                             0.85     0.2
matmul:q_proj:L20                0.75     0.2
matmul:o_proj:L4                 0.60     0.1
matmul:o_proj:L12                0.36     0.1
matmul:q_proj:L13                0.18     0.0
matmul:o_proj:L16                0.17     0.0
matmul:o_proj:L13                0.17     0.0
matmul:o_proj:L24                0.17     0.0
matmul:q_proj:L0                 0.17     0.0
matmul:q_proj:L25                0.16     0.0
matmul:o_proj:L25                0.16     0.0
matmul:o_proj:L21                0.16     0.0
matmul:q_proj:L12                0.16     0.0
matmul:q_proj:L5                 0.15     0.0
matmul:o_proj:L9                 0.15     0.0
matmul:o_proj:L0                 0.15     0.0
matmul:q_proj:L4                 0.14     0.0
matmul:q_proj:L21                0.14     0.0
matmul:o_proj:L1                 0.14     0.0
matmul:o_proj:L5                 0.14     0.0
matmul:o_proj:L17                0.14     0.0
matmul:o_proj:L19                0.14     0.0
matmul:o_proj:L8                 0.14     0.0
matmul:q_proj:L24                0.13     0.0
matmul:o_proj:L2                 0.13     0.0
matmul:q_proj:L16                0.13     0.0
matmul:o_proj:L11                0.13     0.0
matmul:o_proj:L15                0.13     0.0
matmul:o_proj:L7                 0.13     0.0
matmul:o_proj:L23                0.13     0.0
matmul:q_proj:L17                0.13     0.0
matmul:q_proj:L14                0.13     0.0
matmul:q_proj:L9                 0.13     0.0
matmul:q_proj:L1                 0.13     0.0
matmul:q_proj:L23                0.13     0.0
matmul:o_proj:L3                 0.13     0.0
matmul:o_proj:L20                0.13     0.0
matmul:o_proj:L10                0.13     0.0
matmul:q_proj:L10                0.13     0.0
matmul:q_proj:L2                 0.13     0.0
matmul:o_proj:L14                0.12     0.0
matmul:q_proj:L19                0.12     0.0
matmul:o_proj:L22                0.12     0.0
matmul:o_proj:L6                 0.12     0.0
matmul:q_proj:L8                 0.12     0.0
matmul:q_proj:L3                 0.12     0.0
matmul:q_proj:L15                0.12     0.0
matmul:q_proj:L7                 0.12     0.0
matmul:q_proj:L11                0.12     0.0
matmul:q_proj:L22                0.12     0.0
matmul:q_proj:L6                 0.12     0.0
matmul:o_proj:L18                0.12     0.0
matmul:q_proj:L18                0.12     0.0
sample_phase1                    0.08     0.0
matmul:k_proj:L13                0.07     0.0
sample_phase3                    0.07     0.0
matmul:k_proj:L5                 0.07     0.0
matmul:v_proj:L21                0.07     0.0
matmul:v_proj:L13                0.07     0.0
matmul:v_proj:L5                 0.06     0.0
matmul:v_proj:L25                0.06     0.0
matmul:k_proj:L25                0.06     0.0
matmul:k_proj:L21                0.06     0.0
matmul:v_proj:L12                0.06     0.0
matmul:v_proj:L24                0.06     0.0
matmul:k_proj:L24                0.06     0.0
matmul:v_proj:L4                 0.06     0.0
matmul:k_proj:L12                0.06     0.0
matmul:k_proj:L4                 0.05     0.0
matmul:k_proj:L20                0.05     0.0
matmul:k_proj:L0                 0.05     0.0
matmul:k_proj:L14                0.05     0.0
matmul:v_proj:L0                 0.05     0.0
matmul:v_proj:L20                0.05     0.0
matmul:k_proj:L8                 0.05     0.0
matmul:v_proj:L16                0.05     0.0
matmul:k_proj:L17                0.05     0.0
matmul:k_proj:L16                0.05     0.0
matmul:k_proj:L3                 0.05     0.0
matmul:k_proj:L19                0.05     0.0
matmul:v_proj:L14                0.05     0.0
matmul:k_proj:L2                 0.05     0.0
matmul:k_proj:L9                 0.05     0.0
matmul:k_proj:L11                0.05     0.0
matmul:k_proj:L15                0.05     0.0
matmul:k_proj:L7                 0.04     0.0
matmul:k_proj:L22                0.04     0.0
matmul:k_proj:L23                0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:k_proj:L10                0.04     0.0
matmul:k_proj:L1                 0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:v_proj:L17                0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:k_proj:L18                0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:v_proj:L19                0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:v_proj:L22                0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:v_proj:L18                0.04     0.0
gather                           0.03     0.0
scale                            0.02     0.0
──────────────────────────────────────────────────
TOTAL                          470.57   100.0

[browser:warning] [12788.2ms][Profile] Batch decode (N=4):
[browser:warning] [12788.3ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      147.25    30.8
fused_ffn                       39.78     8.3
matmul:lm_head                  30.81     6.5
matmul_rmsnorm_fused:L13.ffn_down       10.65     2.2
matmul_rmsnorm_fused:L12.ffn_down       10.46     2.2
matmul_rmsnorm_fused:L15.ffn_down       10.40     2.2
matmul_rmsnorm_fused:L10.ffn_down       10.26     2.1
matmul_rmsnorm_fused:L4.ffn_down       10.11     2.1
matmul_rmsnorm_fused:L8.ffn_down        9.87     2.1
matmul_rmsnorm_fused:L2.ffn_down        9.78     2.0
matmul_rmsnorm_fused:L21.ffn_down        9.63     2.0
matmul_rmsnorm_fused:L23.ffn_down        9.62     2.0
matmul_rmsnorm_fused:L18.ffn_down        9.61     2.0
matmul_rmsnorm_fused:L20.ffn_down        9.52     2.0
matmul_rmsnorm_fused:L5.ffn_down        9.52     2.0
matmul_rmsnorm_fused:L0.ffn_down        9.40     2.0
matmul_rmsnorm_fused:L7.ffn_down        8.79     1.8
matmul_rmsnorm_fused:L6.ffn_down        8.78     1.8
matmul_rmsnorm_fused:L9.ffn_down        8.76     1.8
matmul_rmsnorm_fused:L19.ffn_down        8.75     1.8
matmul_rmsnorm_fused:L3.ffn_down        8.74     1.8
matmul_rmsnorm_fused:L22.ffn_down        8.72     1.8
matmul_rmsnorm_fused:L11.ffn_down        8.68     1.8
matmul_rmsnorm_fused:L14.ffn_down        8.67     1.8
matmul_rmsnorm_fused:L17.ffn_down        8.67     1.8
matmul_rmsnorm_fused:L1.ffn_down        8.67     1.8
matmul_rmsnorm_fused:L16.ffn_down        8.66     1.8
matmul_rmsnorm_fused:L24.ffn_down        8.66     1.8
matmul_rmsnorm_fused:L25.ffn_down        8.64     1.8
sample_phase2                    3.29     0.7
rmsnorm                          3.11     0.7
rope                             0.80     0.2
matmul:o_proj:L6                 0.57     0.1
matmul:o_proj:L0                 0.26     0.1
matmul:q_proj:L0                 0.24     0.1
matmul:o_proj:L8                 0.23     0.0
matmul:o_proj:L20                0.17     0.0
matmul:q_proj:L19                0.17     0.0
matmul:o_proj:L21                0.16     0.0
matmul:q_proj:L6                 0.16     0.0
matmul:o_proj:L23                0.16     0.0
matmul:q_proj:L3                 0.15     0.0
matmul:o_proj:L11                0.15     0.0
matmul:o_proj:L22                0.15     0.0
matmul:o_proj:L19                0.14     0.0
matmul:o_proj:L13                0.14     0.0
matmul:o_proj:L3                 0.14     0.0
matmul:o_proj:L4                 0.14     0.0
matmul:q_proj:L5                 0.14     0.0
matmul:q_proj:L8                 0.14     0.0
matmul:o_proj:L10                0.14     0.0
matmul:q_proj:L21                0.14     0.0
matmul:q_proj:L11                0.14     0.0
matmul:o_proj:L15                0.14     0.0
matmul:o_proj:L12                0.13     0.0
matmul:o_proj:L5                 0.13     0.0
matmul:q_proj:L20                0.13     0.0
matmul:q_proj:L22                0.13     0.0
matmul:q_proj:L10                0.13     0.0
matmul:q_proj:L23                0.13     0.0
matmul:o_proj:L1                 0.13     0.0
matmul:o_proj:L9                 0.13     0.0
matmul:o_proj:L14                0.13     0.0
matmul:q_proj:L9                 0.13     0.0
matmul:o_proj:L18                0.13     0.0
matmul:q_proj:L16                0.13     0.0
matmul:o_proj:L25                0.13     0.0
matmul:q_proj:L12                0.13     0.0
matmul:q_proj:L13                0.13     0.0
matmul:o_proj:L2                 0.13     0.0
matmul:o_proj:L7                 0.13     0.0
matmul:q_proj:L24                0.13     0.0
matmul:o_proj:L17                0.13     0.0
matmul:q_proj:L14                0.13     0.0
matmul:q_proj:L4                 0.12     0.0
matmul:q_proj:L18                0.12     0.0
matmul:o_proj:L16                0.12     0.0
matmul:q_proj:L2                 0.12     0.0
matmul:q_proj:L15                0.12     0.0
matmul:o_proj:L24                0.12     0.0
matmul:q_proj:L17                0.12     0.0
matmul:q_proj:L25                0.12     0.0
matmul:q_proj:L1                 0.12     0.0
matmul:q_proj:L7                 0.12     0.0
sample_phase1                    0.09     0.0
sample_phase3                    0.09     0.0
matmul:k_proj:L0                 0.08     0.0
matmul:v_proj:L6                 0.07     0.0
matmul:k_proj:L19                0.07     0.0
matmul:k_proj:L6                 0.07     0.0
matmul:v_proj:L0                 0.06     0.0
matmul:k_proj:L3                 0.06     0.0
matmul:v_proj:L19                0.06     0.0
matmul:v_proj:L3                 0.06     0.0
matmul:k_proj:L5                 0.05     0.0
matmul:k_proj:L11                0.05     0.0
matmul:v_proj:L11                0.05     0.0
matmul:v_proj:L5                 0.05     0.0
matmul:v_proj:L8                 0.05     0.0
matmul:k_proj:L21                0.05     0.0
matmul:v_proj:L21                0.05     0.0
matmul:k_proj:L8                 0.05     0.0
matmul:v_proj:L25                0.05     0.0
matmul:k_proj:L23                0.05     0.0
matmul:k_proj:L18                0.05     0.0
matmul:v_proj:L20                0.05     0.0
matmul:k_proj:L10                0.05     0.0
matmul:k_proj:L22                0.05     0.0
matmul:k_proj:L20                0.05     0.0
matmul:k_proj:L2                 0.05     0.0
matmul:k_proj:L7                 0.05     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:k_proj:L16                0.04     0.0
matmul:k_proj:L13                0.04     0.0
matmul:k_proj:L12                0.04     0.0
matmul:v_proj:L22                0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:k_proj:L14                0.04     0.0
matmul:k_proj:L4                 0.04     0.0
gather                           0.04     0.0
matmul:k_proj:L15                0.04     0.0
matmul:v_proj:L14                0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:k_proj:L17                0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:k_proj:L24                0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:v_proj:L16                0.04     0.0
matmul:k_proj:L1                 0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:v_proj:L18                0.04     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:v_proj:L17                0.04     0.0
matmul:v_proj:L24                0.04     0.0
scale                            0.03     0.0
──────────────────────────────────────────────────
TOTAL                          477.62   100.0

[browser:warning] [13320.8ms][Profile] Batch decode (N=4):
[browser:warning] [13320.9ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      154.49    31.9
fused_ffn                       39.69     8.2
matmul:lm_head                  30.88     6.4
matmul_rmsnorm_fused:L21.ffn_down       11.91     2.5
matmul_rmsnorm_fused:L6.ffn_down       11.86     2.4
matmul_rmsnorm_fused:L1.ffn_down       10.49     2.2
matmul_rmsnorm_fused:L11.ffn_down       10.48     2.2
matmul_rmsnorm_fused:L13.ffn_down       10.28     2.1
matmul_rmsnorm_fused:L16.ffn_down       10.14     2.1
matmul_rmsnorm_fused:L19.ffn_down        9.76     2.0
matmul_rmsnorm_fused:L24.ffn_down        9.63     2.0
matmul_rmsnorm_fused:L14.ffn_down        9.50     2.0
matmul_rmsnorm_fused:L4.ffn_down        9.27     1.9
matmul_rmsnorm_fused:L9.ffn_down        9.19     1.9
matmul_rmsnorm_fused:L8.ffn_down        8.85     1.8
matmul_rmsnorm_fused:L22.ffn_down        8.70     1.8
matmul_rmsnorm_fused:L17.ffn_down        8.69     1.8
matmul_rmsnorm_fused:L12.ffn_down        8.68     1.8
matmul_rmsnorm_fused:L0.ffn_down        8.68     1.8
matmul_rmsnorm_fused:L20.ffn_down        8.68     1.8
matmul_rmsnorm_fused:L18.ffn_down        8.67     1.8
matmul_rmsnorm_fused:L15.ffn_down        8.67     1.8
matmul_rmsnorm_fused:L2.ffn_down        8.67     1.8
matmul_rmsnorm_fused:L10.ffn_down        8.66     1.8
matmul_rmsnorm_fused:L23.ffn_down        8.66     1.8
matmul_rmsnorm_fused:L5.ffn_down        8.66     1.8
matmul_rmsnorm_fused:L25.ffn_down        8.65     1.8
matmul_rmsnorm_fused:L3.ffn_down        8.63     1.8
matmul_rmsnorm_fused:L7.ffn_down        8.60     1.8
sample_phase2                    3.27     0.7
rmsnorm                          3.16     0.7
rope                             0.76     0.2
matmul:o_proj:L9                 0.61     0.1
matmul:q_proj:L0                 0.18     0.0
matmul:o_proj:L4                 0.17     0.0
matmul:o_proj:L6                 0.16     0.0
matmul:o_proj:L19                0.16     0.0
matmul:o_proj:L14                0.15     0.0
matmul:o_proj:L0                 0.15     0.0
matmul:o_proj:L24                0.15     0.0
matmul:q_proj:L14                0.14     0.0
matmul:o_proj:L17                0.14     0.0
matmul:o_proj:L21                0.14     0.0
matmul:q_proj:L22                0.14     0.0
matmul:o_proj:L12                0.13     0.0
matmul:o_proj:L20                0.13     0.0
matmul:q_proj:L9                 0.13     0.0
matmul:o_proj:L13                0.13     0.0
matmul:q_proj:L7                 0.13     0.0
matmul:o_proj:L22                0.13     0.0
matmul:o_proj:L25                0.13     0.0
matmul:o_proj:L1                 0.13     0.0
matmul:o_proj:L2                 0.13     0.0
matmul:q_proj:L17                0.13     0.0
matmul:o_proj:L10                0.13     0.0
matmul:o_proj:L5                 0.13     0.0
matmul:q_proj:L13                0.13     0.0
matmul:o_proj:L7                 0.13     0.0
matmul:o_proj:L3                 0.13     0.0
matmul:q_proj:L4                 0.13     0.0
matmul:q_proj:L12                0.13     0.0
matmul:q_proj:L18                0.13     0.0
matmul:o_proj:L16                0.13     0.0
matmul:o_proj:L15                0.12     0.0
matmul:q_proj:L20                0.12     0.0
matmul:q_proj:L21                0.12     0.0
matmul:o_proj:L11                0.12     0.0
matmul:o_proj:L18                0.12     0.0
matmul:q_proj:L25                0.12     0.0
matmul:o_proj:L23                0.12     0.0
matmul:q_proj:L2                 0.12     0.0
matmul:q_proj:L6                 0.12     0.0
matmul:q_proj:L5                 0.12     0.0
matmul:o_proj:L8                 0.12     0.0
matmul:q_proj:L16                0.12     0.0
matmul:q_proj:L24                0.12     0.0
matmul:q_proj:L3                 0.12     0.0
matmul:q_proj:L23                0.12     0.0
matmul:q_proj:L8                 0.12     0.0
matmul:q_proj:L10                0.12     0.0
matmul:q_proj:L1                 0.12     0.0
matmul:q_proj:L15                0.12     0.0
matmul:q_proj:L11                0.12     0.0
matmul:q_proj:L19                0.12     0.0
sample_phase1                    0.08     0.0
matmul:k_proj:L0                 0.07     0.0
matmul:v_proj:L0                 0.07     0.0
matmul:v_proj:L9                 0.07     0.0
sample_phase3                    0.06     0.0
matmul:k_proj:L9                 0.06     0.0
matmul:k_proj:L17                0.06     0.0
matmul:k_proj:L14                0.05     0.0
matmul:k_proj:L22                0.05     0.0
matmul:v_proj:L7                 0.05     0.0
matmul:v_proj:L22                0.05     0.0
matmul:v_proj:L17                0.05     0.0
matmul:v_proj:L14                0.05     0.0
matmul:v_proj:L11                0.05     0.0
matmul:k_proj:L7                 0.05     0.0
matmul:k_proj:L4                 0.05     0.0
matmul:k_proj:L18                0.05     0.0
matmul:v_proj:L12                0.05     0.0
matmul:k_proj:L12                0.05     0.0
matmul:k_proj:L25                0.05     0.0
matmul:k_proj:L3                 0.05     0.0
matmul:k_proj:L20                0.05     0.0
matmul:k_proj:L21                0.05     0.0
matmul:k_proj:L1                 0.04     0.0
matmul:k_proj:L5                 0.04     0.0
matmul:k_proj:L24                0.04     0.0
matmul:k_proj:L13                0.04     0.0
matmul:k_proj:L19                0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:k_proj:L10                0.04     0.0
matmul:k_proj:L2                 0.04     0.0
matmul:k_proj:L11                0.04     0.0
matmul:k_proj:L23                0.04     0.0
matmul:k_proj:L16                0.04     0.0
matmul:k_proj:L15                0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:v_proj:L24                0.04     0.0
matmul:v_proj:L18                0.04     0.0
matmul:v_proj:L16                0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:v_proj:L19                0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:v_proj:L5                 0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:v_proj:L8                 0.04     0.0
gather                           0.03     0.0
scale                            0.02     0.0
──────────────────────────────────────────────────
TOTAL                          484.86   100.0

[browser:warning] [13862.2ms][Profile] Batch decode (N=4):
[browser:warning] [13862.3ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      161.58    32.7
fused_ffn                       40.47     8.2
matmul:lm_head                  30.67     6.2
matmul_rmsnorm_fused:L23.ffn_down       10.44     2.1
matmul_rmsnorm_fused:L12.ffn_down       10.39     2.1
matmul_rmsnorm_fused:L10.ffn_down       10.38     2.1
matmul_rmsnorm_fused:L25.ffn_down       10.34     2.1
matmul_rmsnorm_fused:L21.ffn_down       10.34     2.1
matmul_rmsnorm_fused:L8.ffn_down       10.25     2.1
matmul_rmsnorm_fused:L6.ffn_down       10.15     2.1
matmul_rmsnorm_fused:L16.ffn_down        9.67     2.0
matmul_rmsnorm_fused:L2.ffn_down        9.44     1.9
matmul_rmsnorm_fused:L17.ffn_down        9.32     1.9
matmul_rmsnorm_fused:L14.ffn_down        9.32     1.9
matmul_rmsnorm_fused:L4.ffn_down        9.26     1.9
matmul_rmsnorm_fused:L19.ffn_down        9.17     1.9
matmul_rmsnorm_fused:L20.ffn_down        8.94     1.8
matmul_rmsnorm_fused:L0.ffn_down        8.91     1.8
matmul_rmsnorm_fused:L1.ffn_down        8.88     1.8
matmul_rmsnorm_fused:L5.ffn_down        8.86     1.8
matmul_rmsnorm_fused:L18.ffn_down        8.83     1.8
matmul_rmsnorm_fused:L3.ffn_down        8.77     1.8
matmul_rmsnorm_fused:L22.ffn_down        8.71     1.8
matmul_rmsnorm_fused:L9.ffn_down        8.69     1.8
matmul_rmsnorm_fused:L15.ffn_down        8.67     1.8
matmul_rmsnorm_fused:L11.ffn_down        8.65     1.8
matmul_rmsnorm_fused:L13.ffn_down        8.65     1.8
matmul_rmsnorm_fused:L24.ffn_down        8.65     1.8
matmul_rmsnorm_fused:L7.ffn_down        8.64     1.8
rmsnorm                          3.79     0.8
sample_phase2                    3.33     0.7
rope                             0.83     0.2
matmul:o_proj:L18                0.63     0.1
matmul:o_proj:L16                0.48     0.1
matmul:o_proj:L14                0.16     0.0
matmul:q_proj:L3                 0.16     0.0
matmul:o_proj:L8                 0.15     0.0
matmul:q_proj:L20                0.15     0.0
matmul:q_proj:L18                0.15     0.0
matmul:q_proj:L5                 0.15     0.0
matmul:o_proj:L25                0.15     0.0
matmul:o_proj:L3                 0.15     0.0
matmul:o_proj:L12                0.14     0.0
matmul:o_proj:L1                 0.14     0.0
matmul:o_proj:L20                0.14     0.0
matmul:q_proj:L1                 0.14     0.0
matmul:o_proj:L5                 0.14     0.0
matmul:o_proj:L0                 0.14     0.0
matmul:q_proj:L7                 0.14     0.0
matmul:q_proj:L24                0.14     0.0
matmul:o_proj:L11                0.14     0.0
matmul:q_proj:L11                0.14     0.0
matmul:q_proj:L0                 0.13     0.0
matmul:o_proj:L13                0.13     0.0
matmul:o_proj:L24                0.13     0.0
matmul:q_proj:L22                0.13     0.0
matmul:q_proj:L14                0.13     0.0
matmul:o_proj:L17                0.13     0.0
matmul:q_proj:L13                0.13     0.0
matmul:o_proj:L7                 0.13     0.0
matmul:o_proj:L9                 0.13     0.0
matmul:o_proj:L23                0.13     0.0
matmul:o_proj:L6                 0.13     0.0
matmul:o_proj:L10                0.13     0.0
matmul:o_proj:L22                0.13     0.0
matmul:o_proj:L2                 0.13     0.0
matmul:o_proj:L19                0.13     0.0
matmul:q_proj:L8                 0.13     0.0
matmul:o_proj:L21                0.12     0.0
matmul:q_proj:L17                0.12     0.0
matmul:q_proj:L16                0.12     0.0
matmul:q_proj:L10                0.12     0.0
matmul:q_proj:L23                0.12     0.0
matmul:o_proj:L15                0.12     0.0
matmul:o_proj:L4                 0.12     0.0
matmul:q_proj:L4                 0.12     0.0
matmul:q_proj:L6                 0.12     0.0
matmul:q_proj:L25                0.12     0.0
matmul:q_proj:L19                0.12     0.0
matmul:q_proj:L2                 0.12     0.0
matmul:q_proj:L15                0.12     0.0
matmul:q_proj:L9                 0.12     0.0
matmul:q_proj:L12                0.12     0.0
matmul:q_proj:L21                0.12     0.0
sample_phase1                    0.08     0.0
sample_phase3                    0.08     0.0
matmul:k_proj:L3                 0.06     0.0
matmul:k_proj:L5                 0.06     0.0
matmul:k_proj:L20                0.06     0.0
matmul:v_proj:L5                 0.06     0.0
matmul:k_proj:L18                0.06     0.0
matmul:v_proj:L20                0.06     0.0
matmul:v_proj:L3                 0.06     0.0
matmul:k_proj:L22                0.06     0.0
matmul:v_proj:L18                0.06     0.0
matmul:v_proj:L1                 0.06     0.0
matmul:k_proj:L1                 0.06     0.0
matmul:k_proj:L7                 0.05     0.0
matmul:k_proj:L24                0.05     0.0
matmul:v_proj:L11                0.05     0.0
matmul:v_proj:L22                0.05     0.0
matmul:v_proj:L24                0.05     0.0
matmul:v_proj:L14                0.05     0.0
matmul:k_proj:L11                0.05     0.0
matmul:v_proj:L7                 0.05     0.0
matmul:k_proj:L16                0.05     0.0
matmul:k_proj:L14                0.05     0.0
matmul:k_proj:L8                 0.05     0.0
matmul:v_proj:L16                0.05     0.0
matmul:k_proj:L10                0.04     0.0
matmul:k_proj:L13                0.04     0.0
matmul:k_proj:L21                0.04     0.0
matmul:k_proj:L4                 0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:k_proj:L19                0.04     0.0
matmul:k_proj:L23                0.04     0.0
matmul:k_proj:L0                 0.04     0.0
matmul:k_proj:L2                 0.04     0.0
matmul:k_proj:L12                0.04     0.0
matmul:k_proj:L15                0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:v_proj:L0                 0.04     0.0
matmul:k_proj:L17                0.04     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:v_proj:L19                0.04     0.0
matmul:v_proj:L17                0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:v_proj:L15                0.04     0.0
gather                           0.01     0.0
scale                            0.01     0.0
──────────────────────────────────────────────────
TOTAL                          493.42   100.0

[browser:warning] [14412.1ms][Profile] Batch decode (N=4):
[browser:warning] [14412.3ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      168.80    33.7
fused_ffn                       42.27     8.4
matmul:lm_head                  31.36     6.3
matmul_rmsnorm_fused:L8.ffn_down       10.31     2.1
matmul_rmsnorm_fused:L2.ffn_down       10.22     2.0
matmul_rmsnorm_fused:L23.ffn_down       10.05     2.0
matmul_rmsnorm_fused:L15.ffn_down        9.99     2.0
matmul_rmsnorm_fused:L10.ffn_down        9.90     2.0
matmul_rmsnorm_fused:L12.ffn_down        9.83     2.0
matmul_rmsnorm_fused:L14.ffn_down        9.74     1.9
matmul_rmsnorm_fused:L21.ffn_down        9.60     1.9
matmul_rmsnorm_fused:L1.ffn_down        9.45     1.9
matmul_rmsnorm_fused:L5.ffn_down        9.43     1.9
matmul_rmsnorm_fused:L25.ffn_down        9.41     1.9
matmul_rmsnorm_fused:L17.ffn_down        9.36     1.9
matmul_rmsnorm_fused:L0.ffn_down        9.01     1.8
matmul_rmsnorm_fused:L19.ffn_down        8.99     1.8
matmul_rmsnorm_fused:L7.ffn_down        8.94     1.8
matmul_rmsnorm_fused:L22.ffn_down        8.89     1.8
matmul_rmsnorm_fused:L6.ffn_down        8.88     1.8
matmul_rmsnorm_fused:L24.ffn_down        8.86     1.8
matmul_rmsnorm_fused:L20.ffn_down        8.84     1.8
matmul_rmsnorm_fused:L18.ffn_down        8.73     1.7
matmul_rmsnorm_fused:L4.ffn_down        8.72     1.7
matmul_rmsnorm_fused:L16.ffn_down        8.69     1.7
matmul_rmsnorm_fused:L9.ffn_down        8.68     1.7
matmul_rmsnorm_fused:L11.ffn_down        8.68     1.7
matmul_rmsnorm_fused:L13.ffn_down        8.66     1.7
matmul_rmsnorm_fused:L3.ffn_down        8.65     1.7
sample_phase2                    3.33     0.7
rmsnorm                          3.24     0.6
rope                             0.81     0.2
matmul:o_proj:L7                 0.64     0.1
matmul:o_proj:L1                 0.18     0.0
matmul:q_proj:L22                0.18     0.0
matmul:o_proj:L25                0.18     0.0
matmul:o_proj:L2                 0.17     0.0
matmul:o_proj:L14                0.17     0.0
matmul:o_proj:L23                0.16     0.0
matmul:o_proj:L5                 0.16     0.0
matmul:o_proj:L0                 0.16     0.0
matmul:q_proj:L18                0.16     0.0
matmul:o_proj:L12                0.16     0.0
matmul:o_proj:L20                0.16     0.0
matmul:q_proj:L13                0.16     0.0
matmul:q_proj:L0                 0.16     0.0
matmul:q_proj:L7                 0.16     0.0
matmul:o_proj:L3                 0.15     0.0
matmul:q_proj:L20                0.15     0.0
matmul:o_proj:L22                0.15     0.0
matmul:o_proj:L10                0.15     0.0
matmul:q_proj:L19                0.14     0.0
matmul:o_proj:L18                0.14     0.0
matmul:q_proj:L16                0.14     0.0
matmul:q_proj:L1                 0.14     0.0
matmul:o_proj:L24                0.14     0.0
matmul:q_proj:L9                 0.14     0.0
matmul:o_proj:L21                0.14     0.0
matmul:q_proj:L23                0.14     0.0
matmul:q_proj:L2                 0.13     0.0
matmul:q_proj:L12                0.13     0.0
matmul:o_proj:L15                0.13     0.0
matmul:o_proj:L19                0.13     0.0
matmul:o_proj:L13                0.13     0.0
matmul:q_proj:L24                0.13     0.0
matmul:q_proj:L25                0.13     0.0
matmul:q_proj:L15                0.13     0.0
matmul:o_proj:L8                 0.13     0.0
matmul:o_proj:L16                0.13     0.0
matmul:o_proj:L11                0.13     0.0
matmul:o_proj:L17                0.13     0.0
matmul:o_proj:L4                 0.13     0.0
matmul:q_proj:L21                0.13     0.0
matmul:q_proj:L3                 0.13     0.0
matmul:o_proj:L6                 0.13     0.0
matmul:q_proj:L5                 0.12     0.0
matmul:o_proj:L9                 0.12     0.0
matmul:q_proj:L4                 0.12     0.0
matmul:q_proj:L10                0.12     0.0
matmul:q_proj:L14                0.12     0.0
matmul:q_proj:L11                0.12     0.0
matmul:q_proj:L17                0.12     0.0
matmul:q_proj:L6                 0.12     0.0
matmul:q_proj:L8                 0.12     0.0
sample_phase1                    0.09     0.0
sample_phase3                    0.08     0.0
matmul:k_proj:L22                0.07     0.0
matmul:k_proj:L7                 0.07     0.0
matmul:v_proj:L22                0.07     0.0
matmul:k_proj:L18                0.06     0.0
matmul:k_proj:L13                0.06     0.0
matmul:k_proj:L20                0.06     0.0
matmul:v_proj:L18                0.06     0.0
matmul:v_proj:L13                0.06     0.0
matmul:k_proj:L0                 0.06     0.0
matmul:v_proj:L0                 0.06     0.0
matmul:v_proj:L20                0.06     0.0
matmul:v_proj:L7                 0.06     0.0
matmul:k_proj:L9                 0.06     0.0
matmul:v_proj:L16                0.05     0.0
matmul:k_proj:L16                0.05     0.0
matmul:v_proj:L9                 0.05     0.0
matmul:k_proj:L19                0.05     0.0
matmul:k_proj:L17                0.05     0.0
matmul:k_proj:L1                 0.05     0.0
matmul:v_proj:L19                0.05     0.0
matmul:k_proj:L2                 0.05     0.0
matmul:k_proj:L23                0.05     0.0
matmul:k_proj:L14                0.05     0.0
matmul:k_proj:L11                0.05     0.0
matmul:v_proj:L23                0.05     0.0
matmul:v_proj:L1                 0.05     0.0
matmul:k_proj:L15                0.05     0.0
matmul:k_proj:L12                0.05     0.0
matmul:v_proj:L2                 0.05     0.0
matmul:k_proj:L5                 0.05     0.0
matmul:k_proj:L24                0.05     0.0
matmul:k_proj:L21                0.05     0.0
matmul:k_proj:L25                0.05     0.0
matmul:k_proj:L10                0.05     0.0
matmul:k_proj:L3                 0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:k_proj:L4                 0.04     0.0
matmul:v_proj:L24                0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:v_proj:L5                 0.04     0.0
matmul:v_proj:L14                0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:v_proj:L17                0.04     0.0
gather                           0.03     0.0
scale                            0.02     0.0
──────────────────────────────────────────────────
TOTAL                          501.00   100.0

[browser:warning] [14986.6ms][Profile] Batch decode (N=4):
[browser:warning] [14986.7ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      175.83    34.7
fused_ffn                       38.99     7.7
matmul:lm_head                  32.29     6.4
matmul_rmsnorm_fused:L14.ffn_down       10.41     2.1
matmul_rmsnorm_fused:L13.ffn_down       10.39     2.0
matmul_rmsnorm_fused:L12.ffn_down       10.38     2.0
matmul_rmsnorm_fused:L6.ffn_down       10.31     2.0
matmul_rmsnorm_fused:L7.ffn_down       10.29     2.0
matmul_rmsnorm_fused:L18.ffn_down       10.26     2.0
matmul_rmsnorm_fused:L25.ffn_down        9.96     2.0
matmul_rmsnorm_fused:L21.ffn_down        9.87     1.9
matmul_rmsnorm_fused:L19.ffn_down        9.86     1.9
matmul_rmsnorm_fused:L5.ffn_down        9.74     1.9
matmul_rmsnorm_fused:L11.ffn_down        9.53     1.9
matmul_rmsnorm_fused:L4.ffn_down        9.51     1.9
matmul_rmsnorm_fused:L0.ffn_down        9.49     1.9
matmul_rmsnorm_fused:L20.ffn_down        9.43     1.9
matmul_rmsnorm_fused:L10.ffn_down        8.72     1.7
matmul_rmsnorm_fused:L3.ffn_down        8.71     1.7
matmul_rmsnorm_fused:L17.ffn_down        8.69     1.7
matmul_rmsnorm_fused:L9.ffn_down        8.68     1.7
matmul_rmsnorm_fused:L2.ffn_down        8.67     1.7
matmul_rmsnorm_fused:L16.ffn_down        8.67     1.7
matmul_rmsnorm_fused:L24.ffn_down        8.65     1.7
matmul_rmsnorm_fused:L22.ffn_down        8.65     1.7
matmul_rmsnorm_fused:L15.ffn_down        8.65     1.7
matmul_rmsnorm_fused:L1.ffn_down        8.65     1.7
matmul_rmsnorm_fused:L23.ffn_down        8.64     1.7
matmul_rmsnorm_fused:L8.ffn_down        8.61     1.7
sample_phase2                    3.38     0.7
rmsnorm                          3.00     0.6
rope                             0.74     0.1
matmul:q_proj:L0                 0.22     0.0
matmul:o_proj:L4                 0.21     0.0
matmul:o_proj:L0                 0.17     0.0
matmul:o_proj:L11                0.17     0.0
matmul:q_proj:L21                0.16     0.0
matmul:o_proj:L5                 0.16     0.0
matmul:o_proj:L6                 0.15     0.0
matmul:o_proj:L2                 0.15     0.0
matmul:q_proj:L20                0.15     0.0
matmul:o_proj:L12                0.15     0.0
matmul:o_proj:L25                0.15     0.0
matmul:o_proj:L17                0.15     0.0
matmul:o_proj:L14                0.15     0.0
matmul:o_proj:L13                0.14     0.0
matmul:q_proj:L19                0.14     0.0
matmul:o_proj:L21                0.14     0.0
matmul:q_proj:L22                0.14     0.0
matmul:q_proj:L14                0.14     0.0
matmul:o_proj:L19                0.13     0.0
matmul:o_proj:L20                0.13     0.0
matmul:o_proj:L18                0.13     0.0
matmul:o_proj:L7                 0.13     0.0
matmul:o_proj:L3                 0.13     0.0
matmul:q_proj:L11                0.13     0.0
matmul:o_proj:L24                0.13     0.0
matmul:o_proj:L22                0.13     0.0
matmul:q_proj:L7                 0.13     0.0
matmul:q_proj:L13                0.13     0.0
matmul:q_proj:L6                 0.13     0.0
matmul:q_proj:L4                 0.13     0.0
matmul:o_proj:L9                 0.12     0.0
matmul:q_proj:L5                 0.12     0.0
matmul:q_proj:L3                 0.12     0.0
matmul:q_proj:L8                 0.12     0.0
matmul:q_proj:L25                0.12     0.0
matmul:o_proj:L10                0.12     0.0
matmul:o_proj:L16                0.12     0.0
matmul:q_proj:L12                0.12     0.0
matmul:o_proj:L1                 0.12     0.0
matmul:q_proj:L15                0.12     0.0
matmul:q_proj:L18                0.12     0.0
matmul:q_proj:L10                0.12     0.0
matmul:o_proj:L15                0.12     0.0
matmul:q_proj:L1                 0.12     0.0
matmul:q_proj:L9                 0.12     0.0
matmul:q_proj:L17                0.12     0.0
matmul:q_proj:L24                0.12     0.0
matmul:o_proj:L8                 0.12     0.0
matmul:q_proj:L2                 0.12     0.0
matmul:q_proj:L16                0.12     0.0
matmul:o_proj:L23                0.12     0.0
matmul:q_proj:L23                0.12     0.0
sample_phase1                    0.09     0.0
matmul:k_proj:L0                 0.08     0.0
matmul:v_proj:L0                 0.08     0.0
matmul:v_proj:L21                0.07     0.0
matmul:k_proj:L21                0.07     0.0
matmul:k_proj:L20                0.06     0.0
sample_phase3                    0.06     0.0
matmul:v_proj:L20                0.06     0.0
matmul:v_proj:L22                0.05     0.0
matmul:k_proj:L22                0.05     0.0
matmul:k_proj:L19                0.05     0.0
matmul:k_proj:L14                0.05     0.0
matmul:v_proj:L14                0.05     0.0
matmul:v_proj:L19                0.05     0.0
matmul:k_proj:L24                0.05     0.0
matmul:k_proj:L7                 0.05     0.0
matmul:k_proj:L11                0.05     0.0
matmul:k_proj:L4                 0.05     0.0
matmul:k_proj:L13                0.05     0.0
matmul:k_proj:L18                0.05     0.0
matmul:k_proj:L8                 0.05     0.0
matmul:v_proj:L7                 0.05     0.0
matmul:k_proj:L12                0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:k_proj:L5                 0.04     0.0
matmul:k_proj:L17                0.04     0.0
matmul:k_proj:L15                0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:k_proj:L3                 0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:k_proj:L2                 0.04     0.0
matmul:k_proj:L10                0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:k_proj:L1                 0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:v_proj:L5                 0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:k_proj:L23                0.04     0.0
matmul:k_proj:L16                0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:v_proj:L17                0.04     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:v_proj:L24                0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:v_proj:L18                0.04     0.0
matmul:v_proj:L16                0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:v_proj:L2                 0.04     0.0
gather                           0.03     0.0
scale                            0.03     0.0
──────────────────────────────────────────────────
TOTAL                          507.40   100.0

[browser:warning] [15548.1ms][Profile] Batch decode (N=4):
[browser:warning] [15548.3ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      182.29    35.4
fused_ffn                       39.11     7.6
matmul:lm_head                  29.92     5.8
matmul_rmsnorm_fused:L15.ffn_down       12.09     2.3
matmul_rmsnorm_fused:L21.ffn_down       11.27     2.2
matmul_rmsnorm_fused:L8.ffn_down       10.41     2.0
matmul_rmsnorm_fused:L0.ffn_down       10.35     2.0
matmul_rmsnorm_fused:L14.ffn_down       10.31     2.0
matmul_rmsnorm_fused:L6.ffn_down       10.30     2.0
matmul_rmsnorm_fused:L1.ffn_down       10.28     2.0
matmul_rmsnorm_fused:L22.ffn_down       10.21     2.0
matmul_rmsnorm_fused:L7.ffn_down       10.05     2.0
matmul_rmsnorm_fused:L23.ffn_down       10.04     2.0
matmul_rmsnorm_fused:L9.ffn_down        9.99     1.9
matmul_rmsnorm_fused:L2.ffn_down        9.37     1.8
matmul_rmsnorm_fused:L13.ffn_down        9.20     1.8
matmul_rmsnorm_fused:L20.ffn_down        8.68     1.7
matmul_rmsnorm_fused:L19.ffn_down        8.67     1.7
matmul_rmsnorm_fused:L5.ffn_down        8.66     1.7
matmul_rmsnorm_fused:L10.ffn_down        8.65     1.7
matmul_rmsnorm_fused:L12.ffn_down        8.65     1.7
matmul_rmsnorm_fused:L16.ffn_down        8.64     1.7
matmul_rmsnorm_fused:L25.ffn_down        8.63     1.7
matmul_rmsnorm_fused:L17.ffn_down        8.63     1.7
matmul_rmsnorm_fused:L18.ffn_down        8.63     1.7
matmul_rmsnorm_fused:L11.ffn_down        8.62     1.7
matmul_rmsnorm_fused:L3.ffn_down        8.61     1.7
matmul_rmsnorm_fused:L4.ffn_down        8.61     1.7
matmul_rmsnorm_fused:L24.ffn_down        8.60     1.7
rmsnorm                          3.55     0.7
sample_phase2                    3.24     0.6
rope                             0.73     0.1
matmul:o_proj:L9                 0.59     0.1
matmul:o_proj:L21                0.17     0.0
matmul:o_proj:L0                 0.16     0.0
matmul:o_proj:L15                0.16     0.0
matmul:o_proj:L2                 0.16     0.0
matmul:o_proj:L1                 0.16     0.0
matmul:o_proj:L22                0.15     0.0
matmul:o_proj:L14                0.15     0.0
matmul:q_proj:L14                0.15     0.0
matmul:o_proj:L23                0.15     0.0
matmul:q_proj:L0                 0.14     0.0
matmul:q_proj:L7                 0.14     0.0
matmul:o_proj:L8                 0.14     0.0
matmul:q_proj:L15                0.14     0.0
matmul:o_proj:L7                 0.14     0.0
matmul:o_proj:L13                0.14     0.0
matmul:q_proj:L1                 0.13     0.0
matmul:q_proj:L2                 0.13     0.0
matmul:q_proj:L8                 0.13     0.0
matmul:o_proj:L5                 0.13     0.0
matmul:o_proj:L6                 0.13     0.0
matmul:q_proj:L21                0.13     0.0
matmul:o_proj:L16                0.13     0.0
matmul:q_proj:L23                0.13     0.0
matmul:q_proj:L22                0.13     0.0
matmul:q_proj:L16                0.13     0.0
matmul:q_proj:L9                 0.13     0.0
matmul:o_proj:L20                0.13     0.0
matmul:q_proj:L6                 0.13     0.0
matmul:o_proj:L3                 0.12     0.0
matmul:o_proj:L12                0.12     0.0
matmul:q_proj:L24                0.12     0.0
matmul:q_proj:L20                0.12     0.0
matmul:q_proj:L10                0.12     0.0
matmul:o_proj:L10                0.12     0.0
matmul:q_proj:L13                0.12     0.0
matmul:o_proj:L19                0.12     0.0
matmul:o_proj:L11                0.12     0.0
matmul:q_proj:L19                0.12     0.0
matmul:q_proj:L17                0.12     0.0
matmul:q_proj:L11                0.12     0.0
matmul:q_proj:L5                 0.12     0.0
matmul:o_proj:L24                0.12     0.0
matmul:o_proj:L25                0.12     0.0
matmul:q_proj:L25                0.12     0.0
matmul:o_proj:L4                 0.12     0.0
matmul:o_proj:L17                0.12     0.0
matmul:q_proj:L12                0.12     0.0
matmul:q_proj:L3                 0.12     0.0
matmul:q_proj:L4                 0.12     0.0
matmul:o_proj:L18                0.12     0.0
matmul:q_proj:L18                0.12     0.0
sample_phase1                    0.06     0.0
matmul:k_proj:L14                0.06     0.0
matmul:v_proj:L14                0.06     0.0
matmul:v_proj:L7                 0.06     0.0
matmul:k_proj:L7                 0.05     0.0
matmul:k_proj:L8                 0.05     0.0
matmul:k_proj:L15                0.05     0.0
matmul:v_proj:L1                 0.05     0.0
matmul:k_proj:L1                 0.05     0.0
matmul:k_proj:L2                 0.05     0.0
matmul:v_proj:L8                 0.05     0.0
matmul:v_proj:L15                0.05     0.0
matmul:k_proj:L0                 0.05     0.0
matmul:k_proj:L10                0.05     0.0
matmul:k_proj:L21                0.05     0.0
matmul:k_proj:L16                0.05     0.0
matmul:k_proj:L13                0.05     0.0
matmul:k_proj:L6                 0.05     0.0
sample_phase3                    0.05     0.0
matmul:k_proj:L22                0.05     0.0
matmul:v_proj:L21                0.05     0.0
matmul:v_proj:L0                 0.05     0.0
matmul:v_proj:L2                 0.05     0.0
matmul:k_proj:L23                0.05     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:k_proj:L5                 0.04     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:k_proj:L17                0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:v_proj:L22                0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:k_proj:L12                0.04     0.0
matmul:k_proj:L18                0.04     0.0
matmul:k_proj:L11                0.04     0.0
matmul:k_proj:L3                 0.04     0.0
matmul:v_proj:L16                0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:k_proj:L20                0.04     0.0
matmul:k_proj:L4                 0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:k_proj:L24                0.04     0.0
matmul:v_proj:L5                 0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:k_proj:L19                0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:v_proj:L19                0.04     0.0
matmul:v_proj:L24                0.04     0.0
matmul:v_proj:L17                0.04     0.0
matmul:v_proj:L18                0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:v_proj:L3                 0.04     0.0
gather                           0.01     0.0
scale                            0.01     0.0
──────────────────────────────────────────────────
TOTAL                          514.80   100.0

[browser:warning] [16117.7ms][Profile] Batch decode (N=4):
[browser:warning] [16117.9ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      189.65    36.3
fused_ffn                       39.39     7.5
matmul:lm_head                  30.73     5.9
matmul_rmsnorm_fused:L22.ffn_down       12.94     2.5
matmul_rmsnorm_fused:L15.ffn_down       12.01     2.3
matmul_rmsnorm_fused:L1.ffn_down       11.89     2.3
matmul_rmsnorm_fused:L14.ffn_down       11.59     2.2
matmul_rmsnorm_fused:L8.ffn_down       11.58     2.2
matmul_rmsnorm_fused:L7.ffn_down       11.26     2.2
matmul_rmsnorm_fused:L0.ffn_down       10.29     2.0
matmul_rmsnorm_fused:L21.ffn_down        9.16     1.8
matmul_rmsnorm_fused:L18.ffn_down        8.72     1.7
matmul_rmsnorm_fused:L6.ffn_down        8.72     1.7
matmul_rmsnorm_fused:L24.ffn_down        8.69     1.7
matmul_rmsnorm_fused:L13.ffn_down        8.69     1.7
matmul_rmsnorm_fused:L20.ffn_down        8.68     1.7
matmul_rmsnorm_fused:L12.ffn_down        8.67     1.7
matmul_rmsnorm_fused:L19.ffn_down        8.65     1.7
matmul_rmsnorm_fused:L2.ffn_down        8.65     1.7
matmul_rmsnorm_fused:L16.ffn_down        8.65     1.7
matmul_rmsnorm_fused:L10.ffn_down        8.64     1.7
matmul_rmsnorm_fused:L17.ffn_down        8.64     1.7
matmul_rmsnorm_fused:L9.ffn_down        8.63     1.7
matmul_rmsnorm_fused:L5.ffn_down        8.63     1.7
matmul_rmsnorm_fused:L23.ffn_down        8.63     1.6
matmul_rmsnorm_fused:L25.ffn_down        8.62     1.6
matmul_rmsnorm_fused:L11.ffn_down        8.61     1.6
matmul_rmsnorm_fused:L3.ffn_down        8.60     1.6
matmul_rmsnorm_fused:L4.ffn_down        8.59     1.6
sample_phase2                    3.24     0.6
rmsnorm                          3.10     0.6
rope                             0.71     0.1
matmul:o_proj:L8                 0.38     0.1
matmul:o_proj:L22                0.22     0.0
matmul:o_proj:L15                0.18     0.0
matmul:o_proj:L0                 0.18     0.0
matmul:o_proj:L1                 0.18     0.0
matmul:q_proj:L0                 0.17     0.0
matmul:o_proj:L13                0.17     0.0
matmul:o_proj:L14                0.17     0.0
matmul:q_proj:L1                 0.17     0.0
matmul:q_proj:L8                 0.17     0.0
matmul:o_proj:L7                 0.16     0.0
matmul:q_proj:L15                0.15     0.0
matmul:o_proj:L21                0.14     0.0
matmul:q_proj:L22                0.14     0.0
matmul:o_proj:L5                 0.13     0.0
matmul:o_proj:L6                 0.13     0.0
matmul:o_proj:L20                0.13     0.0
matmul:q_proj:L9                 0.13     0.0
matmul:q_proj:L23                0.13     0.0
matmul:o_proj:L19                0.13     0.0
matmul:q_proj:L2                 0.13     0.0
matmul:q_proj:L14                0.13     0.0
matmul:o_proj:L9                 0.13     0.0
matmul:q_proj:L16                0.13     0.0
matmul:q_proj:L7                 0.13     0.0
matmul:o_proj:L16                0.13     0.0
matmul:q_proj:L21                0.13     0.0
matmul:q_proj:L13                0.13     0.0
matmul:o_proj:L4                 0.13     0.0
matmul:o_proj:L25                0.12     0.0
matmul:o_proj:L18                0.12     0.0
matmul:o_proj:L2                 0.12     0.0
matmul:q_proj:L20                0.12     0.0
matmul:q_proj:L6                 0.12     0.0
matmul:o_proj:L3                 0.12     0.0
matmul:o_proj:L23                0.12     0.0
matmul:q_proj:L5                 0.12     0.0
matmul:o_proj:L17                0.12     0.0
matmul:q_proj:L18                0.12     0.0
matmul:o_proj:L11                0.12     0.0
matmul:o_proj:L12                0.12     0.0
matmul:q_proj:L11                0.12     0.0
matmul:q_proj:L4                 0.12     0.0
matmul:q_proj:L3                 0.12     0.0
matmul:q_proj:L10                0.12     0.0
matmul:q_proj:L25                0.12     0.0
matmul:q_proj:L19                0.12     0.0
matmul:q_proj:L24                0.12     0.0
matmul:o_proj:L24                0.12     0.0
matmul:o_proj:L10                0.12     0.0
matmul:q_proj:L17                0.12     0.0
matmul:q_proj:L12                0.12     0.0
sample_phase1                    0.08     0.0
matmul:k_proj:L1                 0.07     0.0
matmul:v_proj:L1                 0.07     0.0
matmul:k_proj:L8                 0.06     0.0
matmul:v_proj:L8                 0.06     0.0
matmul:v_proj:L15                0.06     0.0
matmul:k_proj:L15                0.05     0.0
matmul:k_proj:L22                0.05     0.0
matmul:v_proj:L22                0.05     0.0
matmul:k_proj:L0                 0.05     0.0
matmul:v_proj:L0                 0.05     0.0
sample_phase3                    0.05     0.0
matmul:k_proj:L21                0.05     0.0
matmul:k_proj:L13                0.05     0.0
matmul:k_proj:L23                0.05     0.0
matmul:k_proj:L2                 0.05     0.0
matmul:k_proj:L16                0.05     0.0
matmul:k_proj:L7                 0.05     0.0
matmul:k_proj:L25                0.04     0.0
matmul:k_proj:L14                0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:k_proj:L11                0.04     0.0
matmul:v_proj:L16                0.04     0.0
matmul:k_proj:L17                0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:k_proj:L4                 0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:k_proj:L10                0.04     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:v_proj:L14                0.04     0.0
matmul:k_proj:L3                 0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:k_proj:L20                0.04     0.0
matmul:k_proj:L19                0.04     0.0
matmul:k_proj:L18                0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:k_proj:L24                0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:k_proj:L5                 0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:v_proj:L5                 0.04     0.0
matmul:v_proj:L19                0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:k_proj:L12                0.04     0.0
matmul:v_proj:L24                0.04     0.0
matmul:v_proj:L18                0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:v_proj:L17                0.04     0.0
gather                           0.02     0.0
scale                            0.01     0.0
──────────────────────────────────────────────────
TOTAL                          523.08   100.0

[browser:warning] [16695.2ms][Profile] Batch decode (N=4):
[browser:warning] [16695.3ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      197.92    37.3
fused_ffn                       41.14     7.7
matmul:lm_head                  30.75     5.8
matmul_rmsnorm_fused:L20.ffn_down       13.69     2.6
matmul_rmsnorm_fused:L13.ffn_down       12.69     2.4
matmul_rmsnorm_fused:L6.ffn_down       12.02     2.3
matmul_rmsnorm_fused:L0.ffn_down       11.82     2.2
matmul_rmsnorm_fused:L7.ffn_down       10.48     2.0
matmul_rmsnorm_fused:L21.ffn_down        9.12     1.7
matmul_rmsnorm_fused:L19.ffn_down        8.74     1.6
matmul_rmsnorm_fused:L14.ffn_down        8.71     1.6
matmul_rmsnorm_fused:L5.ffn_down        8.70     1.6
matmul_rmsnorm_fused:L12.ffn_down        8.69     1.6
matmul_rmsnorm_fused:L22.ffn_down        8.69     1.6
matmul_rmsnorm_fused:L18.ffn_down        8.68     1.6
matmul_rmsnorm_fused:L25.ffn_down        8.67     1.6
matmul_rmsnorm_fused:L16.ffn_down        8.66     1.6
matmul_rmsnorm_fused:L11.ffn_down        8.66     1.6
matmul_rmsnorm_fused:L23.ffn_down        8.66     1.6
matmul_rmsnorm_fused:L9.ffn_down        8.65     1.6
matmul_rmsnorm_fused:L10.ffn_down        8.65     1.6
matmul_rmsnorm_fused:L2.ffn_down        8.64     1.6
matmul_rmsnorm_fused:L17.ffn_down        8.63     1.6
matmul_rmsnorm_fused:L15.ffn_down        8.63     1.6
matmul_rmsnorm_fused:L1.ffn_down        8.62     1.6
matmul_rmsnorm_fused:L24.ffn_down        8.62     1.6
matmul_rmsnorm_fused:L4.ffn_down        8.61     1.6
matmul_rmsnorm_fused:L3.ffn_down        8.61     1.6
matmul_rmsnorm_fused:L8.ffn_down        8.60     1.6
sample_phase2                    3.38     0.6
rmsnorm                          3.12     0.6
rope                             0.80     0.2
matmul:k_proj:L14                0.70     0.1
matmul:o_proj:L14                0.61     0.1
matmul:o_proj:L0                 0.46     0.1
matmul:q_proj:L14                0.23     0.0
matmul:o_proj:L7                 0.20     0.0
matmul:q_proj:L0                 0.19     0.0
matmul:o_proj:L21                0.18     0.0
matmul:o_proj:L20                0.17     0.0
matmul:q_proj:L7                 0.17     0.0
matmul:o_proj:L13                0.16     0.0
matmul:o_proj:L6                 0.15     0.0
matmul:q_proj:L21                0.15     0.0
matmul:o_proj:L5                 0.14     0.0
matmul:o_proj:L19                0.14     0.0
matmul:o_proj:L1                 0.14     0.0
matmul:o_proj:L12                0.14     0.0
matmul:q_proj:L13                0.13     0.0
matmul:q_proj:L6                 0.13     0.0
matmul:q_proj:L19                0.13     0.0
matmul:q_proj:L5                 0.13     0.0
matmul:q_proj:L20                0.13     0.0
matmul:o_proj:L3                 0.13     0.0
matmul:o_proj:L25                0.13     0.0
matmul:q_proj:L12                0.13     0.0
matmul:q_proj:L15                0.13     0.0
matmul:o_proj:L22                0.13     0.0
matmul:o_proj:L9                 0.12     0.0
matmul:q_proj:L2                 0.12     0.0
matmul:o_proj:L10                0.12     0.0
matmul:q_proj:L10                0.12     0.0
matmul:o_proj:L17                0.12     0.0
matmul:o_proj:L23                0.12     0.0
matmul:q_proj:L3                 0.12     0.0
matmul:q_proj:L22                0.12     0.0
matmul:o_proj:L16                0.12     0.0
matmul:q_proj:L1                 0.12     0.0
matmul:o_proj:L18                0.12     0.0
matmul:o_proj:L24                0.12     0.0
matmul:o_proj:L2                 0.12     0.0
matmul:q_proj:L24                0.12     0.0
matmul:o_proj:L8                 0.12     0.0
matmul:q_proj:L25                0.12     0.0
matmul:q_proj:L16                0.12     0.0
matmul:q_proj:L17                0.12     0.0
matmul:o_proj:L11                0.12     0.0
matmul:o_proj:L15                0.12     0.0
matmul:q_proj:L8                 0.12     0.0
matmul:q_proj:L9                 0.12     0.0
matmul:q_proj:L23                0.12     0.0
matmul:q_proj:L4                 0.11     0.0
matmul:q_proj:L11                0.11     0.0
matmul:q_proj:L18                0.11     0.0
matmul:o_proj:L4                 0.11     0.0
matmul:v_proj:L14                0.10     0.0
sample_phase1                    0.09     0.0
sample_phase3                    0.08     0.0
matmul:k_proj:L7                 0.07     0.0
matmul:v_proj:L0                 0.07     0.0
matmul:k_proj:L0                 0.07     0.0
matmul:v_proj:L7                 0.07     0.0
matmul:v_proj:L21                0.06     0.0
matmul:k_proj:L21                0.05     0.0
matmul:k_proj:L8                 0.05     0.0
matmul:k_proj:L13                0.05     0.0
matmul:k_proj:L19                0.05     0.0
matmul:k_proj:L5                 0.05     0.0
matmul:k_proj:L6                 0.05     0.0
matmul:v_proj:L5                 0.05     0.0
matmul:k_proj:L3                 0.04     0.0
matmul:k_proj:L22                0.04     0.0
matmul:k_proj:L23                0.04     0.0
matmul:k_proj:L20                0.04     0.0
matmul:k_proj:L10                0.04     0.0
matmul:v_proj:L19                0.04     0.0
matmul:k_proj:L17                0.04     0.0
matmul:k_proj:L1                 0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:k_proj:L12                0.04     0.0
matmul:k_proj:L4                 0.04     0.0
matmul:k_proj:L15                0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:k_proj:L11                0.04     0.0
matmul:k_proj:L2                 0.04     0.0
matmul:k_proj:L16                0.04     0.0
matmul:v_proj:L22                0.04     0.0
matmul:v_proj:L17                0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:v_proj:L16                0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:k_proj:L24                0.04     0.0
matmul:k_proj:L18                0.04     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:v_proj:L24                0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:v_proj:L18                0.04     0.0
matmul:v_proj:L11                0.04     0.0
gather                           0.03     0.0
scale                            0.02     0.0
──────────────────────────────────────────────────
TOTAL                          531.11   100.0

[browser:warning] [17333.1ms][Profile] Batch decode (N=4):
[browser:warning] [17333.3ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      204.48    35.0
fused_ffn                       53.47     9.2
matmul:lm_head                  36.35     6.2
matmul_rmsnorm_fused:L4.ffn_down       12.45     2.1
matmul_rmsnorm_fused:L10.ffn_down       12.16     2.1
matmul_rmsnorm_fused:L16.ffn_down       12.11     2.1
rmsnorm                         11.34     1.9
matmul_rmsnorm_fused:L18.ffn_down       11.12     1.9
matmul_rmsnorm_fused:L21.ffn_down       11.03     1.9
matmul_rmsnorm_fused:L11.ffn_down       10.74     1.8
matmul_rmsnorm_fused:L3.ffn_down       10.18     1.7
matmul_rmsnorm_fused:L24.ffn_down       10.05     1.7
matmul_rmsnorm_fused:L25.ffn_down        9.82     1.7
matmul_rmsnorm_fused:L22.ffn_down        9.73     1.7
matmul_rmsnorm_fused:L12.ffn_down        9.68     1.7
matmul_rmsnorm_fused:L23.ffn_down        9.16     1.6
matmul_rmsnorm_fused:L19.ffn_down        8.92     1.5
matmul_rmsnorm_fused:L15.ffn_down        8.92     1.5
matmul_rmsnorm_fused:L17.ffn_down        8.90     1.5
matmul_rmsnorm_fused:L5.ffn_down        8.89     1.5
matmul_rmsnorm_fused:L14.ffn_down        8.89     1.5
matmul_rmsnorm_fused:L20.ffn_down        8.80     1.5
matmul_rmsnorm_fused:L9.ffn_down        8.74     1.5
matmul_rmsnorm_fused:L2.ffn_down        8.73     1.5
matmul_rmsnorm_fused:L6.ffn_down        8.72     1.5
matmul_rmsnorm_fused:L1.ffn_down        8.68     1.5
matmul_rmsnorm_fused:L13.ffn_down        8.66     1.5
matmul_rmsnorm_fused:L8.ffn_down        8.62     1.5
matmul_rmsnorm_fused:L7.ffn_down        8.60     1.5
matmul_rmsnorm_fused:L0.ffn_down        8.59     1.5
sample_phase2                    3.38     0.6
matmul:q_proj:L17                3.23     0.6
matmul:o_proj:L22                2.13     0.4
matmul:q_proj:L22                2.13     0.4
rope                             1.18     0.2
matmul:q_proj:L24                1.11     0.2
matmul:o_proj:L18                1.03     0.2
matmul:q_proj:L16                0.90     0.2
matmul:k_proj:L16                0.90     0.2
matmul:o_proj:L24                0.69     0.1
matmul:o_proj:L7                 0.65     0.1
matmul:q_proj:L11                0.58     0.1
matmul:q_proj:L5                 0.51     0.1
matmul:q_proj:L13                0.46     0.1
matmul:v_proj:L16                0.37     0.1
matmul:o_proj:L10                0.20     0.0
matmul:o_proj:L4                 0.20     0.0
matmul:o_proj:L11                0.19     0.0
matmul:q_proj:L0                 0.17     0.0
matmul:q_proj:L19                0.17     0.0
matmul:o_proj:L25                0.17     0.0
matmul:o_proj:L16                0.16     0.0
matmul:q_proj:L18                0.15     0.0
matmul:q_proj:L4                 0.15     0.0
matmul:o_proj:L3                 0.15     0.0
matmul:o_proj:L20                0.15     0.0
matmul:o_proj:L17                0.15     0.0
matmul:o_proj:L19                0.15     0.0
matmul:q_proj:L25                0.15     0.0
matmul:o_proj:L21                0.14     0.0
matmul:o_proj:L13                0.14     0.0
matmul:o_proj:L15                0.14     0.0
matmul:o_proj:L5                 0.14     0.0
matmul:o_proj:L0                 0.14     0.0
matmul:o_proj:L14                0.14     0.0
matmul:o_proj:L9                 0.14     0.0
matmul:o_proj:L2                 0.13     0.0
matmul:q_proj:L3                 0.13     0.0
matmul:q_proj:L14                0.13     0.0
matmul:q_proj:L15                0.13     0.0
matmul:q_proj:L10                0.13     0.0
matmul:o_proj:L23                0.13     0.0
matmul:q_proj:L20                0.13     0.0
matmul:o_proj:L8                 0.13     0.0
matmul:o_proj:L12                0.13     0.0
matmul:q_proj:L7                 0.12     0.0
matmul:o_proj:L1                 0.12     0.0
matmul:q_proj:L12                0.12     0.0
matmul:q_proj:L21                0.12     0.0
matmul:q_proj:L9                 0.12     0.0
matmul:q_proj:L23                0.12     0.0
matmul:o_proj:L6                 0.12     0.0
matmul:q_proj:L6                 0.12     0.0
matmul:q_proj:L2                 0.12     0.0
matmul:q_proj:L8                 0.12     0.0
matmul:q_proj:L1                 0.12     0.0
matmul:v_proj:L24                0.09     0.0
sample_phase1                    0.08     0.0
matmul:k_proj:L5                 0.07     0.0
matmul:k_proj:L17                0.07     0.0
matmul:k_proj:L18                0.07     0.0
matmul:v_proj:L22                0.07     0.0
matmul:k_proj:L0                 0.06     0.0
matmul:v_proj:L17                0.06     0.0
matmul:v_proj:L5                 0.06     0.0
matmul:k_proj:L22                0.06     0.0
matmul:k_proj:L13                0.06     0.0
matmul:v_proj:L18                0.06     0.0
matmul:k_proj:L24                0.06     0.0
sample_phase3                    0.06     0.0
matmul:k_proj:L19                0.06     0.0
matmul:k_proj:L4                 0.06     0.0
matmul:k_proj:L25                0.06     0.0
matmul:v_proj:L4                 0.05     0.0
matmul:v_proj:L0                 0.05     0.0
matmul:v_proj:L25                0.05     0.0
matmul:v_proj:L13                0.05     0.0
matmul:k_proj:L21                0.05     0.0
matmul:v_proj:L19                0.05     0.0
matmul:k_proj:L11                0.05     0.0
matmul:k_proj:L14                0.05     0.0
matmul:v_proj:L20                0.05     0.0
matmul:v_proj:L11                0.05     0.0
matmul:k_proj:L10                0.05     0.0
matmul:k_proj:L20                0.05     0.0
matmul:k_proj:L3                 0.05     0.0
matmul:k_proj:L7                 0.05     0.0
matmul:k_proj:L15                0.04     0.0
matmul:v_proj:L14                0.04     0.0
matmul:k_proj:L2                 0.04     0.0
matmul:k_proj:L23                0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:k_proj:L1                 0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:k_proj:L12                0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:v_proj:L8                 0.04     0.0
gather                           0.03     0.0
scale                            0.02     0.0
──────────────────────────────────────────────────
TOTAL                          584.24   100.0

[browser:warning] [18004.1ms][Profile] Batch decode (N=4):
[browser:warning] [18004.4ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      211.40    35.0
fused_ffn                       60.41    10.0
matmul:lm_head                  38.18     6.3
matmul_rmsnorm_fused:L5.ffn_down       12.39     2.1
matmul_rmsnorm_fused:L22.ffn_down       12.10     2.0
matmul_rmsnorm_fused:L16.ffn_down       11.12     1.8
matmul_rmsnorm_fused:L7.ffn_down       10.85     1.8
matmul_rmsnorm_fused:L25.ffn_down       10.61     1.8
matmul_rmsnorm_fused:L2.ffn_down       10.38     1.7
matmul_rmsnorm_fused:L11.ffn_down       10.28     1.7
matmul_rmsnorm_fused:L9.ffn_down       10.21     1.7
matmul_rmsnorm_fused:L14.ffn_down        9.90     1.6
matmul_rmsnorm_fused:L21.ffn_down        9.80     1.6
matmul_rmsnorm_fused:L15.ffn_down        9.71     1.6
matmul_rmsnorm_fused:L18.ffn_down        9.66     1.6
matmul_rmsnorm_fused:L1.ffn_down        9.63     1.6
matmul_rmsnorm_fused:L17.ffn_down        9.48     1.6
matmul_rmsnorm_fused:L0.ffn_down        9.27     1.5
matmul_rmsnorm_fused:L13.ffn_down        9.22     1.5
matmul_rmsnorm_fused:L3.ffn_down        9.07     1.5
matmul_rmsnorm_fused:L24.ffn_down        9.02     1.5
matmul_rmsnorm_fused:L23.ffn_down        8.83     1.5
matmul_rmsnorm_fused:L10.ffn_down        8.75     1.4
matmul_rmsnorm_fused:L20.ffn_down        8.73     1.4
matmul_rmsnorm_fused:L19.ffn_down        8.69     1.4
matmul_rmsnorm_fused:L8.ffn_down        8.67     1.4
matmul_rmsnorm_fused:L4.ffn_down        8.67     1.4
matmul_rmsnorm_fused:L6.ffn_down        8.67     1.4
matmul_rmsnorm_fused:L12.ffn_down        8.63     1.4
rmsnorm                          8.40     1.4
matmul:o_proj:L0                 6.42     1.1
sample_phase2                    3.39     0.6
matmul:q_proj:L17                2.91     0.5
matmul:o_proj:L22                2.66     0.4
matmul:o_proj:L2                 2.31     0.4
matmul:o_proj:L5                 1.59     0.3
rope                             1.19     0.2
matmul:q_proj:L6                 0.87     0.1
matmul:q_proj:L19                0.81     0.1
matmul:o_proj:L13                0.74     0.1
matmul:o_proj:L24                0.70     0.1
matmul:q_proj:L8                 0.65     0.1
matmul:o_proj:L23                0.36     0.1
matmul:q_proj:L0                 0.20     0.0
matmul:o_proj:L21                0.19     0.0
matmul:o_proj:L1                 0.18     0.0
matmul:o_proj:L9                 0.18     0.0
matmul:o_proj:L11                0.17     0.0
matmul:q_proj:L16                0.17     0.0
matmul:q_proj:L18                0.17     0.0
matmul:o_proj:L20                0.16     0.0
matmul:q_proj:L4                 0.16     0.0
matmul:v_proj:L8                 0.16     0.0
matmul:o_proj:L25                0.16     0.0
matmul:q_proj:L23                0.15     0.0
matmul:o_proj:L7                 0.15     0.0
matmul:o_proj:L14                0.15     0.0
matmul:o_proj:L16                0.15     0.0
matmul:o_proj:L3                 0.15     0.0
matmul:o_proj:L15                0.15     0.0
matmul:o_proj:L8                 0.14     0.0
matmul:q_proj:L22                0.14     0.0
matmul:q_proj:L21                0.14     0.0
matmul:q_proj:L2                 0.14     0.0
matmul:o_proj:L4                 0.14     0.0
matmul:o_proj:L19                0.14     0.0
matmul:o_proj:L18                0.14     0.0
matmul:o_proj:L17                0.14     0.0
matmul:q_proj:L24                0.14     0.0
matmul:o_proj:L6                 0.14     0.0
matmul:q_proj:L9                 0.14     0.0
matmul:q_proj:L5                 0.14     0.0
matmul:o_proj:L10                0.13     0.0
matmul:q_proj:L20                0.13     0.0
matmul:q_proj:L10                0.13     0.0
matmul:q_proj:L25                0.13     0.0
matmul:q_proj:L11                0.13     0.0
matmul:q_proj:L1                 0.13     0.0
matmul:q_proj:L14                0.13     0.0
matmul:q_proj:L15                0.13     0.0
matmul:q_proj:L7                 0.12     0.0
matmul:q_proj:L13                0.12     0.0
matmul:o_proj:L12                0.12     0.0
matmul:q_proj:L12                0.12     0.0
matmul:q_proj:L3                 0.12     0.0
matmul:k_proj:L8                 0.10     0.0
matmul:k_proj:L24                0.08     0.0
matmul:k_proj:L0                 0.08     0.0
sample_phase1                    0.08     0.0
matmul:v_proj:L0                 0.08     0.0
matmul:v_proj:L6                 0.07     0.0
matmul:k_proj:L6                 0.07     0.0
sample_phase3                    0.07     0.0
matmul:k_proj:L18                0.07     0.0
matmul:v_proj:L16                0.07     0.0
matmul:k_proj:L16                0.06     0.0
matmul:v_proj:L18                0.06     0.0
matmul:k_proj:L4                 0.06     0.0
matmul:v_proj:L24                0.06     0.0
matmul:v_proj:L4                 0.06     0.0
matmul:k_proj:L19                0.06     0.0
matmul:k_proj:L23                0.06     0.0
matmul:k_proj:L22                0.06     0.0
matmul:k_proj:L17                0.06     0.0
matmul:v_proj:L17                0.05     0.0
matmul:v_proj:L19                0.05     0.0
matmul:v_proj:L22                0.05     0.0
matmul:k_proj:L2                 0.05     0.0
matmul:k_proj:L21                0.05     0.0
matmul:v_proj:L23                0.05     0.0
matmul:k_proj:L10                0.05     0.0
matmul:v_proj:L2                 0.05     0.0
matmul:k_proj:L5                 0.05     0.0
matmul:k_proj:L7                 0.05     0.0
matmul:k_proj:L9                 0.05     0.0
matmul:v_proj:L9                 0.05     0.0
matmul:k_proj:L20                0.05     0.0
matmul:v_proj:L21                0.05     0.0
matmul:k_proj:L13                0.05     0.0
matmul:k_proj:L11                0.05     0.0
matmul:k_proj:L25                0.05     0.0
matmul:v_proj:L25                0.05     0.0
matmul:v_proj:L5                 0.05     0.0
matmul:k_proj:L14                0.05     0.0
matmul:v_proj:L11                0.05     0.0
matmul:v_proj:L10                0.05     0.0
matmul:v_proj:L20                0.05     0.0
matmul:v_proj:L13                0.04     0.0
matmul:k_proj:L1                 0.04     0.0
matmul:k_proj:L15                0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:k_proj:L12                0.04     0.0
matmul:k_proj:L3                 0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:v_proj:L15                0.04     0.0
gather                           0.04     0.0
matmul:v_proj:L14                0.04     0.0
matmul:v_proj:L3                 0.04     0.0
scale                            0.04     0.0
──────────────────────────────────────────────────
TOTAL                          604.43   100.0

[browser:warning] [18749.8ms][Profile] Batch decode (N=4):
[browser:warning] [18750.0ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      219.20    32.2
fused_ffn                       83.16    12.2
matmul:lm_head                  41.41     6.1
rmsnorm                         20.02     2.9
matmul_rmsnorm_fused:L15.ffn_down       12.20     1.8
matmul_rmsnorm_fused:L4.ffn_down       11.98     1.8
matmul_rmsnorm_fused:L19.ffn_down       11.40     1.7
matmul_rmsnorm_fused:L25.ffn_down       11.30     1.7
matmul_rmsnorm_fused:L3.ffn_down       10.85     1.6
matmul_rmsnorm_fused:L24.ffn_down       10.81     1.6
matmul_rmsnorm_fused:L13.ffn_down       10.72     1.6
matmul_rmsnorm_fused:L8.ffn_down       10.69     1.6
matmul_rmsnorm_fused:L9.ffn_down       10.56     1.6
matmul_rmsnorm_fused:L10.ffn_down       10.45     1.5
matmul_rmsnorm_fused:L20.ffn_down       10.44     1.5
matmul_rmsnorm_fused:L14.ffn_down       10.39     1.5
matmul_rmsnorm_fused:L11.ffn_down       10.13     1.5
matmul_rmsnorm_fused:L17.ffn_down        9.82     1.4
matmul_rmsnorm_fused:L5.ffn_down        9.71     1.4
matmul_rmsnorm_fused:L16.ffn_down        9.57     1.4
matmul_rmsnorm_fused:L0.ffn_down        9.23     1.4
matmul_rmsnorm_fused:L1.ffn_down        9.06     1.3
matmul_rmsnorm_fused:L21.ffn_down        8.88     1.3
matmul_rmsnorm_fused:L2.ffn_down        8.85     1.3
matmul_rmsnorm_fused:L6.ffn_down        8.80     1.3
matmul_rmsnorm_fused:L23.ffn_down        8.79     1.3
matmul_rmsnorm_fused:L12.ffn_down        8.79     1.3
matmul_rmsnorm_fused:L22.ffn_down        8.78     1.3
matmul_rmsnorm_fused:L18.ffn_down        8.75     1.3
matmul_rmsnorm_fused:L7.ffn_down        8.67     1.3
matmul:o_proj:L9                 5.85     0.9
matmul:o_proj:L20                4.11     0.6
sample_phase2                    3.60     0.5
matmul:k_proj:L21                3.22     0.5
rope                             2.99     0.4
matmul:o_proj:L4                 2.76     0.4
matmul:o_proj:L14                2.21     0.3
matmul:q_proj:L5                 1.86     0.3
matmul:q_proj:L2                 1.67     0.2
matmul:q_proj:L16                1.53     0.2
gather                           1.52     0.2
matmul:o_proj:L25                1.44     0.2
matmul:o_proj:L0                 1.44     0.2
matmul:o_proj:L3                 1.35     0.2
matmul:o_proj:L23                1.26     0.2
matmul:q_proj:L6                 1.14     0.2
matmul:o_proj:L12                1.13     0.2
sample_phase1                    1.01     0.1
matmul:q_proj:L12                0.96     0.1
matmul:v_proj:L2                 0.92     0.1
matmul:q_proj:L20                0.86     0.1
matmul:q_proj:L0                 0.81     0.1
matmul:q_proj:L1                 0.81     0.1
matmul:o_proj:L22                0.81     0.1
matmul:q_proj:L7                 0.73     0.1
matmul:o_proj:L6                 0.72     0.1
matmul:o_proj:L17                0.67     0.1
matmul:q_proj:L25                0.65     0.1
matmul:v_proj:L25                0.55     0.1
matmul:k_proj:L6                 0.54     0.1
matmul:o_proj:L10                0.45     0.1
sample_phase3                    0.42     0.1
matmul:v_proj:L6                 0.35     0.1
matmul:q_proj:L4                 0.18     0.0
matmul:o_proj:L19                0.17     0.0
matmul:q_proj:L21                0.17     0.0
matmul:q_proj:L14                0.17     0.0
matmul:o_proj:L16                0.17     0.0
matmul:q_proj:L10                0.16     0.0
matmul:q_proj:L18                0.16     0.0
matmul:o_proj:L18                0.16     0.0
matmul:q_proj:L11                0.16     0.0
matmul:q_proj:L22                0.16     0.0
matmul:q_proj:L23                0.16     0.0
matmul:o_proj:L5                 0.15     0.0
matmul:o_proj:L1                 0.15     0.0
matmul:o_proj:L15                0.15     0.0
matmul:o_proj:L8                 0.15     0.0
matmul:o_proj:L2                 0.15     0.0
matmul:q_proj:L3                 0.15     0.0
matmul:o_proj:L7                 0.15     0.0
matmul:q_proj:L17                0.14     0.0
matmul:o_proj:L24                0.14     0.0
matmul:q_proj:L9                 0.14     0.0
matmul:o_proj:L21                0.14     0.0
matmul:o_proj:L13                0.14     0.0
matmul:o_proj:L11                0.14     0.0
matmul:q_proj:L15                0.13     0.0
matmul:q_proj:L19                0.13     0.0
matmul:q_proj:L8                 0.13     0.0
matmul:q_proj:L24                0.13     0.0
matmul:q_proj:L13                0.12     0.0
matmul:k_proj:L2                 0.11     0.0
matmul:v_proj:L7                 0.09     0.0
matmul:v_proj:L21                0.09     0.0
matmul:k_proj:L0                 0.08     0.0
matmul:v_proj:L0                 0.07     0.0
scale                            0.07     0.0
matmul:k_proj:L20                0.07     0.0
matmul:v_proj:L20                0.07     0.0
matmul:v_proj:L11                0.06     0.0
matmul:k_proj:L7                 0.06     0.0
matmul:k_proj:L12                0.06     0.0
matmul:k_proj:L1                 0.06     0.0
matmul:v_proj:L12                0.06     0.0
matmul:v_proj:L18                0.06     0.0
matmul:v_proj:L4                 0.06     0.0
matmul:k_proj:L16                0.06     0.0
matmul:v_proj:L5                 0.06     0.0
matmul:k_proj:L4                 0.06     0.0
matmul:k_proj:L18                0.06     0.0
matmul:v_proj:L1                 0.05     0.0
matmul:k_proj:L5                 0.05     0.0
matmul:v_proj:L17                0.05     0.0
matmul:k_proj:L22                0.05     0.0
matmul:v_proj:L16                0.05     0.0
matmul:k_proj:L25                0.05     0.0
matmul:k_proj:L17                0.05     0.0
matmul:v_proj:L9                 0.05     0.0
matmul:k_proj:L14                0.05     0.0
matmul:k_proj:L11                0.05     0.0
matmul:k_proj:L3                 0.05     0.0
matmul:v_proj:L3                 0.05     0.0
matmul:v_proj:L22                0.05     0.0
matmul:k_proj:L9                 0.05     0.0
matmul:k_proj:L23                0.05     0.0
matmul:k_proj:L10                0.05     0.0
matmul:k_proj:L15                0.05     0.0
matmul:v_proj:L10                0.05     0.0
matmul:k_proj:L19                0.05     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:v_proj:L19                0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:v_proj:L14                0.04     0.0
matmul:v_proj:L24                0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:k_proj:L13                0.04     0.0
matmul:k_proj:L24                0.04     0.0
──────────────────────────────────────────────────
TOTAL                          680.80   100.0

[browser:warning] [19369.7ms][Profile] Batch decode (N=4):
[browser:warning] [19369.9ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      224.62    39.6
fused_ffn                       44.62     7.9
matmul:lm_head                  32.39     5.7
matmul_rmsnorm_fused:L20.ffn_down       10.67     1.9
matmul_rmsnorm_fused:L23.ffn_down       10.66     1.9
matmul_rmsnorm_fused:L10.ffn_down       10.24     1.8
matmul_rmsnorm_fused:L7.ffn_down       10.23     1.8
matmul_rmsnorm_fused:L25.ffn_down       10.14     1.8
matmul_rmsnorm_fused:L12.ffn_down       10.11     1.8
matmul_rmsnorm_fused:L15.ffn_down       10.09     1.8
matmul_rmsnorm_fused:L22.ffn_down        9.87     1.7
matmul_rmsnorm_fused:L4.ffn_down        9.86     1.7
matmul_rmsnorm_fused:L19.ffn_down        9.61     1.7
matmul_rmsnorm_fused:L17.ffn_down        9.52     1.7
matmul_rmsnorm_fused:L1.ffn_down        9.38     1.7
matmul_rmsnorm_fused:L13.ffn_down        9.20     1.6
matmul_rmsnorm_fused:L6.ffn_down        9.18     1.6
matmul_rmsnorm_fused:L2.ffn_down        9.06     1.6
matmul_rmsnorm_fused:L9.ffn_down        8.88     1.6
matmul_rmsnorm_fused:L8.ffn_down        8.81     1.6
matmul_rmsnorm_fused:L18.ffn_down        8.72     1.5
matmul_rmsnorm_fused:L0.ffn_down        8.71     1.5
matmul_rmsnorm_fused:L21.ffn_down        8.71     1.5
matmul_rmsnorm_fused:L14.ffn_down        8.68     1.5
matmul_rmsnorm_fused:L24.ffn_down        8.68     1.5
matmul_rmsnorm_fused:L11.ffn_down        8.67     1.5
matmul_rmsnorm_fused:L16.ffn_down        8.67     1.5
matmul_rmsnorm_fused:L3.ffn_down        8.64     1.5
matmul_rmsnorm_fused:L5.ffn_down        8.64     1.5
rmsnorm                          4.65     0.8
sample_phase2                    3.28     0.6
matmul:q_proj:L0                 1.31     0.2
rope                             0.80     0.1
matmul:o_proj:L2                 0.57     0.1
matmul:q_proj:L8                 0.43     0.1
gather                           0.41     0.1
matmul:k_proj:L8                 0.35     0.1
matmul:o_proj:L17                0.31     0.1
scale                            0.30     0.1
matmul:o_proj:L5                 0.26     0.0
matmul:o_proj:L1                 0.18     0.0
matmul:o_proj:L19                0.17     0.0
matmul:o_proj:L22                0.16     0.0
matmul:o_proj:L20                0.16     0.0
matmul:o_proj:L14                0.16     0.0
matmul:q_proj:L14                0.16     0.0
matmul:o_proj:L10                0.15     0.0
matmul:o_proj:L16                0.15     0.0
matmul:o_proj:L9                 0.15     0.0
matmul:o_proj:L6                 0.15     0.0
matmul:o_proj:L0                 0.15     0.0
matmul:q_proj:L16                0.14     0.0
matmul:q_proj:L5                 0.14     0.0
matmul:q_proj:L24                0.14     0.0
matmul:o_proj:L8                 0.14     0.0
matmul:q_proj:L22                0.14     0.0
matmul:o_proj:L25                0.14     0.0
matmul:q_proj:L21                0.14     0.0
matmul:o_proj:L15                0.14     0.0
matmul:o_proj:L3                 0.14     0.0
matmul:o_proj:L13                0.14     0.0
matmul:o_proj:L21                0.14     0.0
matmul:q_proj:L2                 0.14     0.0
matmul:q_proj:L13                0.14     0.0
matmul:o_proj:L23                0.13     0.0
matmul:o_proj:L7                 0.13     0.0
matmul:o_proj:L12                0.13     0.0
matmul:q_proj:L9                 0.13     0.0
matmul:o_proj:L24                0.13     0.0
matmul:o_proj:L4                 0.13     0.0
matmul:q_proj:L1                 0.13     0.0
matmul:q_proj:L23                0.13     0.0
matmul:q_proj:L19                0.13     0.0
matmul:q_proj:L20                0.13     0.0
matmul:o_proj:L18                0.13     0.0
matmul:q_proj:L11                0.13     0.0
matmul:q_proj:L15                0.13     0.0
matmul:q_proj:L12                0.13     0.0
matmul:q_proj:L25                0.13     0.0
matmul:q_proj:L6                 0.13     0.0
matmul:q_proj:L7                 0.13     0.0
matmul:q_proj:L10                0.13     0.0
matmul:o_proj:L11                0.12     0.0
matmul:q_proj:L3                 0.12     0.0
matmul:q_proj:L4                 0.12     0.0
matmul:q_proj:L17                0.12     0.0
matmul:q_proj:L18                0.12     0.0
matmul:k_proj:L0                 0.10     0.0
sample_phase3                    0.08     0.0
sample_phase1                    0.08     0.0
matmul:v_proj:L8                 0.07     0.0
matmul:k_proj:L14                0.06     0.0
matmul:v_proj:L0                 0.06     0.0
matmul:v_proj:L14                0.06     0.0
matmul:v_proj:L1                 0.05     0.0
matmul:k_proj:L16                0.05     0.0
matmul:v_proj:L24                0.05     0.0
matmul:k_proj:L5                 0.05     0.0
matmul:v_proj:L5                 0.05     0.0
matmul:k_proj:L13                0.05     0.0
matmul:v_proj:L16                0.05     0.0
matmul:v_proj:L13                0.05     0.0
matmul:k_proj:L24                0.05     0.0
matmul:k_proj:L22                0.05     0.0
matmul:v_proj:L12                0.05     0.0
matmul:k_proj:L2                 0.05     0.0
matmul:v_proj:L22                0.05     0.0
matmul:k_proj:L21                0.05     0.0
matmul:v_proj:L2                 0.05     0.0
matmul:v_proj:L3                 0.05     0.0
matmul:k_proj:L23                0.05     0.0
matmul:v_proj:L21                0.05     0.0
matmul:k_proj:L9                 0.05     0.0
matmul:k_proj:L1                 0.05     0.0
matmul:v_proj:L10                0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:k_proj:L20                0.04     0.0
matmul:k_proj:L15                0.04     0.0
matmul:k_proj:L10                0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:v_proj:L19                0.04     0.0
matmul:k_proj:L12                0.04     0.0
matmul:k_proj:L7                 0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:k_proj:L18                0.04     0.0
matmul:k_proj:L11                0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:k_proj:L4                 0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:k_proj:L19                0.04     0.0
matmul:v_proj:L17                0.04     0.0
matmul:k_proj:L17                0.04     0.0
matmul:k_proj:L3                 0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:v_proj:L18                0.04     0.0
──────────────────────────────────────────────────
TOTAL                          567.08   100.0

[browser:warning] [19975.4ms][Profile] Batch decode (N=4):
[browser:warning] [19975.5ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      232.16    41.6
fused_ffn                       40.23     7.2
matmul:lm_head                  30.58     5.5
matmul_rmsnorm_fused:L15.ffn_down       10.38     1.9
matmul_rmsnorm_fused:L7.ffn_down       10.35     1.9
matmul_rmsnorm_fused:L19.ffn_down       10.19     1.8
matmul_rmsnorm_fused:L2.ffn_down       10.15     1.8
matmul_rmsnorm_fused:L11.ffn_down        9.79     1.8
matmul_rmsnorm_fused:L18.ffn_down        9.51     1.7
matmul_rmsnorm_fused:L21.ffn_down        9.38     1.7
matmul_rmsnorm_fused:L22.ffn_down        9.27     1.7
matmul_rmsnorm_fused:L14.ffn_down        9.21     1.6
matmul_rmsnorm_fused:L6.ffn_down        9.20     1.6
matmul_rmsnorm_fused:L24.ffn_down        9.17     1.6
matmul_rmsnorm_fused:L4.ffn_down        9.08     1.6
matmul_rmsnorm_fused:L9.ffn_down        9.08     1.6
matmul_rmsnorm_fused:L1.ffn_down        8.82     1.6
matmul_rmsnorm_fused:L0.ffn_down        8.81     1.6
matmul_rmsnorm_fused:L12.ffn_down        8.78     1.6
matmul_rmsnorm_fused:L17.ffn_down        8.70     1.6
matmul_rmsnorm_fused:L23.ffn_down        8.69     1.6
matmul_rmsnorm_fused:L10.ffn_down        8.68     1.6
matmul_rmsnorm_fused:L25.ffn_down        8.66     1.6
matmul_rmsnorm_fused:L8.ffn_down        8.66     1.6
matmul_rmsnorm_fused:L3.ffn_down        8.66     1.6
matmul_rmsnorm_fused:L13.ffn_down        8.66     1.5
matmul_rmsnorm_fused:L20.ffn_down        8.65     1.5
matmul_rmsnorm_fused:L16.ffn_down        8.65     1.5
matmul_rmsnorm_fused:L5.ffn_down        8.64     1.5
sample_phase2                    3.39     0.6
rmsnorm                          3.12     0.6
rope                             0.77     0.1
matmul:q_proj:L12                0.72     0.1
matmul:q_proj:L0                 0.21     0.0
matmul:o_proj:L6                 0.18     0.0
matmul:o_proj:L21                0.17     0.0
matmul:o_proj:L24                0.17     0.0
matmul:q_proj:L3                 0.16     0.0
matmul:q_proj:L1                 0.16     0.0
matmul:o_proj:L14                0.16     0.0
matmul:o_proj:L18                0.15     0.0
matmul:q_proj:L13                0.15     0.0
matmul:o_proj:L11                0.15     0.0
matmul:o_proj:L22                0.15     0.0
matmul:o_proj:L13                0.15     0.0
matmul:o_proj:L17                0.15     0.0
matmul:o_proj:L10                0.15     0.0
matmul:q_proj:L5                 0.15     0.0
matmul:o_proj:L1                 0.15     0.0
matmul:o_proj:L7                 0.14     0.0
matmul:o_proj:L0                 0.14     0.0
matmul:o_proj:L9                 0.14     0.0
matmul:o_proj:L5                 0.14     0.0
matmul:o_proj:L3                 0.14     0.0
matmul:o_proj:L4                 0.14     0.0
matmul:o_proj:L12                0.13     0.0
matmul:q_proj:L20                0.13     0.0
matmul:o_proj:L23                0.13     0.0
matmul:o_proj:L19                0.13     0.0
matmul:o_proj:L20                0.13     0.0
matmul:o_proj:L2                 0.13     0.0
matmul:q_proj:L23                0.13     0.0
matmul:q_proj:L9                 0.13     0.0
matmul:o_proj:L8                 0.13     0.0
matmul:o_proj:L16                0.13     0.0
matmul:o_proj:L25                0.13     0.0
matmul:q_proj:L18                0.13     0.0
matmul:q_proj:L15                0.13     0.0
matmul:q_proj:L16                0.13     0.0
matmul:q_proj:L22                0.12     0.0
matmul:q_proj:L24                0.12     0.0
matmul:q_proj:L21                0.12     0.0
matmul:o_proj:L15                0.12     0.0
matmul:q_proj:L7                 0.12     0.0
matmul:q_proj:L10                0.12     0.0
matmul:q_proj:L6                 0.12     0.0
matmul:q_proj:L8                 0.12     0.0
matmul:q_proj:L19                0.12     0.0
matmul:q_proj:L11                0.12     0.0
matmul:q_proj:L2                 0.12     0.0
matmul:q_proj:L4                 0.12     0.0
matmul:q_proj:L14                0.12     0.0
matmul:q_proj:L25                0.12     0.0
matmul:q_proj:L17                0.12     0.0
matmul:k_proj:L0                 0.09     0.0
sample_phase1                    0.09     0.0
matmul:v_proj:L0                 0.08     0.0
sample_phase3                    0.07     0.0
matmul:k_proj:L13                0.06     0.0
matmul:k_proj:L1                 0.06     0.0
matmul:v_proj:L1                 0.06     0.0
matmul:k_proj:L5                 0.05     0.0
matmul:v_proj:L5                 0.05     0.0
matmul:v_proj:L12                0.05     0.0
matmul:v_proj:L13                0.05     0.0
matmul:k_proj:L3                 0.05     0.0
matmul:v_proj:L3                 0.05     0.0
matmul:k_proj:L20                0.05     0.0
matmul:v_proj:L20                0.05     0.0
matmul:k_proj:L12                0.05     0.0
matmul:k_proj:L23                0.05     0.0
matmul:k_proj:L14                0.05     0.0
matmul:k_proj:L22                0.05     0.0
matmul:v_proj:L23                0.05     0.0
matmul:v_proj:L9                 0.05     0.0
matmul:v_proj:L25                0.05     0.0
gather                           0.05     0.0
matmul:k_proj:L9                 0.05     0.0
matmul:v_proj:L19                0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:v_proj:L22                0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:k_proj:L18                0.04     0.0
matmul:v_proj:L14                0.04     0.0
matmul:k_proj:L2                 0.04     0.0
matmul:k_proj:L19                0.04     0.0
matmul:k_proj:L16                0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:k_proj:L15                0.04     0.0
matmul:k_proj:L24                0.04     0.0
matmul:v_proj:L16                0.04     0.0
matmul:k_proj:L11                0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:k_proj:L21                0.04     0.0
matmul:v_proj:L18                0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:k_proj:L7                 0.04     0.0
matmul:k_proj:L17                0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:k_proj:L10                0.04     0.0
matmul:k_proj:L4                 0.04     0.0
matmul:v_proj:L24                0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:v_proj:L17                0.04     0.0
scale                            0.03     0.0
──────────────────────────────────────────────────
TOTAL                          558.59   100.0

[browser:warning] [20592.9ms][Profile] Batch decode (N=4):
[browser:warning] [20593.0ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      238.43    41.7
fused_ffn                       40.15     7.0
matmul:lm_head                  30.12     5.3
matmul_rmsnorm_fused:L8.ffn_down       11.38     2.0
matmul_rmsnorm_fused:L23.ffn_down       10.41     1.8
matmul_rmsnorm_fused:L21.ffn_down       10.23     1.8
matmul_rmsnorm_fused:L19.ffn_down       10.23     1.8
matmul_rmsnorm_fused:L15.ffn_down       10.18     1.8
matmul_rmsnorm_fused:L6.ffn_down       10.14     1.8
matmul_rmsnorm_fused:L2.ffn_down       10.07     1.8
matmul_rmsnorm_fused:L12.ffn_down       10.00     1.8
matmul_rmsnorm_fused:L10.ffn_down        9.98     1.7
matmul_rmsnorm_fused:L14.ffn_down        9.92     1.7
matmul_rmsnorm_fused:L4.ffn_down        9.80     1.7
matmul_rmsnorm_fused:L25.ffn_down        9.76     1.7
matmul_rmsnorm_fused:L1.ffn_down        9.58     1.7
matmul_rmsnorm_fused:L17.ffn_down        9.08     1.6
matmul_rmsnorm_fused:L11.ffn_down        8.98     1.6
matmul_rmsnorm_fused:L20.ffn_down        8.79     1.5
matmul_rmsnorm_fused:L5.ffn_down        8.71     1.5
matmul_rmsnorm_fused:L18.ffn_down        8.70     1.5
matmul_rmsnorm_fused:L22.ffn_down        8.69     1.5
matmul_rmsnorm_fused:L16.ffn_down        8.67     1.5
matmul_rmsnorm_fused:L3.ffn_down        8.65     1.5
matmul_rmsnorm_fused:L13.ffn_down        8.65     1.5
matmul_rmsnorm_fused:L9.ffn_down        8.65     1.5
matmul_rmsnorm_fused:L24.ffn_down        8.64     1.5
matmul_rmsnorm_fused:L7.ffn_down        8.63     1.5
matmul_rmsnorm_fused:L0.ffn_down        8.63     1.5
rmsnorm                          3.63     0.6
sample_phase2                    3.39     0.6
rope                             0.78     0.1
matmul:q_proj:L0                 0.17     0.0
matmul:o_proj:L4                 0.16     0.0
matmul:o_proj:L0                 0.16     0.0
matmul:o_proj:L21                0.16     0.0
matmul:o_proj:L8                 0.16     0.0
matmul:o_proj:L19                0.15     0.0
matmul:q_proj:L18                0.15     0.0
matmul:o_proj:L6                 0.15     0.0
matmul:q_proj:L2                 0.15     0.0
matmul:o_proj:L1                 0.15     0.0
matmul:o_proj:L16                0.15     0.0
matmul:o_proj:L10                0.15     0.0
matmul:o_proj:L17                0.14     0.0
matmul:o_proj:L3                 0.14     0.0
matmul:q_proj:L9                 0.14     0.0
matmul:o_proj:L15                0.14     0.0
matmul:q_proj:L15                0.14     0.0
matmul:q_proj:L11                0.14     0.0
matmul:q_proj:L3                 0.14     0.0
matmul:q_proj:L12                0.14     0.0
matmul:o_proj:L20                0.14     0.0
matmul:o_proj:L13                0.14     0.0
matmul:q_proj:L13                0.13     0.0
matmul:o_proj:L9                 0.13     0.0
matmul:o_proj:L7                 0.13     0.0
matmul:o_proj:L11                0.13     0.0
matmul:o_proj:L12                0.13     0.0
matmul:o_proj:L18                0.13     0.0
matmul:q_proj:L21                0.13     0.0
matmul:o_proj:L14                0.13     0.0
matmul:o_proj:L22                0.13     0.0
matmul:o_proj:L2                 0.13     0.0
matmul:q_proj:L7                 0.13     0.0
matmul:q_proj:L14                0.13     0.0
matmul:o_proj:L5                 0.13     0.0
matmul:q_proj:L16                0.13     0.0
matmul:q_proj:L24                0.13     0.0
matmul:o_proj:L23                0.13     0.0
matmul:q_proj:L20                0.13     0.0
matmul:q_proj:L10                0.13     0.0
matmul:o_proj:L25                0.12     0.0
matmul:q_proj:L1                 0.12     0.0
matmul:q_proj:L19                0.12     0.0
matmul:q_proj:L6                 0.12     0.0
matmul:q_proj:L23                0.12     0.0
matmul:q_proj:L5                 0.12     0.0
matmul:o_proj:L24                0.12     0.0
matmul:q_proj:L22                0.12     0.0
matmul:q_proj:L8                 0.12     0.0
matmul:q_proj:L25                0.12     0.0
matmul:q_proj:L17                0.12     0.0
matmul:q_proj:L4                 0.12     0.0
sample_phase3                    0.08     0.0
sample_phase1                    0.08     0.0
matmul:v_proj:L0                 0.08     0.0
matmul:k_proj:L0                 0.07     0.0
matmul:v_proj:L2                 0.06     0.0
matmul:k_proj:L2                 0.06     0.0
matmul:k_proj:L11                0.05     0.0
matmul:k_proj:L3                 0.05     0.0
matmul:k_proj:L15                0.05     0.0
matmul:k_proj:L9                 0.05     0.0
matmul:v_proj:L13                0.05     0.0
matmul:v_proj:L15                0.05     0.0
matmul:v_proj:L11                0.05     0.0
matmul:k_proj:L13                0.05     0.0
matmul:v_proj:L18                0.05     0.0
matmul:k_proj:L18                0.05     0.0
matmul:v_proj:L9                 0.05     0.0
matmul:v_proj:L3                 0.05     0.0
matmul:k_proj:L21                0.05     0.0
matmul:k_proj:L12                0.05     0.0
matmul:k_proj:L14                0.04     0.0
matmul:v_proj:L14                0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:k_proj:L7                 0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:v_proj:L24                0.04     0.0
matmul:k_proj:L24                0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:k_proj:L19                0.04     0.0
matmul:k_proj:L20                0.04     0.0
matmul:v_proj:L19                0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:k_proj:L1                 0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:k_proj:L10                0.04     0.0
matmul:v_proj:L16                0.04     0.0
matmul:k_proj:L17                0.04     0.0
matmul:k_proj:L23                0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:k_proj:L16                0.04     0.0
matmul:v_proj:L5                 0.04     0.0
matmul:k_proj:L4                 0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:k_proj:L22                0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:v_proj:L22                0.04     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:k_proj:L5                 0.04     0.0
matmul:v_proj:L17                0.04     0.0
gather                           0.03     0.0
scale                            0.03     0.0
──────────────────────────────────────────────────
TOTAL                          571.39   100.0

[browser:warning] [21219.1ms][Profile] Batch decode (N=4):
[browser:warning] [21219.3ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      245.51    42.4
fused_ffn                       41.02     7.1
matmul:lm_head                  30.22     5.2
matmul_rmsnorm_fused:L4.ffn_down       10.97     1.9
matmul_rmsnorm_fused:L22.ffn_down       10.54     1.8
matmul_rmsnorm_fused:L23.ffn_down       10.43     1.8
matmul_rmsnorm_fused:L6.ffn_down       10.39     1.8
matmul_rmsnorm_fused:L12.ffn_down       10.36     1.8
matmul_rmsnorm_fused:L8.ffn_down       10.31     1.8
matmul_rmsnorm_fused:L17.ffn_down       10.30     1.8
matmul_rmsnorm_fused:L10.ffn_down       10.27     1.8
matmul_rmsnorm_fused:L16.ffn_down        9.91     1.7
matmul_rmsnorm_fused:L25.ffn_down        9.72     1.7
matmul_rmsnorm_fused:L3.ffn_down        9.55     1.6
matmul_rmsnorm_fused:L21.ffn_down        9.48     1.6
matmul_rmsnorm_fused:L1.ffn_down        9.18     1.6
matmul_rmsnorm_fused:L0.ffn_down        9.12     1.6
matmul_rmsnorm_fused:L9.ffn_down        8.82     1.5
matmul_rmsnorm_fused:L14.ffn_down        8.79     1.5
matmul_rmsnorm_fused:L18.ffn_down        8.78     1.5
matmul_rmsnorm_fused:L19.ffn_down        8.77     1.5
matmul_rmsnorm_fused:L15.ffn_down        8.74     1.5
matmul_rmsnorm_fused:L11.ffn_down        8.73     1.5
matmul_rmsnorm_fused:L2.ffn_down        8.71     1.5
matmul_rmsnorm_fused:L7.ffn_down        8.69     1.5
matmul_rmsnorm_fused:L24.ffn_down        8.66     1.5
matmul_rmsnorm_fused:L13.ffn_down        8.65     1.5
matmul_rmsnorm_fused:L20.ffn_down        8.64     1.5
matmul_rmsnorm_fused:L5.ffn_down        8.63     1.5
sample_phase2                    3.24     0.6
rmsnorm                          3.10     0.5
rope                             0.86     0.1
matmul:o_proj:L4                 0.21     0.0
matmul:q_proj:L4                 0.20     0.0
matmul:o_proj:L10                0.19     0.0
matmul:o_proj:L16                0.18     0.0
matmul:o_proj:L0                 0.17     0.0
matmul:o_proj:L25                0.17     0.0
matmul:q_proj:L2                 0.16     0.0
matmul:o_proj:L21                0.16     0.0
matmul:q_proj:L10                0.15     0.0
matmul:q_proj:L19                0.15     0.0
matmul:q_proj:L15                0.15     0.0
matmul:o_proj:L20                0.15     0.0
matmul:o_proj:L15                0.14     0.0
matmul:o_proj:L3                 0.14     0.0
matmul:o_proj:L2                 0.14     0.0
matmul:o_proj:L23                0.14     0.0
matmul:q_proj:L0                 0.14     0.0
matmul:q_proj:L23                0.14     0.0
matmul:o_proj:L17                0.14     0.0
matmul:o_proj:L13                0.14     0.0
matmul:o_proj:L6                 0.14     0.0
matmul:q_proj:L11                0.14     0.0
matmul:o_proj:L7                 0.14     0.0
matmul:o_proj:L1                 0.13     0.0
matmul:o_proj:L19                0.13     0.0
matmul:o_proj:L9                 0.13     0.0
matmul:o_proj:L22                0.13     0.0
matmul:o_proj:L24                0.13     0.0
matmul:o_proj:L5                 0.13     0.0
matmul:q_proj:L17                0.13     0.0
matmul:q_proj:L24                0.13     0.0
matmul:o_proj:L11                0.13     0.0
matmul:q_proj:L20                0.13     0.0
matmul:o_proj:L8                 0.13     0.0
matmul:q_proj:L1                 0.13     0.0
matmul:o_proj:L12                0.13     0.0
matmul:q_proj:L13                0.13     0.0
matmul:o_proj:L18                0.13     0.0
matmul:q_proj:L22                0.13     0.0
matmul:o_proj:L14                0.13     0.0
matmul:q_proj:L9                 0.12     0.0
matmul:q_proj:L18                0.12     0.0
matmul:q_proj:L16                0.12     0.0
matmul:q_proj:L12                0.12     0.0
matmul:q_proj:L3                 0.12     0.0
matmul:q_proj:L7                 0.12     0.0
matmul:q_proj:L8                 0.12     0.0
matmul:q_proj:L14                0.12     0.0
matmul:q_proj:L6                 0.12     0.0
matmul:q_proj:L21                0.12     0.0
matmul:q_proj:L5                 0.12     0.0
matmul:q_proj:L25                0.12     0.0
matmul:k_proj:L4                 0.08     0.0
matmul:v_proj:L4                 0.08     0.0
sample_phase1                    0.06     0.0
matmul:k_proj:L10                0.06     0.0
matmul:k_proj:L23                0.06     0.0
matmul:k_proj:L19                0.06     0.0
matmul:v_proj:L2                 0.06     0.0
matmul:v_proj:L10                0.06     0.0
matmul:k_proj:L11                0.05     0.0
matmul:k_proj:L15                0.05     0.0
matmul:v_proj:L11                0.05     0.0
matmul:k_proj:L2                 0.05     0.0
matmul:v_proj:L20                0.05     0.0
sample_phase3                    0.05     0.0
matmul:k_proj:L17                0.05     0.0
matmul:v_proj:L5                 0.05     0.0
matmul:k_proj:L0                 0.05     0.0
matmul:v_proj:L0                 0.05     0.0
matmul:k_proj:L24                0.05     0.0
matmul:k_proj:L20                0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:v_proj:L24                0.04     0.0
matmul:k_proj:L1                 0.04     0.0
matmul:k_proj:L3                 0.04     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:k_proj:L18                0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:k_proj:L7                 0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:v_proj:L17                0.04     0.0
matmul:v_proj:L19                0.04     0.0
matmul:k_proj:L13                0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:k_proj:L16                0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:v_proj:L16                0.04     0.0
matmul:k_proj:L22                0.04     0.0
matmul:k_proj:L21                0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:k_proj:L12                0.04     0.0
matmul:k_proj:L14                0.04     0.0
matmul:v_proj:L22                0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:v_proj:L18                0.04     0.0
matmul:v_proj:L14                0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:k_proj:L5                 0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:v_proj:L25                0.04     0.0
gather                           0.01     0.0
scale                            0.01     0.0
──────────────────────────────────────────────────
TOTAL                          578.94   100.0

[browser:warning] [21890.4ms][Profile] Batch decode (N=4):
[browser:warning] [21890.7ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      254.17    41.2
fused_ffn                       48.91     7.9
matmul:lm_head                  35.91     5.8
matmul_rmsnorm_fused:L25.ffn_down       11.23     1.8
matmul_rmsnorm_fused:L19.ffn_down       11.09     1.8
matmul_rmsnorm_fused:L3.ffn_down       10.80     1.7
matmul_rmsnorm_fused:L5.ffn_down       10.62     1.7
matmul_rmsnorm_fused:L9.ffn_down       10.58     1.7
matmul_rmsnorm_fused:L15.ffn_down       10.44     1.7
matmul_rmsnorm_fused:L18.ffn_down       10.43     1.7
matmul_rmsnorm_fused:L24.ffn_down       10.28     1.7
matmul_rmsnorm_fused:L6.ffn_down       10.02     1.6
matmul_rmsnorm_fused:L21.ffn_down        9.94     1.6
matmul_rmsnorm_fused:L0.ffn_down        9.89     1.6
matmul_rmsnorm_fused:L11.ffn_down        9.48     1.5
matmul_rmsnorm_fused:L14.ffn_down        9.46     1.5
matmul_rmsnorm_fused:L8.ffn_down        9.18     1.5
matmul_rmsnorm_fused:L1.ffn_down        9.14     1.5
rmsnorm                          9.04     1.5
matmul_rmsnorm_fused:L10.ffn_down        8.87     1.4
matmul_rmsnorm_fused:L7.ffn_down        8.85     1.4
matmul_rmsnorm_fused:L12.ffn_down        8.82     1.4
matmul_rmsnorm_fused:L2.ffn_down        8.76     1.4
matmul_rmsnorm_fused:L22.ffn_down        8.73     1.4
matmul_rmsnorm_fused:L20.ffn_down        8.72     1.4
matmul_rmsnorm_fused:L17.ffn_down        8.71     1.4
matmul_rmsnorm_fused:L23.ffn_down        8.71     1.4
matmul_rmsnorm_fused:L16.ffn_down        8.68     1.4
matmul_rmsnorm_fused:L13.ffn_down        8.64     1.4
matmul_rmsnorm_fused:L4.ffn_down        8.62     1.4
sample_phase2                    3.26     0.5
matmul:q_proj:L4                 1.69     0.3
rope                             1.18     0.2
matmul:v_proj:L9                 1.09     0.2
matmul:o_proj:L21                0.92     0.1
matmul:o_proj:L24                0.86     0.1
matmul:o_proj:L14                0.83     0.1
matmul:q_proj:L6                 0.82     0.1
matmul:q_proj:L9                 0.46     0.1
matmul:v_proj:L6                 0.33     0.1
matmul:k_proj:L6                 0.29     0.0
matmul:o_proj:L19                0.25     0.0
matmul:o_proj:L1                 0.22     0.0
matmul:o_proj:L0                 0.17     0.0
matmul:o_proj:L3                 0.16     0.0
matmul:q_proj:L0                 0.16     0.0
matmul:o_proj:L25                0.16     0.0
matmul:q_proj:L12                0.16     0.0
matmul:o_proj:L9                 0.15     0.0
matmul:o_proj:L13                0.15     0.0
matmul:q_proj:L10                0.15     0.0
matmul:o_proj:L7                 0.15     0.0
matmul:o_proj:L12                0.15     0.0
matmul:q_proj:L13                0.14     0.0
matmul:q_proj:L2                 0.14     0.0
matmul:o_proj:L5                 0.14     0.0
matmul:o_proj:L2                 0.14     0.0
matmul:q_proj:L22                0.14     0.0
matmul:q_proj:L7                 0.14     0.0
matmul:o_proj:L10                0.14     0.0
matmul:o_proj:L16                0.14     0.0
matmul:q_proj:L21                0.14     0.0
matmul:o_proj:L17                0.14     0.0
matmul:o_proj:L8                 0.14     0.0
matmul:o_proj:L18                0.14     0.0
matmul:o_proj:L23                0.14     0.0
matmul:o_proj:L6                 0.13     0.0
matmul:o_proj:L4                 0.13     0.0
matmul:o_proj:L11                0.13     0.0
matmul:q_proj:L19                0.13     0.0
matmul:q_proj:L16                0.13     0.0
matmul:q_proj:L3                 0.13     0.0
matmul:q_proj:L24                0.13     0.0
matmul:o_proj:L22                0.13     0.0
matmul:o_proj:L15                0.13     0.0
matmul:q_proj:L1                 0.13     0.0
matmul:q_proj:L25                0.13     0.0
matmul:q_proj:L11                0.13     0.0
matmul:q_proj:L8                 0.13     0.0
matmul:q_proj:L20                0.13     0.0
matmul:q_proj:L18                0.13     0.0
matmul:q_proj:L15                0.13     0.0
matmul:q_proj:L5                 0.13     0.0
matmul:q_proj:L23                0.12     0.0
matmul:q_proj:L17                0.12     0.0
matmul:q_proj:L14                0.12     0.0
matmul:o_proj:L20                0.12     0.0
sample_phase1                    0.11     0.0
matmul:v_proj:L3                 0.10     0.0
matmul:k_proj:L11                0.07     0.0
matmul:k_proj:L9                 0.07     0.0
matmul:k_proj:L12                0.07     0.0
matmul:v_proj:L12                0.07     0.0
matmul:k_proj:L4                 0.06     0.0
matmul:k_proj:L13                0.06     0.0
matmul:k_proj:L10                0.05     0.0
matmul:v_proj:L7                 0.05     0.0
matmul:k_proj:L7                 0.05     0.0
matmul:v_proj:L4                 0.05     0.0
matmul:k_proj:L0                 0.05     0.0
matmul:k_proj:L22                0.05     0.0
matmul:v_proj:L10                0.05     0.0
matmul:v_proj:L22                0.05     0.0
matmul:v_proj:L0                 0.05     0.0
matmul:k_proj:L3                 0.05     0.0
sample_phase3                    0.05     0.0
matmul:k_proj:L2                 0.05     0.0
matmul:k_proj:L21                0.05     0.0
matmul:v_proj:L2                 0.05     0.0
matmul:v_proj:L21                0.05     0.0
matmul:k_proj:L19                0.05     0.0
matmul:k_proj:L16                0.05     0.0
matmul:k_proj:L23                0.05     0.0
matmul:v_proj:L16                0.05     0.0
matmul:k_proj:L20                0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:k_proj:L18                0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:k_proj:L17                0.04     0.0
matmul:v_proj:L24                0.04     0.0
matmul:k_proj:L1                 0.04     0.0
matmul:k_proj:L15                0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:v_proj:L19                0.04     0.0
matmul:v_proj:L17                0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:k_proj:L24                0.04     0.0
matmul:v_proj:L18                0.04     0.0
matmul:k_proj:L14                0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:k_proj:L5                 0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:v_proj:L14                0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:v_proj:L5                 0.04     0.0
gather                           0.01     0.0
scale                            0.01     0.0
──────────────────────────────────────────────────
TOTAL                          617.64   100.0

[browser:warning] [22661.5ms][Profile] Batch decode (N=4):
[browser:warning] [22661.9ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      261.56    38.0
fused_ffn                       66.56     9.7
matmul:lm_head                  46.40     6.7
matmul_rmsnorm_fused:L3.ffn_down       12.00     1.7
matmul_rmsnorm_fused:L9.ffn_down       11.77     1.7
matmul_rmsnorm_fused:L19.ffn_down       11.73     1.7
rmsnorm                         11.64     1.7
matmul_rmsnorm_fused:L0.ffn_down       11.10     1.6
matmul_rmsnorm_fused:L15.ffn_down       11.05     1.6
matmul_rmsnorm_fused:L21.ffn_down       10.94     1.6
matmul_rmsnorm_fused:L24.ffn_down       10.75     1.6
matmul_rmsnorm_fused:L25.ffn_down       10.49     1.5
matmul_rmsnorm_fused:L20.ffn_down       10.41     1.5
matmul_rmsnorm_fused:L8.ffn_down       10.40     1.5
matmul_rmsnorm_fused:L5.ffn_down       10.36     1.5
matmul_rmsnorm_fused:L10.ffn_down       10.35     1.5
matmul_rmsnorm_fused:L14.ffn_down       10.15     1.5
matmul_rmsnorm_fused:L13.ffn_down        9.93     1.4
matmul_rmsnorm_fused:L2.ffn_down        9.55     1.4
matmul_rmsnorm_fused:L4.ffn_down        9.28     1.3
matmul_rmsnorm_fused:L11.ffn_down        9.10     1.3
matmul_rmsnorm_fused:L12.ffn_down        9.00     1.3
matmul_rmsnorm_fused:L16.ffn_down        8.87     1.3
matmul_rmsnorm_fused:L7.ffn_down        8.86     1.3
matmul_rmsnorm_fused:L23.ffn_down        8.75     1.3
matmul_rmsnorm_fused:L22.ffn_down        8.74     1.3
matmul_rmsnorm_fused:L18.ffn_down        8.73     1.3
matmul_rmsnorm_fused:L1.ffn_down        8.70     1.3
matmul_rmsnorm_fused:L17.ffn_down        8.70     1.3
matmul_rmsnorm_fused:L6.ffn_down        8.65     1.3
sample_phase2                    3.71     0.5
matmul:o_proj:L9                 2.95     0.4
matmul:o_proj:L21                2.71     0.4
matmul:o_proj:L14                2.56     0.4
matmul:o_proj:L0                 1.83     0.3
matmul:o_proj:L16                1.70     0.2
matmul:o_proj:L2                 1.48     0.2
matmul:k_proj:L11                1.42     0.2
matmul:o_proj:L11                1.41     0.2
matmul:q_proj:L6                 1.38     0.2
matmul:o_proj:L6                 1.37     0.2
matmul:o_proj:L1                 1.24     0.2
matmul:o_proj:L19                1.24     0.2
matmul:o_proj:L4                 1.04     0.2
rope                             0.94     0.1
matmul:v_proj:L6                 0.85     0.1
matmul:q_proj:L8                 0.83     0.1
matmul:q_proj:L17                0.83     0.1
matmul:q_proj:L11                0.82     0.1
matmul:q_proj:L4                 0.71     0.1
matmul:q_proj:L13                0.68     0.1
matmul:o_proj:L23                0.64     0.1
matmul:q_proj:L25                0.59     0.1
matmul:k_proj:L6                 0.58     0.1
matmul:v_proj:L13                0.57     0.1
matmul:o_proj:L22                0.45     0.1
matmul:k_proj:L4                 0.35     0.1
matmul:k_proj:L25                0.34     0.0
matmul:k_proj:L13                0.33     0.0
matmul:v_proj:L8                 0.33     0.0
matmul:v_proj:L4                 0.31     0.0
matmul:k_proj:L8                 0.29     0.0
matmul:q_proj:L0                 0.28     0.0
matmul:q_proj:L22                0.23     0.0
matmul:o_proj:L24                0.18     0.0
matmul:q_proj:L9                 0.18     0.0
matmul:o_proj:L3                 0.18     0.0
matmul:q_proj:L16                0.17     0.0
matmul:o_proj:L10                0.17     0.0
matmul:o_proj:L25                0.16     0.0
matmul:o_proj:L5                 0.16     0.0
matmul:o_proj:L15                0.16     0.0
matmul:o_proj:L8                 0.16     0.0
matmul:q_proj:L19                0.15     0.0
matmul:q_proj:L14                0.15     0.0
matmul:o_proj:L13                0.15     0.0
matmul:o_proj:L12                0.15     0.0
matmul:o_proj:L18                0.14     0.0
matmul:q_proj:L3                 0.14     0.0
matmul:q_proj:L15                0.14     0.0
matmul:q_proj:L24                0.14     0.0
matmul:q_proj:L23                0.13     0.0
matmul:o_proj:L7                 0.13     0.0
matmul:o_proj:L20                0.13     0.0
matmul:q_proj:L2                 0.13     0.0
matmul:q_proj:L21                0.13     0.0
matmul:q_proj:L20                0.13     0.0
matmul:q_proj:L1                 0.13     0.0
matmul:q_proj:L10                0.13     0.0
matmul:q_proj:L18                0.13     0.0
matmul:o_proj:L17                0.12     0.0
matmul:q_proj:L5                 0.12     0.0
matmul:q_proj:L7                 0.12     0.0
matmul:q_proj:L12                0.12     0.0
sample_phase1                    0.10     0.0
matmul:v_proj:L0                 0.09     0.0
matmul:k_proj:L0                 0.09     0.0
matmul:v_proj:L16                0.07     0.0
matmul:k_proj:L9                 0.07     0.0
matmul:v_proj:L11                0.07     0.0
sample_phase3                    0.07     0.0
matmul:k_proj:L14                0.06     0.0
matmul:k_proj:L19                0.06     0.0
matmul:v_proj:L9                 0.06     0.0
matmul:v_proj:L22                0.06     0.0
matmul:k_proj:L16                0.06     0.0
matmul:k_proj:L22                0.06     0.0
matmul:v_proj:L25                0.06     0.0
matmul:v_proj:L14                0.05     0.0
matmul:v_proj:L19                0.05     0.0
gather                           0.05     0.0
matmul:k_proj:L15                0.05     0.0
matmul:k_proj:L3                 0.05     0.0
matmul:v_proj:L15                0.05     0.0
matmul:k_proj:L24                0.05     0.0
matmul:k_proj:L1                 0.05     0.0
matmul:k_proj:L21                0.05     0.0
matmul:k_proj:L10                0.05     0.0
matmul:k_proj:L12                0.05     0.0
matmul:v_proj:L24                0.05     0.0
matmul:v_proj:L12                0.05     0.0
matmul:k_proj:L23                0.05     0.0
matmul:v_proj:L3                 0.05     0.0
matmul:k_proj:L2                 0.05     0.0
matmul:k_proj:L18                0.05     0.0
matmul:v_proj:L1                 0.05     0.0
matmul:k_proj:L7                 0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:k_proj:L17                0.04     0.0
matmul:k_proj:L20                0.04     0.0
matmul:v_proj:L18                0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:v_proj:L5                 0.04     0.0
matmul:k_proj:L5                 0.04     0.0
matmul:v_proj:L17                0.04     0.0
scale                            0.04     0.0
──────────────────────────────────────────────────
TOTAL                          688.27   100.0

[browser:warning] [23375.8ms][Profile] Batch decode (N=4):
[browser:warning] [23376.1ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      268.14    42.1
fused_ffn                       45.76     7.2
matmul:lm_head                  35.75     5.6
matmul_rmsnorm_fused:L10.ffn_down       11.14     1.7
matmul_rmsnorm_fused:L8.ffn_down       11.08     1.7
matmul_rmsnorm_fused:L25.ffn_down       11.02     1.7
matmul_rmsnorm_fused:L13.ffn_down       10.88     1.7
rmsnorm                         10.88     1.7
matmul_rmsnorm_fused:L15.ffn_down       10.43     1.6
matmul_rmsnorm_fused:L21.ffn_down       10.33     1.6
matmul_rmsnorm_fused:L3.ffn_down       10.19     1.6
matmul_rmsnorm_fused:L0.ffn_down       10.17     1.6
matmul_rmsnorm_fused:L22.ffn_down       10.15     1.6
matmul_rmsnorm_fused:L16.ffn_down       10.13     1.6
matmul_rmsnorm_fused:L19.ffn_down       10.11     1.6
matmul_rmsnorm_fused:L4.ffn_down       10.10     1.6
matmul_rmsnorm_fused:L12.ffn_down        9.25     1.5
matmul_rmsnorm_fused:L23.ffn_down        9.25     1.5
matmul_rmsnorm_fused:L1.ffn_down        9.15     1.4
matmul_rmsnorm_fused:L6.ffn_down        8.96     1.4
matmul_rmsnorm_fused:L9.ffn_down        8.93     1.4
matmul_rmsnorm_fused:L24.ffn_down        8.74     1.4
matmul_rmsnorm_fused:L18.ffn_down        8.73     1.4
matmul_rmsnorm_fused:L14.ffn_down        8.71     1.4
matmul_rmsnorm_fused:L17.ffn_down        8.71     1.4
matmul_rmsnorm_fused:L2.ffn_down        8.71     1.4
matmul_rmsnorm_fused:L20.ffn_down        8.70     1.4
matmul_rmsnorm_fused:L7.ffn_down        8.69     1.4
matmul_rmsnorm_fused:L11.ffn_down        8.66     1.4
matmul_rmsnorm_fused:L5.ffn_down        8.64     1.4
sample_phase2                    3.27     0.5
rope                             1.72     0.3
matmul:q_proj:L9                 1.60     0.3
matmul:o_proj:L16                1.53     0.2
matmul:q_proj:L24                1.48     0.2
matmul:q_proj:L2                 1.11     0.2
matmul:k_proj:L1                 0.94     0.1
matmul:q_proj:L22                0.93     0.1
matmul:q_proj:L0                 0.92     0.1
matmul:q_proj:L1                 0.74     0.1
matmul:q_proj:L11                0.65     0.1
matmul:o_proj:L4                 0.62     0.1
matmul:q_proj:L14                0.61     0.1
matmul:o_proj:L7                 0.55     0.1
matmul:o_proj:L18                0.49     0.1
matmul:v_proj:L5                 0.44     0.1
matmul:k_proj:L24                0.32     0.1
matmul:o_proj:L6                 0.26     0.0
matmul:q_proj:L5                 0.26     0.0
matmul:o_proj:L19                0.22     0.0
matmul:o_proj:L25                0.19     0.0
matmul:o_proj:L21                0.17     0.0
matmul:o_proj:L10                0.17     0.0
matmul:o_proj:L22                0.17     0.0
matmul:k_proj:L5                 0.16     0.0
matmul:o_proj:L3                 0.16     0.0
matmul:v_proj:L11                0.16     0.0
matmul:o_proj:L8                 0.16     0.0
matmul:o_proj:L11                0.15     0.0
matmul:q_proj:L7                 0.15     0.0
matmul:o_proj:L13                0.15     0.0
matmul:v_proj:L22                0.15     0.0
matmul:q_proj:L10                0.15     0.0
matmul:q_proj:L13                0.15     0.0
matmul:o_proj:L9                 0.15     0.0
matmul:o_proj:L15                0.15     0.0
matmul:o_proj:L20                0.15     0.0
matmul:o_proj:L17                0.15     0.0
matmul:o_proj:L0                 0.14     0.0
matmul:o_proj:L2                 0.14     0.0
matmul:o_proj:L12                0.14     0.0
matmul:o_proj:L24                0.14     0.0
matmul:o_proj:L14                0.14     0.0
matmul:q_proj:L16                0.14     0.0
matmul:k_proj:L22                0.14     0.0
matmul:q_proj:L20                0.14     0.0
matmul:q_proj:L18                0.14     0.0
matmul:o_proj:L5                 0.14     0.0
matmul:o_proj:L23                0.14     0.0
matmul:q_proj:L19                0.13     0.0
matmul:q_proj:L8                 0.13     0.0
matmul:o_proj:L1                 0.13     0.0
matmul:q_proj:L25                0.13     0.0
matmul:q_proj:L4                 0.13     0.0
matmul:q_proj:L21                0.13     0.0
matmul:q_proj:L17                0.13     0.0
matmul:q_proj:L3                 0.13     0.0
matmul:q_proj:L12                0.13     0.0
matmul:q_proj:L15                0.13     0.0
matmul:q_proj:L23                0.13     0.0
matmul:q_proj:L6                 0.13     0.0
matmul:v_proj:L0                 0.12     0.0
matmul:k_proj:L0                 0.11     0.0
matmul:k_proj:L11                0.10     0.0
matmul:v_proj:L2                 0.09     0.0
sample_phase1                    0.08     0.0
matmul:v_proj:L1                 0.08     0.0
scale                            0.07     0.0
gather                           0.06     0.0
matmul:k_proj:L2                 0.06     0.0
matmul:v_proj:L18                0.06     0.0
matmul:k_proj:L7                 0.06     0.0
matmul:k_proj:L10                0.06     0.0
matmul:k_proj:L9                 0.06     0.0
matmul:v_proj:L24                0.06     0.0
matmul:v_proj:L7                 0.06     0.0
sample_phase3                    0.06     0.0
matmul:v_proj:L14                0.05     0.0
matmul:k_proj:L18                0.05     0.0
matmul:v_proj:L10                0.05     0.0
matmul:v_proj:L9                 0.05     0.0
matmul:k_proj:L14                0.05     0.0
matmul:k_proj:L13                0.05     0.0
matmul:k_proj:L12                0.05     0.0
matmul:v_proj:L13                0.05     0.0
matmul:k_proj:L16                0.05     0.0
matmul:k_proj:L17                0.05     0.0
matmul:v_proj:L8                 0.05     0.0
matmul:v_proj:L25                0.05     0.0
matmul:k_proj:L4                 0.05     0.0
matmul:k_proj:L21                0.05     0.0
matmul:v_proj:L16                0.05     0.0
matmul:k_proj:L3                 0.05     0.0
matmul:k_proj:L19                0.05     0.0
matmul:k_proj:L25                0.05     0.0
matmul:k_proj:L8                 0.05     0.0
matmul:k_proj:L20                0.05     0.0
matmul:v_proj:L20                0.05     0.0
matmul:v_proj:L17                0.05     0.0
matmul:v_proj:L4                 0.05     0.0
matmul:v_proj:L12                0.05     0.0
matmul:k_proj:L15                0.05     0.0
matmul:v_proj:L21                0.04     0.0
matmul:v_proj:L19                0.04     0.0
matmul:k_proj:L23                0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:v_proj:L6                 0.04     0.0
──────────────────────────────────────────────────
TOTAL                          637.44   100.0

[browser:warning] [24064.0ms][Profile] Batch decode (N=4):
[browser:warning] [24064.3ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      274.08    44.3
fused_ffn                       47.99     7.7
matmul:lm_head                  30.47     4.9
matmul_rmsnorm_fused:L1.ffn_down       11.91     1.9
matmul_rmsnorm_fused:L7.ffn_down       11.87     1.9
matmul_rmsnorm_fused:L13.ffn_down       10.76     1.7
matmul_rmsnorm_fused:L19.ffn_down       10.35     1.7
matmul_rmsnorm_fused:L25.ffn_down       10.23     1.7
matmul_rmsnorm_fused:L23.ffn_down       10.06     1.6
matmul_rmsnorm_fused:L18.ffn_down       10.03     1.6
matmul_rmsnorm_fused:L22.ffn_down        9.95     1.6
matmul_rmsnorm_fused:L16.ffn_down        9.52     1.5
matmul_rmsnorm_fused:L11.ffn_down        9.52     1.5
matmul_rmsnorm_fused:L17.ffn_down        9.48     1.5
matmul_rmsnorm_fused:L3.ffn_down        9.06     1.5
matmul_rmsnorm_fused:L5.ffn_down        9.00     1.5
matmul_rmsnorm_fused:L10.ffn_down        8.74     1.4
matmul_rmsnorm_fused:L14.ffn_down        8.73     1.4
matmul_rmsnorm_fused:L9.ffn_down        8.71     1.4
matmul_rmsnorm_fused:L6.ffn_down        8.70     1.4
matmul_rmsnorm_fused:L15.ffn_down        8.69     1.4
matmul_rmsnorm_fused:L2.ffn_down        8.67     1.4
matmul_rmsnorm_fused:L4.ffn_down        8.66     1.4
matmul_rmsnorm_fused:L0.ffn_down        8.66     1.4
matmul_rmsnorm_fused:L21.ffn_down        8.65     1.4
matmul_rmsnorm_fused:L12.ffn_down        8.65     1.4
matmul_rmsnorm_fused:L24.ffn_down        8.64     1.4
matmul_rmsnorm_fused:L20.ffn_down        8.62     1.4
matmul_rmsnorm_fused:L8.ffn_down        8.59     1.4
rmsnorm                          4.68     0.8
sample_phase2                    3.24     0.5
matmul:o_proj:L25                1.25     0.2
matmul:o_proj:L20                1.19     0.2
matmul:o_proj:L14                0.86     0.1
matmul:o_proj:L18                0.79     0.1
rope                             0.74     0.1
matmul:o_proj:L23                0.56     0.1
matmul:q_proj:L0                 0.20     0.0
matmul:o_proj:L13                0.19     0.0
matmul:o_proj:L16                0.18     0.0
matmul:o_proj:L11                0.18     0.0
matmul:o_proj:L17                0.17     0.0
matmul:o_proj:L4                 0.15     0.0
matmul:q_proj:L2                 0.15     0.0
matmul:q_proj:L4                 0.15     0.0
matmul:q_proj:L23                0.15     0.0
matmul:o_proj:L22                0.14     0.0
matmul:o_proj:L21                0.14     0.0
matmul:o_proj:L10                0.14     0.0
matmul:q_proj:L8                 0.14     0.0
matmul:o_proj:L0                 0.14     0.0
matmul:o_proj:L12                0.14     0.0
matmul:o_proj:L5                 0.14     0.0
matmul:q_proj:L15                0.14     0.0
matmul:o_proj:L15                0.13     0.0
matmul:o_proj:L6                 0.13     0.0
matmul:o_proj:L2                 0.13     0.0
matmul:o_proj:L3                 0.13     0.0
matmul:q_proj:L10                0.13     0.0
matmul:o_proj:L24                0.13     0.0
matmul:q_proj:L17                0.13     0.0
matmul:o_proj:L1                 0.13     0.0
matmul:q_proj:L1                 0.13     0.0
matmul:q_proj:L11                0.13     0.0
matmul:o_proj:L7                 0.13     0.0
matmul:o_proj:L8                 0.13     0.0
matmul:q_proj:L12                0.13     0.0
matmul:o_proj:L9                 0.13     0.0
matmul:q_proj:L13                0.13     0.0
matmul:q_proj:L20                0.13     0.0
matmul:q_proj:L14                0.13     0.0
matmul:q_proj:L5                 0.13     0.0
matmul:q_proj:L18                0.13     0.0
matmul:q_proj:L7                 0.13     0.0
matmul:o_proj:L19                0.13     0.0
matmul:q_proj:L22                0.13     0.0
matmul:q_proj:L16                0.13     0.0
matmul:q_proj:L25                0.12     0.0
matmul:q_proj:L19                0.12     0.0
matmul:q_proj:L9                 0.12     0.0
matmul:q_proj:L6                 0.12     0.0
matmul:q_proj:L3                 0.12     0.0
matmul:q_proj:L21                0.12     0.0
matmul:q_proj:L24                0.12     0.0
matmul:k_proj:L23                0.07     0.0
matmul:v_proj:L23                0.07     0.0
sample_phase1                    0.06     0.0
matmul:k_proj:L2                 0.06     0.0
matmul:k_proj:L4                 0.06     0.0
matmul:v_proj:L2                 0.06     0.0
matmul:v_proj:L4                 0.06     0.0
matmul:k_proj:L8                 0.05     0.0
matmul:k_proj:L0                 0.05     0.0
matmul:v_proj:L8                 0.05     0.0
matmul:k_proj:L5                 0.05     0.0
sample_phase3                    0.05     0.0
matmul:v_proj:L0                 0.05     0.0
matmul:k_proj:L10                0.05     0.0
matmul:v_proj:L5                 0.05     0.0
matmul:k_proj:L17                0.05     0.0
matmul:v_proj:L6                 0.05     0.0
matmul:k_proj:L15                0.05     0.0
matmul:k_proj:L7                 0.05     0.0
matmul:k_proj:L11                0.05     0.0
matmul:v_proj:L12                0.05     0.0
matmul:k_proj:L1                 0.05     0.0
matmul:k_proj:L12                0.05     0.0
matmul:v_proj:L1                 0.05     0.0
matmul:v_proj:L15                0.05     0.0
matmul:k_proj:L3                 0.05     0.0
matmul:k_proj:L25                0.05     0.0
matmul:v_proj:L10                0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:k_proj:L21                0.04     0.0
matmul:k_proj:L13                0.04     0.0
matmul:v_proj:L17                0.04     0.0
matmul:k_proj:L18                0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:v_proj:L18                0.04     0.0
matmul:k_proj:L22                0.04     0.0
matmul:k_proj:L19                0.04     0.0
matmul:k_proj:L16                0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:k_proj:L20                0.04     0.0
matmul:v_proj:L22                0.04     0.0
matmul:v_proj:L16                0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:k_proj:L14                0.04     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:k_proj:L24                0.04     0.0
matmul:v_proj:L14                0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:v_proj:L19                0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:v_proj:L24                0.04     0.0
gather                           0.02     0.0
scale                            0.01     0.0
──────────────────────────────────────────────────
TOTAL                          619.34   100.0

[browser:warning] [24830.0ms][Profile] Batch decode (N=4):
[browser:warning] [24830.2ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      284.30    41.5
fused_ffn                       64.55     9.4
matmul:lm_head                  35.90     5.2
matmul_rmsnorm_fused:L4.ffn_down       12.19     1.8
matmul_rmsnorm_fused:L21.ffn_down       12.11     1.8
matmul_rmsnorm_fused:L9.ffn_down       11.96     1.7
matmul_rmsnorm_fused:L16.ffn_down       11.31     1.7
matmul_rmsnorm_fused:L19.ffn_down       11.01     1.6
matmul_rmsnorm_fused:L6.ffn_down       10.68     1.6
rmsnorm                         10.17     1.5
matmul_rmsnorm_fused:L15.ffn_down        9.87     1.4
matmul_rmsnorm_fused:L23.ffn_down        9.80     1.4
matmul_rmsnorm_fused:L14.ffn_down        9.75     1.4
matmul_rmsnorm_fused:L11.ffn_down        9.29     1.4
matmul_rmsnorm_fused:L13.ffn_down        9.17     1.3
matmul_rmsnorm_fused:L20.ffn_down        9.14     1.3
matmul_rmsnorm_fused:L12.ffn_down        9.07     1.3
matmul_rmsnorm_fused:L0.ffn_down        9.05     1.3
matmul_rmsnorm_fused:L24.ffn_down        9.00     1.3
matmul_rmsnorm_fused:L8.ffn_down        8.89     1.3
matmul_rmsnorm_fused:L18.ffn_down        8.88     1.3
matmul_rmsnorm_fused:L22.ffn_down        8.84     1.3
matmul_rmsnorm_fused:L5.ffn_down        8.80     1.3
matmul_rmsnorm_fused:L2.ffn_down        8.77     1.3
matmul_rmsnorm_fused:L25.ffn_down        8.75     1.3
matmul_rmsnorm_fused:L10.ffn_down        8.71     1.3
matmul_rmsnorm_fused:L17.ffn_down        8.71     1.3
matmul_rmsnorm_fused:L3.ffn_down        8.69     1.3
matmul_rmsnorm_fused:L1.ffn_down        8.69     1.3
matmul_rmsnorm_fused:L7.ffn_down        8.64     1.3
matmul:o_proj:L23                4.81     0.7
matmul:o_proj:L6                 3.37     0.5
sample_phase2                    3.28     0.5
matmul:o_proj:L24                3.20     0.5
matmul:o_proj:L11                3.06     0.4
matmul:q_proj:L20                1.63     0.2
matmul:o_proj:L8                 1.58     0.2
matmul:o_proj:L21                1.50     0.2
matmul:o_proj:L16                1.50     0.2
matmul:o_proj:L13                1.42     0.2
matmul:q_proj:L21                1.22     0.2
matmul:o_proj:L19                1.17     0.2
matmul:o_proj:L3                 1.13     0.2
matmul:o_proj:L25                0.99     0.1
rope                             0.87     0.1
matmul:q_proj:L15                0.49     0.1
matmul:o_proj:L4                 0.44     0.1
matmul:q_proj:L0                 0.23     0.0
matmul:o_proj:L18                0.20     0.0
matmul:o_proj:L1                 0.20     0.0
matmul:q_proj:L10                0.19     0.0
matmul:o_proj:L9                 0.18     0.0
matmul:q_proj:L17                0.17     0.0
matmul:o_proj:L22                0.17     0.0
matmul:v_proj:L10                0.16     0.0
matmul:q_proj:L22                0.16     0.0
matmul:q_proj:L16                0.16     0.0
matmul:q_proj:L14                0.16     0.0
matmul:o_proj:L0                 0.16     0.0
matmul:o_proj:L10                0.15     0.0
matmul:v_proj:L15                0.15     0.0
matmul:q_proj:L1                 0.15     0.0
matmul:o_proj:L15                0.15     0.0
matmul:q_proj:L9                 0.15     0.0
matmul:o_proj:L20                0.15     0.0
matmul:q_proj:L5                 0.14     0.0
matmul:o_proj:L14                0.14     0.0
matmul:o_proj:L12                0.14     0.0
matmul:o_proj:L7                 0.14     0.0
matmul:q_proj:L7                 0.14     0.0
matmul:o_proj:L5                 0.14     0.0
matmul:o_proj:L17                0.14     0.0
matmul:q_proj:L6                 0.14     0.0
matmul:q_proj:L25                0.13     0.0
matmul:q_proj:L18                0.13     0.0
matmul:q_proj:L8                 0.13     0.0
matmul:q_proj:L11                0.13     0.0
matmul:q_proj:L19                0.13     0.0
matmul:q_proj:L24                0.13     0.0
matmul:o_proj:L2                 0.13     0.0
matmul:q_proj:L12                0.13     0.0
matmul:q_proj:L4                 0.13     0.0
matmul:q_proj:L23                0.13     0.0
matmul:q_proj:L13                0.13     0.0
matmul:q_proj:L3                 0.12     0.0
matmul:q_proj:L2                 0.12     0.0
gather                           0.10     0.0
matmul:k_proj:L10                0.10     0.0
matmul:k_proj:L0                 0.09     0.0
matmul:k_proj:L15                0.09     0.0
matmul:v_proj:L0                 0.09     0.0
sample_phase1                    0.08     0.0
matmul:v_proj:L1                 0.07     0.0
matmul:k_proj:L1                 0.06     0.0
sample_phase3                    0.06     0.0
matmul:v_proj:L20                0.06     0.0
matmul:v_proj:L16                0.06     0.0
matmul:k_proj:L16                0.06     0.0
matmul:k_proj:L9                 0.06     0.0
matmul:k_proj:L14                0.06     0.0
matmul:v_proj:L14                0.06     0.0
matmul:k_proj:L5                 0.06     0.0
matmul:v_proj:L17                0.06     0.0
matmul:v_proj:L22                0.06     0.0
matmul:v_proj:L9                 0.06     0.0
matmul:v_proj:L5                 0.06     0.0
matmul:k_proj:L17                0.06     0.0
matmul:k_proj:L22                0.06     0.0
matmul:k_proj:L20                0.05     0.0
matmul:k_proj:L19                0.05     0.0
matmul:v_proj:L19                0.05     0.0
matmul:k_proj:L7                 0.05     0.0
matmul:k_proj:L18                0.05     0.0
matmul:k_proj:L6                 0.05     0.0
matmul:k_proj:L21                0.05     0.0
matmul:k_proj:L25                0.05     0.0
matmul:v_proj:L7                 0.05     0.0
matmul:k_proj:L8                 0.05     0.0
matmul:k_proj:L11                0.05     0.0
matmul:v_proj:L4                 0.05     0.0
matmul:v_proj:L21                0.05     0.0
matmul:v_proj:L6                 0.05     0.0
matmul:k_proj:L12                0.05     0.0
matmul:k_proj:L4                 0.05     0.0
matmul:k_proj:L13                0.05     0.0
matmul:v_proj:L12                0.05     0.0
matmul:v_proj:L25                0.05     0.0
matmul:k_proj:L23                0.05     0.0
matmul:v_proj:L18                0.05     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:v_proj:L24                0.04     0.0
matmul:k_proj:L3                 0.04     0.0
matmul:k_proj:L24                0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:k_proj:L2                 0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:v_proj:L2                 0.04     0.0
scale                            0.03     0.0
──────────────────────────────────────────────────
TOTAL                          685.09   100.0

[browser:warning] [25581.0ms][Profile] Batch decode (N=4):
[browser:warning] [25581.3ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      290.21    42.8
fused_ffn                       58.23     8.6
matmul:lm_head                  30.69     4.5
rmsnorm                         11.18     1.7
matmul_rmsnorm_fused:L0.ffn_down       10.95     1.6
matmul_rmsnorm_fused:L17.ffn_down       10.79     1.6
matmul_rmsnorm_fused:L1.ffn_down       10.67     1.6
matmul_rmsnorm_fused:L4.ffn_down       10.54     1.6
matmul_rmsnorm_fused:L11.ffn_down       10.37     1.5
matmul_rmsnorm_fused:L12.ffn_down       10.29     1.5
matmul_rmsnorm_fused:L7.ffn_down       10.23     1.5
matmul_rmsnorm_fused:L22.ffn_down       10.19     1.5
matmul_rmsnorm_fused:L20.ffn_down       10.12     1.5
matmul_rmsnorm_fused:L13.ffn_down        9.68     1.4
matmul_rmsnorm_fused:L2.ffn_down        9.53     1.4
matmul_rmsnorm_fused:L5.ffn_down        9.38     1.4
matmul_rmsnorm_fused:L24.ffn_down        9.07     1.3
matmul_rmsnorm_fused:L15.ffn_down        9.07     1.3
matmul_rmsnorm_fused:L14.ffn_down        9.04     1.3
matmul_rmsnorm_fused:L23.ffn_down        9.04     1.3
matmul_rmsnorm_fused:L19.ffn_down        9.00     1.3
matmul_rmsnorm_fused:L9.ffn_down        8.89     1.3
matmul_rmsnorm_fused:L25.ffn_down        8.78     1.3
matmul_rmsnorm_fused:L18.ffn_down        8.77     1.3
matmul_rmsnorm_fused:L10.ffn_down        8.74     1.3
matmul_rmsnorm_fused:L16.ffn_down        8.74     1.3
matmul_rmsnorm_fused:L6.ffn_down        8.69     1.3
matmul_rmsnorm_fused:L21.ffn_down        8.69     1.3
matmul_rmsnorm_fused:L3.ffn_down        8.68     1.3
matmul_rmsnorm_fused:L8.ffn_down        8.67     1.3
matmul:o_proj:L10                4.44     0.7
matmul:o_proj:L25                3.88     0.6
sample_phase2                    3.31     0.5
matmul:o_proj:L15                3.19     0.5
matmul:o_proj:L0                 2.22     0.3
matmul:o_proj:L20                1.83     0.3
matmul:q_proj:L1                 1.77     0.3
rope                             1.33     0.2
matmul:o_proj:L18                1.09     0.2
matmul:q_proj:L0                 1.04     0.2
matmul:o_proj:L13                1.01     0.1
matmul:k_proj:L1                 0.86     0.1
matmul:o_proj:L22                0.86     0.1
matmul:o_proj:L2                 0.81     0.1
matmul:o_proj:L12                0.78     0.1
matmul:o_proj:L17                0.68     0.1
matmul:o_proj:L23                0.67     0.1
matmul:o_proj:L8                 0.60     0.1
matmul:q_proj:L3                 0.52     0.1
matmul:o_proj:L5                 0.44     0.1
matmul:o_proj:L4                 0.43     0.1
matmul:k_proj:L3                 0.33     0.0
gather                           0.31     0.0
sample_phase3                    0.30     0.0
matmul:v_proj:L3                 0.29     0.0
matmul:o_proj:L7                 0.20     0.0
matmul:q_proj:L8                 0.18     0.0
matmul:o_proj:L1                 0.17     0.0
matmul:q_proj:L10                0.17     0.0
matmul:q_proj:L5                 0.16     0.0
matmul:o_proj:L19                0.16     0.0
matmul:o_proj:L16                0.15     0.0
matmul:q_proj:L2                 0.15     0.0
matmul:o_proj:L9                 0.15     0.0
matmul:q_proj:L25                0.15     0.0
matmul:q_proj:L15                0.15     0.0
matmul:o_proj:L11                0.14     0.0
matmul:o_proj:L6                 0.14     0.0
matmul:q_proj:L9                 0.14     0.0
matmul:q_proj:L13                0.14     0.0
matmul:o_proj:L14                0.14     0.0
matmul:q_proj:L16                0.14     0.0
matmul:o_proj:L3                 0.14     0.0
matmul:q_proj:L12                0.14     0.0
matmul:o_proj:L21                0.14     0.0
matmul:q_proj:L22                0.13     0.0
matmul:q_proj:L11                0.13     0.0
matmul:q_proj:L17                0.13     0.0
matmul:q_proj:L21                0.13     0.0
matmul:o_proj:L24                0.13     0.0
matmul:q_proj:L19                0.13     0.0
matmul:q_proj:L20                0.13     0.0
matmul:q_proj:L18                0.13     0.0
matmul:q_proj:L23                0.13     0.0
matmul:q_proj:L7                 0.13     0.0
matmul:q_proj:L24                0.13     0.0
matmul:q_proj:L14                0.13     0.0
matmul:q_proj:L4                 0.13     0.0
matmul:q_proj:L6                 0.12     0.0
sample_phase1                    0.10     0.0
matmul:k_proj:L0                 0.08     0.0
matmul:v_proj:L0                 0.08     0.0
matmul:k_proj:L10                0.07     0.0
matmul:k_proj:L5                 0.07     0.0
matmul:v_proj:L10                0.06     0.0
matmul:v_proj:L2                 0.06     0.0
matmul:v_proj:L8                 0.06     0.0
matmul:k_proj:L15                0.06     0.0
matmul:v_proj:L1                 0.06     0.0
matmul:v_proj:L15                0.06     0.0
matmul:k_proj:L2                 0.06     0.0
matmul:k_proj:L25                0.06     0.0
matmul:k_proj:L8                 0.05     0.0
matmul:v_proj:L5                 0.05     0.0
matmul:v_proj:L25                0.05     0.0
matmul:v_proj:L4                 0.05     0.0
matmul:k_proj:L16                0.05     0.0
matmul:k_proj:L9                 0.05     0.0
matmul:k_proj:L21                0.05     0.0
matmul:v_proj:L16                0.05     0.0
matmul:k_proj:L17                0.05     0.0
matmul:k_proj:L13                0.05     0.0
matmul:k_proj:L22                0.05     0.0
matmul:k_proj:L7                 0.05     0.0
matmul:k_proj:L11                0.05     0.0
matmul:v_proj:L13                0.05     0.0
matmul:v_proj:L21                0.05     0.0
matmul:k_proj:L12                0.05     0.0
matmul:v_proj:L12                0.05     0.0
matmul:v_proj:L9                 0.05     0.0
matmul:k_proj:L18                0.05     0.0
matmul:v_proj:L22                0.05     0.0
matmul:k_proj:L23                0.05     0.0
matmul:k_proj:L4                 0.05     0.0
matmul:k_proj:L20                0.05     0.0
matmul:v_proj:L7                 0.05     0.0
matmul:k_proj:L19                0.05     0.0
matmul:v_proj:L23                0.05     0.0
matmul:v_proj:L18                0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:v_proj:L17                0.04     0.0
matmul:v_proj:L19                0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:k_proj:L14                0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:v_proj:L24                0.04     0.0
matmul:v_proj:L14                0.04     0.0
matmul:k_proj:L24                0.04     0.0
matmul:v_proj:L6                 0.04     0.0
scale                            0.02     0.0
──────────────────────────────────────────────────
TOTAL                          677.34   100.0

[browser:warning] [26276.9ms][Profile] Batch decode (N=4):
[browser:warning] [26277.1ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      294.98    47.2
fused_ffn                       39.64     6.3
matmul:lm_head                  30.56     4.9
matmul_rmsnorm_fused:L18.ffn_down       10.78     1.7
matmul_rmsnorm_fused:L5.ffn_down       10.33     1.7
matmul_rmsnorm_fused:L15.ffn_down       10.24     1.6
matmul_rmsnorm_fused:L19.ffn_down       10.16     1.6
matmul_rmsnorm_fused:L25.ffn_down       10.12     1.6
matmul_rmsnorm_fused:L23.ffn_down        9.97     1.6
matmul_rmsnorm_fused:L12.ffn_down        9.89     1.6
matmul_rmsnorm_fused:L24.ffn_down        9.78     1.6
matmul_rmsnorm_fused:L9.ffn_down        9.57     1.5
matmul_rmsnorm_fused:L13.ffn_down        9.41     1.5
matmul_rmsnorm_fused:L21.ffn_down        9.36     1.5
matmul_rmsnorm_fused:L11.ffn_down        9.29     1.5
matmul_rmsnorm_fused:L17.ffn_down        9.26     1.5
matmul_rmsnorm_fused:L2.ffn_down        9.21     1.5
matmul_rmsnorm_fused:L3.ffn_down        9.15     1.5
matmul_rmsnorm_fused:L8.ffn_down        9.13     1.5
matmul_rmsnorm_fused:L1.ffn_down        8.86     1.4
matmul_rmsnorm_fused:L6.ffn_down        8.82     1.4
matmul_rmsnorm_fused:L22.ffn_down        8.81     1.4
matmul_rmsnorm_fused:L16.ffn_down        8.69     1.4
matmul_rmsnorm_fused:L14.ffn_down        8.69     1.4
matmul_rmsnorm_fused:L10.ffn_down        8.68     1.4
matmul_rmsnorm_fused:L20.ffn_down        8.68     1.4
matmul_rmsnorm_fused:L0.ffn_down        8.65     1.4
matmul_rmsnorm_fused:L4.ffn_down        8.64     1.4
matmul_rmsnorm_fused:L7.ffn_down        8.62     1.4
sample_phase2                    3.27     0.5
rmsnorm                          3.26     0.5
rope                             0.82     0.1
matmul:q_proj:L0                 0.20     0.0
matmul:o_proj:L24                0.19     0.0
matmul:o_proj:L21                0.18     0.0
matmul:q_proj:L4                 0.17     0.0
matmul:o_proj:L2                 0.17     0.0
matmul:q_proj:L14                0.16     0.0
matmul:o_proj:L17                0.16     0.0
matmul:q_proj:L10                0.16     0.0
matmul:o_proj:L11                0.16     0.0
matmul:o_proj:L8                 0.16     0.0
matmul:q_proj:L23                0.16     0.0
matmul:o_proj:L20                0.15     0.0
matmul:o_proj:L10                0.15     0.0
matmul:q_proj:L7                 0.15     0.0
matmul:o_proj:L14                0.15     0.0
matmul:q_proj:L21                0.15     0.0
matmul:o_proj:L23                0.15     0.0
matmul:o_proj:L15                0.15     0.0
matmul:o_proj:L5                 0.15     0.0
matmul:o_proj:L0                 0.14     0.0
matmul:q_proj:L16                0.14     0.0
matmul:o_proj:L25                0.14     0.0
matmul:q_proj:L19                0.14     0.0
matmul:o_proj:L19                0.14     0.0
matmul:q_proj:L13                0.14     0.0
matmul:o_proj:L22                0.14     0.0
matmul:o_proj:L1                 0.14     0.0
matmul:o_proj:L18                0.14     0.0
matmul:o_proj:L13                0.14     0.0
matmul:o_proj:L16                0.14     0.0
matmul:q_proj:L20                0.14     0.0
matmul:o_proj:L4                 0.14     0.0
matmul:o_proj:L6                 0.14     0.0
matmul:o_proj:L3                 0.14     0.0
matmul:o_proj:L7                 0.13     0.0
matmul:o_proj:L9                 0.13     0.0
matmul:q_proj:L22                0.13     0.0
matmul:o_proj:L12                0.13     0.0
matmul:q_proj:L6                 0.13     0.0
matmul:q_proj:L1                 0.13     0.0
matmul:q_proj:L24                0.13     0.0
matmul:q_proj:L12                0.13     0.0
matmul:q_proj:L3                 0.13     0.0
matmul:q_proj:L5                 0.12     0.0
matmul:q_proj:L2                 0.12     0.0
matmul:q_proj:L15                0.12     0.0
matmul:q_proj:L25                0.12     0.0
matmul:q_proj:L8                 0.12     0.0
matmul:q_proj:L17                0.12     0.0
matmul:q_proj:L9                 0.12     0.0
matmul:q_proj:L11                0.12     0.0
matmul:q_proj:L18                0.12     0.0
matmul:v_proj:L13                0.08     0.0
sample_phase1                    0.08     0.0
matmul:k_proj:L0                 0.07     0.0
matmul:v_proj:L0                 0.07     0.0
matmul:v_proj:L14                0.07     0.0
matmul:v_proj:L7                 0.07     0.0
matmul:k_proj:L14                0.07     0.0
matmul:k_proj:L23                0.07     0.0
matmul:k_proj:L4                 0.06     0.0
matmul:v_proj:L23                0.06     0.0
matmul:v_proj:L10                0.06     0.0
sample_phase3                    0.06     0.0
matmul:k_proj:L10                0.06     0.0
matmul:v_proj:L4                 0.06     0.0
matmul:v_proj:L19                0.05     0.0
matmul:k_proj:L19                0.05     0.0
matmul:k_proj:L13                0.05     0.0
matmul:v_proj:L20                0.05     0.0
matmul:k_proj:L20                0.05     0.0
matmul:k_proj:L7                 0.05     0.0
matmul:v_proj:L16                0.05     0.0
matmul:k_proj:L16                0.05     0.0
matmul:v_proj:L8                 0.05     0.0
matmul:k_proj:L18                0.05     0.0
matmul:v_proj:L1                 0.05     0.0
matmul:k_proj:L21                0.05     0.0
matmul:v_proj:L21                0.05     0.0
matmul:k_proj:L22                0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:v_proj:L24                0.04     0.0
matmul:k_proj:L15                0.04     0.0
matmul:k_proj:L1                 0.04     0.0
matmul:k_proj:L24                0.04     0.0
matmul:v_proj:L22                0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:k_proj:L2                 0.04     0.0
matmul:k_proj:L5                 0.04     0.0
matmul:k_proj:L17                0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:k_proj:L12                0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:k_proj:L3                 0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:v_proj:L17                0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:v_proj:L5                 0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:k_proj:L11                0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:v_proj:L18                0.04     0.0
gather                           0.03     0.0
scale                            0.02     0.0
──────────────────────────────────────────────────
TOTAL                          625.53   100.0

[browser:warning] [26956.9ms][Profile] Batch decode (N=4):
[browser:warning] [26957.2ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      303.54    48.0
fused_ffn                       39.47     6.2
matmul:lm_head                  30.19     4.8
matmul_rmsnorm_fused:L1.ffn_down       10.32     1.6
matmul_rmsnorm_fused:L5.ffn_down       10.27     1.6
matmul_rmsnorm_fused:L10.ffn_down       10.26     1.6
matmul_rmsnorm_fused:L6.ffn_down       10.26     1.6
matmul_rmsnorm_fused:L15.ffn_down       10.26     1.6
matmul_rmsnorm_fused:L25.ffn_down       10.22     1.6
matmul_rmsnorm_fused:L19.ffn_down        9.98     1.6
matmul_rmsnorm_fused:L12.ffn_down        9.54     1.5
matmul_rmsnorm_fused:L8.ffn_down        9.52     1.5
matmul_rmsnorm_fused:L23.ffn_down        9.46     1.5
matmul_rmsnorm_fused:L3.ffn_down        9.45     1.5
matmul_rmsnorm_fused:L9.ffn_down        9.37     1.5
matmul_rmsnorm_fused:L18.ffn_down        9.32     1.5
matmul_rmsnorm_fused:L2.ffn_down        9.21     1.5
matmul_rmsnorm_fused:L21.ffn_down        9.07     1.4
matmul_rmsnorm_fused:L16.ffn_down        9.04     1.4
matmul_rmsnorm_fused:L14.ffn_down        8.90     1.4
matmul_rmsnorm_fused:L24.ffn_down        8.68     1.4
matmul_rmsnorm_fused:L17.ffn_down        8.67     1.4
matmul_rmsnorm_fused:L22.ffn_down        8.67     1.4
matmul_rmsnorm_fused:L13.ffn_down        8.66     1.4
matmul_rmsnorm_fused:L0.ffn_down        8.65     1.4
matmul_rmsnorm_fused:L20.ffn_down        8.65     1.4
matmul_rmsnorm_fused:L11.ffn_down        8.63     1.4
matmul_rmsnorm_fused:L4.ffn_down        8.62     1.4
matmul_rmsnorm_fused:L7.ffn_down        8.60     1.4
sample_phase2                    3.29     0.5
rmsnorm                          3.09     0.5
rope                             0.78     0.1
matmul:q_proj:L0                 0.19     0.0
matmul:o_proj:L18                0.17     0.0
matmul:o_proj:L9                 0.17     0.0
matmul:o_proj:L8                 0.17     0.0
matmul:q_proj:L24                0.17     0.0
matmul:o_proj:L2                 0.16     0.0
matmul:o_proj:L12                0.16     0.0
matmul:q_proj:L4                 0.16     0.0
matmul:o_proj:L25                0.15     0.0
matmul:o_proj:L5                 0.15     0.0
matmul:o_proj:L1                 0.15     0.0
matmul:o_proj:L0                 0.15     0.0
matmul:q_proj:L22                0.15     0.0
matmul:o_proj:L21                0.15     0.0
matmul:o_proj:L17                0.15     0.0
matmul:o_proj:L14                0.14     0.0
matmul:o_proj:L15                0.14     0.0
matmul:o_proj:L24                0.14     0.0
matmul:o_proj:L16                0.14     0.0
matmul:o_proj:L7                 0.14     0.0
matmul:o_proj:L11                0.14     0.0
matmul:q_proj:L20                0.13     0.0
matmul:q_proj:L7                 0.13     0.0
matmul:q_proj:L14                0.13     0.0
matmul:o_proj:L20                0.13     0.0
matmul:q_proj:L11                0.13     0.0
matmul:o_proj:L22                0.13     0.0
matmul:o_proj:L4                 0.13     0.0
matmul:o_proj:L3                 0.13     0.0
matmul:o_proj:L6                 0.13     0.0
matmul:q_proj:L16                0.13     0.0
matmul:o_proj:L19                0.13     0.0
matmul:o_proj:L10                0.13     0.0
matmul:q_proj:L17                0.13     0.0
matmul:o_proj:L13                0.13     0.0
matmul:q_proj:L21                0.13     0.0
matmul:q_proj:L2                 0.13     0.0
matmul:o_proj:L23                0.12     0.0
matmul:q_proj:L1                 0.12     0.0
matmul:q_proj:L13                0.12     0.0
matmul:q_proj:L5                 0.12     0.0
matmul:q_proj:L15                0.12     0.0
matmul:q_proj:L8                 0.12     0.0
matmul:q_proj:L25                0.12     0.0
matmul:q_proj:L19                0.12     0.0
matmul:q_proj:L3                 0.12     0.0
matmul:q_proj:L18                0.12     0.0
matmul:q_proj:L6                 0.12     0.0
matmul:q_proj:L23                0.12     0.0
matmul:q_proj:L9                 0.12     0.0
matmul:q_proj:L10                0.12     0.0
matmul:q_proj:L12                0.12     0.0
sample_phase1                    0.09     0.0
matmul:k_proj:L0                 0.07     0.0
matmul:k_proj:L24                0.07     0.0
matmul:v_proj:L24                0.07     0.0
matmul:v_proj:L0                 0.07     0.0
matmul:k_proj:L4                 0.07     0.0
matmul:v_proj:L4                 0.07     0.0
sample_phase3                    0.06     0.0
matmul:k_proj:L7                 0.05     0.0
matmul:k_proj:L11                0.05     0.0
matmul:v_proj:L7                 0.05     0.0
matmul:v_proj:L20                0.05     0.0
matmul:v_proj:L17                0.05     0.0
matmul:k_proj:L20                0.05     0.0
matmul:v_proj:L11                0.05     0.0
matmul:k_proj:L14                0.05     0.0
matmul:k_proj:L18                0.05     0.0
matmul:v_proj:L3                 0.05     0.0
matmul:k_proj:L22                0.05     0.0
matmul:v_proj:L14                0.05     0.0
matmul:k_proj:L5                 0.05     0.0
matmul:k_proj:L17                0.05     0.0
matmul:k_proj:L19                0.05     0.0
matmul:k_proj:L13                0.04     0.0
matmul:k_proj:L21                0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:k_proj:L1                 0.04     0.0
matmul:v_proj:L19                0.04     0.0
matmul:v_proj:L22                0.04     0.0
matmul:k_proj:L3                 0.04     0.0
matmul:k_proj:L10                0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:k_proj:L2                 0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:k_proj:L16                0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:v_proj:L5                 0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:k_proj:L15                0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:v_proj:L16                0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:k_proj:L12                0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:k_proj:L23                0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:v_proj:L18                0.04     0.0
gather                           0.03     0.0
scale                            0.02     0.0
──────────────────────────────────────────────────
TOTAL                          632.43   100.0

[browser:warning] [27647.4ms][Profile] Batch decode (N=4):
[browser:warning] [27647.5ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      315.59    49.1
fused_ffn                       39.28     6.1
matmul:lm_head                  30.92     4.8
matmul_rmsnorm_fused:L11.ffn_down       11.26     1.8
matmul_rmsnorm_fused:L15.ffn_down       10.15     1.6
matmul_rmsnorm_fused:L16.ffn_down       10.12     1.6
matmul_rmsnorm_fused:L18.ffn_down       10.11     1.6
matmul_rmsnorm_fused:L23.ffn_down       10.10     1.6
matmul_rmsnorm_fused:L12.ffn_down       10.05     1.6
matmul_rmsnorm_fused:L4.ffn_down       10.01     1.6
matmul_rmsnorm_fused:L0.ffn_down        9.79     1.5
matmul_rmsnorm_fused:L21.ffn_down        9.60     1.5
matmul_rmsnorm_fused:L9.ffn_down        9.17     1.4
matmul_rmsnorm_fused:L6.ffn_down        9.10     1.4
matmul_rmsnorm_fused:L17.ffn_down        9.09     1.4
matmul_rmsnorm_fused:L22.ffn_down        9.06     1.4
matmul_rmsnorm_fused:L5.ffn_down        8.97     1.4
matmul_rmsnorm_fused:L1.ffn_down        8.88     1.4
matmul_rmsnorm_fused:L10.ffn_down        8.68     1.4
matmul_rmsnorm_fused:L14.ffn_down        8.66     1.3
matmul_rmsnorm_fused:L20.ffn_down        8.65     1.3
matmul_rmsnorm_fused:L3.ffn_down        8.65     1.3
matmul_rmsnorm_fused:L25.ffn_down        8.65     1.3
matmul_rmsnorm_fused:L2.ffn_down        8.64     1.3
matmul_rmsnorm_fused:L8.ffn_down        8.64     1.3
matmul_rmsnorm_fused:L19.ffn_down        8.63     1.3
matmul_rmsnorm_fused:L24.ffn_down        8.62     1.3
matmul_rmsnorm_fused:L13.ffn_down        8.58     1.3
matmul_rmsnorm_fused:L7.ffn_down        8.58     1.3
sample_phase2                    3.29     0.5
rmsnorm                          3.14     0.5
rope                             0.80     0.1
matmul:q_proj:L0                 0.18     0.0
matmul:o_proj:L11                0.16     0.0
matmul:o_proj:L21                0.16     0.0
matmul:o_proj:L0                 0.16     0.0
matmul:o_proj:L22                0.15     0.0
matmul:q_proj:L23                0.15     0.0
matmul:o_proj:L16                0.15     0.0
matmul:q_proj:L10                0.15     0.0
matmul:o_proj:L17                0.15     0.0
matmul:q_proj:L7                 0.14     0.0
matmul:o_proj:L6                 0.14     0.0
matmul:o_proj:L5                 0.14     0.0
matmul:o_proj:L10                0.14     0.0
matmul:q_proj:L16                0.14     0.0
matmul:o_proj:L23                0.14     0.0
matmul:q_proj:L24                0.14     0.0
matmul:o_proj:L9                 0.14     0.0
matmul:o_proj:L1                 0.14     0.0
matmul:q_proj:L22                0.13     0.0
matmul:q_proj:L19                0.13     0.0
matmul:o_proj:L4                 0.13     0.0
matmul:o_proj:L8                 0.13     0.0
matmul:q_proj:L13                0.13     0.0
matmul:q_proj:L17                0.13     0.0
matmul:o_proj:L15                0.13     0.0
matmul:o_proj:L19                0.13     0.0
matmul:q_proj:L15                0.13     0.0
matmul:q_proj:L6                 0.13     0.0
matmul:q_proj:L12                0.13     0.0
matmul:q_proj:L11                0.13     0.0
matmul:q_proj:L4                 0.13     0.0
matmul:q_proj:L21                0.13     0.0
matmul:o_proj:L3                 0.12     0.0
matmul:o_proj:L25                0.12     0.0
matmul:o_proj:L20                0.12     0.0
matmul:q_proj:L5                 0.12     0.0
matmul:q_proj:L9                 0.12     0.0
matmul:q_proj:L14                0.12     0.0
matmul:o_proj:L14                0.12     0.0
matmul:o_proj:L2                 0.12     0.0
matmul:q_proj:L1                 0.12     0.0
matmul:o_proj:L24                0.12     0.0
matmul:o_proj:L18                0.12     0.0
matmul:o_proj:L13                0.12     0.0
matmul:q_proj:L20                0.12     0.0
matmul:q_proj:L25                0.12     0.0
matmul:q_proj:L18                0.12     0.0
matmul:o_proj:L7                 0.12     0.0
matmul:q_proj:L3                 0.12     0.0
matmul:o_proj:L12                0.12     0.0
sample_phase1                    0.12     0.0
matmul:q_proj:L8                 0.12     0.0
matmul:q_proj:L2                 0.12     0.0
matmul:k_proj:L0                 0.07     0.0
matmul:k_proj:L23                0.07     0.0
matmul:k_proj:L7                 0.07     0.0
matmul:v_proj:L23                0.07     0.0
matmul:v_proj:L0                 0.06     0.0
matmul:v_proj:L7                 0.06     0.0
sample_phase3                    0.06     0.0
matmul:k_proj:L10                0.05     0.0
matmul:v_proj:L16                0.05     0.0
matmul:k_proj:L16                0.05     0.0
matmul:v_proj:L10                0.05     0.0
matmul:k_proj:L19                0.05     0.0
matmul:k_proj:L13                0.05     0.0
matmul:k_proj:L24                0.05     0.0
matmul:v_proj:L13                0.05     0.0
matmul:v_proj:L19                0.05     0.0
matmul:v_proj:L24                0.05     0.0
matmul:k_proj:L22                0.05     0.0
matmul:k_proj:L17                0.05     0.0
matmul:v_proj:L22                0.05     0.0
matmul:v_proj:L20                0.05     0.0
matmul:k_proj:L15                0.04     0.0
matmul:k_proj:L4                 0.04     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:k_proj:L11                0.04     0.0
matmul:k_proj:L5                 0.04     0.0
matmul:k_proj:L21                0.04     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:k_proj:L12                0.04     0.0
matmul:v_proj:L5                 0.04     0.0
matmul:v_proj:L18                0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:k_proj:L18                0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:k_proj:L3                 0.04     0.0
matmul:k_proj:L20                0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:v_proj:L14                0.04     0.0
matmul:k_proj:L14                0.04     0.0
matmul:k_proj:L1                 0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:k_proj:L2                 0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:v_proj:L17                0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:v_proj:L8                 0.04     0.0
gather                           0.03     0.0
scale                            0.02     0.0
──────────────────────────────────────────────────
TOTAL                          643.05   100.0

[browser:warning] [28344.2ms][Profile] Batch decode (N=4):
[browser:warning] [28344.3ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      320.67    49.4
fused_ffn                       39.22     6.0
matmul:lm_head                  29.69     4.6
matmul_rmsnorm_fused:L7.ffn_down       11.82     1.8
matmul_rmsnorm_fused:L18.ffn_down       11.75     1.8
matmul_rmsnorm_fused:L12.ffn_down       11.41     1.8
matmul_rmsnorm_fused:L23.ffn_down       11.20     1.7
matmul_rmsnorm_fused:L1.ffn_down       10.31     1.6
matmul_rmsnorm_fused:L11.ffn_down        9.98     1.5
matmul_rmsnorm_fused:L24.ffn_down        9.59     1.5
matmul_rmsnorm_fused:L17.ffn_down        9.58     1.5
matmul_rmsnorm_fused:L22.ffn_down        9.37     1.4
matmul_rmsnorm_fused:L5.ffn_down        9.09     1.4
matmul_rmsnorm_fused:L13.ffn_down        8.98     1.4
matmul_rmsnorm_fused:L2.ffn_down        8.80     1.4
matmul_rmsnorm_fused:L6.ffn_down        8.73     1.3
matmul_rmsnorm_fused:L16.ffn_down        8.71     1.3
matmul_rmsnorm_fused:L0.ffn_down        8.69     1.3
matmul_rmsnorm_fused:L9.ffn_down        8.67     1.3
matmul_rmsnorm_fused:L14.ffn_down        8.66     1.3
matmul_rmsnorm_fused:L10.ffn_down        8.66     1.3
matmul_rmsnorm_fused:L15.ffn_down        8.66     1.3
matmul_rmsnorm_fused:L19.ffn_down        8.64     1.3
matmul_rmsnorm_fused:L21.ffn_down        8.63     1.3
matmul_rmsnorm_fused:L3.ffn_down        8.61     1.3
matmul_rmsnorm_fused:L20.ffn_down        8.61     1.3
matmul_rmsnorm_fused:L25.ffn_down        8.61     1.3
matmul_rmsnorm_fused:L4.ffn_down        8.60     1.3
matmul_rmsnorm_fused:L8.ffn_down        8.60     1.3
sample_phase2                    3.24     0.5
rmsnorm                          3.08     0.5
rope                             0.79     0.1
matmul:o_proj:L2                 0.16     0.0
matmul:o_proj:L17                0.16     0.0
matmul:o_proj:L12                0.16     0.0
matmul:q_proj:L24                0.16     0.0
matmul:o_proj:L16                0.15     0.0
matmul:o_proj:L0                 0.15     0.0
matmul:o_proj:L24                0.15     0.0
matmul:q_proj:L19                0.15     0.0
matmul:o_proj:L7                 0.15     0.0
matmul:q_proj:L23                0.15     0.0
matmul:o_proj:L1                 0.15     0.0
matmul:q_proj:L6                 0.15     0.0
matmul:o_proj:L22                0.15     0.0
matmul:o_proj:L18                0.15     0.0
matmul:o_proj:L5                 0.15     0.0
matmul:q_proj:L0                 0.14     0.0
matmul:q_proj:L12                0.14     0.0
matmul:o_proj:L25                0.14     0.0
matmul:q_proj:L13                0.14     0.0
matmul:q_proj:L7                 0.14     0.0
matmul:o_proj:L19                0.14     0.0
matmul:o_proj:L23                0.14     0.0
matmul:o_proj:L6                 0.14     0.0
matmul:o_proj:L15                0.14     0.0
matmul:o_proj:L13                0.14     0.0
matmul:o_proj:L14                0.14     0.0
matmul:q_proj:L2                 0.14     0.0
matmul:o_proj:L11                0.14     0.0
matmul:q_proj:L18                0.13     0.0
matmul:q_proj:L8                 0.13     0.0
matmul:o_proj:L10                0.13     0.0
matmul:q_proj:L1                 0.13     0.0
matmul:q_proj:L20                0.12     0.0
matmul:q_proj:L17                0.12     0.0
matmul:o_proj:L9                 0.12     0.0
matmul:o_proj:L20                0.12     0.0
matmul:o_proj:L3                 0.12     0.0
matmul:q_proj:L16                0.12     0.0
matmul:q_proj:L15                0.12     0.0
matmul:q_proj:L22                0.12     0.0
matmul:q_proj:L11                0.12     0.0
matmul:q_proj:L21                0.12     0.0
matmul:q_proj:L5                 0.12     0.0
matmul:q_proj:L10                0.12     0.0
matmul:q_proj:L9                 0.12     0.0
matmul:o_proj:L4                 0.12     0.0
matmul:o_proj:L8                 0.12     0.0
matmul:q_proj:L25                0.12     0.0
matmul:q_proj:L14                0.12     0.0
matmul:q_proj:L3                 0.12     0.0
matmul:o_proj:L21                0.12     0.0
matmul:q_proj:L4                 0.12     0.0
sample_phase1                    0.06     0.0
matmul:v_proj:L6                 0.06     0.0
matmul:v_proj:L23                0.06     0.0
matmul:k_proj:L24                0.06     0.0
matmul:k_proj:L19                0.06     0.0
matmul:k_proj:L23                0.06     0.0
matmul:k_proj:L6                 0.06     0.0
matmul:v_proj:L24                0.06     0.0
matmul:v_proj:L19                0.06     0.0
matmul:k_proj:L13                0.05     0.0
matmul:v_proj:L12                0.05     0.0
matmul:k_proj:L12                0.05     0.0
matmul:v_proj:L13                0.05     0.0
matmul:k_proj:L2                 0.05     0.0
matmul:v_proj:L2                 0.05     0.0
matmul:v_proj:L0                 0.05     0.0
matmul:k_proj:L0                 0.05     0.0
sample_phase3                    0.05     0.0
matmul:v_proj:L10                0.05     0.0
matmul:k_proj:L7                 0.05     0.0
matmul:k_proj:L25                0.05     0.0
matmul:k_proj:L18                0.04     0.0
matmul:k_proj:L17                0.04     0.0
matmul:k_proj:L1                 0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:v_proj:L18                0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:k_proj:L10                0.04     0.0
matmul:v_proj:L16                0.04     0.0
matmul:k_proj:L15                0.04     0.0
matmul:v_proj:L17                0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:k_proj:L20                0.04     0.0
matmul:k_proj:L16                0.04     0.0
matmul:k_proj:L11                0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:v_proj:L5                 0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:k_proj:L5                 0.04     0.0
matmul:v_proj:L22                0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:v_proj:L14                0.04     0.0
matmul:k_proj:L3                 0.04     0.0
matmul:k_proj:L21                0.04     0.0
matmul:k_proj:L4                 0.04     0.0
matmul:k_proj:L22                0.04     0.0
matmul:k_proj:L14                0.04     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:v_proj:L3                 0.04     0.0
gather                           0.01     0.0
scale                            0.01     0.0
──────────────────────────────────────────────────
TOTAL                          649.27   100.0

[browser:warning] [29044.8ms][Profile] Batch decode (N=4):
[browser:warning] [29044.9ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      322.76    49.3
fused_ffn                       42.08     6.4
matmul:lm_head                  29.84     4.6
matmul_rmsnorm_fused:L12.ffn_down       12.15     1.9
matmul_rmsnorm_fused:L1.ffn_down       12.11     1.9
matmul_rmsnorm_fused:L6.ffn_down       11.00     1.7
matmul_rmsnorm_fused:L23.ffn_down       10.85     1.7
matmul_rmsnorm_fused:L18.ffn_down       10.62     1.6
matmul_rmsnorm_fused:L17.ffn_down       10.40     1.6
matmul_rmsnorm_fused:L7.ffn_down       10.20     1.6
matmul_rmsnorm_fused:L24.ffn_down        9.24     1.4
matmul_rmsnorm_fused:L22.ffn_down        8.75     1.3
matmul_rmsnorm_fused:L21.ffn_down        8.75     1.3
matmul_rmsnorm_fused:L11.ffn_down        8.74     1.3
matmul_rmsnorm_fused:L16.ffn_down        8.72     1.3
matmul_rmsnorm_fused:L0.ffn_down        8.70     1.3
matmul_rmsnorm_fused:L19.ffn_down        8.68     1.3
matmul_rmsnorm_fused:L5.ffn_down        8.67     1.3
matmul_rmsnorm_fused:L10.ffn_down        8.67     1.3
matmul_rmsnorm_fused:L9.ffn_down        8.67     1.3
matmul_rmsnorm_fused:L3.ffn_down        8.65     1.3
matmul_rmsnorm_fused:L14.ffn_down        8.65     1.3
matmul_rmsnorm_fused:L15.ffn_down        8.64     1.3
matmul_rmsnorm_fused:L2.ffn_down        8.64     1.3
matmul_rmsnorm_fused:L20.ffn_down        8.64     1.3
matmul_rmsnorm_fused:L13.ffn_down        8.63     1.3
matmul_rmsnorm_fused:L25.ffn_down        8.62     1.3
matmul_rmsnorm_fused:L4.ffn_down        8.62     1.3
matmul_rmsnorm_fused:L8.ffn_down        8.59     1.3
rmsnorm                          3.41     0.5
sample_phase2                    3.24     0.5
rope                             0.70     0.1
matmul:q_proj:L7                 0.18     0.0
matmul:o_proj:L24                0.18     0.0
matmul:o_proj:L1                 0.17     0.0
matmul:o_proj:L6                 0.17     0.0
matmul:o_proj:L23                0.16     0.0
matmul:o_proj:L12                0.16     0.0
matmul:q_proj:L13                0.16     0.0
matmul:o_proj:L17                0.16     0.0
matmul:q_proj:L2                 0.16     0.0
matmul:o_proj:L18                0.15     0.0
matmul:o_proj:L0                 0.15     0.0
matmul:o_proj:L7                 0.15     0.0
matmul:o_proj:L19                0.15     0.0
matmul:o_proj:L21                0.15     0.0
matmul:q_proj:L18                0.15     0.0
matmul:o_proj:L5                 0.15     0.0
matmul:o_proj:L16                0.15     0.0
matmul:o_proj:L22                0.14     0.0
matmul:o_proj:L9                 0.14     0.0
matmul:o_proj:L4                 0.14     0.0
matmul:q_proj:L24                0.14     0.0
matmul:q_proj:L12                0.14     0.0
matmul:o_proj:L11                0.14     0.0
matmul:o_proj:L13                0.13     0.0
matmul:q_proj:L0                 0.13     0.0
matmul:o_proj:L15                0.13     0.0
matmul:o_proj:L14                0.13     0.0
matmul:q_proj:L1                 0.13     0.0
matmul:o_proj:L3                 0.13     0.0
matmul:o_proj:L2                 0.13     0.0
matmul:o_proj:L25                0.13     0.0
matmul:o_proj:L10                0.13     0.0
matmul:q_proj:L6                 0.13     0.0
matmul:q_proj:L23                0.13     0.0
matmul:q_proj:L17                0.13     0.0
matmul:q_proj:L21                0.13     0.0
matmul:o_proj:L20                0.12     0.0
matmul:q_proj:L5                 0.12     0.0
matmul:q_proj:L10                0.12     0.0
matmul:q_proj:L3                 0.12     0.0
matmul:q_proj:L25                0.12     0.0
matmul:q_proj:L20                0.12     0.0
matmul:q_proj:L22                0.12     0.0
matmul:q_proj:L4                 0.12     0.0
matmul:q_proj:L19                0.12     0.0
matmul:q_proj:L11                0.12     0.0
matmul:q_proj:L16                0.12     0.0
matmul:q_proj:L14                0.12     0.0
matmul:q_proj:L15                0.12     0.0
matmul:q_proj:L8                 0.12     0.0
matmul:o_proj:L8                 0.12     0.0
matmul:q_proj:L9                 0.12     0.0
matmul:v_proj:L7                 0.07     0.0
matmul:k_proj:L7                 0.07     0.0
sample_phase1                    0.06     0.0
matmul:k_proj:L2                 0.06     0.0
matmul:v_proj:L2                 0.06     0.0
matmul:v_proj:L24                0.06     0.0
matmul:k_proj:L13                0.06     0.0
sample_phase3                    0.05     0.0
matmul:k_proj:L12                0.05     0.0
matmul:v_proj:L20                0.05     0.0
matmul:k_proj:L20                0.05     0.0
matmul:v_proj:L13                0.05     0.0
matmul:k_proj:L18                0.05     0.0
matmul:k_proj:L0                 0.05     0.0
matmul:v_proj:L12                0.05     0.0
matmul:k_proj:L24                0.05     0.0
matmul:v_proj:L18                0.05     0.0
matmul:v_proj:L0                 0.05     0.0
matmul:k_proj:L10                0.05     0.0
matmul:k_proj:L23                0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:k_proj:L1                 0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:k_proj:L17                0.04     0.0
matmul:k_proj:L11                0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:k_proj:L21                0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:k_proj:L4                 0.04     0.0
matmul:k_proj:L3                 0.04     0.0
matmul:v_proj:L22                0.04     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:v_proj:L17                0.04     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:k_proj:L5                 0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:k_proj:L22                0.04     0.0
matmul:v_proj:L14                0.04     0.0
matmul:k_proj:L19                0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:k_proj:L16                0.04     0.0
matmul:v_proj:L5                 0.04     0.0
matmul:v_proj:L16                0.04     0.0
matmul:v_proj:L19                0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:k_proj:L15                0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:k_proj:L14                0.04     0.0
gather                           0.01     0.0
scale                            0.01     0.0
──────────────────────────────────────────────────
TOTAL                          654.35   100.0

[browser:warning] [29751.9ms][Profile] Batch decode (N=4):
[browser:warning] [29752.0ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      334.94    50.7
fused_ffn                       39.10     5.9
matmul:lm_head                  30.38     4.6
matmul_rmsnorm_fused:L6.ffn_down       12.36     1.9
matmul_rmsnorm_fused:L17.ffn_down       12.07     1.8
matmul_rmsnorm_fused:L0.ffn_down       11.31     1.7
matmul_rmsnorm_fused:L23.ffn_down       10.42     1.6
matmul_rmsnorm_fused:L11.ffn_down        9.63     1.5
matmul_rmsnorm_fused:L22.ffn_down        9.19     1.4
matmul_rmsnorm_fused:L1.ffn_down        9.18     1.4
matmul_rmsnorm_fused:L15.ffn_down        8.93     1.4
matmul_rmsnorm_fused:L2.ffn_down        8.89     1.3
matmul_rmsnorm_fused:L16.ffn_down        8.75     1.3
matmul_rmsnorm_fused:L12.ffn_down        8.73     1.3
matmul_rmsnorm_fused:L14.ffn_down        8.70     1.3
matmul_rmsnorm_fused:L5.ffn_down        8.69     1.3
matmul_rmsnorm_fused:L10.ffn_down        8.68     1.3
matmul_rmsnorm_fused:L3.ffn_down        8.65     1.3
matmul_rmsnorm_fused:L21.ffn_down        8.65     1.3
matmul_rmsnorm_fused:L19.ffn_down        8.65     1.3
matmul_rmsnorm_fused:L18.ffn_down        8.64     1.3
matmul_rmsnorm_fused:L25.ffn_down        8.64     1.3
matmul_rmsnorm_fused:L9.ffn_down        8.64     1.3
matmul_rmsnorm_fused:L24.ffn_down        8.63     1.3
matmul_rmsnorm_fused:L20.ffn_down        8.62     1.3
matmul_rmsnorm_fused:L4.ffn_down        8.61     1.3
matmul_rmsnorm_fused:L8.ffn_down        8.59     1.3
matmul_rmsnorm_fused:L13.ffn_down        8.59     1.3
matmul_rmsnorm_fused:L7.ffn_down        8.57     1.3
rmsnorm                          3.25     0.5
sample_phase2                    3.24     0.5
rope                             0.82     0.1
matmul:o_proj:L17                0.23     0.0
matmul:o_proj:L6                 0.20     0.0
matmul:q_proj:L1                 0.19     0.0
matmul:q_proj:L12                0.18     0.0
matmul:o_proj:L1                 0.18     0.0
matmul:q_proj:L18                0.16     0.0
matmul:o_proj:L15                0.16     0.0
matmul:o_proj:L23                0.15     0.0
matmul:q_proj:L0                 0.15     0.0
matmul:o_proj:L2                 0.15     0.0
matmul:o_proj:L4                 0.15     0.0
matmul:o_proj:L0                 0.15     0.0
matmul:q_proj:L23                0.15     0.0
matmul:o_proj:L12                0.15     0.0
matmul:q_proj:L7                 0.15     0.0
matmul:o_proj:L16                0.14     0.0
matmul:o_proj:L22                0.14     0.0
matmul:o_proj:L5                 0.14     0.0
matmul:o_proj:L11                0.14     0.0
matmul:q_proj:L15                0.13     0.0
matmul:o_proj:L10                0.13     0.0
matmul:o_proj:L18                0.13     0.0
matmul:o_proj:L21                0.13     0.0
matmul:q_proj:L6                 0.13     0.0
matmul:q_proj:L22                0.13     0.0
matmul:o_proj:L7                 0.13     0.0
matmul:q_proj:L17                0.13     0.0
matmul:o_proj:L25                0.13     0.0
matmul:q_proj:L11                0.13     0.0
matmul:q_proj:L4                 0.13     0.0
matmul:o_proj:L19                0.13     0.0
matmul:o_proj:L13                0.13     0.0
matmul:q_proj:L16                0.12     0.0
matmul:o_proj:L3                 0.12     0.0
matmul:o_proj:L14                0.12     0.0
matmul:q_proj:L24                0.12     0.0
matmul:q_proj:L5                 0.12     0.0
matmul:q_proj:L19                0.12     0.0
matmul:q_proj:L2                 0.12     0.0
matmul:q_proj:L20                0.12     0.0
matmul:o_proj:L8                 0.12     0.0
matmul:o_proj:L20                0.12     0.0
matmul:q_proj:L21                0.12     0.0
matmul:q_proj:L9                 0.12     0.0
matmul:q_proj:L10                0.12     0.0
matmul:o_proj:L9                 0.12     0.0
matmul:q_proj:L13                0.12     0.0
matmul:o_proj:L24                0.12     0.0
matmul:q_proj:L3                 0.12     0.0
matmul:q_proj:L8                 0.12     0.0
matmul:q_proj:L14                0.12     0.0
matmul:q_proj:L25                0.11     0.0
matmul:k_proj:L1                 0.09     0.0
matmul:v_proj:L1                 0.08     0.0
matmul:k_proj:L12                0.07     0.0
matmul:v_proj:L12                0.07     0.0
matmul:v_proj:L23                0.07     0.0
sample_phase1                    0.06     0.0
matmul:k_proj:L23                0.06     0.0
matmul:k_proj:L18                0.06     0.0
matmul:v_proj:L18                0.06     0.0
matmul:k_proj:L7                 0.05     0.0
matmul:v_proj:L7                 0.05     0.0
sample_phase3                    0.05     0.0
matmul:k_proj:L0                 0.05     0.0
matmul:v_proj:L15                0.05     0.0
matmul:v_proj:L0                 0.05     0.0
matmul:k_proj:L15                0.05     0.0
matmul:k_proj:L11                0.04     0.0
matmul:k_proj:L4                 0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:k_proj:L10                0.04     0.0
matmul:k_proj:L22                0.04     0.0
matmul:k_proj:L17                0.04     0.0
matmul:k_proj:L16                0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:v_proj:L22                0.04     0.0
matmul:k_proj:L20                0.04     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:v_proj:L17                0.04     0.0
matmul:k_proj:L2                 0.04     0.0
matmul:v_proj:L16                0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:k_proj:L5                 0.04     0.0
matmul:k_proj:L13                0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:k_proj:L24                0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:v_proj:L5                 0.04     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:v_proj:L24                0.04     0.0
matmul:k_proj:L21                0.04     0.0
matmul:v_proj:L19                0.04     0.0
matmul:k_proj:L3                 0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:k_proj:L19                0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:v_proj:L14                0.04     0.0
matmul:k_proj:L14                0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:v_proj:L13                0.04     0.0
gather                           0.02     0.0
scale                            0.01     0.0
──────────────────────────────────────────────────
TOTAL                          660.46   100.0

[browser:warning] [30471.1ms][Profile] Batch decode (N=4):
[browser:warning] [30471.2ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      338.44    50.4
fused_ffn                       39.36     5.9
matmul:lm_head                  30.81     4.6
matmul_rmsnorm_fused:L4.ffn_down       11.87     1.8
matmul_rmsnorm_fused:L20.ffn_down       11.55     1.7
matmul_rmsnorm_fused:L15.ffn_down       11.54     1.7
matmul_rmsnorm_fused:L9.ffn_down       11.51     1.7
matmul_rmsnorm_fused:L14.ffn_down       10.68     1.6
matmul_rmsnorm_fused:L21.ffn_down       10.24     1.5
matmul_rmsnorm_fused:L25.ffn_down       10.08     1.5
matmul_rmsnorm_fused:L10.ffn_down       10.07     1.5
matmul_rmsnorm_fused:L5.ffn_down        9.98     1.5
matmul_rmsnorm_fused:L3.ffn_down        9.75     1.5
matmul_rmsnorm_fused:L17.ffn_down        8.74     1.3
matmul_rmsnorm_fused:L18.ffn_down        8.73     1.3
matmul_rmsnorm_fused:L19.ffn_down        8.71     1.3
matmul_rmsnorm_fused:L8.ffn_down        8.71     1.3
matmul_rmsnorm_fused:L11.ffn_down        8.69     1.3
matmul_rmsnorm_fused:L6.ffn_down        8.68     1.3
matmul_rmsnorm_fused:L24.ffn_down        8.68     1.3
matmul_rmsnorm_fused:L2.ffn_down        8.68     1.3
matmul_rmsnorm_fused:L22.ffn_down        8.65     1.3
matmul_rmsnorm_fused:L13.ffn_down        8.65     1.3
matmul_rmsnorm_fused:L16.ffn_down        8.65     1.3
matmul_rmsnorm_fused:L12.ffn_down        8.65     1.3
matmul_rmsnorm_fused:L1.ffn_down        8.64     1.3
matmul_rmsnorm_fused:L23.ffn_down        8.64     1.3
matmul_rmsnorm_fused:L7.ffn_down        8.60     1.3
matmul_rmsnorm_fused:L0.ffn_down        8.58     1.3
sample_phase2                    3.41     0.5
rmsnorm                          3.14     0.5
rope                             0.79     0.1
matmul:q_proj:L0                 0.30     0.0
matmul:o_proj:L20                0.21     0.0
matmul:o_proj:L9                 0.19     0.0
matmul:o_proj:L5                 0.18     0.0
matmul:o_proj:L25                0.17     0.0
matmul:o_proj:L21                0.17     0.0
matmul:o_proj:L10                0.16     0.0
matmul:q_proj:L15                0.16     0.0
matmul:o_proj:L14                0.15     0.0
matmul:q_proj:L4                 0.15     0.0
matmul:q_proj:L10                0.15     0.0
matmul:o_proj:L4                 0.14     0.0
matmul:o_proj:L3                 0.14     0.0
matmul:o_proj:L15                0.14     0.0
matmul:o_proj:L19                0.14     0.0
matmul:q_proj:L16                0.14     0.0
matmul:o_proj:L12                0.14     0.0
matmul:q_proj:L19                0.14     0.0
matmul:o_proj:L23                0.14     0.0
matmul:q_proj:L21                0.14     0.0
matmul:o_proj:L16                0.14     0.0
matmul:o_proj:L13                0.14     0.0
matmul:q_proj:L20                0.14     0.0
matmul:o_proj:L2                 0.14     0.0
matmul:o_proj:L24                0.14     0.0
matmul:o_proj:L0                 0.13     0.0
matmul:q_proj:L18                0.13     0.0
matmul:q_proj:L9                 0.13     0.0
matmul:o_proj:L8                 0.13     0.0
matmul:q_proj:L25                0.13     0.0
matmul:o_proj:L1                 0.13     0.0
matmul:q_proj:L14                0.13     0.0
matmul:q_proj:L5                 0.13     0.0
matmul:o_proj:L17                0.13     0.0
matmul:o_proj:L18                0.12     0.0
matmul:q_proj:L3                 0.12     0.0
matmul:o_proj:L22                0.12     0.0
matmul:q_proj:L12                0.12     0.0
matmul:q_proj:L22                0.12     0.0
matmul:o_proj:L7                 0.12     0.0
matmul:o_proj:L6                 0.12     0.0
matmul:q_proj:L23                0.12     0.0
matmul:q_proj:L24                0.12     0.0
matmul:o_proj:L11                0.12     0.0
matmul:q_proj:L6                 0.12     0.0
matmul:q_proj:L11                0.12     0.0
matmul:q_proj:L17                0.12     0.0
matmul:q_proj:L13                0.12     0.0
matmul:q_proj:L2                 0.12     0.0
matmul:q_proj:L7                 0.12     0.0
matmul:q_proj:L8                 0.12     0.0
matmul:q_proj:L1                 0.12     0.0
sample_phase1                    0.10     0.0
matmul:k_proj:L0                 0.10     0.0
matmul:v_proj:L0                 0.09     0.0
sample_phase3                    0.08     0.0
matmul:k_proj:L15                0.06     0.0
matmul:k_proj:L10                0.06     0.0
gather                           0.06     0.0
matmul:v_proj:L15                0.05     0.0
matmul:k_proj:L4                 0.05     0.0
matmul:v_proj:L10                0.05     0.0
matmul:v_proj:L16                0.05     0.0
matmul:k_proj:L16                0.05     0.0
matmul:v_proj:L4                 0.05     0.0
matmul:k_proj:L21                0.05     0.0
matmul:v_proj:L21                0.05     0.0
matmul:v_proj:L14                0.05     0.0
matmul:k_proj:L14                0.05     0.0
matmul:k_proj:L20                0.05     0.0
matmul:k_proj:L19                0.05     0.0
scale                            0.05     0.0
matmul:k_proj:L25                0.05     0.0
matmul:v_proj:L20                0.05     0.0
matmul:k_proj:L18                0.05     0.0
matmul:v_proj:L19                0.04     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:k_proj:L13                0.04     0.0
matmul:k_proj:L12                0.04     0.0
matmul:k_proj:L5                 0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:v_proj:L5                 0.04     0.0
matmul:k_proj:L7                 0.04     0.0
matmul:k_proj:L2                 0.04     0.0
matmul:k_proj:L3                 0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:v_proj:L18                0.04     0.0
matmul:k_proj:L24                0.04     0.0
matmul:k_proj:L11                0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:k_proj:L17                0.04     0.0
matmul:v_proj:L22                0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:v_proj:L17                0.04     0.0
matmul:k_proj:L22                0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:v_proj:L24                0.04     0.0
matmul:k_proj:L1                 0.04     0.0
matmul:k_proj:L23                0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:v_proj:L1                 0.04     0.0
──────────────────────────────────────────────────
TOTAL                          671.96   100.0

[browser:warning] [31199.1ms][Profile] Batch decode (N=4):
[browser:warning] [31199.5ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      344.88    51.0
fused_ffn                       39.70     5.9
matmul:lm_head                  30.94     4.6
matmul_rmsnorm_fused:L17.ffn_down       13.37     2.0
matmul_rmsnorm_fused:L22.ffn_down       12.22     1.8
matmul_rmsnorm_fused:L6.ffn_down       10.81     1.6
matmul_rmsnorm_fused:L1.ffn_down       10.27     1.5
matmul_rmsnorm_fused:L7.ffn_down       10.19     1.5
matmul_rmsnorm_fused:L18.ffn_down       10.09     1.5
matmul_rmsnorm_fused:L23.ffn_down       10.08     1.5
matmul_rmsnorm_fused:L11.ffn_down        9.72     1.4
matmul_rmsnorm_fused:L12.ffn_down        9.52     1.4
matmul_rmsnorm_fused:L0.ffn_down        8.90     1.3
matmul_rmsnorm_fused:L2.ffn_down        8.82     1.3
matmul_rmsnorm_fused:L10.ffn_down        8.77     1.3
matmul_rmsnorm_fused:L5.ffn_down        8.76     1.3
matmul_rmsnorm_fused:L15.ffn_down        8.72     1.3
matmul_rmsnorm_fused:L16.ffn_down        8.72     1.3
matmul_rmsnorm_fused:L21.ffn_down        8.67     1.3
matmul_rmsnorm_fused:L9.ffn_down        8.65     1.3
matmul_rmsnorm_fused:L25.ffn_down        8.65     1.3
matmul_rmsnorm_fused:L14.ffn_down        8.65     1.3
matmul_rmsnorm_fused:L20.ffn_down        8.65     1.3
matmul_rmsnorm_fused:L19.ffn_down        8.63     1.3
matmul_rmsnorm_fused:L3.ffn_down        8.62     1.3
matmul_rmsnorm_fused:L24.ffn_down        8.61     1.3
matmul_rmsnorm_fused:L4.ffn_down        8.61     1.3
matmul_rmsnorm_fused:L8.ffn_down        8.61     1.3
matmul_rmsnorm_fused:L13.ffn_down        8.58     1.3
sample_phase2                    3.25     0.5
rmsnorm                          2.95     0.4
rope                             0.73     0.1
matmul:o_proj:L4                 0.18     0.0
matmul:q_proj:L12                0.18     0.0
matmul:o_proj:L6                 0.16     0.0
matmul:q_proj:L0                 0.16     0.0
matmul:o_proj:L0                 0.16     0.0
matmul:o_proj:L18                0.16     0.0
matmul:o_proj:L17                0.16     0.0
matmul:q_proj:L1                 0.16     0.0
matmul:o_proj:L23                0.16     0.0
matmul:q_proj:L13                0.15     0.0
matmul:o_proj:L12                0.15     0.0
matmul:o_proj:L15                0.15     0.0
matmul:o_proj:L14                0.15     0.0
matmul:o_proj:L7                 0.15     0.0
matmul:o_proj:L10                0.15     0.0
matmul:o_proj:L22                0.15     0.0
matmul:q_proj:L7                 0.15     0.0
matmul:o_proj:L3                 0.15     0.0
matmul:o_proj:L1                 0.15     0.0
matmul:o_proj:L21                0.15     0.0
matmul:o_proj:L2                 0.15     0.0
matmul:o_proj:L11                0.14     0.0
matmul:q_proj:L23                0.14     0.0
matmul:o_proj:L13                0.14     0.0
matmul:q_proj:L18                0.14     0.0
matmul:o_proj:L16                0.14     0.0
matmul:q_proj:L22                0.13     0.0
matmul:o_proj:L5                 0.13     0.0
matmul:o_proj:L20                0.13     0.0
matmul:q_proj:L6                 0.13     0.0
matmul:q_proj:L11                0.13     0.0
matmul:o_proj:L19                0.13     0.0
matmul:q_proj:L17                0.13     0.0
matmul:q_proj:L2                 0.13     0.0
matmul:o_proj:L9                 0.13     0.0
matmul:q_proj:L3                 0.13     0.0
matmul:q_proj:L8                 0.13     0.0
matmul:q_proj:L21                0.13     0.0
matmul:o_proj:L25                0.13     0.0
matmul:q_proj:L20                0.12     0.0
matmul:q_proj:L16                0.12     0.0
matmul:q_proj:L25                0.12     0.0
matmul:o_proj:L8                 0.12     0.0
matmul:o_proj:L24                0.12     0.0
matmul:q_proj:L24                0.12     0.0
matmul:q_proj:L15                0.12     0.0
matmul:q_proj:L14                0.12     0.0
matmul:q_proj:L9                 0.12     0.0
matmul:q_proj:L10                0.12     0.0
matmul:q_proj:L5                 0.12     0.0
matmul:q_proj:L4                 0.12     0.0
matmul:q_proj:L19                0.12     0.0
sample_phase1                    0.08     0.0
matmul:k_proj:L12                0.08     0.0
matmul:v_proj:L12                0.07     0.0
matmul:v_proj:L13                0.07     0.0
matmul:k_proj:L7                 0.07     0.0
matmul:k_proj:L13                0.07     0.0
sample_phase3                    0.06     0.0
matmul:v_proj:L7                 0.06     0.0
matmul:k_proj:L0                 0.05     0.0
matmul:k_proj:L1                 0.05     0.0
matmul:v_proj:L0                 0.05     0.0
matmul:v_proj:L1                 0.05     0.0
matmul:v_proj:L23                0.05     0.0
matmul:k_proj:L23                0.05     0.0
matmul:k_proj:L2                 0.05     0.0
matmul:k_proj:L11                0.05     0.0
matmul:k_proj:L21                0.05     0.0
matmul:k_proj:L22                0.04     0.0
matmul:k_proj:L16                0.04     0.0
matmul:k_proj:L18                0.04     0.0
matmul:k_proj:L3                 0.04     0.0
matmul:v_proj:L17                0.04     0.0
matmul:v_proj:L22                0.04     0.0
matmul:k_proj:L17                0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:v_proj:L18                0.04     0.0
matmul:k_proj:L4                 0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:k_proj:L10                0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:k_proj:L20                0.04     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:k_proj:L15                0.04     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:k_proj:L5                 0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:k_proj:L14                0.04     0.0
matmul:v_proj:L14                0.04     0.0
matmul:k_proj:L19                0.04     0.0
matmul:v_proj:L16                0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:k_proj:L24                0.04     0.0
matmul:v_proj:L5                 0.04     0.0
matmul:v_proj:L19                0.04     0.0
matmul:v_proj:L24                0.04     0.0
gather                           0.01     0.0
scale                            0.01     0.0
──────────────────────────────────────────────────
TOTAL                          676.16   100.0

[browser:warning] [31954.0ms][Profile] Batch decode (N=4):
[browser:warning] [31954.1ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      355.49    52.0
fused_ffn                       39.25     5.7
matmul:lm_head                  30.33     4.4
matmul_rmsnorm_fused:L8.ffn_down       10.40     1.5
matmul_rmsnorm_fused:L24.ffn_down       10.40     1.5
matmul_rmsnorm_fused:L22.ffn_down       10.35     1.5
matmul_rmsnorm_fused:L14.ffn_down       10.26     1.5
matmul_rmsnorm_fused:L9.ffn_down       10.25     1.5
matmul_rmsnorm_fused:L7.ffn_down       10.03     1.5
matmul_rmsnorm_fused:L2.ffn_down        9.79     1.4
matmul_rmsnorm_fused:L19.ffn_down        9.69     1.4
matmul_rmsnorm_fused:L17.ffn_down        9.48     1.4
matmul_rmsnorm_fused:L12.ffn_down        9.27     1.4
matmul_rmsnorm_fused:L6.ffn_down        9.25     1.4
matmul_rmsnorm_fused:L23.ffn_down        9.20     1.3
matmul_rmsnorm_fused:L4.ffn_down        9.14     1.3
matmul_rmsnorm_fused:L18.ffn_down        9.13     1.3
matmul_rmsnorm_fused:L1.ffn_down        9.02     1.3
matmul_rmsnorm_fused:L3.ffn_down        8.96     1.3
matmul_rmsnorm_fused:L25.ffn_down        8.95     1.3
matmul_rmsnorm_fused:L13.ffn_down        8.67     1.3
matmul_rmsnorm_fused:L11.ffn_down        8.66     1.3
matmul_rmsnorm_fused:L16.ffn_down        8.65     1.3
matmul_rmsnorm_fused:L15.ffn_down        8.63     1.3
matmul_rmsnorm_fused:L10.ffn_down        8.62     1.3
matmul_rmsnorm_fused:L21.ffn_down        8.62     1.3
matmul_rmsnorm_fused:L5.ffn_down        8.61     1.3
matmul_rmsnorm_fused:L0.ffn_down        8.61     1.3
matmul_rmsnorm_fused:L20.ffn_down        8.59     1.3
sample_phase2                    3.24     0.5
rmsnorm                          3.12     0.5
rope                             0.79     0.1
matmul:q_proj:L0                 0.18     0.0
matmul:o_proj:L14                0.17     0.0
matmul:o_proj:L19                0.17     0.0
matmul:o_proj:L2                 0.16     0.0
matmul:o_proj:L3                 0.16     0.0
matmul:o_proj:L18                0.16     0.0
matmul:q_proj:L18                0.16     0.0
matmul:q_proj:L7                 0.16     0.0
matmul:o_proj:L4                 0.15     0.0
matmul:q_proj:L20                0.15     0.0
matmul:q_proj:L24                0.15     0.0
matmul:o_proj:L12                0.15     0.0
matmul:q_proj:L13                0.15     0.0
matmul:o_proj:L7                 0.15     0.0
matmul:o_proj:L13                0.15     0.0
matmul:q_proj:L2                 0.14     0.0
matmul:o_proj:L24                0.14     0.0
matmul:o_proj:L25                0.14     0.0
matmul:o_proj:L0                 0.14     0.0
matmul:q_proj:L23                0.14     0.0
matmul:q_proj:L14                0.14     0.0
matmul:o_proj:L23                0.13     0.0
matmul:o_proj:L10                0.13     0.0
matmul:o_proj:L1                 0.13     0.0
matmul:o_proj:L22                0.13     0.0
matmul:o_proj:L8                 0.13     0.0
matmul:o_proj:L6                 0.13     0.0
matmul:o_proj:L11                0.13     0.0
matmul:o_proj:L16                0.13     0.0
matmul:o_proj:L17                0.13     0.0
matmul:q_proj:L8                 0.13     0.0
matmul:o_proj:L9                 0.13     0.0
matmul:o_proj:L21                0.13     0.0
matmul:q_proj:L9                 0.13     0.0
matmul:q_proj:L12                0.13     0.0
matmul:q_proj:L25                0.12     0.0
matmul:q_proj:L19                0.12     0.0
matmul:o_proj:L20                0.12     0.0
matmul:o_proj:L5                 0.12     0.0
matmul:q_proj:L17                0.12     0.0
matmul:o_proj:L15                0.12     0.0
matmul:q_proj:L3                 0.12     0.0
matmul:q_proj:L15                0.12     0.0
matmul:q_proj:L22                0.12     0.0
matmul:q_proj:L10                0.12     0.0
matmul:q_proj:L1                 0.12     0.0
matmul:q_proj:L11                0.12     0.0
matmul:q_proj:L4                 0.12     0.0
matmul:q_proj:L5                 0.12     0.0
matmul:q_proj:L6                 0.12     0.0
matmul:q_proj:L21                0.12     0.0
matmul:q_proj:L16                0.11     0.0
matmul:k_proj:L18                0.07     0.0
sample_phase1                    0.07     0.0
matmul:v_proj:L7                 0.06     0.0
matmul:v_proj:L20                0.06     0.0
matmul:k_proj:L7                 0.06     0.0
matmul:k_proj:L20                0.06     0.0
matmul:v_proj:L18                0.06     0.0
matmul:v_proj:L13                0.06     0.0
matmul:k_proj:L13                0.06     0.0
sample_phase3                    0.06     0.0
matmul:k_proj:L24                0.06     0.0
matmul:v_proj:L24                0.06     0.0
matmul:k_proj:L2                 0.06     0.0
matmul:v_proj:L2                 0.05     0.0
matmul:k_proj:L23                0.05     0.0
matmul:v_proj:L23                0.05     0.0
matmul:k_proj:L0                 0.05     0.0
matmul:k_proj:L15                0.05     0.0
matmul:v_proj:L0                 0.05     0.0
matmul:v_proj:L12                0.05     0.0
matmul:v_proj:L14                0.05     0.0
matmul:k_proj:L14                0.05     0.0
matmul:k_proj:L3                 0.05     0.0
matmul:k_proj:L25                0.04     0.0
matmul:k_proj:L11                0.04     0.0
matmul:k_proj:L10                0.04     0.0
matmul:k_proj:L17                0.04     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:k_proj:L12                0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:k_proj:L1                 0.04     0.0
matmul:k_proj:L22                0.04     0.0
matmul:k_proj:L19                0.04     0.0
matmul:k_proj:L16                0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:k_proj:L4                 0.04     0.0
matmul:v_proj:L22                0.04     0.0
matmul:v_proj:L19                0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:k_proj:L5                 0.04     0.0
matmul:v_proj:L17                0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:k_proj:L21                0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:v_proj:L5                 0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:v_proj:L16                0.04     0.0
gather                           0.01     0.0
scale                            0.01     0.0
──────────────────────────────────────────────────
TOTAL                          683.16   100.0

[browser:warning] [32693.5ms][Profile] Batch decode (N=4):
[browser:warning] [32693.6ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      359.59    52.0
fused_ffn                       39.47     5.7
matmul:lm_head                  30.46     4.4
matmul_rmsnorm_fused:L11.ffn_down       10.55     1.5
matmul_rmsnorm_fused:L9.ffn_down       10.44     1.5
matmul_rmsnorm_fused:L12.ffn_down       10.38     1.5
matmul_rmsnorm_fused:L8.ffn_down       10.31     1.5
matmul_rmsnorm_fused:L25.ffn_down       10.29     1.5
matmul_rmsnorm_fused:L13.ffn_down       10.26     1.5
matmul_rmsnorm_fused:L24.ffn_down       10.25     1.5
matmul_rmsnorm_fused:L4.ffn_down       10.16     1.5
matmul_rmsnorm_fused:L16.ffn_down       10.06     1.5
matmul_rmsnorm_fused:L14.ffn_down        9.93     1.4
matmul_rmsnorm_fused:L7.ffn_down        9.88     1.4
matmul_rmsnorm_fused:L6.ffn_down        9.84     1.4
matmul_rmsnorm_fused:L21.ffn_down        9.40     1.4
matmul_rmsnorm_fused:L18.ffn_down        9.08     1.3
matmul_rmsnorm_fused:L3.ffn_down        8.91     1.3
matmul_rmsnorm_fused:L1.ffn_down        8.83     1.3
matmul_rmsnorm_fused:L23.ffn_down        8.83     1.3
matmul_rmsnorm_fused:L22.ffn_down        8.78     1.3
matmul_rmsnorm_fused:L5.ffn_down        8.72     1.3
matmul_rmsnorm_fused:L17.ffn_down        8.71     1.3
matmul_rmsnorm_fused:L20.ffn_down        8.70     1.3
matmul_rmsnorm_fused:L10.ffn_down        8.68     1.3
matmul_rmsnorm_fused:L2.ffn_down        8.67     1.3
matmul_rmsnorm_fused:L15.ffn_down        8.66     1.3
matmul_rmsnorm_fused:L19.ffn_down        8.65     1.3
matmul_rmsnorm_fused:L0.ffn_down        8.64     1.2
sample_phase2                    3.28     0.5
rmsnorm                          2.94     0.4
rope                             0.71     0.1
matmul:o_proj:L6                 0.18     0.0
matmul:o_proj:L1                 0.18     0.0
matmul:q_proj:L12                0.18     0.0
matmul:o_proj:L7                 0.16     0.0
matmul:q_proj:L22                0.16     0.0
matmul:o_proj:L21                0.16     0.0
matmul:o_proj:L16                0.16     0.0
matmul:o_proj:L5                 0.16     0.0
matmul:o_proj:L22                0.15     0.0
matmul:o_proj:L23                0.15     0.0
matmul:o_proj:L4                 0.15     0.0
matmul:o_proj:L3                 0.15     0.0
matmul:o_proj:L0                 0.14     0.0
matmul:o_proj:L13                0.14     0.0
matmul:q_proj:L19                0.14     0.0
matmul:o_proj:L9                 0.14     0.0
matmul:o_proj:L11                0.14     0.0
matmul:o_proj:L17                0.14     0.0
matmul:q_proj:L13                0.14     0.0
matmul:q_proj:L17                0.14     0.0
matmul:q_proj:L2                 0.14     0.0
matmul:o_proj:L12                0.14     0.0
matmul:o_proj:L10                0.14     0.0
matmul:o_proj:L18                0.13     0.0
matmul:o_proj:L2                 0.13     0.0
matmul:q_proj:L6                 0.13     0.0
matmul:q_proj:L15                0.13     0.0
matmul:o_proj:L15                0.13     0.0
matmul:o_proj:L19                0.13     0.0
matmul:o_proj:L8                 0.13     0.0
matmul:q_proj:L9                 0.13     0.0
matmul:o_proj:L24                0.13     0.0
matmul:q_proj:L20                0.13     0.0
matmul:q_proj:L10                0.13     0.0
matmul:o_proj:L25                0.13     0.0
matmul:o_proj:L20                0.13     0.0
matmul:q_proj:L23                0.13     0.0
matmul:q_proj:L0                 0.13     0.0
matmul:o_proj:L14                0.13     0.0
matmul:q_proj:L3                 0.13     0.0
matmul:q_proj:L18                0.13     0.0
matmul:q_proj:L11                0.12     0.0
matmul:q_proj:L14                0.12     0.0
matmul:q_proj:L7                 0.12     0.0
matmul:q_proj:L1                 0.12     0.0
matmul:q_proj:L5                 0.12     0.0
matmul:q_proj:L25                0.12     0.0
matmul:q_proj:L4                 0.12     0.0
matmul:q_proj:L24                0.12     0.0
matmul:q_proj:L8                 0.12     0.0
matmul:q_proj:L16                0.12     0.0
matmul:q_proj:L21                0.12     0.0
sample_phase1                    0.08     0.0
matmul:k_proj:L22                0.07     0.0
matmul:v_proj:L22                0.07     0.0
matmul:v_proj:L9                 0.07     0.0
sample_phase3                    0.06     0.0
matmul:k_proj:L12                0.06     0.0
matmul:k_proj:L19                0.05     0.0
matmul:v_proj:L19                0.05     0.0
matmul:v_proj:L17                0.05     0.0
matmul:v_proj:L15                0.05     0.0
matmul:k_proj:L15                0.05     0.0
matmul:k_proj:L17                0.05     0.0
matmul:v_proj:L12                0.05     0.0
matmul:k_proj:L25                0.05     0.0
matmul:k_proj:L13                0.05     0.0
matmul:k_proj:L2                 0.05     0.0
matmul:k_proj:L8                 0.05     0.0
matmul:k_proj:L9                 0.05     0.0
matmul:k_proj:L10                0.05     0.0
matmul:k_proj:L18                0.05     0.0
matmul:k_proj:L23                0.05     0.0
matmul:k_proj:L6                 0.05     0.0
matmul:v_proj:L0                 0.05     0.0
matmul:k_proj:L7                 0.05     0.0
matmul:k_proj:L3                 0.05     0.0
matmul:v_proj:L18                0.05     0.0
matmul:v_proj:L20                0.05     0.0
matmul:v_proj:L13                0.05     0.0
matmul:k_proj:L0                 0.04     0.0
matmul:k_proj:L16                0.04     0.0
matmul:k_proj:L21                0.04     0.0
matmul:k_proj:L1                 0.04     0.0
matmul:k_proj:L11                0.04     0.0
matmul:v_proj:L5                 0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:k_proj:L5                 0.04     0.0
matmul:k_proj:L20                0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:k_proj:L4                 0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:k_proj:L14                0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:v_proj:L14                0.04     0.0
matmul:k_proj:L24                0.04     0.0
matmul:v_proj:L16                0.04     0.0
matmul:v_proj:L24                0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:v_proj:L21                0.04     0.0
gather                           0.01     0.0
scale                            0.01     0.0
──────────────────────────────────────────────────
TOTAL                          691.80   100.0

[browser:warning] [33443.6ms][Profile] Batch decode (N=4):
[browser:warning] [33443.8ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      368.45    52.4
fused_ffn                       39.55     5.6
matmul:lm_head                  30.22     4.3
matmul_rmsnorm_fused:L3.ffn_down       10.97     1.6
matmul_rmsnorm_fused:L24.ffn_down       10.45     1.5
matmul_rmsnorm_fused:L8.ffn_down       10.26     1.5
matmul_rmsnorm_fused:L13.ffn_down       10.26     1.5
matmul_rmsnorm_fused:L15.ffn_down       10.25     1.5
matmul_rmsnorm_fused:L22.ffn_down       10.22     1.5
matmul_rmsnorm_fused:L14.ffn_down       10.14     1.4
matmul_rmsnorm_fused:L10.ffn_down       10.12     1.4
matmul_rmsnorm_fused:L18.ffn_down       10.06     1.4
matmul_rmsnorm_fused:L0.ffn_down        9.84     1.4
matmul_rmsnorm_fused:L1.ffn_down        9.72     1.4
matmul_rmsnorm_fused:L5.ffn_down        9.70     1.4
matmul_rmsnorm_fused:L17.ffn_down        9.69     1.4
matmul_rmsnorm_fused:L12.ffn_down        9.59     1.4
matmul_rmsnorm_fused:L20.ffn_down        9.39     1.3
matmul_rmsnorm_fused:L19.ffn_down        9.12     1.3
matmul_rmsnorm_fused:L9.ffn_down        8.97     1.3
matmul_rmsnorm_fused:L2.ffn_down        8.78     1.2
matmul_rmsnorm_fused:L6.ffn_down        8.78     1.2
matmul_rmsnorm_fused:L23.ffn_down        8.70     1.2
matmul_rmsnorm_fused:L16.ffn_down        8.68     1.2
matmul_rmsnorm_fused:L11.ffn_down        8.67     1.2
matmul_rmsnorm_fused:L25.ffn_down        8.66     1.2
matmul_rmsnorm_fused:L21.ffn_down        8.65     1.2
matmul_rmsnorm_fused:L7.ffn_down        8.64     1.2
matmul_rmsnorm_fused:L4.ffn_down        8.63     1.2
rmsnorm                          3.51     0.5
sample_phase2                    3.28     0.5
rope                             0.80     0.1
matmul:q_proj:L23                0.60     0.1
matmul:q_proj:L0                 0.17     0.0
matmul:o_proj:L12                0.17     0.0
matmul:o_proj:L17                0.16     0.0
matmul:q_proj:L4                 0.16     0.0
matmul:o_proj:L19                0.16     0.0
matmul:o_proj:L9                 0.16     0.0
matmul:o_proj:L0                 0.16     0.0
matmul:o_proj:L14                0.16     0.0
matmul:q_proj:L21                0.15     0.0
matmul:o_proj:L10                0.15     0.0
matmul:o_proj:L11                0.15     0.0
matmul:o_proj:L21                0.15     0.0
matmul:o_proj:L5                 0.15     0.0
matmul:o_proj:L23                0.15     0.0
matmul:o_proj:L24                0.15     0.0
matmul:o_proj:L3                 0.14     0.0
matmul:q_proj:L15                0.14     0.0
matmul:q_proj:L7                 0.14     0.0
matmul:o_proj:L18                0.14     0.0
matmul:o_proj:L8                 0.14     0.0
matmul:o_proj:L22                0.14     0.0
matmul:q_proj:L19                0.14     0.0
matmul:q_proj:L3                 0.14     0.0
matmul:o_proj:L6                 0.14     0.0
matmul:o_proj:L4                 0.14     0.0
matmul:o_proj:L13                0.14     0.0
matmul:q_proj:L2                 0.14     0.0
matmul:o_proj:L16                0.14     0.0
matmul:q_proj:L16                0.14     0.0
matmul:q_proj:L14                0.14     0.0
matmul:o_proj:L7                 0.13     0.0
matmul:o_proj:L2                 0.13     0.0
matmul:o_proj:L25                0.13     0.0
matmul:o_proj:L15                0.13     0.0
matmul:q_proj:L18                0.13     0.0
matmul:q_proj:L13                0.13     0.0
matmul:o_proj:L1                 0.13     0.0
matmul:q_proj:L9                 0.13     0.0
matmul:q_proj:L22                0.13     0.0
matmul:q_proj:L8                 0.13     0.0
matmul:q_proj:L5                 0.13     0.0
matmul:q_proj:L12                0.13     0.0
matmul:o_proj:L20                0.12     0.0
matmul:q_proj:L24                0.12     0.0
matmul:q_proj:L1                 0.12     0.0
matmul:q_proj:L11                0.12     0.0
matmul:q_proj:L10                0.12     0.0
matmul:q_proj:L6                 0.12     0.0
matmul:q_proj:L25                0.12     0.0
matmul:q_proj:L20                0.12     0.0
matmul:q_proj:L17                0.12     0.0
matmul:v_proj:L23                0.10     0.0
matmul:k_proj:L23                0.09     0.0
sample_phase1                    0.08     0.0
matmul:k_proj:L21                0.07     0.0
matmul:k_proj:L4                 0.07     0.0
matmul:v_proj:L4                 0.07     0.0
matmul:v_proj:L21                0.06     0.0
matmul:k_proj:L0                 0.06     0.0
matmul:v_proj:L0                 0.06     0.0
sample_phase3                    0.06     0.0
matmul:k_proj:L2                 0.06     0.0
matmul:k_proj:L7                 0.06     0.0
matmul:v_proj:L19                0.06     0.0
matmul:v_proj:L14                0.05     0.0
matmul:k_proj:L16                0.05     0.0
matmul:v_proj:L2                 0.05     0.0
matmul:k_proj:L14                0.05     0.0
matmul:k_proj:L19                0.05     0.0
matmul:k_proj:L15                0.05     0.0
matmul:v_proj:L16                0.05     0.0
matmul:k_proj:L8                 0.05     0.0
matmul:k_proj:L17                0.05     0.0
matmul:k_proj:L3                 0.05     0.0
matmul:v_proj:L15                0.05     0.0
matmul:k_proj:L13                0.05     0.0
matmul:k_proj:L25                0.05     0.0
matmul:k_proj:L18                0.05     0.0
matmul:k_proj:L9                 0.05     0.0
matmul:v_proj:L18                0.05     0.0
matmul:v_proj:L9                 0.05     0.0
matmul:k_proj:L1                 0.04     0.0
matmul:k_proj:L10                0.04     0.0
matmul:k_proj:L11                0.04     0.0
matmul:k_proj:L22                0.04     0.0
matmul:k_proj:L12                0.04     0.0
matmul:k_proj:L20                0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:v_proj:L22                0.04     0.0
matmul:k_proj:L24                0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:v_proj:L5                 0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:k_proj:L5                 0.04     0.0
matmul:v_proj:L17                0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:v_proj:L24                0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:v_proj:L25                0.04     0.0
gather                           0.03     0.0
scale                            0.02     0.0
──────────────────────────────────────────────────
TOTAL                          703.26   100.0

[browser:warning] [34204.0ms][Profile] Batch decode (N=4):
[browser:warning] [34204.1ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      378.69    53.1
fused_ffn                       39.70     5.6
matmul:lm_head                  30.61     4.3
matmul_rmsnorm_fused:L0.ffn_down       11.97     1.7
matmul_rmsnorm_fused:L15.ffn_down       10.43     1.5
matmul_rmsnorm_fused:L25.ffn_down       10.33     1.4
matmul_rmsnorm_fused:L16.ffn_down       10.25     1.4
matmul_rmsnorm_fused:L22.ffn_down       10.24     1.4
matmul_rmsnorm_fused:L17.ffn_down       10.22     1.4
matmul_rmsnorm_fused:L20.ffn_down       10.04     1.4
matmul_rmsnorm_fused:L9.ffn_down        9.90     1.4
matmul_rmsnorm_fused:L14.ffn_down        9.80     1.4
matmul_rmsnorm_fused:L19.ffn_down        9.79     1.4
matmul_rmsnorm_fused:L2.ffn_down        9.78     1.4
matmul_rmsnorm_fused:L4.ffn_down        9.68     1.4
matmul_rmsnorm_fused:L5.ffn_down        9.38     1.3
matmul_rmsnorm_fused:L10.ffn_down        9.38     1.3
matmul_rmsnorm_fused:L24.ffn_down        9.33     1.3
matmul_rmsnorm_fused:L12.ffn_down        9.17     1.3
matmul_rmsnorm_fused:L21.ffn_down        9.02     1.3
matmul_rmsnorm_fused:L7.ffn_down        8.80     1.2
matmul_rmsnorm_fused:L1.ffn_down        8.73     1.2
matmul_rmsnorm_fused:L18.ffn_down        8.69     1.2
matmul_rmsnorm_fused:L6.ffn_down        8.67     1.2
matmul_rmsnorm_fused:L3.ffn_down        8.66     1.2
matmul_rmsnorm_fused:L8.ffn_down        8.64     1.2
matmul_rmsnorm_fused:L23.ffn_down        8.64     1.2
matmul_rmsnorm_fused:L11.ffn_down        8.63     1.2
matmul_rmsnorm_fused:L13.ffn_down        8.61     1.2
sample_phase2                    3.29     0.5
rmsnorm                          3.10     0.4
rope                             0.73     0.1
matmul:o_proj:L3                 0.32     0.0
matmul:q_proj:L0                 0.18     0.0
matmul:o_proj:L5                 0.17     0.0
matmul:o_proj:L10                0.17     0.0
matmul:o_proj:L4                 0.16     0.0
matmul:o_proj:L19                0.16     0.0
matmul:o_proj:L12                0.16     0.0
matmul:o_proj:L0                 0.15     0.0
matmul:q_proj:L25                0.15     0.0
matmul:o_proj:L2                 0.15     0.0
matmul:o_proj:L18                0.15     0.0
matmul:o_proj:L11                0.15     0.0
matmul:q_proj:L11                0.15     0.0
matmul:o_proj:L9                 0.15     0.0
matmul:o_proj:L16                0.15     0.0
matmul:q_proj:L1                 0.15     0.0
matmul:o_proj:L6                 0.14     0.0
matmul:o_proj:L8                 0.14     0.0
matmul:o_proj:L14                0.14     0.0
matmul:o_proj:L7                 0.14     0.0
matmul:o_proj:L25                0.14     0.0
matmul:o_proj:L20                0.14     0.0
matmul:o_proj:L21                0.14     0.0
matmul:o_proj:L22                0.14     0.0
matmul:q_proj:L16                0.13     0.0
matmul:o_proj:L17                0.13     0.0
matmul:o_proj:L24                0.13     0.0
matmul:o_proj:L1                 0.13     0.0
matmul:o_proj:L15                0.13     0.0
matmul:o_proj:L13                0.13     0.0
matmul:q_proj:L15                0.13     0.0
matmul:q_proj:L10                0.12     0.0
matmul:q_proj:L9                 0.12     0.0
matmul:q_proj:L22                0.12     0.0
matmul:q_proj:L19                0.12     0.0
matmul:q_proj:L4                 0.12     0.0
matmul:o_proj:L23                0.12     0.0
matmul:q_proj:L17                0.12     0.0
matmul:q_proj:L20                0.12     0.0
matmul:q_proj:L21                0.12     0.0
matmul:q_proj:L18                0.12     0.0
matmul:q_proj:L5                 0.12     0.0
matmul:q_proj:L23                0.12     0.0
matmul:q_proj:L2                 0.12     0.0
matmul:q_proj:L8                 0.12     0.0
matmul:q_proj:L12                0.12     0.0
matmul:q_proj:L6                 0.12     0.0
matmul:q_proj:L3                 0.12     0.0
matmul:q_proj:L7                 0.12     0.0
matmul:q_proj:L24                0.12     0.0
matmul:q_proj:L13                0.12     0.0
matmul:q_proj:L14                0.12     0.0
sample_phase1                    0.09     0.0
matmul:k_proj:L0                 0.06     0.0
sample_phase3                    0.06     0.0
matmul:v_proj:L0                 0.06     0.0
matmul:v_proj:L11                0.06     0.0
matmul:v_proj:L25                0.06     0.0
matmul:k_proj:L11                0.06     0.0
matmul:k_proj:L25                0.06     0.0
matmul:k_proj:L1                 0.05     0.0
matmul:v_proj:L1                 0.05     0.0
matmul:k_proj:L3                 0.05     0.0
matmul:k_proj:L9                 0.05     0.0
matmul:k_proj:L8                 0.05     0.0
matmul:k_proj:L16                0.05     0.0
matmul:v_proj:L6                 0.05     0.0
matmul:k_proj:L21                0.05     0.0
matmul:k_proj:L10                0.04     0.0
matmul:v_proj:L16                0.04     0.0
matmul:k_proj:L15                0.04     0.0
matmul:k_proj:L4                 0.04     0.0
matmul:k_proj:L7                 0.04     0.0
matmul:k_proj:L22                0.04     0.0
matmul:k_proj:L12                0.04     0.0
matmul:k_proj:L2                 0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:k_proj:L17                0.04     0.0
matmul:k_proj:L20                0.04     0.0
matmul:k_proj:L19                0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:k_proj:L13                0.04     0.0
matmul:k_proj:L18                0.04     0.0
matmul:k_proj:L24                0.04     0.0
matmul:k_proj:L5                 0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:k_proj:L23                0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:v_proj:L5                 0.04     0.0
matmul:v_proj:L18                0.04     0.0
matmul:v_proj:L22                0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:v_proj:L14                0.04     0.0
matmul:v_proj:L24                0.04     0.0
matmul:v_proj:L19                0.04     0.0
matmul:v_proj:L17                0.04     0.0
matmul:k_proj:L14                0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:v_proj:L23                0.04     0.0
gather                           0.03     0.0
scale                            0.02     0.0
──────────────────────────────────────────────────
TOTAL                          712.72   100.0

[browser:warning] [34963.3ms][Profile] Batch decode (N=4):
[browser:warning] [34963.4ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      383.18    53.7
fused_ffn                       39.76     5.6
matmul:lm_head                  30.32     4.3
matmul_rmsnorm_fused:L23.ffn_down       10.38     1.5
matmul_rmsnorm_fused:L11.ffn_down       10.36     1.5
matmul_rmsnorm_fused:L15.ffn_down       10.26     1.4
matmul_rmsnorm_fused:L21.ffn_down       10.24     1.4
matmul_rmsnorm_fused:L18.ffn_down       10.12     1.4
matmul_rmsnorm_fused:L20.ffn_down       10.10     1.4
matmul_rmsnorm_fused:L25.ffn_down       10.00     1.4
matmul_rmsnorm_fused:L6.ffn_down        9.72     1.4
matmul_rmsnorm_fused:L5.ffn_down        9.64     1.4
matmul_rmsnorm_fused:L3.ffn_down        9.45     1.3
matmul_rmsnorm_fused:L2.ffn_down        9.37     1.3
matmul_rmsnorm_fused:L10.ffn_down        9.24     1.3
matmul_rmsnorm_fused:L0.ffn_down        9.19     1.3
matmul_rmsnorm_fused:L13.ffn_down        9.18     1.3
matmul_rmsnorm_fused:L17.ffn_down        9.15     1.3
matmul_rmsnorm_fused:L16.ffn_down        9.01     1.3
matmul_rmsnorm_fused:L12.ffn_down        8.97     1.3
matmul_rmsnorm_fused:L22.ffn_down        8.97     1.3
matmul_rmsnorm_fused:L9.ffn_down        8.80     1.2
matmul_rmsnorm_fused:L14.ffn_down        8.68     1.2
matmul_rmsnorm_fused:L19.ffn_down        8.68     1.2
matmul_rmsnorm_fused:L1.ffn_down        8.67     1.2
matmul_rmsnorm_fused:L7.ffn_down        8.64     1.2
matmul_rmsnorm_fused:L8.ffn_down        8.64     1.2
matmul_rmsnorm_fused:L24.ffn_down        8.64     1.2
matmul_rmsnorm_fused:L4.ffn_down        8.61     1.2
rmsnorm                          3.60     0.5
sample_phase2                    3.28     0.5
rope                             0.64     0.1
matmul:o_proj:L0                 0.19     0.0
matmul:o_proj:L3                 0.19     0.0
matmul:o_proj:L25                0.18     0.0
matmul:o_proj:L20                0.17     0.0
matmul:o_proj:L13                0.16     0.0
matmul:o_proj:L12                0.16     0.0
matmul:o_proj:L2                 0.16     0.0
matmul:o_proj:L5                 0.16     0.0
matmul:o_proj:L6                 0.16     0.0
matmul:o_proj:L10                0.16     0.0
matmul:o_proj:L21                0.16     0.0
matmul:o_proj:L22                0.16     0.0
matmul:o_proj:L11                0.15     0.0
matmul:o_proj:L15                0.15     0.0
matmul:o_proj:L16                0.15     0.0
matmul:o_proj:L9                 0.15     0.0
matmul:q_proj:L18                0.15     0.0
matmul:o_proj:L23                0.14     0.0
matmul:o_proj:L17                0.14     0.0
matmul:o_proj:L18                0.14     0.0
matmul:o_proj:L8                 0.14     0.0
matmul:q_proj:L22                0.14     0.0
matmul:o_proj:L1                 0.14     0.0
matmul:o_proj:L7                 0.14     0.0
matmul:q_proj:L0                 0.14     0.0
matmul:o_proj:L24                0.14     0.0
matmul:q_proj:L16                0.13     0.0
matmul:o_proj:L19                0.13     0.0
matmul:q_proj:L9                 0.13     0.0
matmul:o_proj:L4                 0.13     0.0
matmul:q_proj:L13                0.13     0.0
matmul:q_proj:L11                0.13     0.0
matmul:q_proj:L21                0.13     0.0
matmul:q_proj:L12                0.13     0.0
matmul:q_proj:L6                 0.12     0.0
matmul:q_proj:L25                0.12     0.0
matmul:q_proj:L20                0.12     0.0
matmul:o_proj:L14                0.12     0.0
matmul:q_proj:L8                 0.12     0.0
matmul:q_proj:L1                 0.12     0.0
matmul:q_proj:L7                 0.12     0.0
matmul:q_proj:L24                0.12     0.0
matmul:q_proj:L15                0.12     0.0
matmul:q_proj:L3                 0.12     0.0
matmul:q_proj:L2                 0.12     0.0
matmul:q_proj:L23                0.12     0.0
matmul:q_proj:L10                0.12     0.0
matmul:q_proj:L17                0.12     0.0
matmul:q_proj:L5                 0.12     0.0
matmul:q_proj:L4                 0.12     0.0
matmul:q_proj:L19                0.12     0.0
matmul:q_proj:L14                0.12     0.0
sample_phase1                    0.08     0.0
sample_phase3                    0.06     0.0
matmul:k_proj:L22                0.05     0.0
matmul:v_proj:L22                0.05     0.0
matmul:k_proj:L18                0.05     0.0
matmul:v_proj:L12                0.05     0.0
matmul:v_proj:L18                0.05     0.0
matmul:k_proj:L0                 0.05     0.0
matmul:k_proj:L14                0.05     0.0
matmul:k_proj:L13                0.05     0.0
matmul:k_proj:L12                0.05     0.0
matmul:k_proj:L25                0.05     0.0
matmul:v_proj:L0                 0.05     0.0
matmul:k_proj:L10                0.05     0.0
matmul:k_proj:L1                 0.05     0.0
matmul:k_proj:L21                0.04     0.0
matmul:k_proj:L15                0.04     0.0
matmul:k_proj:L11                0.04     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:k_proj:L4                 0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:k_proj:L16                0.04     0.0
matmul:k_proj:L2                 0.04     0.0
matmul:k_proj:L3                 0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:k_proj:L17                0.04     0.0
matmul:k_proj:L7                 0.04     0.0
matmul:k_proj:L23                0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:v_proj:L16                0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:v_proj:L24                0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:k_proj:L20                0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:k_proj:L5                 0.04     0.0
matmul:v_proj:L14                0.04     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:v_proj:L17                0.04     0.0
matmul:k_proj:L24                0.04     0.0
matmul:k_proj:L19                0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:v_proj:L5                 0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:v_proj:L19                0.04     0.0
gather                           0.01     0.0
scale                            0.01     0.0
──────────────────────────────────────────────────
TOTAL                          713.17   100.0

[browser:warning] [35724.9ms][Profile] Batch decode (N=4):
[browser:warning] [35725.1ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      392.39    55.0
fused_ffn                       39.19     5.5
matmul:lm_head                  30.87     4.3
matmul_rmsnorm_fused:L18.ffn_down       10.31     1.4
matmul_rmsnorm_fused:L11.ffn_down       10.26     1.4
matmul_rmsnorm_fused:L21.ffn_down        9.87     1.4
matmul_rmsnorm_fused:L8.ffn_down        9.70     1.4
matmul_rmsnorm_fused:L22.ffn_down        9.53     1.3
matmul_rmsnorm_fused:L17.ffn_down        9.46     1.3
matmul_rmsnorm_fused:L23.ffn_down        9.14     1.3
matmul_rmsnorm_fused:L2.ffn_down        9.06     1.3
matmul_rmsnorm_fused:L9.ffn_down        9.02     1.3
matmul_rmsnorm_fused:L16.ffn_down        8.99     1.3
matmul_rmsnorm_fused:L24.ffn_down        8.95     1.3
matmul_rmsnorm_fused:L6.ffn_down        8.90     1.2
matmul_rmsnorm_fused:L3.ffn_down        8.87     1.2
matmul_rmsnorm_fused:L19.ffn_down        8.86     1.2
matmul_rmsnorm_fused:L14.ffn_down        8.82     1.2
matmul_rmsnorm_fused:L15.ffn_down        8.76     1.2
matmul_rmsnorm_fused:L12.ffn_down        8.73     1.2
matmul_rmsnorm_fused:L1.ffn_down        8.69     1.2
matmul_rmsnorm_fused:L7.ffn_down        8.66     1.2
matmul_rmsnorm_fused:L5.ffn_down        8.64     1.2
matmul_rmsnorm_fused:L25.ffn_down        8.64     1.2
matmul_rmsnorm_fused:L10.ffn_down        8.63     1.2
matmul_rmsnorm_fused:L0.ffn_down        8.63     1.2
matmul_rmsnorm_fused:L4.ffn_down        8.63     1.2
matmul_rmsnorm_fused:L20.ffn_down        8.62     1.2
matmul_rmsnorm_fused:L13.ffn_down        8.62     1.2
sample_phase2                    3.27     0.5
rmsnorm                          3.05     0.4
rope                             0.70     0.1
matmul:q_proj:L0                 0.17     0.0
matmul:o_proj:L23                0.16     0.0
matmul:o_proj:L22                0.16     0.0
matmul:o_proj:L17                0.16     0.0
matmul:o_proj:L21                0.15     0.0
matmul:o_proj:L3                 0.15     0.0
matmul:o_proj:L12                0.15     0.0
matmul:o_proj:L14                0.15     0.0
matmul:o_proj:L8                 0.14     0.0
matmul:o_proj:L18                0.14     0.0
matmul:o_proj:L6                 0.14     0.0
matmul:o_proj:L19                0.14     0.0
matmul:o_proj:L16                0.14     0.0
matmul:q_proj:L16                0.14     0.0
matmul:o_proj:L24                0.14     0.0
matmul:q_proj:L12                0.14     0.0
matmul:o_proj:L7                 0.14     0.0
matmul:o_proj:L2                 0.14     0.0
matmul:o_proj:L9                 0.14     0.0
matmul:o_proj:L0                 0.14     0.0
matmul:q_proj:L15                0.14     0.0
matmul:o_proj:L15                0.14     0.0
matmul:q_proj:L4                 0.13     0.0
matmul:o_proj:L13                0.13     0.0
matmul:q_proj:L3                 0.13     0.0
matmul:o_proj:L11                0.13     0.0
matmul:o_proj:L1                 0.13     0.0
matmul:q_proj:L19                0.13     0.0
matmul:q_proj:L9                 0.13     0.0
matmul:q_proj:L2                 0.13     0.0
matmul:o_proj:L25                0.13     0.0
matmul:q_proj:L6                 0.13     0.0
matmul:q_proj:L8                 0.12     0.0
matmul:q_proj:L22                0.12     0.0
matmul:o_proj:L4                 0.12     0.0
matmul:o_proj:L5                 0.12     0.0
matmul:q_proj:L1                 0.12     0.0
matmul:o_proj:L10                0.12     0.0
matmul:q_proj:L7                 0.12     0.0
matmul:q_proj:L23                0.12     0.0
matmul:q_proj:L13                0.12     0.0
matmul:q_proj:L10                0.12     0.0
matmul:q_proj:L18                0.12     0.0
matmul:q_proj:L14                0.12     0.0
matmul:o_proj:L20                0.12     0.0
matmul:q_proj:L25                0.12     0.0
matmul:q_proj:L11                0.12     0.0
matmul:q_proj:L21                0.12     0.0
matmul:q_proj:L5                 0.12     0.0
matmul:q_proj:L17                0.12     0.0
matmul:q_proj:L24                0.12     0.0
matmul:q_proj:L20                0.12     0.0
sample_phase1                    0.08     0.0
matmul:k_proj:L0                 0.06     0.0
matmul:v_proj:L0                 0.06     0.0
sample_phase3                    0.06     0.0
matmul:k_proj:L4                 0.06     0.0
matmul:v_proj:L4                 0.05     0.0
matmul:k_proj:L12                0.05     0.0
matmul:v_proj:L12                0.05     0.0
matmul:k_proj:L3                 0.05     0.0
matmul:k_proj:L16                0.05     0.0
matmul:k_proj:L15                0.05     0.0
matmul:v_proj:L3                 0.05     0.0
matmul:v_proj:L16                0.05     0.0
matmul:k_proj:L7                 0.05     0.0
matmul:k_proj:L13                0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:k_proj:L23                0.04     0.0
matmul:k_proj:L19                0.04     0.0
matmul:k_proj:L2                 0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:k_proj:L1                 0.04     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:k_proj:L11                0.04     0.0
matmul:v_proj:L19                0.04     0.0
matmul:k_proj:L21                0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:k_proj:L10                0.04     0.0
matmul:k_proj:L18                0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:k_proj:L17                0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:v_proj:L18                0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:v_proj:L22                0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:k_proj:L22                0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:k_proj:L14                0.04     0.0
matmul:k_proj:L24                0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:k_proj:L20                0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:v_proj:L5                 0.04     0.0
matmul:v_proj:L14                0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:v_proj:L24                0.04     0.0
matmul:k_proj:L5                 0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:v_proj:L17                0.04     0.0
gather                           0.03     0.0
scale                            0.02     0.0
──────────────────────────────────────────────────
TOTAL                          713.91   100.0

[browser:warning] [36492.7ms][Profile] Batch decode (N=4):
[browser:warning] [36492.8ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      399.54    55.6
fused_ffn                       39.27     5.5
matmul:lm_head                  30.37     4.2
matmul_rmsnorm_fused:L14.ffn_down       10.11     1.4
matmul_rmsnorm_fused:L3.ffn_down       10.01     1.4
matmul_rmsnorm_fused:L13.ffn_down        9.68     1.3
matmul_rmsnorm_fused:L8.ffn_down        9.50     1.3
matmul_rmsnorm_fused:L1.ffn_down        9.36     1.3
matmul_rmsnorm_fused:L18.ffn_down        9.09     1.3
matmul_rmsnorm_fused:L5.ffn_down        9.08     1.3
matmul_rmsnorm_fused:L21.ffn_down        8.96     1.2
matmul_rmsnorm_fused:L23.ffn_down        8.96     1.2
matmul_rmsnorm_fused:L22.ffn_down        8.84     1.2
matmul_rmsnorm_fused:L4.ffn_down        8.83     1.2
matmul_rmsnorm_fused:L17.ffn_down        8.79     1.2
matmul_rmsnorm_fused:L6.ffn_down        8.74     1.2
matmul_rmsnorm_fused:L10.ffn_down        8.73     1.2
matmul_rmsnorm_fused:L24.ffn_down        8.70     1.2
matmul_rmsnorm_fused:L15.ffn_down        8.69     1.2
matmul_rmsnorm_fused:L11.ffn_down        8.68     1.2
matmul_rmsnorm_fused:L2.ffn_down        8.66     1.2
matmul_rmsnorm_fused:L12.ffn_down        8.66     1.2
matmul_rmsnorm_fused:L25.ffn_down        8.66     1.2
matmul_rmsnorm_fused:L16.ffn_down        8.65     1.2
matmul_rmsnorm_fused:L20.ffn_down        8.65     1.2
matmul_rmsnorm_fused:L7.ffn_down        8.65     1.2
matmul_rmsnorm_fused:L9.ffn_down        8.65     1.2
matmul_rmsnorm_fused:L0.ffn_down        8.61     1.2
matmul_rmsnorm_fused:L19.ffn_down        8.60     1.2
sample_phase2                    3.35     0.5
rmsnorm                          3.01     0.4
rope                             0.69     0.1
matmul:q_proj:L0                 0.19     0.0
matmul:o_proj:L21                0.17     0.0
matmul:o_proj:L8                 0.17     0.0
matmul:o_proj:L1                 0.17     0.0
matmul:o_proj:L22                0.16     0.0
matmul:q_proj:L6                 0.16     0.0
matmul:o_proj:L0                 0.16     0.0
matmul:o_proj:L24                0.15     0.0
matmul:o_proj:L13                0.15     0.0
matmul:o_proj:L12                0.15     0.0
matmul:o_proj:L17                0.15     0.0
matmul:o_proj:L10                0.14     0.0
matmul:o_proj:L15                0.14     0.0
matmul:o_proj:L7                 0.14     0.0
matmul:o_proj:L18                0.14     0.0
matmul:o_proj:L14                0.14     0.0
matmul:o_proj:L11                0.14     0.0
matmul:o_proj:L6                 0.14     0.0
matmul:o_proj:L23                0.14     0.0
matmul:o_proj:L4                 0.14     0.0
matmul:q_proj:L4                 0.14     0.0
matmul:q_proj:L22                0.13     0.0
matmul:o_proj:L16                0.13     0.0
matmul:o_proj:L25                0.13     0.0
matmul:o_proj:L19                0.13     0.0
matmul:o_proj:L3                 0.13     0.0
matmul:o_proj:L2                 0.13     0.0
matmul:q_proj:L7                 0.13     0.0
matmul:o_proj:L20                0.13     0.0
matmul:q_proj:L21                0.13     0.0
matmul:o_proj:L9                 0.13     0.0
matmul:q_proj:L13                0.13     0.0
matmul:q_proj:L16                0.12     0.0
matmul:o_proj:L5                 0.12     0.0
matmul:q_proj:L1                 0.12     0.0
matmul:q_proj:L11                0.12     0.0
matmul:q_proj:L8                 0.12     0.0
matmul:q_proj:L9                 0.12     0.0
matmul:q_proj:L3                 0.12     0.0
matmul:q_proj:L2                 0.12     0.0
matmul:q_proj:L23                0.12     0.0
matmul:q_proj:L12                0.12     0.0
matmul:q_proj:L24                0.12     0.0
matmul:q_proj:L15                0.12     0.0
matmul:q_proj:L18                0.12     0.0
matmul:q_proj:L20                0.12     0.0
matmul:q_proj:L19                0.12     0.0
matmul:q_proj:L14                0.12     0.0
matmul:q_proj:L5                 0.12     0.0
matmul:q_proj:L10                0.12     0.0
matmul:q_proj:L25                0.12     0.0
matmul:q_proj:L17                0.12     0.0
sample_phase1                    0.09     0.0
sample_phase3                    0.07     0.0
matmul:k_proj:L0                 0.07     0.0
matmul:v_proj:L0                 0.06     0.0
matmul:k_proj:L6                 0.06     0.0
matmul:v_proj:L6                 0.06     0.0
matmul:k_proj:L4                 0.05     0.0
matmul:v_proj:L4                 0.05     0.0
matmul:k_proj:L2                 0.05     0.0
matmul:k_proj:L18                0.05     0.0
matmul:k_proj:L1                 0.05     0.0
matmul:k_proj:L3                 0.05     0.0
matmul:v_proj:L2                 0.05     0.0
matmul:k_proj:L21                0.05     0.0
matmul:k_proj:L7                 0.05     0.0
matmul:k_proj:L15                0.05     0.0
matmul:k_proj:L16                0.05     0.0
matmul:k_proj:L22                0.05     0.0
matmul:k_proj:L13                0.04     0.0
matmul:k_proj:L23                0.04     0.0
matmul:k_proj:L11                0.04     0.0
matmul:v_proj:L22                0.04     0.0
matmul:k_proj:L10                0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:k_proj:L17                0.04     0.0
matmul:k_proj:L24                0.04     0.0
matmul:k_proj:L12                0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:k_proj:L14                0.04     0.0
matmul:k_proj:L19                0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:v_proj:L16                0.04     0.0
matmul:v_proj:L18                0.04     0.0
matmul:v_proj:L5                 0.04     0.0
matmul:k_proj:L5                 0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:v_proj:L19                0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:k_proj:L20                0.04     0.0
matmul:v_proj:L17                0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:v_proj:L24                0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:v_proj:L14                0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:v_proj:L25                0.04     0.0
gather                           0.03     0.0
scale                            0.02     0.0
──────────────────────────────────────────────────
TOTAL                          718.37   100.0

[browser:warning] [37271.4ms][Profile] Batch decode (N=4):
[browser:warning] [37271.5ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      402.84    55.0
fused_ffn                       39.26     5.4
matmul:lm_head                  30.23     4.1
matmul_rmsnorm_fused:L8.ffn_down       11.80     1.6
matmul_rmsnorm_fused:L13.ffn_down       10.93     1.5
matmul_rmsnorm_fused:L18.ffn_down       10.83     1.5
matmul_rmsnorm_fused:L23.ffn_down       10.71     1.5
matmul_rmsnorm_fused:L15.ffn_down       10.18     1.4
matmul_rmsnorm_fused:L5.ffn_down       10.07     1.4
matmul_rmsnorm_fused:L0.ffn_down        9.76     1.3
matmul_rmsnorm_fused:L11.ffn_down        9.75     1.3
matmul_rmsnorm_fused:L10.ffn_down        9.72     1.3
matmul_rmsnorm_fused:L3.ffn_down        9.60     1.3
matmul_rmsnorm_fused:L20.ffn_down        9.27     1.3
matmul_rmsnorm_fused:L25.ffn_down        8.98     1.2
matmul_rmsnorm_fused:L1.ffn_down        8.71     1.2
matmul_rmsnorm_fused:L7.ffn_down        8.70     1.2
matmul_rmsnorm_fused:L12.ffn_down        8.68     1.2
matmul_rmsnorm_fused:L2.ffn_down        8.68     1.2
matmul_rmsnorm_fused:L22.ffn_down        8.68     1.2
matmul_rmsnorm_fused:L14.ffn_down        8.67     1.2
matmul_rmsnorm_fused:L19.ffn_down        8.67     1.2
matmul_rmsnorm_fused:L17.ffn_down        8.67     1.2
matmul_rmsnorm_fused:L16.ffn_down        8.64     1.2
matmul_rmsnorm_fused:L9.ffn_down        8.64     1.2
matmul_rmsnorm_fused:L24.ffn_down        8.64     1.2
matmul_rmsnorm_fused:L4.ffn_down        8.64     1.2
matmul_rmsnorm_fused:L21.ffn_down        8.61     1.2
matmul_rmsnorm_fused:L6.ffn_down        8.60     1.2
sample_phase2                    3.28     0.4
rmsnorm                          3.08     0.4
rope                             0.78     0.1
matmul:q_proj:L0                 0.19     0.0
matmul:o_proj:L18                0.19     0.0
matmul:o_proj:L13                0.18     0.0
matmul:o_proj:L15                0.17     0.0
matmul:o_proj:L20                0.16     0.0
matmul:o_proj:L11                0.16     0.0
matmul:q_proj:L4                 0.16     0.0
matmul:o_proj:L25                0.15     0.0
matmul:o_proj:L2                 0.15     0.0
matmul:q_proj:L11                0.15     0.0
matmul:o_proj:L23                0.14     0.0
matmul:o_proj:L0                 0.14     0.0
matmul:o_proj:L9                 0.14     0.0
matmul:o_proj:L3                 0.14     0.0
matmul:o_proj:L17                0.14     0.0
matmul:q_proj:L9                 0.14     0.0
matmul:o_proj:L8                 0.14     0.0
matmul:o_proj:L1                 0.14     0.0
matmul:o_proj:L4                 0.14     0.0
matmul:q_proj:L8                 0.14     0.0
matmul:q_proj:L1                 0.13     0.0
matmul:q_proj:L6                 0.13     0.0
matmul:q_proj:L19                0.13     0.0
matmul:o_proj:L19                0.13     0.0
matmul:o_proj:L6                 0.13     0.0
matmul:o_proj:L7                 0.13     0.0
matmul:o_proj:L10                0.13     0.0
matmul:q_proj:L16                0.13     0.0
matmul:o_proj:L22                0.13     0.0
matmul:o_proj:L12                0.13     0.0
matmul:q_proj:L3                 0.13     0.0
matmul:o_proj:L14                0.13     0.0
matmul:o_proj:L24                0.13     0.0
matmul:o_proj:L16                0.13     0.0
matmul:o_proj:L5                 0.13     0.0
matmul:q_proj:L24                0.13     0.0
matmul:q_proj:L10                0.13     0.0
matmul:o_proj:L21                0.13     0.0
matmul:q_proj:L13                0.12     0.0
matmul:q_proj:L25                0.12     0.0
matmul:q_proj:L15                0.12     0.0
matmul:q_proj:L20                0.12     0.0
matmul:q_proj:L22                0.12     0.0
matmul:q_proj:L21                0.12     0.0
matmul:q_proj:L23                0.12     0.0
matmul:q_proj:L18                0.12     0.0
matmul:q_proj:L17                0.12     0.0
matmul:q_proj:L12                0.12     0.0
matmul:q_proj:L2                 0.12     0.0
matmul:q_proj:L5                 0.12     0.0
matmul:q_proj:L14                0.12     0.0
matmul:q_proj:L7                 0.12     0.0
sample_phase1                    0.10     0.0
matmul:v_proj:L0                 0.07     0.0
matmul:k_proj:L0                 0.07     0.0
matmul:k_proj:L4                 0.07     0.0
sample_phase3                    0.07     0.0
matmul:v_proj:L4                 0.06     0.0
matmul:k_proj:L11                0.06     0.0
matmul:k_proj:L1                 0.05     0.0
matmul:v_proj:L9                 0.05     0.0
matmul:k_proj:L9                 0.05     0.0
matmul:v_proj:L11                0.05     0.0
matmul:v_proj:L19                0.05     0.0
matmul:k_proj:L6                 0.05     0.0
matmul:v_proj:L1                 0.05     0.0
matmul:k_proj:L19                0.05     0.0
matmul:v_proj:L6                 0.05     0.0
matmul:k_proj:L25                0.05     0.0
matmul:k_proj:L14                0.05     0.0
matmul:v_proj:L3                 0.05     0.0
matmul:k_proj:L17                0.05     0.0
matmul:k_proj:L16                0.05     0.0
matmul:k_proj:L15                0.05     0.0
matmul:k_proj:L8                 0.05     0.0
matmul:v_proj:L8                 0.05     0.0
matmul:k_proj:L21                0.05     0.0
matmul:k_proj:L10                0.04     0.0
matmul:k_proj:L13                0.04     0.0
matmul:k_proj:L2                 0.04     0.0
matmul:v_proj:L14                0.04     0.0
matmul:v_proj:L16                0.04     0.0
matmul:k_proj:L3                 0.04     0.0
matmul:k_proj:L23                0.04     0.0
matmul:k_proj:L7                 0.04     0.0
matmul:k_proj:L24                0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:k_proj:L20                0.04     0.0
matmul:k_proj:L18                0.04     0.0
matmul:v_proj:L24                0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:k_proj:L5                 0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:v_proj:L5                 0.04     0.0
matmul:k_proj:L12                0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:v_proj:L18                0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:v_proj:L22                0.04     0.0
matmul:k_proj:L22                0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:v_proj:L17                0.04     0.0
gather                           0.03     0.0
scale                            0.02     0.0
──────────────────────────────────────────────────
TOTAL                          732.06   100.0

[browser:warning] [38059.9ms][Profile] Batch decode (N=4):
[browser:warning] [38060.0ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      414.88    56.0
fused_ffn                       39.03     5.3
matmul:lm_head                  30.44     4.1
matmul_rmsnorm_fused:L6.ffn_down       10.39     1.4
matmul_rmsnorm_fused:L18.ffn_down       10.30     1.4
matmul_rmsnorm_fused:L2.ffn_down       10.28     1.4
matmul_rmsnorm_fused:L5.ffn_down       10.26     1.4
matmul_rmsnorm_fused:L11.ffn_down       10.17     1.4
matmul_rmsnorm_fused:L10.ffn_down       10.09     1.4
matmul_rmsnorm_fused:L8.ffn_down        9.93     1.3
matmul_rmsnorm_fused:L20.ffn_down        9.58     1.3
matmul_rmsnorm_fused:L7.ffn_down        9.54     1.3
matmul_rmsnorm_fused:L13.ffn_down        9.48     1.3
matmul_rmsnorm_fused:L3.ffn_down        9.44     1.3
matmul_rmsnorm_fused:L21.ffn_down        8.85     1.2
matmul_rmsnorm_fused:L12.ffn_down        8.76     1.2
matmul_rmsnorm_fused:L22.ffn_down        8.76     1.2
matmul_rmsnorm_fused:L23.ffn_down        8.73     1.2
matmul_rmsnorm_fused:L9.ffn_down        8.71     1.2
matmul_rmsnorm_fused:L14.ffn_down        8.71     1.2
matmul_rmsnorm_fused:L25.ffn_down        8.68     1.2
matmul_rmsnorm_fused:L15.ffn_down        8.68     1.2
matmul_rmsnorm_fused:L1.ffn_down        8.67     1.2
matmul_rmsnorm_fused:L24.ffn_down        8.67     1.2
matmul_rmsnorm_fused:L16.ffn_down        8.66     1.2
matmul_rmsnorm_fused:L19.ffn_down        8.65     1.2
matmul_rmsnorm_fused:L17.ffn_down        8.65     1.2
matmul_rmsnorm_fused:L0.ffn_down        8.65     1.2
matmul_rmsnorm_fused:L4.ffn_down        8.61     1.2
sample_phase2                    3.31     0.4
rmsnorm                          2.97     0.4
rope                             0.75     0.1
matmul:q_proj:L0                 0.20     0.0
matmul:o_proj:L7                 0.16     0.0
matmul:q_proj:L4                 0.16     0.0
matmul:o_proj:L20                0.16     0.0
matmul:o_proj:L22                0.15     0.0
matmul:o_proj:L13                0.15     0.0
matmul:o_proj:L21                0.15     0.0
matmul:o_proj:L0                 0.15     0.0
matmul:o_proj:L18                0.15     0.0
matmul:o_proj:L12                0.14     0.0
matmul:o_proj:L25                0.14     0.0
matmul:o_proj:L5                 0.14     0.0
matmul:o_proj:L1                 0.14     0.0
matmul:q_proj:L7                 0.14     0.0
matmul:o_proj:L10                0.14     0.0
matmul:o_proj:L6                 0.14     0.0
matmul:o_proj:L16                0.14     0.0
matmul:q_proj:L12                0.14     0.0
matmul:o_proj:L9                 0.13     0.0
matmul:o_proj:L23                0.13     0.0
matmul:q_proj:L25                0.13     0.0
matmul:q_proj:L9                 0.13     0.0
matmul:o_proj:L8                 0.13     0.0
matmul:q_proj:L14                0.13     0.0
matmul:o_proj:L2                 0.13     0.0
matmul:o_proj:L14                0.13     0.0
matmul:o_proj:L15                0.13     0.0
matmul:o_proj:L4                 0.13     0.0
matmul:o_proj:L11                0.13     0.0
matmul:q_proj:L15                0.13     0.0
matmul:q_proj:L19                0.13     0.0
matmul:q_proj:L11                0.13     0.0
matmul:q_proj:L1                 0.13     0.0
matmul:q_proj:L22                0.13     0.0
matmul:o_proj:L17                0.13     0.0
matmul:q_proj:L6                 0.13     0.0
matmul:q_proj:L5                 0.13     0.0
matmul:o_proj:L3                 0.13     0.0
matmul:o_proj:L24                0.12     0.0
matmul:q_proj:L20                0.12     0.0
matmul:q_proj:L3                 0.12     0.0
matmul:q_proj:L21                0.12     0.0
matmul:q_proj:L16                0.12     0.0
matmul:q_proj:L10                0.12     0.0
matmul:q_proj:L13                0.12     0.0
matmul:q_proj:L8                 0.12     0.0
matmul:q_proj:L2                 0.12     0.0
matmul:o_proj:L19                0.12     0.0
matmul:q_proj:L23                0.12     0.0
matmul:q_proj:L18                0.12     0.0
matmul:q_proj:L24                0.12     0.0
matmul:q_proj:L17                0.12     0.0
sample_phase1                    0.11     0.0
sample_phase3                    0.10     0.0
matmul:k_proj:L0                 0.07     0.0
matmul:k_proj:L4                 0.07     0.0
matmul:v_proj:L0                 0.06     0.0
matmul:v_proj:L4                 0.06     0.0
matmul:k_proj:L25                0.06     0.0
matmul:v_proj:L25                0.06     0.0
matmul:k_proj:L12                0.05     0.0
matmul:v_proj:L12                0.05     0.0
matmul:v_proj:L9                 0.05     0.0
matmul:k_proj:L9                 0.05     0.0
matmul:k_proj:L7                 0.05     0.0
matmul:k_proj:L24                0.05     0.0
matmul:k_proj:L11                0.05     0.0
matmul:v_proj:L21                0.05     0.0
matmul:k_proj:L21                0.05     0.0
matmul:v_proj:L7                 0.05     0.0
matmul:k_proj:L3                 0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:k_proj:L23                0.04     0.0
matmul:k_proj:L10                0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:k_proj:L16                0.04     0.0
matmul:k_proj:L15                0.04     0.0
matmul:k_proj:L17                0.04     0.0
matmul:k_proj:L14                0.04     0.0
matmul:k_proj:L5                 0.04     0.0
matmul:k_proj:L1                 0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:k_proj:L2                 0.04     0.0
matmul:k_proj:L20                0.04     0.0
matmul:k_proj:L13                0.04     0.0
matmul:k_proj:L19                0.04     0.0
matmul:v_proj:L22                0.04     0.0
matmul:k_proj:L22                0.04     0.0
matmul:v_proj:L19                0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:k_proj:L18                0.04     0.0
matmul:v_proj:L14                0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:v_proj:L5                 0.04     0.0
matmul:v_proj:L17                0.04     0.0
matmul:v_proj:L24                0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:v_proj:L16                0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:v_proj:L18                0.04     0.0
gather                           0.03     0.0
scale                            0.02     0.0
──────────────────────────────────────────────────
TOTAL                          740.89   100.0

[browser:warning] [38848.0ms][Profile] Batch decode (N=4):
[browser:warning] [38848.1ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      421.66    56.9
fused_ffn                       39.25     5.3
matmul:lm_head                  30.55     4.1
matmul_rmsnorm_fused:L2.ffn_down       10.32     1.4
matmul_rmsnorm_fused:L3.ffn_down        9.91     1.3
matmul_rmsnorm_fused:L5.ffn_down        9.67     1.3
matmul_rmsnorm_fused:L0.ffn_down        9.66     1.3
matmul_rmsnorm_fused:L4.ffn_down        9.58     1.3
matmul_rmsnorm_fused:L7.ffn_down        9.27     1.3
matmul_rmsnorm_fused:L18.ffn_down        9.15     1.2
matmul_rmsnorm_fused:L10.ffn_down        9.11     1.2
matmul_rmsnorm_fused:L8.ffn_down        8.98     1.2
matmul_rmsnorm_fused:L12.ffn_down        8.87     1.2
matmul_rmsnorm_fused:L23.ffn_down        8.76     1.2
matmul_rmsnorm_fused:L13.ffn_down        8.74     1.2
matmul_rmsnorm_fused:L22.ffn_down        8.71     1.2
matmul_rmsnorm_fused:L25.ffn_down        8.70     1.2
matmul_rmsnorm_fused:L9.ffn_down        8.68     1.2
matmul_rmsnorm_fused:L16.ffn_down        8.68     1.2
matmul_rmsnorm_fused:L21.ffn_down        8.67     1.2
matmul_rmsnorm_fused:L17.ffn_down        8.67     1.2
matmul_rmsnorm_fused:L14.ffn_down        8.66     1.2
matmul_rmsnorm_fused:L6.ffn_down        8.66     1.2
matmul_rmsnorm_fused:L19.ffn_down        8.65     1.2
matmul_rmsnorm_fused:L1.ffn_down        8.65     1.2
matmul_rmsnorm_fused:L15.ffn_down        8.65     1.2
matmul_rmsnorm_fused:L11.ffn_down        8.64     1.2
matmul_rmsnorm_fused:L24.ffn_down        8.63     1.2
matmul_rmsnorm_fused:L20.ffn_down        8.59     1.2
sample_phase2                    3.29     0.4
rmsnorm                          2.97     0.4
rope                             0.69     0.1
matmul:q_proj:L0                 0.20     0.0
matmul:o_proj:L7                 0.17     0.0
matmul:o_proj:L6                 0.17     0.0
matmul:o_proj:L16                0.16     0.0
matmul:o_proj:L0                 0.16     0.0
matmul:q_proj:L19                0.16     0.0
matmul:o_proj:L4                 0.16     0.0
matmul:o_proj:L12                0.15     0.0
matmul:o_proj:L9                 0.15     0.0
matmul:o_proj:L23                0.15     0.0
matmul:o_proj:L13                0.15     0.0
matmul:o_proj:L5                 0.14     0.0
matmul:o_proj:L14                0.14     0.0
matmul:o_proj:L22                0.14     0.0
matmul:o_proj:L18                0.14     0.0
matmul:o_proj:L8                 0.14     0.0
matmul:o_proj:L19                0.14     0.0
matmul:o_proj:L2                 0.14     0.0
matmul:o_proj:L17                0.14     0.0
matmul:o_proj:L10                0.14     0.0
matmul:o_proj:L24                0.13     0.0
matmul:q_proj:L24                0.13     0.0
matmul:o_proj:L11                0.13     0.0
matmul:q_proj:L4                 0.13     0.0
matmul:o_proj:L25                0.13     0.0
matmul:o_proj:L3                 0.13     0.0
matmul:q_proj:L23                0.13     0.0
matmul:o_proj:L15                0.13     0.0
matmul:q_proj:L22                0.13     0.0
matmul:q_proj:L9                 0.13     0.0
matmul:q_proj:L7                 0.13     0.0
matmul:q_proj:L18                0.13     0.0
matmul:q_proj:L17                0.13     0.0
matmul:q_proj:L13                0.13     0.0
matmul:q_proj:L5                 0.12     0.0
matmul:q_proj:L11                0.12     0.0
matmul:o_proj:L21                0.12     0.0
matmul:q_proj:L14                0.12     0.0
matmul:q_proj:L3                 0.12     0.0
matmul:o_proj:L20                0.12     0.0
matmul:o_proj:L1                 0.12     0.0
matmul:q_proj:L20                0.12     0.0
matmul:q_proj:L12                0.12     0.0
matmul:q_proj:L8                 0.12     0.0
matmul:q_proj:L15                0.12     0.0
matmul:q_proj:L2                 0.12     0.0
matmul:q_proj:L16                0.12     0.0
matmul:q_proj:L25                0.12     0.0
matmul:q_proj:L6                 0.12     0.0
matmul:q_proj:L10                0.12     0.0
matmul:q_proj:L1                 0.12     0.0
matmul:q_proj:L21                0.12     0.0
sample_phase1                    0.11     0.0
matmul:k_proj:L0                 0.07     0.0
matmul:k_proj:L19                0.07     0.0
sample_phase3                    0.06     0.0
matmul:v_proj:L0                 0.06     0.0
matmul:v_proj:L19                0.06     0.0
matmul:k_proj:L4                 0.05     0.0
matmul:v_proj:L4                 0.05     0.0
matmul:v_proj:L24                0.05     0.0
matmul:k_proj:L17                0.05     0.0
matmul:k_proj:L16                0.05     0.0
matmul:k_proj:L1                 0.05     0.0
matmul:k_proj:L23                0.05     0.0
matmul:v_proj:L17                0.05     0.0
matmul:v_proj:L23                0.05     0.0
matmul:k_proj:L2                 0.05     0.0
matmul:k_proj:L11                0.04     0.0
matmul:k_proj:L24                0.04     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:k_proj:L3                 0.04     0.0
matmul:k_proj:L15                0.04     0.0
matmul:k_proj:L13                0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:k_proj:L22                0.04     0.0
matmul:k_proj:L7                 0.04     0.0
matmul:k_proj:L14                0.04     0.0
matmul:v_proj:L22                0.04     0.0
matmul:k_proj:L5                 0.04     0.0
matmul:k_proj:L21                0.04     0.0
matmul:k_proj:L20                0.04     0.0
matmul:k_proj:L18                0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:k_proj:L10                0.04     0.0
matmul:k_proj:L12                0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:v_proj:L18                0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:v_proj:L14                0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:v_proj:L5                 0.04     0.0
matmul:v_proj:L16                0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:v_proj:L2                 0.04     0.0
gather                           0.03     0.0
scale                            0.02     0.0
──────────────────────────────────────────────────
TOTAL                          741.29   100.0

[browser:warning] [39646.6ms][Profile] Batch decode (N=4):
[browser:warning] [39646.8ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      422.54    56.1
fused_ffn                       40.91     5.4
matmul:lm_head                  30.77     4.1
matmul_rmsnorm_fused:L22.ffn_down       10.72     1.4
matmul_rmsnorm_fused:L19.ffn_down       10.54     1.4
matmul_rmsnorm_fused:L9.ffn_down       10.35     1.4
matmul_rmsnorm_fused:L3.ffn_down       10.29     1.4
matmul_rmsnorm_fused:L11.ffn_down       10.27     1.4
matmul_rmsnorm_fused:L6.ffn_down       10.19     1.4
matmul_rmsnorm_fused:L5.ffn_down        9.71     1.3
matmul_rmsnorm_fused:L14.ffn_down        9.55     1.3
matmul_rmsnorm_fused:L15.ffn_down        9.23     1.2
matmul_rmsnorm_fused:L1.ffn_down        9.19     1.2
matmul_rmsnorm_fused:L8.ffn_down        9.16     1.2
matmul_rmsnorm_fused:L24.ffn_down        9.16     1.2
matmul_rmsnorm_fused:L4.ffn_down        9.11     1.2
matmul_rmsnorm_fused:L10.ffn_down        9.05     1.2
matmul_rmsnorm_fused:L20.ffn_down        8.89     1.2
matmul_rmsnorm_fused:L18.ffn_down        8.84     1.2
matmul_rmsnorm_fused:L17.ffn_down        8.83     1.2
matmul_rmsnorm_fused:L16.ffn_down        8.81     1.2
matmul_rmsnorm_fused:L23.ffn_down        8.71     1.2
matmul_rmsnorm_fused:L21.ffn_down        8.68     1.2
matmul_rmsnorm_fused:L2.ffn_down        8.66     1.2
matmul_rmsnorm_fused:L25.ffn_down        8.66     1.2
matmul_rmsnorm_fused:L12.ffn_down        8.66     1.2
matmul_rmsnorm_fused:L13.ffn_down        8.65     1.1
matmul_rmsnorm_fused:L7.ffn_down        8.63     1.1
matmul_rmsnorm_fused:L0.ffn_down        8.62     1.1
sample_phase2                    3.28     0.4
rmsnorm                          3.15     0.4
rope                             0.86     0.1
matmul:o_proj:L0                 0.26     0.0
matmul:q_proj:L0                 0.18     0.0
matmul:o_proj:L24                0.17     0.0
matmul:o_proj:L8                 0.16     0.0
matmul:o_proj:L19                0.16     0.0
matmul:o_proj:L10                0.16     0.0
matmul:q_proj:L16                0.16     0.0
matmul:o_proj:L23                0.16     0.0
matmul:o_proj:L9                 0.16     0.0
matmul:q_proj:L5                 0.16     0.0
matmul:o_proj:L5                 0.16     0.0
matmul:q_proj:L15                0.15     0.0
matmul:q_proj:L2                 0.15     0.0
matmul:o_proj:L7                 0.15     0.0
matmul:q_proj:L21                0.15     0.0
matmul:o_proj:L13                0.15     0.0
matmul:o_proj:L14                0.15     0.0
matmul:o_proj:L15                0.15     0.0
matmul:o_proj:L22                0.14     0.0
matmul:o_proj:L16                0.14     0.0
matmul:o_proj:L12                0.14     0.0
matmul:q_proj:L7                 0.14     0.0
matmul:o_proj:L11                0.14     0.0
matmul:o_proj:L3                 0.14     0.0
matmul:o_proj:L21                0.14     0.0
matmul:o_proj:L2                 0.14     0.0
matmul:o_proj:L6                 0.14     0.0
matmul:o_proj:L18                0.14     0.0
matmul:o_proj:L1                 0.14     0.0
matmul:o_proj:L20                0.13     0.0
matmul:o_proj:L4                 0.13     0.0
matmul:q_proj:L9                 0.13     0.0
matmul:q_proj:L10                0.13     0.0
matmul:o_proj:L25                0.13     0.0
matmul:q_proj:L18                0.13     0.0
matmul:q_proj:L23                0.13     0.0
matmul:q_proj:L4                 0.13     0.0
matmul:q_proj:L20                0.13     0.0
matmul:q_proj:L19                0.13     0.0
matmul:q_proj:L12                0.13     0.0
matmul:q_proj:L22                0.13     0.0
matmul:q_proj:L24                0.13     0.0
matmul:q_proj:L6                 0.13     0.0
matmul:q_proj:L25                0.13     0.0
matmul:q_proj:L11                0.13     0.0
matmul:q_proj:L14                0.13     0.0
matmul:q_proj:L8                 0.13     0.0
matmul:o_proj:L17                0.13     0.0
matmul:q_proj:L17                0.12     0.0
matmul:q_proj:L3                 0.12     0.0
matmul:q_proj:L13                0.12     0.0
matmul:q_proj:L1                 0.12     0.0
sample_phase1                    0.08     0.0
sample_phase3                    0.07     0.0
matmul:v_proj:L0                 0.07     0.0
matmul:k_proj:L15                0.06     0.0
matmul:k_proj:L0                 0.06     0.0
matmul:v_proj:L5                 0.06     0.0
matmul:v_proj:L2                 0.06     0.0
matmul:k_proj:L5                 0.06     0.0
matmul:k_proj:L2                 0.06     0.0
matmul:k_proj:L16                0.06     0.0
matmul:k_proj:L21                0.06     0.0
matmul:v_proj:L21                0.06     0.0
matmul:v_proj:L16                0.06     0.0
matmul:v_proj:L15                0.06     0.0
matmul:v_proj:L18                0.05     0.0
matmul:k_proj:L7                 0.05     0.0
matmul:k_proj:L18                0.05     0.0
matmul:v_proj:L7                 0.05     0.0
matmul:k_proj:L10                0.05     0.0
matmul:k_proj:L23                0.05     0.0
matmul:k_proj:L17                0.05     0.0
matmul:k_proj:L25                0.05     0.0
matmul:k_proj:L9                 0.05     0.0
matmul:k_proj:L4                 0.05     0.0
matmul:k_proj:L12                0.04     0.0
matmul:k_proj:L24                0.04     0.0
matmul:k_proj:L22                0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:k_proj:L11                0.04     0.0
matmul:k_proj:L13                0.04     0.0
matmul:v_proj:L22                0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:k_proj:L3                 0.04     0.0
matmul:k_proj:L1                 0.04     0.0
matmul:v_proj:L24                0.04     0.0
matmul:k_proj:L14                0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:k_proj:L19                0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:v_proj:L14                0.04     0.0
matmul:v_proj:L19                0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:k_proj:L20                0.04     0.0
matmul:v_proj:L17                0.04     0.0
gather                           0.04     0.0
matmul:v_proj:L1                 0.04     0.0
scale                            0.03     0.0
──────────────────────────────────────────────────
TOTAL                          752.84   100.0

[browser:warning] [40443.2ms][Profile] Batch decode (N=4):
[browser:warning] [40443.3ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      425.79    56.9
fused_ffn                       39.53     5.3
matmul:lm_head                  30.88     4.1
matmul_rmsnorm_fused:L24.ffn_down       11.01     1.5
matmul_rmsnorm_fused:L14.ffn_down       10.47     1.4
matmul_rmsnorm_fused:L3.ffn_down       10.32     1.4
matmul_rmsnorm_fused:L6.ffn_down        9.92     1.3
matmul_rmsnorm_fused:L19.ffn_down        9.39     1.3
matmul_rmsnorm_fused:L5.ffn_down        9.21     1.2
matmul_rmsnorm_fused:L0.ffn_down        9.11     1.2
matmul_rmsnorm_fused:L13.ffn_down        9.06     1.2
matmul_rmsnorm_fused:L17.ffn_down        8.91     1.2
matmul_rmsnorm_fused:L1.ffn_down        8.86     1.2
matmul_rmsnorm_fused:L23.ffn_down        8.78     1.2
matmul_rmsnorm_fused:L16.ffn_down        8.76     1.2
matmul_rmsnorm_fused:L2.ffn_down        8.75     1.2
matmul_rmsnorm_fused:L4.ffn_down        8.74     1.2
matmul_rmsnorm_fused:L11.ffn_down        8.74     1.2
matmul_rmsnorm_fused:L9.ffn_down        8.74     1.2
matmul_rmsnorm_fused:L8.ffn_down        8.72     1.2
matmul_rmsnorm_fused:L18.ffn_down        8.71     1.2
matmul_rmsnorm_fused:L15.ffn_down        8.69     1.2
matmul_rmsnorm_fused:L25.ffn_down        8.69     1.2
matmul_rmsnorm_fused:L10.ffn_down        8.68     1.2
matmul_rmsnorm_fused:L20.ffn_down        8.68     1.2
matmul_rmsnorm_fused:L22.ffn_down        8.67     1.2
matmul_rmsnorm_fused:L12.ffn_down        8.66     1.2
matmul_rmsnorm_fused:L21.ffn_down        8.66     1.2
matmul_rmsnorm_fused:L7.ffn_down        8.65     1.2
sample_phase2                    3.29     0.4
rmsnorm                          2.85     0.4
rope                             0.73     0.1
matmul:q_proj:L0                 0.22     0.0
matmul:o_proj:L24                0.18     0.0
matmul:o_proj:L0                 0.17     0.0
matmul:o_proj:L19                0.17     0.0
matmul:o_proj:L5                 0.17     0.0
matmul:o_proj:L14                0.16     0.0
matmul:o_proj:L11                0.15     0.0
matmul:o_proj:L7                 0.15     0.0
matmul:o_proj:L17                0.15     0.0
matmul:o_proj:L3                 0.15     0.0
matmul:o_proj:L16                0.15     0.0
matmul:o_proj:L4                 0.15     0.0
matmul:o_proj:L12                0.15     0.0
matmul:q_proj:L20                0.14     0.0
matmul:o_proj:L2                 0.14     0.0
matmul:o_proj:L13                0.14     0.0
matmul:q_proj:L7                 0.14     0.0
matmul:o_proj:L18                0.14     0.0
matmul:q_proj:L17                0.14     0.0
matmul:q_proj:L2                 0.14     0.0
matmul:o_proj:L9                 0.14     0.0
matmul:o_proj:L10                0.14     0.0
matmul:q_proj:L15                0.14     0.0
matmul:q_proj:L18                0.14     0.0
matmul:o_proj:L22                0.14     0.0
matmul:q_proj:L4                 0.14     0.0
matmul:q_proj:L10                0.14     0.0
matmul:o_proj:L15                0.14     0.0
matmul:o_proj:L8                 0.13     0.0
matmul:o_proj:L1                 0.13     0.0
matmul:o_proj:L23                0.13     0.0
matmul:o_proj:L6                 0.13     0.0
matmul:o_proj:L25                0.13     0.0
matmul:o_proj:L21                0.13     0.0
matmul:o_proj:L20                0.13     0.0
matmul:q_proj:L13                0.13     0.0
matmul:q_proj:L14                0.13     0.0
matmul:q_proj:L5                 0.13     0.0
matmul:q_proj:L24                0.13     0.0
matmul:q_proj:L3                 0.13     0.0
matmul:q_proj:L19                0.13     0.0
matmul:q_proj:L21                0.12     0.0
matmul:q_proj:L8                 0.12     0.0
matmul:q_proj:L12                0.12     0.0
matmul:q_proj:L6                 0.12     0.0
matmul:q_proj:L1                 0.12     0.0
matmul:q_proj:L23                0.12     0.0
matmul:q_proj:L25                0.12     0.0
matmul:q_proj:L16                0.12     0.0
matmul:q_proj:L9                 0.12     0.0
matmul:q_proj:L22                0.12     0.0
matmul:q_proj:L11                0.12     0.0
sample_phase1                    0.11     0.0
matmul:k_proj:L0                 0.08     0.0
matmul:v_proj:L0                 0.07     0.0
sample_phase3                    0.06     0.0
matmul:v_proj:L7                 0.05     0.0
matmul:k_proj:L15                0.05     0.0
matmul:k_proj:L18                0.05     0.0
matmul:k_proj:L7                 0.05     0.0
matmul:v_proj:L15                0.05     0.0
matmul:v_proj:L18                0.05     0.0
matmul:k_proj:L2                 0.05     0.0
matmul:k_proj:L17                0.05     0.0
matmul:k_proj:L4                 0.05     0.0
matmul:v_proj:L4                 0.05     0.0
matmul:k_proj:L10                0.05     0.0
matmul:k_proj:L21                0.05     0.0
matmul:v_proj:L2                 0.05     0.0
matmul:v_proj:L10                0.05     0.0
matmul:v_proj:L20                0.05     0.0
matmul:k_proj:L13                0.05     0.0
matmul:k_proj:L20                0.05     0.0
matmul:v_proj:L17                0.04     0.0
matmul:k_proj:L19                0.04     0.0
matmul:k_proj:L3                 0.04     0.0
matmul:k_proj:L23                0.04     0.0
matmul:k_proj:L1                 0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:k_proj:L11                0.04     0.0
matmul:k_proj:L16                0.04     0.0
matmul:k_proj:L24                0.04     0.0
matmul:v_proj:L5                 0.04     0.0
matmul:v_proj:L14                0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:v_proj:L19                0.04     0.0
matmul:k_proj:L5                 0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:v_proj:L16                0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:k_proj:L12                0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:k_proj:L14                0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:v_proj:L24                0.04     0.0
matmul:k_proj:L22                0.04     0.0
matmul:v_proj:L22                0.04     0.0
gather                           0.03     0.0
scale                            0.02     0.0
──────────────────────────────────────────────────
TOTAL                          748.54   100.0

[browser:warning] [41260.3ms][Profile] Batch decode (N=4):
[browser:warning] [41260.4ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      439.39    57.3
fused_ffn                       39.95     5.2
matmul:lm_head                  30.63     4.0
matmul_rmsnorm_fused:L17.ffn_down       10.31     1.3
matmul_rmsnorm_fused:L16.ffn_down       10.26     1.3
matmul_rmsnorm_fused:L9.ffn_down       10.09     1.3
matmul_rmsnorm_fused:L3.ffn_down       10.07     1.3
matmul_rmsnorm_fused:L10.ffn_down       10.03     1.3
matmul_rmsnorm_fused:L1.ffn_down        9.90     1.3
matmul_rmsnorm_fused:L14.ffn_down        9.44     1.2
matmul_rmsnorm_fused:L2.ffn_down        9.35     1.2
matmul_rmsnorm_fused:L22.ffn_down        9.19     1.2
matmul_rmsnorm_fused:L23.ffn_down        9.18     1.2
matmul_rmsnorm_fused:L21.ffn_down        9.13     1.2
matmul_rmsnorm_fused:L8.ffn_down        9.13     1.2
matmul_rmsnorm_fused:L20.ffn_down        9.10     1.2
matmul_rmsnorm_fused:L7.ffn_down        9.07     1.2
matmul_rmsnorm_fused:L0.ffn_down        9.05     1.2
matmul_rmsnorm_fused:L15.ffn_down        9.00     1.2
matmul_rmsnorm_fused:L24.ffn_down        8.95     1.2
matmul_rmsnorm_fused:L5.ffn_down        8.88     1.2
matmul_rmsnorm_fused:L12.ffn_down        8.83     1.2
matmul_rmsnorm_fused:L6.ffn_down        8.76     1.1
matmul_rmsnorm_fused:L18.ffn_down        8.71     1.1
matmul_rmsnorm_fused:L25.ffn_down        8.70     1.1
matmul_rmsnorm_fused:L11.ffn_down        8.66     1.1
matmul_rmsnorm_fused:L19.ffn_down        8.66     1.1
matmul_rmsnorm_fused:L13.ffn_down        8.64     1.1
matmul_rmsnorm_fused:L4.ffn_down        8.63     1.1
sample_phase2                    3.32     0.4
rmsnorm                          3.20     0.4
rope                             0.83     0.1
matmul:q_proj:L0                 0.20     0.0
matmul:o_proj:L2                 0.18     0.0
matmul:o_proj:L14                0.18     0.0
matmul:o_proj:L3                 0.17     0.0
matmul:o_proj:L0                 0.17     0.0
matmul:o_proj:L21                0.17     0.0
matmul:o_proj:L6                 0.16     0.0
matmul:o_proj:L22                0.16     0.0
matmul:o_proj:L17                0.16     0.0
matmul:o_proj:L12                0.16     0.0
matmul:o_proj:L16                0.16     0.0
matmul:o_proj:L1                 0.15     0.0
matmul:o_proj:L5                 0.15     0.0
matmul:o_proj:L25                0.15     0.0
matmul:o_proj:L20                0.14     0.0
matmul:o_proj:L15                0.14     0.0
matmul:q_proj:L24                0.14     0.0
matmul:q_proj:L11                0.14     0.0
matmul:o_proj:L10                0.14     0.0
matmul:o_proj:L8                 0.14     0.0
matmul:q_proj:L17                0.14     0.0
matmul:o_proj:L11                0.14     0.0
matmul:q_proj:L10                0.14     0.0
matmul:q_proj:L13                0.14     0.0
matmul:q_proj:L25                0.14     0.0
matmul:o_proj:L13                0.14     0.0
matmul:o_proj:L19                0.13     0.0
matmul:o_proj:L9                 0.13     0.0
matmul:q_proj:L8                 0.13     0.0
matmul:o_proj:L4                 0.13     0.0
matmul:o_proj:L23                0.13     0.0
matmul:q_proj:L9                 0.13     0.0
matmul:o_proj:L18                0.13     0.0
matmul:q_proj:L16                0.13     0.0
matmul:o_proj:L7                 0.13     0.0
matmul:o_proj:L24                0.13     0.0
matmul:q_proj:L6                 0.13     0.0
matmul:q_proj:L19                0.13     0.0
matmul:q_proj:L4                 0.13     0.0
matmul:q_proj:L18                0.12     0.0
matmul:q_proj:L5                 0.12     0.0
matmul:q_proj:L1                 0.12     0.0
matmul:q_proj:L12                0.12     0.0
matmul:q_proj:L2                 0.12     0.0
matmul:q_proj:L20                0.12     0.0
matmul:q_proj:L22                0.12     0.0
matmul:q_proj:L21                0.12     0.0
matmul:q_proj:L15                0.12     0.0
matmul:q_proj:L14                0.12     0.0
matmul:q_proj:L3                 0.12     0.0
matmul:q_proj:L23                0.12     0.0
matmul:q_proj:L7                 0.12     0.0
sample_phase1                    0.11     0.0
sample_phase3                    0.08     0.0
matmul:k_proj:L0                 0.07     0.0
matmul:v_proj:L0                 0.06     0.0
matmul:k_proj:L11                0.05     0.0
matmul:k_proj:L10                0.05     0.0
matmul:v_proj:L25                0.05     0.0
matmul:k_proj:L17                0.05     0.0
matmul:k_proj:L24                0.05     0.0
matmul:v_proj:L10                0.05     0.0
matmul:k_proj:L13                0.05     0.0
matmul:v_proj:L17                0.05     0.0
matmul:k_proj:L25                0.05     0.0
matmul:v_proj:L13                0.05     0.0
matmul:v_proj:L16                0.05     0.0
matmul:v_proj:L24                0.05     0.0
matmul:v_proj:L11                0.05     0.0
matmul:k_proj:L16                0.05     0.0
matmul:v_proj:L5                 0.05     0.0
matmul:k_proj:L19                0.05     0.0
matmul:k_proj:L5                 0.05     0.0
matmul:k_proj:L4                 0.05     0.0
matmul:k_proj:L6                 0.05     0.0
matmul:k_proj:L1                 0.04     0.0
matmul:k_proj:L3                 0.04     0.0
matmul:k_proj:L15                0.04     0.0
matmul:k_proj:L2                 0.04     0.0
matmul:k_proj:L7                 0.04     0.0
matmul:k_proj:L12                0.04     0.0
matmul:k_proj:L20                0.04     0.0
matmul:k_proj:L21                0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:k_proj:L23                0.04     0.0
matmul:k_proj:L22                0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:k_proj:L18                0.04     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:v_proj:L19                0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:k_proj:L14                0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:v_proj:L22                0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:v_proj:L18                0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:v_proj:L14                0.04     0.0
gather                           0.03     0.0
scale                            0.02     0.0
──────────────────────────────────────────────────
TOTAL                          766.92   100.0

[browser:warning] [42076.2ms][Profile] Batch decode (N=4):
[browser:warning] [42076.3ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      446.35    58.0
fused_ffn                       39.26     5.1
matmul:lm_head                  30.00     3.9
matmul_rmsnorm_fused:L0.ffn_down       10.51     1.4
matmul_rmsnorm_fused:L12.ffn_down       10.37     1.3
matmul_rmsnorm_fused:L13.ffn_down       10.37     1.3
matmul_rmsnorm_fused:L10.ffn_down        9.84     1.3
matmul_rmsnorm_fused:L14.ffn_down        9.67     1.3
matmul_rmsnorm_fused:L9.ffn_down        9.51     1.2
matmul_rmsnorm_fused:L17.ffn_down        9.24     1.2
matmul_rmsnorm_fused:L3.ffn_down        9.13     1.2
matmul_rmsnorm_fused:L1.ffn_down        9.10     1.2
matmul_rmsnorm_fused:L19.ffn_down        9.06     1.2
matmul_rmsnorm_fused:L20.ffn_down        8.97     1.2
matmul_rmsnorm_fused:L18.ffn_down        8.93     1.2
matmul_rmsnorm_fused:L15.ffn_down        8.87     1.2
matmul_rmsnorm_fused:L23.ffn_down        8.82     1.1
matmul_rmsnorm_fused:L24.ffn_down        8.81     1.1
matmul_rmsnorm_fused:L5.ffn_down        8.80     1.1
matmul_rmsnorm_fused:L4.ffn_down        8.73     1.1
matmul_rmsnorm_fused:L2.ffn_down        8.71     1.1
matmul_rmsnorm_fused:L21.ffn_down        8.70     1.1
matmul_rmsnorm_fused:L25.ffn_down        8.68     1.1
matmul_rmsnorm_fused:L16.ffn_down        8.67     1.1
matmul_rmsnorm_fused:L22.ffn_down        8.67     1.1
matmul_rmsnorm_fused:L8.ffn_down        8.66     1.1
matmul_rmsnorm_fused:L7.ffn_down        8.65     1.1
matmul_rmsnorm_fused:L11.ffn_down        8.65     1.1
matmul_rmsnorm_fused:L6.ffn_down        8.64     1.1
sample_phase2                    3.29     0.4
rmsnorm                          3.08     0.4
rope                             0.77     0.1
matmul:q_proj:L0                 0.20     0.0
matmul:o_proj:L3                 0.17     0.0
matmul:o_proj:L4                 0.16     0.0
matmul:o_proj:L14                0.16     0.0
matmul:o_proj:L15                0.16     0.0
matmul:o_proj:L17                0.16     0.0
matmul:o_proj:L10                0.16     0.0
matmul:o_proj:L2                 0.15     0.0
matmul:q_proj:L25                0.15     0.0
matmul:o_proj:L13                0.15     0.0
matmul:o_proj:L23                0.15     0.0
matmul:o_proj:L1                 0.15     0.0
matmul:q_proj:L24                0.15     0.0
matmul:q_proj:L10                0.15     0.0
matmul:o_proj:L5                 0.14     0.0
matmul:o_proj:L19                0.14     0.0
matmul:o_proj:L9                 0.14     0.0
matmul:o_proj:L20                0.14     0.0
matmul:o_proj:L18                0.14     0.0
matmul:o_proj:L0                 0.14     0.0
matmul:o_proj:L25                0.14     0.0
matmul:o_proj:L24                0.14     0.0
matmul:o_proj:L16                0.13     0.0
matmul:q_proj:L1                 0.13     0.0
matmul:o_proj:L8                 0.13     0.0
matmul:o_proj:L22                0.13     0.0
matmul:o_proj:L21                0.13     0.0
matmul:o_proj:L11                0.13     0.0
matmul:o_proj:L6                 0.13     0.0
matmul:o_proj:L12                0.13     0.0
matmul:q_proj:L11                0.13     0.0
matmul:q_proj:L5                 0.13     0.0
matmul:o_proj:L7                 0.13     0.0
matmul:q_proj:L15                0.13     0.0
matmul:q_proj:L22                0.13     0.0
matmul:q_proj:L13                0.13     0.0
matmul:q_proj:L9                 0.13     0.0
matmul:q_proj:L14                0.13     0.0
matmul:q_proj:L2                 0.13     0.0
matmul:q_proj:L23                0.13     0.0
matmul:q_proj:L8                 0.12     0.0
matmul:q_proj:L12                0.12     0.0
matmul:q_proj:L4                 0.12     0.0
matmul:q_proj:L6                 0.12     0.0
matmul:q_proj:L3                 0.12     0.0
matmul:q_proj:L18                0.12     0.0
matmul:q_proj:L19                0.12     0.0
matmul:q_proj:L20                0.12     0.0
matmul:q_proj:L17                0.12     0.0
matmul:q_proj:L7                 0.12     0.0
matmul:q_proj:L16                0.12     0.0
matmul:q_proj:L21                0.12     0.0
sample_phase1                    0.09     0.0
matmul:k_proj:L0                 0.07     0.0
matmul:v_proj:L0                 0.07     0.0
sample_phase3                    0.07     0.0
matmul:v_proj:L24                0.06     0.0
matmul:k_proj:L22                0.06     0.0
matmul:v_proj:L22                0.06     0.0
matmul:k_proj:L25                0.06     0.0
matmul:k_proj:L10                0.06     0.0
matmul:k_proj:L24                0.06     0.0
matmul:v_proj:L25                0.06     0.0
matmul:v_proj:L10                0.05     0.0
matmul:k_proj:L11                0.05     0.0
matmul:v_proj:L11                0.05     0.0
matmul:k_proj:L15                0.05     0.0
matmul:k_proj:L3                 0.05     0.0
matmul:k_proj:L4                 0.05     0.0
matmul:k_proj:L2                 0.05     0.0
matmul:k_proj:L17                0.05     0.0
matmul:k_proj:L9                 0.05     0.0
matmul:k_proj:L13                0.05     0.0
matmul:k_proj:L18                0.05     0.0
matmul:k_proj:L1                 0.05     0.0
matmul:k_proj:L7                 0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:k_proj:L19                0.04     0.0
matmul:k_proj:L23                0.04     0.0
matmul:k_proj:L16                0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:v_proj:L5                 0.04     0.0
matmul:k_proj:L21                0.04     0.0
matmul:k_proj:L14                0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:k_proj:L5                 0.04     0.0
matmul:v_proj:L18                0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:k_proj:L20                0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:v_proj:L17                0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:v_proj:L14                0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:k_proj:L12                0.04     0.0
matmul:v_proj:L19                0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:v_proj:L16                0.04     0.0
matmul:v_proj:L21                0.04     0.0
gather                           0.03     0.0
scale                            0.02     0.0
──────────────────────────────────────────────────
TOTAL                          769.34   100.0

[browser:warning] [42905.9ms][Profile] Batch decode (N=4):
[browser:warning] [42906.0ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      453.54    58.0
fused_ffn                       39.58     5.1
matmul:lm_head                  30.05     3.8
matmul_rmsnorm_fused:L5.ffn_down       11.21     1.4
matmul_rmsnorm_fused:L15.ffn_down       10.37     1.3
matmul_rmsnorm_fused:L24.ffn_down       10.35     1.3
matmul_rmsnorm_fused:L20.ffn_down       10.29     1.3
matmul_rmsnorm_fused:L1.ffn_down       10.25     1.3
matmul_rmsnorm_fused:L14.ffn_down        9.95     1.3
matmul_rmsnorm_fused:L11.ffn_down        9.85     1.3
matmul_rmsnorm_fused:L23.ffn_down        9.71     1.2
matmul_rmsnorm_fused:L19.ffn_down        9.45     1.2
matmul_rmsnorm_fused:L10.ffn_down        9.43     1.2
matmul_rmsnorm_fused:L0.ffn_down        9.22     1.2
matmul_rmsnorm_fused:L9.ffn_down        9.19     1.2
matmul_rmsnorm_fused:L6.ffn_down        9.18     1.2
matmul_rmsnorm_fused:L16.ffn_down        9.03     1.2
matmul_rmsnorm_fused:L18.ffn_down        8.78     1.1
matmul_rmsnorm_fused:L12.ffn_down        8.73     1.1
matmul_rmsnorm_fused:L4.ffn_down        8.71     1.1
matmul_rmsnorm_fused:L22.ffn_down        8.69     1.1
matmul_rmsnorm_fused:L2.ffn_down        8.69     1.1
matmul_rmsnorm_fused:L8.ffn_down        8.69     1.1
matmul_rmsnorm_fused:L25.ffn_down        8.68     1.1
matmul_rmsnorm_fused:L17.ffn_down        8.63     1.1
matmul_rmsnorm_fused:L13.ffn_down        8.63     1.1
matmul_rmsnorm_fused:L21.ffn_down        8.62     1.1
matmul_rmsnorm_fused:L3.ffn_down        8.61     1.1
matmul_rmsnorm_fused:L7.ffn_down        8.58     1.1
sample_phase2                    3.24     0.4
rmsnorm                          3.21     0.4
rope                             0.84     0.1
matmul:o_proj:L14                0.42     0.1
matmul:o_proj:L19                0.19     0.0
matmul:o_proj:L11                0.18     0.0
matmul:q_proj:L15                0.18     0.0
matmul:o_proj:L5                 0.17     0.0
matmul:q_proj:L10                0.16     0.0
matmul:q_proj:L0                 0.16     0.0
matmul:o_proj:L15                0.16     0.0
matmul:o_proj:L25                0.16     0.0
matmul:o_proj:L6                 0.16     0.0
matmul:q_proj:L24                0.16     0.0
matmul:q_proj:L16                0.16     0.0
matmul:o_proj:L16                0.15     0.0
matmul:o_proj:L24                0.15     0.0
matmul:q_proj:L1                 0.15     0.0
matmul:q_proj:L7                 0.15     0.0
matmul:o_proj:L21                0.15     0.0
matmul:o_proj:L10                0.15     0.0
matmul:q_proj:L11                0.15     0.0
matmul:o_proj:L1                 0.15     0.0
matmul:o_proj:L0                 0.15     0.0
matmul:o_proj:L23                0.14     0.0
matmul:q_proj:L19                0.14     0.0
matmul:o_proj:L20                0.14     0.0
matmul:q_proj:L6                 0.14     0.0
matmul:o_proj:L9                 0.14     0.0
matmul:o_proj:L2                 0.14     0.0
matmul:o_proj:L18                0.13     0.0
matmul:o_proj:L4                 0.13     0.0
matmul:o_proj:L13                0.13     0.0
matmul:q_proj:L9                 0.13     0.0
matmul:o_proj:L8                 0.13     0.0
matmul:o_proj:L22                0.13     0.0
matmul:q_proj:L25                0.13     0.0
matmul:o_proj:L7                 0.13     0.0
matmul:q_proj:L2                 0.13     0.0
matmul:q_proj:L5                 0.13     0.0
matmul:o_proj:L17                0.13     0.0
matmul:q_proj:L14                0.12     0.0
matmul:q_proj:L23                0.12     0.0
matmul:q_proj:L20                0.12     0.0
matmul:q_proj:L22                0.12     0.0
matmul:o_proj:L3                 0.12     0.0
matmul:q_proj:L21                0.12     0.0
matmul:q_proj:L12                0.12     0.0
matmul:o_proj:L12                0.12     0.0
matmul:q_proj:L13                0.12     0.0
matmul:q_proj:L17                0.12     0.0
matmul:q_proj:L3                 0.12     0.0
matmul:q_proj:L8                 0.12     0.0
matmul:q_proj:L18                0.12     0.0
matmul:q_proj:L4                 0.12     0.0
sample_phase1                    0.08     0.0
matmul:v_proj:L15                0.07     0.0
matmul:k_proj:L15                0.07     0.0
matmul:k_proj:L7                 0.07     0.0
matmul:k_proj:L10                0.06     0.0
matmul:v_proj:L10                0.06     0.0
matmul:k_proj:L1                 0.06     0.0
matmul:v_proj:L11                0.06     0.0
matmul:k_proj:L11                0.06     0.0
matmul:v_proj:L7                 0.06     0.0
matmul:k_proj:L16                0.06     0.0
matmul:v_proj:L1                 0.06     0.0
matmul:v_proj:L16                0.06     0.0
matmul:v_proj:L24                0.05     0.0
matmul:k_proj:L24                0.05     0.0
matmul:k_proj:L6                 0.05     0.0
matmul:k_proj:L0                 0.05     0.0
sample_phase3                    0.05     0.0
matmul:v_proj:L0                 0.05     0.0
matmul:v_proj:L6                 0.05     0.0
matmul:k_proj:L19                0.05     0.0
matmul:k_proj:L2                 0.05     0.0
matmul:k_proj:L9                 0.05     0.0
matmul:k_proj:L25                0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:v_proj:L19                0.04     0.0
matmul:k_proj:L13                0.04     0.0
matmul:k_proj:L23                0.04     0.0
matmul:v_proj:L5                 0.04     0.0
matmul:k_proj:L17                0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:k_proj:L21                0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:k_proj:L3                 0.04     0.0
matmul:k_proj:L5                 0.04     0.0
matmul:k_proj:L18                0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:k_proj:L20                0.04     0.0
matmul:v_proj:L18                0.04     0.0
matmul:k_proj:L14                0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:k_proj:L12                0.04     0.0
matmul:k_proj:L4                 0.04     0.0
matmul:v_proj:L14                0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:v_proj:L22                0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:v_proj:L17                0.04     0.0
matmul:k_proj:L22                0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:k_proj:L8                 0.04     0.0
gather                           0.01     0.0
scale                            0.01     0.0
──────────────────────────────────────────────────
TOTAL                          782.19   100.0

[browser:warning] [43798.8ms][Profile] Batch decode (N=4):
[browser:warning] [43799.1ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      457.37    54.6
fused_ffn                       51.31     6.1
matmul:lm_head                  34.27     4.1
matmul_rmsnorm_fused:L1.ffn_down       12.49     1.5
matmul_rmsnorm_fused:L19.ffn_down       12.32     1.5
matmul_rmsnorm_fused:L5.ffn_down       11.12     1.3
matmul_rmsnorm_fused:L10.ffn_down       10.99     1.3
matmul_rmsnorm_fused:L24.ffn_down       10.78     1.3
matmul_rmsnorm_fused:L14.ffn_down       10.36     1.2
matmul_rmsnorm_fused:L15.ffn_down       10.35     1.2
matmul_rmsnorm_fused:L22.ffn_down       10.28     1.2
matmul_rmsnorm_fused:L18.ffn_down       10.21     1.2
matmul_rmsnorm_fused:L3.ffn_down       10.06     1.2
matmul_rmsnorm_fused:L11.ffn_down        9.67     1.2
rmsnorm                          9.66     1.2
matmul_rmsnorm_fused:L23.ffn_down        9.35     1.1
matmul_rmsnorm_fused:L16.ffn_down        9.31     1.1
matmul_rmsnorm_fused:L6.ffn_down        9.13     1.1
matmul_rmsnorm_fused:L0.ffn_down        9.10     1.1
matmul_rmsnorm_fused:L8.ffn_down        9.08     1.1
matmul_rmsnorm_fused:L12.ffn_down        9.08     1.1
matmul_rmsnorm_fused:L4.ffn_down        8.96     1.1
matmul_rmsnorm_fused:L9.ffn_down        8.75     1.0
matmul_rmsnorm_fused:L20.ffn_down        8.70     1.0
matmul_rmsnorm_fused:L13.ffn_down        8.70     1.0
matmul_rmsnorm_fused:L17.ffn_down        8.69     1.0
matmul_rmsnorm_fused:L7.ffn_down        8.69     1.0
matmul_rmsnorm_fused:L21.ffn_down        8.69     1.0
matmul_rmsnorm_fused:L2.ffn_down        8.67     1.0
matmul_rmsnorm_fused:L25.ffn_down        8.64     1.0
sample_phase2                    3.59     0.4
matmul:o_proj:L23                2.81     0.3
matmul:o_proj:L7                 2.65     0.3
matmul:q_proj:L16                2.63     0.3
matmul:o_proj:L10                2.04     0.2
matmul:o_proj:L19                1.42     0.2
matmul:o_proj:L14                1.26     0.2
sample_phase1                    1.03     0.1
matmul:o_proj:L18                0.92     0.1
rope                             0.87     0.1
matmul:q_proj:L20                0.83     0.1
matmul:q_proj:L17                0.83     0.1
matmul:o_proj:L3                 0.74     0.1
matmul:o_proj:L4                 0.45     0.1
matmul:v_proj:L20                0.34     0.0
matmul:v_proj:L17                0.33     0.0
matmul:k_proj:L20                0.30     0.0
matmul:k_proj:L17                0.30     0.0
sample_phase3                    0.28     0.0
matmul:o_proj:L24                0.20     0.0
matmul:o_proj:L8                 0.20     0.0
matmul:o_proj:L1                 0.19     0.0
matmul:o_proj:L0                 0.19     0.0
matmul:o_proj:L12                0.19     0.0
matmul:o_proj:L11                0.19     0.0
matmul:o_proj:L17                0.18     0.0
matmul:q_proj:L1                 0.17     0.0
matmul:o_proj:L22                0.17     0.0
matmul:q_proj:L6                 0.17     0.0
matmul:q_proj:L15                0.16     0.0
matmul:o_proj:L15                0.16     0.0
matmul:q_proj:L0                 0.16     0.0
matmul:o_proj:L16                0.16     0.0
matmul:o_proj:L5                 0.16     0.0
matmul:q_proj:L11                0.16     0.0
matmul:q_proj:L10                0.16     0.0
matmul:o_proj:L2                 0.15     0.0
matmul:q_proj:L7                 0.15     0.0
matmul:q_proj:L24                0.15     0.0
matmul:o_proj:L20                0.15     0.0
matmul:o_proj:L13                0.15     0.0
matmul:o_proj:L6                 0.15     0.0
matmul:o_proj:L25                0.14     0.0
matmul:o_proj:L21                0.14     0.0
matmul:o_proj:L9                 0.14     0.0
matmul:q_proj:L2                 0.14     0.0
matmul:q_proj:L12                0.14     0.0
matmul:q_proj:L5                 0.14     0.0
matmul:q_proj:L25                0.14     0.0
matmul:q_proj:L21                0.14     0.0
matmul:q_proj:L13                0.14     0.0
matmul:q_proj:L19                0.14     0.0
matmul:q_proj:L14                0.13     0.0
matmul:q_proj:L9                 0.13     0.0
matmul:q_proj:L23                0.13     0.0
matmul:q_proj:L22                0.13     0.0
matmul:q_proj:L18                0.13     0.0
matmul:q_proj:L8                 0.13     0.0
matmul:q_proj:L4                 0.13     0.0
matmul:q_proj:L3                 0.13     0.0
matmul:k_proj:L16                0.07     0.0
matmul:k_proj:L7                 0.07     0.0
matmul:k_proj:L11                0.07     0.0
matmul:k_proj:L21                0.06     0.0
matmul:k_proj:L10                0.06     0.0
matmul:v_proj:L10                0.06     0.0
matmul:k_proj:L15                0.06     0.0
matmul:v_proj:L16                0.06     0.0
matmul:k_proj:L1                 0.06     0.0
matmul:k_proj:L6                 0.06     0.0
matmul:k_proj:L0                 0.06     0.0
matmul:v_proj:L6                 0.06     0.0
matmul:v_proj:L0                 0.06     0.0
matmul:v_proj:L15                0.06     0.0
matmul:k_proj:L2                 0.05     0.0
matmul:v_proj:L7                 0.05     0.0
matmul:v_proj:L2                 0.05     0.0
matmul:v_proj:L1                 0.05     0.0
matmul:v_proj:L11                0.05     0.0
matmul:k_proj:L13                0.05     0.0
matmul:k_proj:L24                0.05     0.0
matmul:k_proj:L19                0.05     0.0
matmul:v_proj:L19                0.05     0.0
matmul:v_proj:L24                0.05     0.0
matmul:k_proj:L25                0.05     0.0
matmul:k_proj:L5                 0.05     0.0
matmul:v_proj:L13                0.05     0.0
matmul:k_proj:L12                0.05     0.0
matmul:k_proj:L9                 0.05     0.0
matmul:v_proj:L21                0.05     0.0
matmul:v_proj:L22                0.05     0.0
matmul:v_proj:L12                0.05     0.0
matmul:v_proj:L5                 0.05     0.0
matmul:k_proj:L14                0.05     0.0
matmul:v_proj:L9                 0.05     0.0
matmul:v_proj:L14                0.05     0.0
matmul:v_proj:L25                0.05     0.0
matmul:k_proj:L23                0.05     0.0
matmul:k_proj:L18                0.05     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:k_proj:L22                0.04     0.0
matmul:k_proj:L3                 0.04     0.0
matmul:k_proj:L4                 0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:v_proj:L18                0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:v_proj:L4                 0.04     0.0
gather                           0.04     0.0
scale                            0.03     0.0
──────────────────────────────────────────────────
TOTAL                          837.24   100.0

[browser:warning] [44475.6ms][Profile] Batch decode (N=3):
[browser:warning] [44475.8ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      347.06    56.5
fused_ffn                       38.61     6.3
matmul:lm_head                  22.58     3.7
matmul_rmsnorm_fused:L20.ffn_down       10.65     1.7
matmul_rmsnorm_fused:L2.ffn_down       10.42     1.7
matmul_rmsnorm_fused:L11.ffn_down        9.93     1.6
matmul_rmsnorm_fused:L16.ffn_down        8.11     1.3
matmul_rmsnorm_fused:L15.ffn_down        7.90     1.3
matmul_rmsnorm_fused:L0.ffn_down        7.45     1.2
matmul_rmsnorm_fused:L25.ffn_down        7.38     1.2
matmul_rmsnorm_fused:L8.ffn_down        7.18     1.2
matmul_rmsnorm_fused:L12.ffn_down        7.10     1.2
matmul_rmsnorm_fused:L1.ffn_down        6.68     1.1
matmul_rmsnorm_fused:L18.ffn_down        6.67     1.1
matmul_rmsnorm_fused:L4.ffn_down        6.63     1.1
matmul_rmsnorm_fused:L14.ffn_down        6.59     1.1
matmul_rmsnorm_fused:L10.ffn_down        6.59     1.1
matmul_rmsnorm_fused:L7.ffn_down        6.57     1.1
matmul_rmsnorm_fused:L13.ffn_down        6.57     1.1
matmul_rmsnorm_fused:L6.ffn_down        6.57     1.1
matmul_rmsnorm_fused:L24.ffn_down        6.56     1.1
matmul_rmsnorm_fused:L19.ffn_down        6.56     1.1
matmul_rmsnorm_fused:L5.ffn_down        6.53     1.1
matmul_rmsnorm_fused:L17.ffn_down        6.52     1.1
matmul_rmsnorm_fused:L22.ffn_down        6.52     1.1
matmul_rmsnorm_fused:L3.ffn_down        6.52     1.1
matmul_rmsnorm_fused:L23.ffn_down        6.52     1.1
matmul_rmsnorm_fused:L9.ffn_down        6.51     1.1
matmul_rmsnorm_fused:L21.ffn_down        6.47     1.1
rmsnorm                          3.49     0.6
matmul:o_proj:L0                 2.72     0.4
sample_phase2                    2.43     0.4
matmul:o_proj:L14                1.23     0.2
matmul:o_proj:L4                 0.59     0.1
rope                             0.56     0.1
matmul:o_proj:L8                 0.26     0.0
matmul:o_proj:L11                0.17     0.0
matmul:o_proj:L2                 0.17     0.0
matmul:o_proj:L25                0.16     0.0
matmul:q_proj:L16                0.16     0.0
matmul:o_proj:L20                0.14     0.0
matmul:q_proj:L21                0.14     0.0
matmul:o_proj:L15                0.13     0.0
matmul:o_proj:L10                0.13     0.0
matmul:o_proj:L7                 0.12     0.0
matmul:o_proj:L16                0.12     0.0
matmul:q_proj:L0                 0.12     0.0
matmul:o_proj:L21                0.12     0.0
matmul:o_proj:L3                 0.12     0.0
matmul:o_proj:L1                 0.12     0.0
matmul:q_proj:L2                 0.12     0.0
matmul:o_proj:L12                0.12     0.0
matmul:o_proj:L9                 0.11     0.0
matmul:o_proj:L6                 0.11     0.0
matmul:o_proj:L13                0.11     0.0
matmul:o_proj:L24                0.11     0.0
matmul:o_proj:L23                0.11     0.0
matmul:o_proj:L19                0.11     0.0
matmul:q_proj:L11                0.11     0.0
matmul:q_proj:L12                0.11     0.0
matmul:q_proj:L6                 0.11     0.0
matmul:o_proj:L17                0.10     0.0
matmul:q_proj:L15                0.10     0.0
matmul:q_proj:L3                 0.10     0.0
matmul:q_proj:L7                 0.10     0.0
matmul:q_proj:L4                 0.10     0.0
matmul:q_proj:L20                0.10     0.0
matmul:q_proj:L25                0.10     0.0
matmul:q_proj:L13                0.10     0.0
matmul:o_proj:L18                0.10     0.0
matmul:q_proj:L8                 0.10     0.0
matmul:o_proj:L5                 0.10     0.0
matmul:q_proj:L24                0.10     0.0
matmul:q_proj:L14                0.10     0.0
matmul:q_proj:L1                 0.10     0.0
matmul:o_proj:L22                0.10     0.0
matmul:q_proj:L23                0.10     0.0
matmul:q_proj:L17                0.09     0.0
matmul:q_proj:L10                0.09     0.0
matmul:q_proj:L5                 0.09     0.0
matmul:q_proj:L19                0.09     0.0
matmul:q_proj:L18                0.09     0.0
matmul:q_proj:L9                 0.09     0.0
matmul:q_proj:L22                0.09     0.0
matmul:v_proj:L21                0.06     0.0
matmul:k_proj:L16                0.06     0.0
matmul:k_proj:L21                0.06     0.0
matmul:k_proj:L2                 0.05     0.0
matmul:v_proj:L16                0.05     0.0
sample_phase1                    0.05     0.0
matmul:k_proj:L0                 0.04     0.0
matmul:v_proj:L0                 0.04     0.0
matmul:k_proj:L17                0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:k_proj:L11                0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:v_proj:L23                0.04     0.0
sample_phase3                    0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:k_proj:L7                 0.04     0.0
matmul:k_proj:L12                0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:k_proj:L15                0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:k_proj:L13                0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:k_proj:L8                 0.03     0.0
matmul:v_proj:L12                0.03     0.0
matmul:v_proj:L4                 0.03     0.0
matmul:k_proj:L25                0.03     0.0
matmul:k_proj:L3                 0.03     0.0
matmul:k_proj:L14                0.03     0.0
matmul:k_proj:L4                 0.03     0.0
matmul:v_proj:L20                0.03     0.0
matmul:v_proj:L13                0.03     0.0
matmul:v_proj:L14                0.03     0.0
matmul:v_proj:L8                 0.03     0.0
matmul:k_proj:L24                0.03     0.0
matmul:k_proj:L1                 0.03     0.0
matmul:k_proj:L20                0.03     0.0
matmul:v_proj:L24                0.03     0.0
matmul:v_proj:L19                0.03     0.0
matmul:v_proj:L25                0.03     0.0
matmul:k_proj:L5                 0.03     0.0
matmul:k_proj:L23                0.03     0.0
matmul:k_proj:L9                 0.03     0.0
matmul:k_proj:L10                0.03     0.0
matmul:k_proj:L19                0.03     0.0
matmul:v_proj:L10                0.03     0.0
matmul:k_proj:L18                0.03     0.0
matmul:v_proj:L9                 0.03     0.0
matmul:v_proj:L17                0.03     0.0
matmul:v_proj:L18                0.03     0.0
matmul:v_proj:L5                 0.03     0.0
matmul:k_proj:L22                0.03     0.0
matmul:v_proj:L22                0.03     0.0
gather                           0.01     0.0
scale                            0.01     0.0
──────────────────────────────────────────────────
TOTAL                          614.65   100.0

[browser:log] [44476.0ms][Perf] TTFT: 269ms | Prefill: 160ms | Decode: 40638ms (255 tokens @ 6.3 tok/s)
[browser:log] [44476.3ms][Pipeline] Unloaded
[ok] debug model=gemma-3-1b-it passed=1 failed=0 duration=44257.1ms
[metrics] prompt="Summarize this input in one sentence."
[metrics] load=3349.1ms prefillTokens=9 decodeTokens=256 maxTokens=256
[metrics] ttft=268.9ms prefill=160.2ms decode=40638.1ms total=40907.2ms
[metrics] tok/s total=6.26 prefill=56.18 decode=6.30
