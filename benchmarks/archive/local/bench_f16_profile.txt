[progress] browser launching WebGPU harness...
[progress] browser resolved modelUrl=/models/local/gemma-3-1b-it
[browser:error] Failed to load resource: the server responded with a status of 404 (Not Found)
[browser:log] [190.3ms][OPFSCache] Cache hit: "gemma-3-1b-it"
[browser:log] [GPU] apple metal-3, f16/subgroups, 4.0GB
[browser:log] [203.0ms][Config] Using manifest-first config (source of truth)
[browser:log] [203.8ms][Pipeline] KernelPath: gemma3-f16-f16a (15 decode steps, 10 kernels, source=config)
[browser:log] [203.9ms][Pipeline] 26L/1152H/4heads (256dim), kernelPath=gemma3-f16-f16a
[browser:log] [204.0ms][Tokenizer] Loading bundled tokenizer from tokenizer.json
[browser:log] [340.2ms][Tokenizer] HuggingFace model.type="BPE", using type="bpe"
[browser:log] [561.1ms][Tokenizer] Loaded HuggingFace 262145 tokens (bpe), 9 special patterns, 514906 merges
[browser:log] [561.3ms][Pipeline] Tokenizer vocabSize=262145 differs from model=262144, using model size
[browser:log] [561.9ms][Loader] Initializing...
[browser:log] [593.2ms][HeapManager] Allocated segment 0: 1024MB
[browser:log] [593.3ms][HeapManager] Segmented heap: 1GB per segment
[browser:log] [593.4ms][HeapManager] Initialized with strategy: SEGMENTED
[browser:log] [593.4ms][Loader] Initialized (f16, subgroups, unified)
[browser:log] [593.7ms][Loader] Loading: gemma-3-1b-it
[browser:log] [594.0ms][Loader] [0.0s] Memory (start): | Heap=2.05 GB/2.05 GB (limit=4.00 GB) | GPU=0 B (0 active, 0 pooled, peak=0 B) | ShardCache=0 B (0 shards) | Layers=0, GPUBuffers=0
[browser:log] [2548.8ms][Loader] Embeddings tensor loaded: name=model.embed_tokens.weight, hasShape=true, shape=[262144,1152], isWeightBuffer=true
[browser:log] [2549.0ms][Loader] Layers: 0-25
[browser:log] [3367.4ms][Loader] Layers: 26 complete (0.82s)
[browser:warning] [3372.2ms][Loader] [FinalNorm] Falling back to role-only final norm selection because tensor groups are missing in manifest.
[browser:log] [3373.1ms][Loader] Complete: 0 B in 1.22s (0 B/s)
[browser:log] [3373.3ms][Loader] [2.8s] Memory (complete): | Heap=1.10 GB/1.10 GB (limit=4.00 GB) | GPU=2.04 GB (340 active, 0 pooled, peak=2.04 GB) | ShardCache=0 B (0 shards) | Layers=26, GPUBuffers=340
[browser:log] [3535.9ms][Pipeline] Model loaded successfully
[browser:warning] [3537.2ms][CommandRecorder] maxQuerySetSize unavailable; using fallback 4096
[browser:log] [3567.2ms][KernelSelect] matmul variant=f16 reason=path_override_adaptive_fallback
[browser:log] [3572.8ms][KernelSelect] attention variant=prefill_streaming_f16 reason=path_override:streaming
[browser:warning] [3717.9ms][Profile] Prefill (prefill):
[browser:warning] [3718.2ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                       24.27    21.2
matmul:lm_head                  19.97    17.5
matmul:ffn_up:L0                 2.11     1.8
matmul:ffn_gate:L0               2.10     1.8
rmsnorm                          2.07     1.8
gather                           2.03     1.8
matmul:ffn_gate:L1               1.87     1.6
matmul:ffn_down:L0               1.75     1.5
matmul:ffn_down:L1               1.30     1.1
matmul:ffn_down:L2               1.18     1.0
matmul:ffn_down:L20              0.99     0.9
matmul:ffn_down:L3               0.95     0.8
matmul:ffn_down:L21              0.94     0.8
matmul:ffn_up:L1                 0.93     0.8
matmul:ffn_down:L10              0.85     0.7
matmul:ffn_up:L2                 0.80     0.7
matmul:ffn_down:L11              0.80     0.7
matmul:ffn_gate:L2               0.78     0.7
matmul:ffn_up:L3                 0.77     0.7
matmul:ffn_gate:L3               0.77     0.7
matmul:ffn_down:L4               0.74     0.6
matmul:ffn_down:L9               0.73     0.6
matmul:ffn_down:L19              0.69     0.6
matmul:ffn_down:L8               0.69     0.6
matmul:ffn_down:L14              0.68     0.6
matmul:ffn_down:L24              0.68     0.6
matmul:ffn_down:L16              0.68     0.6
matmul:ffn_down:L25              0.68     0.6
matmul:ffn_down:L7               0.68     0.6
matmul:ffn_down:L23              0.67     0.6
matmul:ffn_down:L18              0.67     0.6
matmul:ffn_down:L6               0.67     0.6
matmul:ffn_down:L17              0.67     0.6
matmul:ffn_down:L15              0.67     0.6
matmul:ffn_down:L12              0.67     0.6
matmul:ffn_down:L22              0.67     0.6
matmul:ffn_down:L5               0.67     0.6
matmul:ffn_down:L13              0.67     0.6
matmul:ffn_gate:L10              0.63     0.6
matmul:ffn_up:L21                0.58     0.5
matmul:ffn_up:L10                0.58     0.5
matmul:ffn_gate:L21              0.57     0.5
matmul:ffn_gate:L11              0.57     0.5
matmul:ffn_up:L11                0.55     0.5
matmul:ffn_gate:L9               0.54     0.5
matmul:ffn_up:L20                0.54     0.5
matmul:ffn_up:L4                 0.54     0.5
matmul:ffn_gate:L14              0.54     0.5
matmul:ffn_gate:L4               0.54     0.5
matmul:ffn_gate:L19              0.54     0.5
matmul:ffn_gate:L16              0.54     0.5
matmul:ffn_up:L16                0.54     0.5
matmul:ffn_up:L19                0.54     0.5
matmul:ffn_up:L8                 0.54     0.5
matmul:ffn_gate:L15              0.54     0.5
matmul:ffn_up:L9                 0.54     0.5
matmul:ffn_up:L14                0.54     0.5
matmul:ffn_gate:L18              0.54     0.5
matmul:ffn_gate:L20              0.54     0.5
matmul:ffn_gate:L5               0.54     0.5
matmul:ffn_up:L22                0.54     0.5
matmul:ffn_gate:L13              0.54     0.5
matmul:ffn_gate:L6               0.54     0.5
matmul:ffn_gate:L7               0.54     0.5
matmul:ffn_up:L18                0.54     0.5
matmul:ffn_gate:L22              0.54     0.5
matmul:ffn_gate:L24              0.54     0.5
matmul:ffn_up:L5                 0.54     0.5
matmul:ffn_up:L7                 0.54     0.5
matmul:ffn_up:L25                0.54     0.5
matmul:ffn_gate:L12              0.54     0.5
matmul:ffn_up:L24                0.54     0.5
matmul:ffn_gate:L8               0.53     0.5
matmul:ffn_up:L15                0.53     0.5
matmul:ffn_up:L6                 0.53     0.5
matmul:ffn_up:L13                0.53     0.5
matmul:ffn_gate:L23              0.53     0.5
matmul:ffn_up:L12                0.53     0.5
matmul:ffn_up:L17                0.53     0.5
matmul:ffn_gate:L25              0.53     0.5
matmul:ffn_up:L23                0.53     0.5
matmul:ffn_gate:L17              0.53     0.5
matmul:q_proj:L0                 0.44     0.4
matmul:o_proj:L0                 0.41     0.4
rope                             0.28     0.2
matmul:o_proj:L1                 0.23     0.2
matmul:v_proj:L0                 0.23     0.2
gelu                             0.22     0.2
matmul:k_proj:L0                 0.22     0.2
matmul:q_proj:L2                 0.20     0.2
matmul:o_proj:L2                 0.18     0.2
matmul:q_proj:L1                 0.17     0.2
matmul:q_proj:L10                0.17     0.1
matmul:q_proj:L21                0.15     0.1
matmul:o_proj:L10                0.15     0.1
matmul:q_proj:L3                 0.15     0.1
matmul:q_proj:L4                 0.14     0.1
matmul:o_proj:L3                 0.14     0.1
matmul:q_proj:L22                0.14     0.1
matmul:q_proj:L11                0.14     0.1
matmul:o_proj:L21                0.14     0.1
matmul:o_proj:L11                0.14     0.1
matmul:k_proj:L10                0.13     0.1
matmul:v_proj:L11                0.12     0.1
matmul:v_proj:L21                0.12     0.1
matmul:k_proj:L22                0.11     0.1
matmul:k_proj:L11                0.11     0.1
matmul:k_proj:L21                0.11     0.1
matmul:v_proj:L22                0.11     0.1
matmul:v_proj:L2                 0.11     0.1
matmul:k_proj:L2                 0.11     0.1
matmul:q_proj:L20                0.10     0.1
matmul:o_proj:L9                 0.10     0.1
matmul:q_proj:L5                 0.10     0.1
matmul:o_proj:L19                0.10     0.1
matmul:o_proj:L4                 0.10     0.1
matmul:o_proj:L22                0.10     0.1
matmul:q_proj:L18                0.10     0.1
matmul:q_proj:L15                0.10     0.1
matmul:q_proj:L12                0.10     0.1
matmul:q_proj:L9                 0.10     0.1
matmul:q_proj:L8                 0.10     0.1
matmul:o_proj:L14                0.10     0.1
matmul:q_proj:L17                0.10     0.1
matmul:q_proj:L19                0.10     0.1
matmul:q_proj:L25                0.10     0.1
matmul:q_proj:L7                 0.10     0.1
matmul:o_proj:L6                 0.10     0.1
matmul:q_proj:L13                0.10     0.1
matmul:q_proj:L24                0.10     0.1
matmul:q_proj:L16                0.10     0.1
matmul:q_proj:L6                 0.10     0.1
matmul:q_proj:L14                0.10     0.1
matmul:o_proj:L13                0.10     0.1
matmul:q_proj:L23                0.10     0.1
matmul:o_proj:L15                0.10     0.1
matmul:o_proj:L25                0.10     0.1
matmul:o_proj:L5                 0.10     0.1
matmul:o_proj:L18                0.10     0.1
matmul:o_proj:L20                0.10     0.1
matmul:o_proj:L8                 0.10     0.1
matmul:o_proj:L12                0.10     0.1
matmul:o_proj:L23                0.10     0.1
matmul:o_proj:L7                 0.10     0.1
matmul:o_proj:L17                0.10     0.1
matmul:o_proj:L24                0.10     0.1
matmul:o_proj:L16                0.10     0.1
matmul:k_proj:L1                 0.08     0.1
matmul:v_proj:L1                 0.08     0.1
matmul:k_proj:L3                 0.07     0.1
matmul:v_proj:L3                 0.07     0.1
matmul:v_proj:L10                0.06     0.0
matmul:k_proj:L9                 0.05     0.0
matmul:v_proj:L20                0.05     0.0
matmul:v_proj:L9                 0.05     0.0
matmul:v_proj:L24                0.05     0.0
matmul:v_proj:L25                0.05     0.0
matmul:k_proj:L20                0.05     0.0
matmul:k_proj:L18                0.05     0.0
matmul:k_proj:L5                 0.05     0.0
matmul:v_proj:L18                0.05     0.0
matmul:k_proj:L15                0.05     0.0
matmul:k_proj:L12                0.05     0.0
matmul:k_proj:L17                0.05     0.0
matmul:k_proj:L19                0.05     0.0
matmul:k_proj:L25                0.05     0.0
matmul:v_proj:L17                0.05     0.0
matmul:v_proj:L15                0.05     0.0
matmul:k_proj:L8                 0.05     0.0
matmul:v_proj:L5                 0.05     0.0
matmul:v_proj:L14                0.05     0.0
matmul:v_proj:L8                 0.05     0.0
matmul:v_proj:L16                0.05     0.0
matmul:v_proj:L13                0.05     0.0
matmul:k_proj:L13                0.05     0.0
matmul:v_proj:L19                0.05     0.0
matmul:k_proj:L7                 0.05     0.0
matmul:k_proj:L14                0.05     0.0
matmul:v_proj:L12                0.05     0.0
matmul:k_proj:L24                0.05     0.0
matmul:k_proj:L16                0.05     0.0
matmul:v_proj:L23                0.05     0.0
matmul:k_proj:L4                 0.05     0.0
matmul:v_proj:L6                 0.05     0.0
matmul:k_proj:L23                0.05     0.0
matmul:k_proj:L6                 0.05     0.0
matmul:v_proj:L7                 0.05     0.0
matmul:v_proj:L4                 0.05     0.0
scale                            0.04     0.0
──────────────────────────────────────────────────
TOTAL                          114.27   100.0

[browser:log] [3848.3ms][KernelSelect] matmul variant=gemv_subgroup_vec4_f16a reason=path_override
[browser:log] [3852.3ms][KernelSelect] attention variant=decode_chunked_f16 reason=path_override:tiled_large
[browser:log] [3866.7ms][KernelSelect] matmul variant=gemv_subgroup_multicol_f16a reason=path_override
[browser:warning] [4276.3ms][Profile] Batch decode (N=4):
[browser:warning] [4276.4ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
fused_ffn                       39.66    11.4
matmul:lm_head                  30.83     8.8
attention                       20.77     6.0
matmul_rmsnorm_fused:L9.ffn_down       11.46     3.3
matmul_rmsnorm_fused:L2.ffn_down       10.45     3.0
matmul_rmsnorm_fused:L20.ffn_down       10.40     3.0
matmul_rmsnorm_fused:L16.ffn_down        9.94     2.9
matmul_rmsnorm_fused:L5.ffn_down        9.90     2.8
matmul_rmsnorm_fused:L24.ffn_down        9.59     2.8
matmul_rmsnorm_fused:L12.ffn_down        9.42     2.7
matmul_rmsnorm_fused:L21.ffn_down        9.35     2.7
matmul_rmsnorm_fused:L13.ffn_down        9.30     2.7
matmul_rmsnorm_fused:L0.ffn_down        9.18     2.6
matmul_rmsnorm_fused:L23.ffn_down        9.15     2.6
matmul_rmsnorm_fused:L19.ffn_down        9.14     2.6
matmul_rmsnorm_fused:L6.ffn_down        9.11     2.6
matmul_rmsnorm_fused:L8.ffn_down        9.10     2.6
matmul_rmsnorm_fused:L17.ffn_down        9.09     2.6
matmul_rmsnorm_fused:L18.ffn_down        8.74     2.5
matmul_rmsnorm_fused:L25.ffn_down        8.71     2.5
matmul_rmsnorm_fused:L7.ffn_down        8.69     2.5
matmul_rmsnorm_fused:L10.ffn_down        8.69     2.5
matmul_rmsnorm_fused:L14.ffn_down        8.68     2.5
matmul_rmsnorm_fused:L1.ffn_down        8.68     2.5
matmul_rmsnorm_fused:L15.ffn_down        8.66     2.5
matmul_rmsnorm_fused:L22.ffn_down        8.66     2.5
matmul_rmsnorm_fused:L3.ffn_down        8.66     2.5
matmul_rmsnorm_fused:L11.ffn_down        8.65     2.5
matmul_rmsnorm_fused:L4.ffn_down        8.63     2.5
sample_phase2                    3.30     0.9
rmsnorm                          3.21     0.9
rope                             0.83     0.2
matmul:o_proj:L10                0.55     0.2
matmul:q_proj:L0                 0.18     0.1
matmul:o_proj:L0                 0.16     0.0
matmul:q_proj:L21                0.16     0.0
matmul:o_proj:L9                 0.15     0.0
matmul:o_proj:L2                 0.15     0.0
matmul:o_proj:L24                0.15     0.0
matmul:o_proj:L20                0.15     0.0
matmul:q_proj:L20                0.15     0.0
matmul:o_proj:L13                0.15     0.0
matmul:q_proj:L13                0.15     0.0
matmul:o_proj:L21                0.15     0.0
matmul:o_proj:L17                0.14     0.0
matmul:q_proj:L9                 0.14     0.0
matmul:q_proj:L24                0.14     0.0
matmul:o_proj:L6                 0.14     0.0
matmul:q_proj:L6                 0.14     0.0
matmul:q_proj:L17                0.13     0.0
matmul:o_proj:L15                0.13     0.0
matmul:o_proj:L18                0.13     0.0
matmul:q_proj:L10                0.13     0.0
matmul:o_proj:L22                0.13     0.0
matmul:q_proj:L19                0.13     0.0
matmul:o_proj:L7                 0.13     0.0
matmul:o_proj:L19                0.13     0.0
matmul:o_proj:L8                 0.13     0.0
matmul:q_proj:L22                0.13     0.0
matmul:q_proj:L3                 0.13     0.0
matmul:q_proj:L18                0.13     0.0
matmul:q_proj:L23                0.13     0.0
matmul:q_proj:L8                 0.13     0.0
matmul:o_proj:L4                 0.13     0.0
matmul:q_proj:L11                0.13     0.0
matmul:o_proj:L5                 0.12     0.0
matmul:o_proj:L25                0.12     0.0
matmul:o_proj:L23                0.12     0.0
matmul:o_proj:L12                0.12     0.0
matmul:q_proj:L7                 0.12     0.0
matmul:q_proj:L5                 0.12     0.0
matmul:q_proj:L14                0.12     0.0
matmul:q_proj:L16                0.12     0.0
matmul:q_proj:L4                 0.12     0.0
matmul:o_proj:L11                0.12     0.0
matmul:o_proj:L16                0.12     0.0
matmul:q_proj:L25                0.12     0.0
matmul:q_proj:L15                0.12     0.0
matmul:q_proj:L12                0.12     0.0
matmul:o_proj:L14                0.12     0.0
matmul:q_proj:L2                 0.12     0.0
matmul:o_proj:L3                 0.12     0.0
matmul:q_proj:L1                 0.12     0.0
matmul:o_proj:L1                 0.12     0.0
sample_phase1                    0.08     0.0
matmul:k_proj:L21                0.07     0.0
matmul:k_proj:L0                 0.07     0.0
matmul:v_proj:L21                0.06     0.0
matmul:v_proj:L0                 0.06     0.0
matmul:v_proj:L20                0.06     0.0
matmul:k_proj:L20                0.06     0.0
matmul:v_proj:L13                0.06     0.0
matmul:k_proj:L24                0.06     0.0
matmul:v_proj:L24                0.06     0.0
matmul:k_proj:L13                0.06     0.0
matmul:v_proj:L9                 0.06     0.0
matmul:k_proj:L9                 0.05     0.0
matmul:k_proj:L17                0.05     0.0
matmul:k_proj:L6                 0.05     0.0
matmul:v_proj:L17                0.05     0.0
matmul:v_proj:L6                 0.05     0.0
sample_phase3                    0.05     0.0
matmul:v_proj:L8                 0.05     0.0
matmul:k_proj:L2                 0.05     0.0
matmul:v_proj:L15                0.05     0.0
matmul:k_proj:L7                 0.05     0.0
matmul:k_proj:L10                0.05     0.0
matmul:v_proj:L10                0.04     0.0
matmul:k_proj:L3                 0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:k_proj:L12                0.04     0.0
matmul:v_proj:L18                0.04     0.0
matmul:v_proj:L5                 0.04     0.0
matmul:k_proj:L14                0.04     0.0
matmul:k_proj:L16                0.04     0.0
matmul:v_proj:L22                0.04     0.0
matmul:k_proj:L15                0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:k_proj:L22                0.04     0.0
matmul:k_proj:L5                 0.04     0.0
matmul:v_proj:L14                0.04     0.0
matmul:k_proj:L11                0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:k_proj:L23                0.04     0.0
matmul:v_proj:L16                0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:k_proj:L18                0.04     0.0
matmul:v_proj:L19                0.04     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:k_proj:L4                 0.04     0.0
matmul:k_proj:L19                0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:k_proj:L1                 0.04     0.0
gather                           0.03     0.0
scale                            0.02     0.0
──────────────────────────────────────────────────
TOTAL                          348.61   100.0

[browser:warning] [4685.0ms][Profile] Batch decode (N=4):
[browser:warning] [4685.2ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
fused_ffn                       39.28    11.0
matmul:lm_head                  31.14     8.7
attention                       27.77     7.8
matmul_rmsnorm_fused:L25.ffn_down       10.51     2.9
matmul_rmsnorm_fused:L20.ffn_down       10.41     2.9
matmul_rmsnorm_fused:L4.ffn_down       10.40     2.9
matmul_rmsnorm_fused:L7.ffn_down       10.35     2.9
matmul_rmsnorm_fused:L1.ffn_down       10.33     2.9
matmul_rmsnorm_fused:L12.ffn_down       10.32     2.9
matmul_rmsnorm_fused:L17.ffn_down       10.00     2.8
matmul_rmsnorm_fused:L9.ffn_down        9.93     2.8
matmul_rmsnorm_fused:L23.ffn_down        9.40     2.6
matmul_rmsnorm_fused:L14.ffn_down        9.35     2.6
matmul_rmsnorm_fused:L15.ffn_down        9.32     2.6
matmul_rmsnorm_fused:L22.ffn_down        9.29     2.6
matmul_rmsnorm_fused:L8.ffn_down        9.02     2.5
matmul_rmsnorm_fused:L18.ffn_down        8.90     2.5
matmul_rmsnorm_fused:L6.ffn_down        8.71     2.4
matmul_rmsnorm_fused:L5.ffn_down        8.71     2.4
matmul_rmsnorm_fused:L24.ffn_down        8.69     2.4
matmul_rmsnorm_fused:L21.ffn_down        8.68     2.4
matmul_rmsnorm_fused:L16.ffn_down        8.68     2.4
matmul_rmsnorm_fused:L2.ffn_down        8.67     2.4
matmul_rmsnorm_fused:L19.ffn_down        8.67     2.4
matmul_rmsnorm_fused:L13.ffn_down        8.67     2.4
matmul_rmsnorm_fused:L11.ffn_down        8.66     2.4
matmul_rmsnorm_fused:L10.ffn_down        8.66     2.4
matmul_rmsnorm_fused:L3.ffn_down        8.66     2.4
matmul_rmsnorm_fused:L0.ffn_down        8.65     2.4
rmsnorm                          3.62     1.0
sample_phase2                    3.31     0.9
rope                             0.76     0.2
matmul:o_proj:L2                 0.43     0.1
matmul:o_proj:L15                0.15     0.0
matmul:o_proj:L9                 0.15     0.0
matmul:q_proj:L15                0.15     0.0
matmul:o_proj:L7                 0.15     0.0
matmul:o_proj:L5                 0.15     0.0
matmul:q_proj:L23                0.15     0.0
matmul:q_proj:L2                 0.15     0.0
matmul:o_proj:L23                0.15     0.0
matmul:q_proj:L0                 0.14     0.0
matmul:q_proj:L20                0.14     0.0
matmul:o_proj:L18                0.14     0.0
matmul:o_proj:L0                 0.14     0.0
matmul:q_proj:L9                 0.14     0.0
matmul:o_proj:L13                0.14     0.0
matmul:q_proj:L5                 0.14     0.0
matmul:q_proj:L7                 0.13     0.0
matmul:q_proj:L13                0.13     0.0
matmul:o_proj:L24                0.13     0.0
matmul:o_proj:L16                0.13     0.0
matmul:q_proj:L18                0.13     0.0
matmul:o_proj:L14                0.13     0.0
matmul:o_proj:L20                0.13     0.0
matmul:o_proj:L3                 0.13     0.0
matmul:o_proj:L12                0.13     0.0
matmul:o_proj:L25                0.13     0.0
matmul:o_proj:L22                0.13     0.0
matmul:q_proj:L21                0.13     0.0
matmul:q_proj:L4                 0.13     0.0
matmul:o_proj:L17                0.13     0.0
matmul:q_proj:L8                 0.13     0.0
matmul:q_proj:L6                 0.13     0.0
matmul:q_proj:L17                0.13     0.0
matmul:q_proj:L12                0.12     0.0
matmul:o_proj:L19                0.12     0.0
matmul:o_proj:L6                 0.12     0.0
matmul:o_proj:L8                 0.12     0.0
matmul:q_proj:L22                0.12     0.0
matmul:q_proj:L25                0.12     0.0
matmul:q_proj:L3                 0.12     0.0
matmul:o_proj:L4                 0.12     0.0
matmul:q_proj:L10                0.12     0.0
matmul:o_proj:L11                0.12     0.0
matmul:q_proj:L14                0.12     0.0
matmul:q_proj:L24                0.12     0.0
matmul:o_proj:L21                0.12     0.0
matmul:q_proj:L16                0.12     0.0
matmul:o_proj:L10                0.12     0.0
matmul:q_proj:L11                0.12     0.0
matmul:q_proj:L1                 0.12     0.0
matmul:o_proj:L1                 0.12     0.0
matmul:q_proj:L19                0.12     0.0
sample_phase1                    0.08     0.0
matmul:k_proj:L23                0.07     0.0
matmul:v_proj:L23                0.07     0.0
matmul:k_proj:L15                0.06     0.0
matmul:v_proj:L15                0.06     0.0
matmul:k_proj:L9                 0.06     0.0
matmul:v_proj:L9                 0.05     0.0
sample_phase3                    0.05     0.0
matmul:k_proj:L18                0.05     0.0
matmul:k_proj:L13                0.05     0.0
matmul:k_proj:L5                 0.05     0.0
matmul:v_proj:L13                0.05     0.0
matmul:v_proj:L18                0.05     0.0
matmul:v_proj:L5                 0.05     0.0
matmul:k_proj:L7                 0.05     0.0
matmul:v_proj:L7                 0.05     0.0
matmul:v_proj:L20                0.05     0.0
matmul:k_proj:L0                 0.05     0.0
matmul:v_proj:L0                 0.05     0.0
matmul:k_proj:L20                0.05     0.0
matmul:k_proj:L21                0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:v_proj:L16                0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:k_proj:L2                 0.04     0.0
matmul:k_proj:L4                 0.04     0.0
matmul:k_proj:L3                 0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:k_proj:L17                0.04     0.0
matmul:k_proj:L16                0.04     0.0
matmul:k_proj:L22                0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:k_proj:L24                0.04     0.0
matmul:k_proj:L1                 0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:k_proj:L12                0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:k_proj:L14                0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:k_proj:L19                0.04     0.0
matmul:k_proj:L10                0.04     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:v_proj:L14                0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:v_proj:L24                0.04     0.0
matmul:v_proj:L22                0.04     0.0
matmul:v_proj:L17                0.04     0.0
matmul:v_proj:L19                0.04     0.0
matmul:k_proj:L11                0.04     0.0
matmul:v_proj:L1                 0.04     0.0
gather                           0.01     0.0
scale                            0.01     0.0
──────────────────────────────────────────────────
TOTAL                          357.23   100.0

[browser:warning] [5109.5ms][Profile] Batch decode (N=4):
[browser:warning] [5109.6ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
fused_ffn                       42.78    11.4
attention                       34.79     9.3
matmul:lm_head                  33.11     8.8
matmul_rmsnorm_fused:L0.ffn_down       13.11     3.5
matmul_rmsnorm_fused:L18.ffn_down       11.58     3.1
matmul_rmsnorm_fused:L8.ffn_down       11.40     3.0
matmul_rmsnorm_fused:L20.ffn_down       10.54     2.8
matmul_rmsnorm_fused:L10.ffn_down       10.42     2.8
matmul_rmsnorm_fused:L7.ffn_down       10.23     2.7
matmul_rmsnorm_fused:L9.ffn_down        9.87     2.6
matmul_rmsnorm_fused:L6.ffn_down        9.59     2.5
matmul_rmsnorm_fused:L17.ffn_down        9.43     2.5
matmul_rmsnorm_fused:L16.ffn_down        9.38     2.5
matmul_rmsnorm_fused:L19.ffn_down        9.25     2.5
matmul_rmsnorm_fused:L5.ffn_down        8.94     2.4
matmul_rmsnorm_fused:L2.ffn_down        8.90     2.4
matmul_rmsnorm_fused:L25.ffn_down        8.87     2.4
matmul_rmsnorm_fused:L24.ffn_down        8.83     2.3
matmul_rmsnorm_fused:L11.ffn_down        8.81     2.3
matmul_rmsnorm_fused:L4.ffn_down        8.80     2.3
matmul_rmsnorm_fused:L3.ffn_down        8.77     2.3
matmul_rmsnorm_fused:L21.ffn_down        8.75     2.3
matmul_rmsnorm_fused:L1.ffn_down        8.75     2.3
matmul_rmsnorm_fused:L15.ffn_down        8.73     2.3
matmul_rmsnorm_fused:L14.ffn_down        8.73     2.3
matmul_rmsnorm_fused:L12.ffn_down        8.72     2.3
matmul_rmsnorm_fused:L13.ffn_down        8.72     2.3
matmul_rmsnorm_fused:L22.ffn_down        8.66     2.3
matmul_rmsnorm_fused:L23.ffn_down        8.64     2.3
rmsnorm                          3.76     1.0
sample_phase2                    3.32     0.9
rope                             0.83     0.2
matmul:o_proj:L11                0.39     0.1
matmul:o_proj:L0                 0.24     0.1
matmul:o_proj:L7                 0.22     0.1
matmul:q_proj:L0                 0.22     0.1
matmul:o_proj:L8                 0.18     0.0
matmul:q_proj:L7                 0.18     0.0
matmul:o_proj:L9                 0.18     0.0
matmul:q_proj:L9                 0.18     0.0
matmul:o_proj:L17                0.17     0.0
matmul:q_proj:L8                 0.17     0.0
matmul:q_proj:L19                0.17     0.0
matmul:o_proj:L6                 0.17     0.0
matmul:q_proj:L17                0.16     0.0
matmul:q_proj:L6                 0.16     0.0
matmul:o_proj:L18                0.16     0.0
matmul:o_proj:L4                 0.16     0.0
matmul:o_proj:L1                 0.16     0.0
matmul:q_proj:L5                 0.15     0.0
matmul:o_proj:L5                 0.15     0.0
matmul:q_proj:L12                0.15     0.0
matmul:q_proj:L25                0.15     0.0
matmul:q_proj:L18                0.15     0.0
matmul:q_proj:L1                 0.15     0.0
matmul:o_proj:L16                0.15     0.0
matmul:q_proj:L11                0.15     0.0
matmul:o_proj:L20                0.15     0.0
matmul:q_proj:L4                 0.15     0.0
matmul:q_proj:L20                0.15     0.0
matmul:o_proj:L19                0.15     0.0
matmul:o_proj:L10                0.15     0.0
matmul:o_proj:L13                0.15     0.0
matmul:o_proj:L2                 0.14     0.0
matmul:o_proj:L21                0.14     0.0
matmul:q_proj:L13                0.14     0.0
matmul:o_proj:L12                0.14     0.0
matmul:q_proj:L22                0.14     0.0
matmul:q_proj:L2                 0.14     0.0
matmul:o_proj:L25                0.14     0.0
matmul:o_proj:L15                0.14     0.0
matmul:q_proj:L21                0.14     0.0
matmul:o_proj:L23                0.13     0.0
matmul:q_proj:L16                0.13     0.0
matmul:q_proj:L14                0.13     0.0
matmul:q_proj:L10                0.13     0.0
matmul:q_proj:L15                0.13     0.0
matmul:o_proj:L14                0.13     0.0
matmul:o_proj:L3                 0.13     0.0
matmul:o_proj:L22                0.13     0.0
matmul:q_proj:L23                0.13     0.0
matmul:o_proj:L24                0.13     0.0
matmul:q_proj:L3                 0.13     0.0
matmul:q_proj:L24                0.12     0.0
sample_phase1                    0.10     0.0
matmul:k_proj:L0                 0.08     0.0
matmul:v_proj:L0                 0.08     0.0
sample_phase3                    0.08     0.0
matmul:k_proj:L9                 0.07     0.0
matmul:k_proj:L7                 0.07     0.0
matmul:v_proj:L9                 0.07     0.0
matmul:k_proj:L19                0.07     0.0
matmul:v_proj:L7                 0.06     0.0
matmul:v_proj:L19                0.06     0.0
matmul:v_proj:L17                0.06     0.0
matmul:k_proj:L17                0.06     0.0
matmul:k_proj:L8                 0.05     0.0
matmul:k_proj:L21                0.05     0.0
matmul:v_proj:L8                 0.05     0.0
matmul:v_proj:L21                0.05     0.0
matmul:k_proj:L12                0.05     0.0
matmul:k_proj:L6                 0.05     0.0
matmul:v_proj:L13                0.05     0.0
matmul:k_proj:L13                0.05     0.0
matmul:k_proj:L25                0.05     0.0
matmul:v_proj:L12                0.05     0.0
matmul:k_proj:L20                0.05     0.0
matmul:k_proj:L11                0.05     0.0
matmul:k_proj:L5                 0.05     0.0
matmul:k_proj:L18                0.05     0.0
matmul:v_proj:L25                0.05     0.0
matmul:v_proj:L11                0.05     0.0
matmul:k_proj:L1                 0.05     0.0
matmul:v_proj:L18                0.05     0.0
matmul:v_proj:L6                 0.05     0.0
matmul:k_proj:L4                 0.05     0.0
matmul:v_proj:L1                 0.05     0.0
matmul:k_proj:L15                0.05     0.0
matmul:v_proj:L5                 0.05     0.0
matmul:k_proj:L2                 0.05     0.0
matmul:k_proj:L10                0.05     0.0
matmul:v_proj:L20                0.05     0.0
matmul:v_proj:L2                 0.05     0.0
matmul:k_proj:L16                0.05     0.0
matmul:v_proj:L4                 0.05     0.0
matmul:v_proj:L22                0.05     0.0
matmul:k_proj:L22                0.05     0.0
matmul:k_proj:L14                0.05     0.0
matmul:v_proj:L14                0.05     0.0
matmul:v_proj:L16                0.05     0.0
matmul:k_proj:L23                0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:k_proj:L3                 0.04     0.0
matmul:k_proj:L24                0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:v_proj:L24                0.04     0.0
gather                           0.04     0.0
scale                            0.04     0.0
──────────────────────────────────────────────────
TOTAL                          376.09   100.0

[browser:warning] [5533.3ms][Profile] Batch decode (N=4):
[browser:warning] [5533.5ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                       41.84    11.2
fused_ffn                       40.57    10.8
matmul:lm_head                  30.60     8.2
matmul_rmsnorm_fused:L18.ffn_down       10.59     2.8
matmul_rmsnorm_fused:L10.ffn_down       10.50     2.8
matmul_rmsnorm_fused:L20.ffn_down       10.47     2.8
matmul_rmsnorm_fused:L8.ffn_down       10.40     2.8
matmul_rmsnorm_fused:L23.ffn_down       10.33     2.8
matmul_rmsnorm_fused:L13.ffn_down       10.21     2.7
matmul_rmsnorm_fused:L3.ffn_down       10.09     2.7
matmul_rmsnorm_fused:L1.ffn_down       10.07     2.7
matmul_rmsnorm_fused:L11.ffn_down        9.85     2.6
matmul_rmsnorm_fused:L0.ffn_down        9.72     2.6
matmul_rmsnorm_fused:L22.ffn_down        9.42     2.5
matmul_rmsnorm_fused:L21.ffn_down        9.24     2.5
matmul_rmsnorm_fused:L12.ffn_down        8.98     2.4
matmul_rmsnorm_fused:L4.ffn_down        8.82     2.4
matmul_rmsnorm_fused:L2.ffn_down        8.79     2.4
matmul_rmsnorm_fused:L25.ffn_down        8.76     2.3
matmul_rmsnorm_fused:L5.ffn_down        8.75     2.3
matmul_rmsnorm_fused:L9.ffn_down        8.70     2.3
matmul_rmsnorm_fused:L16.ffn_down        8.68     2.3
matmul_rmsnorm_fused:L17.ffn_down        8.67     2.3
matmul_rmsnorm_fused:L7.ffn_down        8.67     2.3
matmul_rmsnorm_fused:L19.ffn_down        8.66     2.3
matmul_rmsnorm_fused:L14.ffn_down        8.64     2.3
matmul_rmsnorm_fused:L6.ffn_down        8.64     2.3
matmul_rmsnorm_fused:L15.ffn_down        8.63     2.3
matmul_rmsnorm_fused:L24.ffn_down        8.62     2.3
rmsnorm                          3.95     1.1
sample_phase2                    3.29     0.9
rope                             0.78     0.2
matmul:o_proj:L9                 0.65     0.2
matmul:q_proj:L0                 0.20     0.1
matmul:o_proj:L0                 0.20     0.1
matmul:o_proj:L22                0.17     0.0
matmul:o_proj:L8                 0.15     0.0
matmul:q_proj:L22                0.15     0.0
matmul:o_proj:L2                 0.15     0.0
matmul:q_proj:L3                 0.15     0.0
matmul:o_proj:L12                0.14     0.0
matmul:o_proj:L14                0.14     0.0
matmul:q_proj:L4                 0.14     0.0
matmul:q_proj:L1                 0.14     0.0
matmul:o_proj:L1                 0.14     0.0
matmul:o_proj:L3                 0.14     0.0
matmul:q_proj:L2                 0.14     0.0
matmul:o_proj:L19                0.14     0.0
matmul:o_proj:L4                 0.14     0.0
matmul:o_proj:L20                0.14     0.0
matmul:q_proj:L12                0.13     0.0
matmul:q_proj:L9                 0.13     0.0
matmul:o_proj:L25                0.13     0.0
matmul:o_proj:L18                0.13     0.0
matmul:o_proj:L6                 0.13     0.0
matmul:q_proj:L24                0.13     0.0
matmul:o_proj:L13                0.13     0.0
matmul:q_proj:L14                0.13     0.0
matmul:o_proj:L23                0.13     0.0
matmul:o_proj:L10                0.13     0.0
matmul:q_proj:L19                0.13     0.0
matmul:o_proj:L21                0.13     0.0
matmul:q_proj:L20                0.13     0.0
matmul:o_proj:L11                0.13     0.0
matmul:q_proj:L8                 0.13     0.0
matmul:o_proj:L17                0.13     0.0
matmul:o_proj:L15                0.13     0.0
matmul:q_proj:L25                0.12     0.0
matmul:q_proj:L18                0.12     0.0
matmul:q_proj:L10                0.12     0.0
matmul:q_proj:L21                0.12     0.0
matmul:q_proj:L11                0.12     0.0
matmul:q_proj:L6                 0.12     0.0
matmul:o_proj:L16                0.12     0.0
matmul:q_proj:L23                0.12     0.0
matmul:q_proj:L7                 0.12     0.0
matmul:q_proj:L17                0.12     0.0
matmul:o_proj:L7                 0.12     0.0
matmul:q_proj:L13                0.12     0.0
matmul:o_proj:L24                0.12     0.0
matmul:q_proj:L16                0.12     0.0
matmul:q_proj:L5                 0.12     0.0
matmul:q_proj:L15                0.12     0.0
matmul:o_proj:L5                 0.11     0.0
sample_phase1                    0.08     0.0
matmul:k_proj:L0                 0.06     0.0
matmul:v_proj:L0                 0.06     0.0
matmul:k_proj:L22                0.06     0.0
matmul:v_proj:L22                0.06     0.0
matmul:v_proj:L12                0.06     0.0
matmul:v_proj:L2                 0.05     0.0
matmul:v_proj:L4                 0.05     0.0
matmul:k_proj:L2                 0.05     0.0
matmul:v_proj:L14                0.05     0.0
matmul:k_proj:L24                0.05     0.0
matmul:k_proj:L12                0.05     0.0
sample_phase3                    0.05     0.0
matmul:k_proj:L4                 0.05     0.0
matmul:k_proj:L14                0.05     0.0
matmul:v_proj:L24                0.05     0.0
matmul:k_proj:L3                 0.05     0.0
matmul:k_proj:L1                 0.05     0.0
matmul:v_proj:L3                 0.05     0.0
matmul:k_proj:L15                0.05     0.0
matmul:v_proj:L1                 0.05     0.0
matmul:v_proj:L19                0.05     0.0
matmul:k_proj:L20                0.05     0.0
matmul:k_proj:L23                0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:k_proj:L19                0.04     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:k_proj:L18                0.04     0.0
matmul:k_proj:L16                0.04     0.0
matmul:v_proj:L16                0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:k_proj:L13                0.04     0.0
matmul:k_proj:L10                0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:v_proj:L18                0.04     0.0
matmul:k_proj:L11                0.04     0.0
matmul:k_proj:L17                0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:k_proj:L21                0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:k_proj:L5                 0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:k_proj:L7                 0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:v_proj:L17                0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:v_proj:L5                 0.04     0.0
gather                           0.03     0.0
scale                            0.02     0.0
──────────────────────────────────────────────────
TOTAL                          373.98   100.0

[browser:warning] [5961.5ms][Profile] Batch decode (N=4):
[browser:warning] [5961.7ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                       48.89    12.9
fused_ffn                       40.45    10.6
matmul:lm_head                  30.02     7.9
matmul_rmsnorm_fused:L14.ffn_down       10.47     2.8
matmul_rmsnorm_fused:L5.ffn_down       10.37     2.7
matmul_rmsnorm_fused:L4.ffn_down       10.36     2.7
matmul_rmsnorm_fused:L25.ffn_down       10.32     2.7
matmul_rmsnorm_fused:L15.ffn_down       10.12     2.7
matmul_rmsnorm_fused:L1.ffn_down       10.01     2.6
matmul_rmsnorm_fused:L24.ffn_down       10.01     2.6
matmul_rmsnorm_fused:L2.ffn_down        9.95     2.6
matmul_rmsnorm_fused:L11.ffn_down        9.95     2.6
matmul_rmsnorm_fused:L21.ffn_down        9.86     2.6
matmul_rmsnorm_fused:L13.ffn_down        9.72     2.6
matmul_rmsnorm_fused:L22.ffn_down        9.52     2.5
matmul_rmsnorm_fused:L23.ffn_down        9.37     2.5
matmul_rmsnorm_fused:L12.ffn_down        8.97     2.4
matmul_rmsnorm_fused:L3.ffn_down        8.87     2.3
matmul_rmsnorm_fused:L20.ffn_down        8.77     2.3
matmul_rmsnorm_fused:L10.ffn_down        8.72     2.3
matmul_rmsnorm_fused:L9.ffn_down        8.71     2.3
matmul_rmsnorm_fused:L7.ffn_down        8.69     2.3
matmul_rmsnorm_fused:L18.ffn_down        8.68     2.3
matmul_rmsnorm_fused:L0.ffn_down        8.68     2.3
matmul_rmsnorm_fused:L6.ffn_down        8.67     2.3
matmul_rmsnorm_fused:L16.ffn_down        8.65     2.3
matmul_rmsnorm_fused:L19.ffn_down        8.64     2.3
matmul_rmsnorm_fused:L17.ffn_down        8.62     2.3
matmul_rmsnorm_fused:L8.ffn_down        8.59     2.3
sample_phase2                    3.26     0.9
rmsnorm                          3.19     0.8
rope                             0.82     0.2
matmul:o_proj:L22                0.76     0.2
matmul:o_proj:L2                 0.45     0.1
matmul:o_proj:L13                0.18     0.0
matmul:q_proj:L23                0.16     0.0
matmul:o_proj:L3                 0.15     0.0
matmul:o_proj:L23                0.15     0.0
matmul:o_proj:L0                 0.15     0.0
matmul:q_proj:L24                0.15     0.0
matmul:o_proj:L24                0.15     0.0
matmul:o_proj:L25                0.15     0.0
matmul:q_proj:L13                0.14     0.0
matmul:q_proj:L15                0.14     0.0
matmul:o_proj:L15                0.14     0.0
matmul:q_proj:L3                 0.14     0.0
matmul:o_proj:L12                0.14     0.0
matmul:q_proj:L12                0.14     0.0
matmul:q_proj:L22                0.14     0.0
matmul:q_proj:L5                 0.14     0.0
matmul:q_proj:L25                0.14     0.0
matmul:q_proj:L2                 0.14     0.0
matmul:o_proj:L16                0.14     0.0
matmul:o_proj:L21                0.13     0.0
matmul:o_proj:L11                0.13     0.0
matmul:o_proj:L14                0.13     0.0
matmul:q_proj:L6                 0.13     0.0
matmul:o_proj:L5                 0.13     0.0
matmul:q_proj:L0                 0.13     0.0
matmul:o_proj:L4                 0.13     0.0
matmul:q_proj:L19                0.13     0.0
matmul:o_proj:L10                0.13     0.0
matmul:o_proj:L20                0.13     0.0
matmul:q_proj:L21                0.13     0.0
matmul:o_proj:L1                 0.13     0.0
matmul:q_proj:L4                 0.13     0.0
matmul:q_proj:L14                0.13     0.0
matmul:q_proj:L10                0.12     0.0
matmul:q_proj:L20                0.12     0.0
matmul:q_proj:L9                 0.12     0.0
matmul:q_proj:L11                0.12     0.0
matmul:o_proj:L9                 0.12     0.0
matmul:q_proj:L1                 0.12     0.0
matmul:o_proj:L7                 0.12     0.0
matmul:o_proj:L6                 0.12     0.0
matmul:q_proj:L7                 0.12     0.0
matmul:q_proj:L8                 0.12     0.0
matmul:q_proj:L17                0.12     0.0
matmul:q_proj:L16                0.12     0.0
matmul:o_proj:L18                0.12     0.0
matmul:o_proj:L19                0.12     0.0
matmul:q_proj:L18                0.12     0.0
matmul:o_proj:L17                0.12     0.0
matmul:o_proj:L8                 0.12     0.0
sample_phase1                    0.07     0.0
matmul:k_proj:L23                0.07     0.0
matmul:v_proj:L23                0.07     0.0
matmul:v_proj:L24                0.07     0.0
matmul:k_proj:L24                0.06     0.0
sample_phase3                    0.06     0.0
matmul:k_proj:L13                0.06     0.0
matmul:v_proj:L13                0.06     0.0
matmul:k_proj:L3                 0.05     0.0
matmul:k_proj:L15                0.05     0.0
matmul:v_proj:L15                0.05     0.0
matmul:k_proj:L2                 0.05     0.0
matmul:k_proj:L22                0.05     0.0
matmul:v_proj:L3                 0.05     0.0
matmul:v_proj:L22                0.05     0.0
matmul:k_proj:L6                 0.05     0.0
matmul:k_proj:L5                 0.05     0.0
matmul:v_proj:L2                 0.05     0.0
matmul:v_proj:L5                 0.05     0.0
matmul:k_proj:L12                0.05     0.0
matmul:v_proj:L6                 0.05     0.0
matmul:v_proj:L12                0.05     0.0
matmul:v_proj:L25                0.05     0.0
matmul:v_proj:L19                0.05     0.0
matmul:k_proj:L0                 0.05     0.0
matmul:k_proj:L7                 0.05     0.0
matmul:v_proj:L20                0.05     0.0
matmul:v_proj:L0                 0.05     0.0
matmul:k_proj:L25                0.05     0.0
matmul:k_proj:L19                0.04     0.0
matmul:k_proj:L20                0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:k_proj:L1                 0.04     0.0
matmul:k_proj:L10                0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:k_proj:L14                0.04     0.0
matmul:k_proj:L4                 0.04     0.0
matmul:k_proj:L21                0.04     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:k_proj:L11                0.04     0.0
matmul:v_proj:L14                0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:v_proj:L18                0.04     0.0
matmul:k_proj:L16                0.04     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:k_proj:L17                0.04     0.0
matmul:v_proj:L16                0.04     0.0
matmul:k_proj:L18                0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:v_proj:L17                0.04     0.0
matmul:v_proj:L8                 0.04     0.0
gather                           0.01     0.0
scale                            0.01     0.0
──────────────────────────────────────────────────
TOTAL                          380.44   100.0

[browser:warning] [6405.4ms][Profile] Batch decode (N=4):
[browser:warning] [6405.7ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                       55.69    14.3
fused_ffn                       41.10    10.5
matmul:lm_head                  30.51     7.8
matmul_rmsnorm_fused:L13.ffn_down       12.48     3.2
matmul_rmsnorm_fused:L3.ffn_down       12.31     3.2
matmul_rmsnorm_fused:L14.ffn_down       11.69     3.0
matmul_rmsnorm_fused:L4.ffn_down       11.44     2.9
matmul_rmsnorm_fused:L22.ffn_down       10.67     2.7
matmul_rmsnorm_fused:L24.ffn_down       10.47     2.7
matmul_rmsnorm_fused:L23.ffn_down       10.20     2.6
matmul_rmsnorm_fused:L5.ffn_down        8.93     2.3
matmul_rmsnorm_fused:L21.ffn_down        8.80     2.3
matmul_rmsnorm_fused:L2.ffn_down        8.76     2.2
matmul_rmsnorm_fused:L1.ffn_down        8.75     2.2
matmul_rmsnorm_fused:L12.ffn_down        8.74     2.2
matmul_rmsnorm_fused:L17.ffn_down        8.73     2.2
matmul_rmsnorm_fused:L9.ffn_down        8.72     2.2
matmul_rmsnorm_fused:L10.ffn_down        8.72     2.2
matmul_rmsnorm_fused:L11.ffn_down        8.71     2.2
matmul_rmsnorm_fused:L6.ffn_down        8.70     2.2
matmul_rmsnorm_fused:L16.ffn_down        8.70     2.2
matmul_rmsnorm_fused:L20.ffn_down        8.69     2.2
matmul_rmsnorm_fused:L0.ffn_down        8.69     2.2
matmul_rmsnorm_fused:L25.ffn_down        8.68     2.2
matmul_rmsnorm_fused:L19.ffn_down        8.67     2.2
matmul_rmsnorm_fused:L7.ffn_down        8.66     2.2
matmul_rmsnorm_fused:L8.ffn_down        8.65     2.2
matmul_rmsnorm_fused:L18.ffn_down        8.63     2.2
matmul_rmsnorm_fused:L15.ffn_down        8.61     2.2
rmsnorm                          4.11     1.1
sample_phase2                    3.26     0.8
rope                             0.78     0.2
matmul:o_proj:L4                 0.73     0.2
matmul:o_proj:L24                0.19     0.0
matmul:o_proj:L14                0.18     0.0
matmul:q_proj:L23                0.18     0.0
matmul:o_proj:L23                0.18     0.0
matmul:q_proj:L5                 0.17     0.0
matmul:q_proj:L24                0.17     0.0
matmul:o_proj:L3                 0.16     0.0
matmul:o_proj:L13                0.15     0.0
matmul:q_proj:L4                 0.15     0.0
matmul:o_proj:L5                 0.15     0.0
matmul:q_proj:L13                0.14     0.0
matmul:o_proj:L2                 0.14     0.0
matmul:q_proj:L22                0.14     0.0
matmul:o_proj:L12                0.14     0.0
matmul:o_proj:L0                 0.14     0.0
matmul:q_proj:L14                0.14     0.0
matmul:o_proj:L22                0.14     0.0
matmul:q_proj:L3                 0.14     0.0
matmul:o_proj:L11                0.13     0.0
matmul:q_proj:L2                 0.13     0.0
matmul:o_proj:L21                0.13     0.0
matmul:o_proj:L16                0.13     0.0
matmul:q_proj:L12                0.13     0.0
matmul:q_proj:L0                 0.13     0.0
matmul:o_proj:L10                0.13     0.0
matmul:o_proj:L18                0.13     0.0
matmul:o_proj:L7                 0.13     0.0
matmul:q_proj:L20                0.13     0.0
matmul:q_proj:L21                0.13     0.0
matmul:o_proj:L1                 0.13     0.0
matmul:q_proj:L17                0.13     0.0
matmul:q_proj:L15                0.13     0.0
matmul:q_proj:L19                0.13     0.0
matmul:q_proj:L1                 0.13     0.0
matmul:q_proj:L11                0.13     0.0
matmul:o_proj:L8                 0.13     0.0
matmul:o_proj:L6                 0.13     0.0
matmul:q_proj:L7                 0.13     0.0
matmul:q_proj:L10                0.13     0.0
matmul:q_proj:L8                 0.12     0.0
matmul:o_proj:L15                0.12     0.0
matmul:q_proj:L18                0.12     0.0
matmul:o_proj:L19                0.12     0.0
matmul:q_proj:L9                 0.12     0.0
matmul:o_proj:L20                0.12     0.0
matmul:o_proj:L17                0.12     0.0
matmul:q_proj:L6                 0.12     0.0
matmul:q_proj:L16                0.12     0.0
matmul:o_proj:L9                 0.12     0.0
matmul:q_proj:L25                0.12     0.0
matmul:o_proj:L25                0.12     0.0
matmul:v_proj:L24                0.08     0.0
matmul:k_proj:L24                0.07     0.0
matmul:v_proj:L23                0.07     0.0
matmul:k_proj:L5                 0.07     0.0
matmul:k_proj:L23                0.07     0.0
sample_phase1                    0.07     0.0
matmul:v_proj:L5                 0.07     0.0
matmul:k_proj:L4                 0.06     0.0
matmul:v_proj:L4                 0.06     0.0
matmul:v_proj:L15                0.05     0.0
matmul:k_proj:L22                0.05     0.0
matmul:v_proj:L13                0.05     0.0
matmul:k_proj:L13                0.05     0.0
matmul:k_proj:L3                 0.05     0.0
matmul:v_proj:L22                0.05     0.0
matmul:k_proj:L14                0.05     0.0
matmul:v_proj:L14                0.05     0.0
matmul:v_proj:L0                 0.05     0.0
matmul:k_proj:L20                0.05     0.0
matmul:k_proj:L15                0.05     0.0
matmul:k_proj:L2                 0.05     0.0
matmul:k_proj:L1                 0.05     0.0
matmul:k_proj:L17                0.05     0.0
matmul:v_proj:L3                 0.05     0.0
matmul:v_proj:L25                0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:k_proj:L0                 0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:k_proj:L12                0.04     0.0
matmul:v_proj:L17                0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:k_proj:L18                0.04     0.0
matmul:k_proj:L19                0.04     0.0
matmul:k_proj:L21                0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:k_proj:L7                 0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:k_proj:L11                0.04     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:v_proj:L19                0.04     0.0
matmul:k_proj:L10                0.04     0.0
matmul:k_proj:L16                0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:v_proj:L16                0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:v_proj:L18                0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:k_proj:L25                0.04     0.0
sample_phase3                    0.04     0.0
gather                           0.01     0.0
scale                            0.01     0.0
──────────────────────────────────────────────────
TOTAL                          390.57   100.0

[browser:warning] [6870.5ms][Profile] Batch decode (N=4):
[browser:warning] [6870.6ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                       63.00    16.0
fused_ffn                       39.18     9.9
matmul:lm_head                  30.08     7.6
matmul_rmsnorm_fused:L3.ffn_down       14.84     3.8
matmul_rmsnorm_fused:L22.ffn_down       14.58     3.7
matmul_rmsnorm_fused:L13.ffn_down       14.23     3.6
matmul_rmsnorm_fused:L12.ffn_down        9.30     2.4
matmul_rmsnorm_fused:L23.ffn_down        8.95     2.3
matmul_rmsnorm_fused:L9.ffn_down        8.80     2.2
matmul_rmsnorm_fused:L21.ffn_down        8.77     2.2
matmul_rmsnorm_fused:L2.ffn_down        8.75     2.2
matmul_rmsnorm_fused:L8.ffn_down        8.75     2.2
matmul_rmsnorm_fused:L1.ffn_down        8.74     2.2
matmul_rmsnorm_fused:L17.ffn_down        8.73     2.2
matmul_rmsnorm_fused:L11.ffn_down        8.73     2.2
matmul_rmsnorm_fused:L10.ffn_down        8.72     2.2
matmul_rmsnorm_fused:L20.ffn_down        8.71     2.2
matmul_rmsnorm_fused:L4.ffn_down        8.70     2.2
matmul_rmsnorm_fused:L19.ffn_down        8.69     2.2
matmul_rmsnorm_fused:L14.ffn_down        8.67     2.2
matmul_rmsnorm_fused:L0.ffn_down        8.66     2.2
matmul_rmsnorm_fused:L24.ffn_down        8.66     2.2
matmul_rmsnorm_fused:L6.ffn_down        8.66     2.2
matmul_rmsnorm_fused:L25.ffn_down        8.65     2.2
matmul_rmsnorm_fused:L5.ffn_down        8.65     2.2
matmul_rmsnorm_fused:L7.ffn_down        8.64     2.2
matmul_rmsnorm_fused:L16.ffn_down        8.64     2.2
matmul_rmsnorm_fused:L18.ffn_down        8.64     2.2
matmul_rmsnorm_fused:L15.ffn_down        8.60     2.2
rmsnorm                          3.35     0.8
sample_phase2                    3.29     0.8
matmul:o_proj:L23                0.86     0.2
rope                             0.85     0.2
matmul:o_proj:L4                 0.31     0.1
matmul:o_proj:L13                0.19     0.0
matmul:q_proj:L4                 0.18     0.0
matmul:q_proj:L13                0.17     0.0
matmul:q_proj:L0                 0.17     0.0
matmul:q_proj:L23                0.17     0.0
matmul:q_proj:L10                0.15     0.0
matmul:o_proj:L22                0.15     0.0
matmul:q_proj:L20                0.15     0.0
matmul:o_proj:L2                 0.15     0.0
matmul:o_proj:L3                 0.15     0.0
matmul:o_proj:L10                0.14     0.0
matmul:o_proj:L21                0.14     0.0
matmul:o_proj:L0                 0.14     0.0
matmul:o_proj:L12                0.14     0.0
matmul:o_proj:L18                0.14     0.0
matmul:o_proj:L11                0.14     0.0
matmul:o_proj:L20                0.14     0.0
matmul:q_proj:L3                 0.14     0.0
matmul:q_proj:L14                0.13     0.0
matmul:q_proj:L2                 0.13     0.0
matmul:q_proj:L12                0.13     0.0
matmul:o_proj:L16                0.13     0.0
matmul:q_proj:L22                0.13     0.0
matmul:q_proj:L21                0.13     0.0
matmul:q_proj:L1                 0.13     0.0
matmul:o_proj:L1                 0.13     0.0
matmul:o_proj:L8                 0.13     0.0
matmul:q_proj:L19                0.13     0.0
matmul:q_proj:L11                0.13     0.0
matmul:o_proj:L25                0.12     0.0
matmul:o_proj:L14                0.12     0.0
matmul:q_proj:L18                0.12     0.0
matmul:o_proj:L19                0.12     0.0
matmul:q_proj:L24                0.12     0.0
matmul:o_proj:L17                0.12     0.0
matmul:o_proj:L15                0.12     0.0
matmul:q_proj:L7                 0.12     0.0
matmul:q_proj:L8                 0.12     0.0
matmul:q_proj:L5                 0.12     0.0
matmul:q_proj:L17                0.12     0.0
matmul:o_proj:L5                 0.12     0.0
matmul:o_proj:L24                0.12     0.0
matmul:o_proj:L6                 0.12     0.0
matmul:o_proj:L9                 0.12     0.0
matmul:q_proj:L25                0.12     0.0
matmul:o_proj:L7                 0.12     0.0
matmul:q_proj:L6                 0.12     0.0
matmul:q_proj:L16                0.12     0.0
matmul:q_proj:L15                0.12     0.0
matmul:q_proj:L9                 0.12     0.0
sample_phase1                    0.09     0.0
matmul:v_proj:L4                 0.08     0.0
matmul:k_proj:L4                 0.08     0.0
matmul:k_proj:L13                0.08     0.0
matmul:v_proj:L13                0.07     0.0
matmul:k_proj:L23                0.07     0.0
matmul:v_proj:L23                0.07     0.0
matmul:k_proj:L10                0.06     0.0
sample_phase3                    0.06     0.0
matmul:k_proj:L0                 0.05     0.0
matmul:k_proj:L20                0.05     0.0
matmul:v_proj:L0                 0.05     0.0
matmul:v_proj:L20                0.05     0.0
matmul:v_proj:L10                0.05     0.0
matmul:k_proj:L24                0.05     0.0
matmul:k_proj:L8                 0.05     0.0
matmul:k_proj:L3                 0.05     0.0
matmul:k_proj:L14                0.05     0.0
matmul:k_proj:L2                 0.05     0.0
matmul:v_proj:L14                0.05     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:k_proj:L15                0.04     0.0
matmul:v_proj:L22                0.04     0.0
matmul:k_proj:L22                0.04     0.0
matmul:k_proj:L21                0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:k_proj:L12                0.04     0.0
matmul:k_proj:L1                 0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:k_proj:L18                0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:k_proj:L11                0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:k_proj:L7                 0.04     0.0
matmul:v_proj:L19                0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:v_proj:L24                0.04     0.0
matmul:v_proj:L18                0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:k_proj:L19                0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:k_proj:L17                0.04     0.0
matmul:k_proj:L5                 0.04     0.0
matmul:v_proj:L16                0.04     0.0
matmul:v_proj:L5                 0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:k_proj:L16                0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:v_proj:L17                0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:v_proj:L6                 0.04     0.0
gather                           0.01     0.0
scale                            0.01     0.0
──────────────────────────────────────────────────
TOTAL                          394.74   100.0

[browser:warning] [7323.6ms][Profile] Batch decode (N=4):
[browser:warning] [7323.6ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                       69.99    17.3
fused_ffn                       40.81    10.1
matmul:lm_head                  32.96     8.1
matmul_rmsnorm_fused:L0.ffn_down       12.96     3.2
matmul_rmsnorm_fused:L19.ffn_down       10.85     2.7
matmul_rmsnorm_fused:L8.ffn_down       10.72     2.6
matmul_rmsnorm_fused:L17.ffn_down       10.55     2.6
matmul_rmsnorm_fused:L9.ffn_down       10.53     2.6
matmul_rmsnorm_fused:L18.ffn_down       10.34     2.5
matmul_rmsnorm_fused:L5.ffn_down       10.07     2.5
matmul_rmsnorm_fused:L10.ffn_down        9.51     2.3
matmul_rmsnorm_fused:L23.ffn_down        9.48     2.3
matmul_rmsnorm_fused:L13.ffn_down        9.46     2.3
matmul_rmsnorm_fused:L21.ffn_down        8.79     2.2
matmul_rmsnorm_fused:L7.ffn_down        8.76     2.2
matmul_rmsnorm_fused:L25.ffn_down        8.75     2.2
matmul_rmsnorm_fused:L16.ffn_down        8.73     2.2
matmul_rmsnorm_fused:L6.ffn_down        8.73     2.2
matmul_rmsnorm_fused:L22.ffn_down        8.73     2.2
matmul_rmsnorm_fused:L3.ffn_down        8.72     2.1
matmul_rmsnorm_fused:L1.ffn_down        8.71     2.1
matmul_rmsnorm_fused:L24.ffn_down        8.68     2.1
matmul_rmsnorm_fused:L14.ffn_down        8.66     2.1
matmul_rmsnorm_fused:L2.ffn_down        8.65     2.1
matmul_rmsnorm_fused:L15.ffn_down        8.64     2.1
matmul_rmsnorm_fused:L20.ffn_down        8.62     2.1
matmul_rmsnorm_fused:L11.ffn_down        8.61     2.1
matmul_rmsnorm_fused:L4.ffn_down        8.61     2.1
matmul_rmsnorm_fused:L12.ffn_down        8.60     2.1
rmsnorm                          3.70     0.9
sample_phase2                    3.47     0.9
rope                             0.85     0.2
matmul:o_proj:L18                0.59     0.1
matmul:o_proj:L0                 0.36     0.1
matmul:q_proj:L0                 0.24     0.1
matmul:o_proj:L9                 0.18     0.0
matmul:q_proj:L9                 0.18     0.0
matmul:o_proj:L8                 0.16     0.0
matmul:o_proj:L19                0.15     0.0
matmul:q_proj:L18                0.15     0.0
matmul:q_proj:L1                 0.15     0.0
matmul:o_proj:L10                0.15     0.0
matmul:q_proj:L6                 0.14     0.0
matmul:o_proj:L7                 0.14     0.0
matmul:q_proj:L10                0.14     0.0
matmul:o_proj:L17                0.14     0.0
matmul:q_proj:L19                0.14     0.0
matmul:o_proj:L1                 0.14     0.0
matmul:o_proj:L16                0.13     0.0
matmul:q_proj:L17                0.13     0.0
matmul:o_proj:L6                 0.13     0.0
matmul:q_proj:L8                 0.13     0.0
matmul:o_proj:L25                0.13     0.0
matmul:o_proj:L15                0.13     0.0
matmul:o_proj:L22                0.13     0.0
matmul:q_proj:L23                0.13     0.0
matmul:q_proj:L7                 0.13     0.0
matmul:q_proj:L20                0.13     0.0
matmul:o_proj:L23                0.13     0.0
matmul:o_proj:L13                0.13     0.0
matmul:o_proj:L20                0.12     0.0
matmul:q_proj:L22                0.12     0.0
matmul:o_proj:L3                 0.12     0.0
matmul:o_proj:L4                 0.12     0.0
matmul:q_proj:L13                0.12     0.0
matmul:o_proj:L5                 0.12     0.0
matmul:q_proj:L16                0.12     0.0
matmul:q_proj:L5                 0.12     0.0
matmul:o_proj:L2                 0.12     0.0
matmul:o_proj:L12                0.12     0.0
matmul:q_proj:L21                0.12     0.0
matmul:q_proj:L25                0.12     0.0
matmul:q_proj:L12                0.12     0.0
matmul:o_proj:L14                0.12     0.0
matmul:o_proj:L24                0.12     0.0
matmul:q_proj:L24                0.12     0.0
matmul:q_proj:L3                 0.12     0.0
matmul:q_proj:L15                0.12     0.0
matmul:q_proj:L4                 0.12     0.0
matmul:o_proj:L21                0.12     0.0
matmul:o_proj:L11                0.12     0.0
matmul:q_proj:L14                0.12     0.0
matmul:q_proj:L2                 0.12     0.0
matmul:q_proj:L11                0.12     0.0
sample_phase1                    0.12     0.0
matmul:k_proj:L0                 0.09     0.0
matmul:v_proj:L0                 0.09     0.0
matmul:v_proj:L9                 0.08     0.0
sample_phase3                    0.08     0.0
matmul:k_proj:L9                 0.08     0.0
matmul:k_proj:L19                0.06     0.0
matmul:v_proj:L19                0.06     0.0
matmul:k_proj:L1                 0.06     0.0
matmul:k_proj:L18                0.05     0.0
matmul:v_proj:L1                 0.05     0.0
matmul:v_proj:L18                0.05     0.0
matmul:k_proj:L20                0.05     0.0
matmul:v_proj:L20                0.05     0.0
matmul:k_proj:L12                0.05     0.0
gather                           0.05     0.0
matmul:k_proj:L17                0.05     0.0
matmul:k_proj:L6                 0.05     0.0
matmul:k_proj:L16                0.05     0.0
matmul:v_proj:L17                0.05     0.0
matmul:k_proj:L11                0.05     0.0
matmul:v_proj:L7                 0.05     0.0
matmul:k_proj:L23                0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:k_proj:L10                0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:k_proj:L15                0.04     0.0
matmul:k_proj:L5                 0.04     0.0
matmul:v_proj:L5                 0.04     0.0
matmul:v_proj:L16                0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:k_proj:L7                 0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:k_proj:L13                0.04     0.0
matmul:k_proj:L22                0.04     0.0
matmul:v_proj:L22                0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:k_proj:L24                0.04     0.0
matmul:v_proj:L24                0.04     0.0
matmul:k_proj:L3                 0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:k_proj:L21                0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:k_proj:L4                 0.04     0.0
matmul:k_proj:L14                0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:k_proj:L2                 0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:v_proj:L14                0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:v_proj:L21                0.04     0.0
scale                            0.04     0.0
──────────────────────────────────────────────────
TOTAL                          405.61   100.0

[browser:warning] [7780.1ms][Profile] Batch decode (N=4):
[browser:warning] [7780.3ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                       76.90    18.8
fused_ffn                       40.50     9.9
matmul:lm_head                  30.43     7.5
matmul_rmsnorm_fused:L13.ffn_down       10.75     2.6
matmul_rmsnorm_fused:L4.ffn_down       10.57     2.6
matmul_rmsnorm_fused:L12.ffn_down       10.53     2.6
matmul_rmsnorm_fused:L22.ffn_down       10.49     2.6
matmul_rmsnorm_fused:L3.ffn_down       10.48     2.6
matmul_rmsnorm_fused:L2.ffn_down       10.40     2.5
matmul_rmsnorm_fused:L10.ffn_down       10.35     2.5
matmul_rmsnorm_fused:L21.ffn_down       10.30     2.5
matmul_rmsnorm_fused:L20.ffn_down       10.19     2.5
matmul_rmsnorm_fused:L23.ffn_down       10.13     2.5
matmul_rmsnorm_fused:L14.ffn_down        9.24     2.3
matmul_rmsnorm_fused:L18.ffn_down        8.78     2.1
matmul_rmsnorm_fused:L8.ffn_down        8.74     2.1
matmul_rmsnorm_fused:L1.ffn_down        8.72     2.1
matmul_rmsnorm_fused:L9.ffn_down        8.70     2.1
matmul_rmsnorm_fused:L25.ffn_down        8.70     2.1
matmul_rmsnorm_fused:L11.ffn_down        8.70     2.1
matmul_rmsnorm_fused:L19.ffn_down        8.68     2.1
matmul_rmsnorm_fused:L5.ffn_down        8.68     2.1
matmul_rmsnorm_fused:L0.ffn_down        8.67     2.1
matmul_rmsnorm_fused:L17.ffn_down        8.66     2.1
matmul_rmsnorm_fused:L16.ffn_down        8.66     2.1
matmul_rmsnorm_fused:L6.ffn_down        8.65     2.1
matmul_rmsnorm_fused:L24.ffn_down        8.65     2.1
matmul_rmsnorm_fused:L7.ffn_down        8.61     2.1
matmul_rmsnorm_fused:L15.ffn_down        8.60     2.1
sample_phase2                    3.26     0.8
rmsnorm                          3.01     0.7
rope                             0.76     0.2
matmul:o_proj:L11                0.40     0.1
matmul:o_proj:L4                 0.17     0.0
matmul:q_proj:L0                 0.16     0.0
matmul:o_proj:L20                0.16     0.0
matmul:q_proj:L14                0.16     0.0
matmul:o_proj:L3                 0.15     0.0
matmul:q_proj:L4                 0.15     0.0
matmul:o_proj:L13                0.15     0.0
matmul:o_proj:L23                0.15     0.0
matmul:q_proj:L24                0.15     0.0
matmul:o_proj:L14                0.15     0.0
matmul:q_proj:L22                0.15     0.0
matmul:o_proj:L0                 0.15     0.0
matmul:o_proj:L5                 0.15     0.0
matmul:o_proj:L12                0.14     0.0
matmul:o_proj:L2                 0.14     0.0
matmul:q_proj:L23                0.14     0.0
matmul:o_proj:L21                0.14     0.0
matmul:q_proj:L11                0.14     0.0
matmul:q_proj:L3                 0.14     0.0
matmul:q_proj:L13                0.14     0.0
matmul:o_proj:L22                0.13     0.0
matmul:q_proj:L21                0.13     0.0
matmul:q_proj:L2                 0.13     0.0
matmul:q_proj:L5                 0.13     0.0
matmul:o_proj:L1                 0.13     0.0
matmul:q_proj:L20                0.13     0.0
matmul:o_proj:L18                0.13     0.0
matmul:q_proj:L19                0.13     0.0
matmul:o_proj:L10                0.13     0.0
matmul:q_proj:L12                0.13     0.0
matmul:o_proj:L19                0.13     0.0
matmul:o_proj:L9                 0.13     0.0
matmul:o_proj:L6                 0.13     0.0
matmul:q_proj:L18                0.13     0.0
matmul:q_proj:L10                0.13     0.0
matmul:o_proj:L7                 0.13     0.0
matmul:o_proj:L16                0.12     0.0
matmul:o_proj:L15                0.12     0.0
matmul:q_proj:L1                 0.12     0.0
matmul:o_proj:L24                0.12     0.0
matmul:o_proj:L25                0.12     0.0
matmul:q_proj:L17                0.12     0.0
matmul:q_proj:L15                0.12     0.0
matmul:o_proj:L8                 0.12     0.0
matmul:q_proj:L9                 0.12     0.0
matmul:o_proj:L17                0.12     0.0
matmul:q_proj:L8                 0.12     0.0
matmul:q_proj:L16                0.12     0.0
matmul:q_proj:L7                 0.12     0.0
matmul:q_proj:L6                 0.12     0.0
matmul:q_proj:L25                0.12     0.0
sample_phase1                    0.08     0.0
matmul:k_proj:L14                0.06     0.0
matmul:k_proj:L4                 0.06     0.0
matmul:v_proj:L14                0.05     0.0
matmul:v_proj:L4                 0.05     0.0
sample_phase3                    0.05     0.0
matmul:k_proj:L23                0.05     0.0
matmul:v_proj:L23                0.05     0.0
matmul:v_proj:L22                0.05     0.0
matmul:k_proj:L11                0.05     0.0
matmul:k_proj:L22                0.05     0.0
matmul:k_proj:L5                 0.05     0.0
matmul:k_proj:L0                 0.05     0.0
matmul:v_proj:L5                 0.05     0.0
matmul:v_proj:L11                0.05     0.0
matmul:v_proj:L0                 0.05     0.0
matmul:k_proj:L24                0.05     0.0
matmul:k_proj:L19                0.05     0.0
matmul:k_proj:L13                0.05     0.0
matmul:k_proj:L1                 0.05     0.0
matmul:k_proj:L21                0.05     0.0
matmul:k_proj:L20                0.05     0.0
matmul:k_proj:L2                 0.05     0.0
matmul:v_proj:L24                0.05     0.0
matmul:k_proj:L3                 0.05     0.0
matmul:v_proj:L20                0.05     0.0
matmul:k_proj:L12                0.05     0.0
matmul:v_proj:L21                0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:v_proj:L19                0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:k_proj:L15                0.04     0.0
matmul:k_proj:L18                0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:v_proj:L18                0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:k_proj:L16                0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:v_proj:L16                0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:k_proj:L7                 0.04     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:k_proj:L10                0.04     0.0
matmul:v_proj:L17                0.04     0.0
matmul:k_proj:L17                0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:v_proj:L8                 0.04     0.0
gather                           0.01     0.0
scale                            0.01     0.0
──────────────────────────────────────────────────
TOTAL                          408.32   100.0

[browser:warning] [8245.5ms][Profile] Batch decode (N=4):
[browser:warning] [8245.7ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                       83.98    20.1
fused_ffn                       41.53     9.9
matmul:lm_head                  30.82     7.4
matmul_rmsnorm_fused:L2.ffn_down       10.49     2.5
matmul_rmsnorm_fused:L23.ffn_down       10.43     2.5
matmul_rmsnorm_fused:L11.ffn_down       10.37     2.5
matmul_rmsnorm_fused:L24.ffn_down       10.33     2.5
matmul_rmsnorm_fused:L15.ffn_down       10.30     2.5
matmul_rmsnorm_fused:L20.ffn_down       10.29     2.5
matmul_rmsnorm_fused:L7.ffn_down       10.17     2.4
matmul_rmsnorm_fused:L21.ffn_down        9.73     2.3
matmul_rmsnorm_fused:L12.ffn_down        9.68     2.3
matmul_rmsnorm_fused:L13.ffn_down        9.51     2.3
matmul_rmsnorm_fused:L3.ffn_down        9.43     2.3
matmul_rmsnorm_fused:L5.ffn_down        9.41     2.3
matmul_rmsnorm_fused:L4.ffn_down        9.27     2.2
matmul_rmsnorm_fused:L14.ffn_down        9.24     2.2
matmul_rmsnorm_fused:L22.ffn_down        8.85     2.1
matmul_rmsnorm_fused:L6.ffn_down        8.80     2.1
matmul_rmsnorm_fused:L9.ffn_down        8.72     2.1
matmul_rmsnorm_fused:L1.ffn_down        8.71     2.1
matmul_rmsnorm_fused:L0.ffn_down        8.70     2.1
matmul_rmsnorm_fused:L10.ffn_down        8.70     2.1
matmul_rmsnorm_fused:L19.ffn_down        8.69     2.1
matmul_rmsnorm_fused:L25.ffn_down        8.67     2.1
matmul_rmsnorm_fused:L17.ffn_down        8.65     2.1
matmul_rmsnorm_fused:L18.ffn_down        8.65     2.1
matmul_rmsnorm_fused:L16.ffn_down        8.65     2.1
matmul_rmsnorm_fused:L8.ffn_down        8.63     2.1
sample_phase2                    3.24     0.8
rmsnorm                          2.96     0.7
rope                             0.78     0.2
matmul:o_proj:L16                0.64     0.2
matmul:o_proj:L22                0.56     0.1
matmul:o_proj:L25                0.46     0.1
matmul:o_proj:L13                0.28     0.1
matmul:q_proj:L4                 0.17     0.0
matmul:o_proj:L7                 0.17     0.0
matmul:o_proj:L0                 0.16     0.0
matmul:o_proj:L5                 0.16     0.0
matmul:o_proj:L20                0.16     0.0
matmul:q_proj:L13                0.16     0.0
matmul:o_proj:L4                 0.15     0.0
matmul:o_proj:L11                0.15     0.0
matmul:o_proj:L3                 0.15     0.0
matmul:q_proj:L7                 0.15     0.0
matmul:o_proj:L6                 0.15     0.0
matmul:o_proj:L1                 0.15     0.0
matmul:q_proj:L5                 0.15     0.0
matmul:q_proj:L3                 0.15     0.0
matmul:q_proj:L14                0.15     0.0
matmul:q_proj:L0                 0.14     0.0
matmul:q_proj:L22                0.14     0.0
matmul:o_proj:L14                0.14     0.0
matmul:q_proj:L24                0.14     0.0
matmul:q_proj:L1                 0.14     0.0
matmul:o_proj:L2                 0.14     0.0
matmul:o_proj:L23                0.14     0.0
matmul:o_proj:L15                0.13     0.0
matmul:q_proj:L12                0.13     0.0
matmul:q_proj:L2                 0.13     0.0
matmul:o_proj:L19                0.13     0.0
matmul:q_proj:L6                 0.13     0.0
matmul:o_proj:L12                0.13     0.0
matmul:o_proj:L24                0.13     0.0
matmul:q_proj:L11                0.13     0.0
matmul:q_proj:L21                0.13     0.0
matmul:q_proj:L20                0.13     0.0
matmul:o_proj:L8                 0.13     0.0
matmul:q_proj:L15                0.13     0.0
matmul:o_proj:L21                0.13     0.0
matmul:o_proj:L9                 0.13     0.0
matmul:q_proj:L10                0.12     0.0
matmul:o_proj:L10                0.12     0.0
matmul:o_proj:L17                0.12     0.0
matmul:o_proj:L18                0.12     0.0
matmul:q_proj:L23                0.12     0.0
matmul:q_proj:L16                0.12     0.0
matmul:q_proj:L25                0.12     0.0
matmul:q_proj:L8                 0.12     0.0
matmul:q_proj:L19                0.12     0.0
matmul:q_proj:L9                 0.12     0.0
matmul:q_proj:L18                0.12     0.0
matmul:q_proj:L17                0.12     0.0
matmul:k_proj:L4                 0.07     0.0
sample_phase1                    0.06     0.0
matmul:k_proj:L13                0.06     0.0
matmul:v_proj:L4                 0.06     0.0
matmul:k_proj:L22                0.06     0.0
matmul:v_proj:L5                 0.06     0.0
matmul:k_proj:L14                0.05     0.0
matmul:v_proj:L13                0.05     0.0
matmul:k_proj:L5                 0.05     0.0
matmul:v_proj:L14                0.05     0.0
matmul:k_proj:L3                 0.05     0.0
matmul:v_proj:L3                 0.05     0.0
matmul:v_proj:L22                0.05     0.0
matmul:k_proj:L25                0.05     0.0
matmul:k_proj:L24                0.05     0.0
matmul:k_proj:L7                 0.05     0.0
matmul:v_proj:L7                 0.05     0.0
matmul:v_proj:L24                0.05     0.0
matmul:v_proj:L0                 0.05     0.0
matmul:k_proj:L0                 0.05     0.0
matmul:k_proj:L1                 0.05     0.0
sample_phase3                    0.05     0.0
matmul:v_proj:L2                 0.05     0.0
matmul:v_proj:L1                 0.05     0.0
matmul:k_proj:L11                0.05     0.0
matmul:k_proj:L12                0.04     0.0
matmul:k_proj:L21                0.04     0.0
matmul:k_proj:L15                0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:k_proj:L2                 0.04     0.0
matmul:k_proj:L23                0.04     0.0
matmul:k_proj:L16                0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:k_proj:L10                0.04     0.0
matmul:k_proj:L20                0.04     0.0
matmul:v_proj:L16                0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:v_proj:L18                0.04     0.0
matmul:k_proj:L19                0.04     0.0
matmul:k_proj:L17                0.04     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:k_proj:L18                0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:v_proj:L19                0.04     0.0
matmul:v_proj:L17                0.04     0.0
gather                           0.01     0.0
scale                            0.01     0.0
──────────────────────────────────────────────────
TOTAL                          417.46   100.0

[browser:warning] [8715.2ms][Profile] Batch decode (N=4):
[browser:warning] [8715.4ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                       90.83    21.6
fused_ffn                       39.34     9.3
matmul:lm_head                  31.61     7.5
matmul_rmsnorm_fused:L13.ffn_down       10.45     2.5
matmul_rmsnorm_fused:L6.ffn_down       10.42     2.5
matmul_rmsnorm_fused:L15.ffn_down       10.33     2.5
matmul_rmsnorm_fused:L4.ffn_down       10.28     2.4
matmul_rmsnorm_fused:L11.ffn_down       10.24     2.4
matmul_rmsnorm_fused:L2.ffn_down       10.13     2.4
matmul_rmsnorm_fused:L22.ffn_down       10.11     2.4
matmul_rmsnorm_fused:L16.ffn_down        9.83     2.3
matmul_rmsnorm_fused:L21.ffn_down        9.74     2.3
matmul_rmsnorm_fused:L7.ffn_down        9.65     2.3
matmul_rmsnorm_fused:L24.ffn_down        9.55     2.3
matmul_rmsnorm_fused:L25.ffn_down        9.16     2.2
matmul_rmsnorm_fused:L20.ffn_down        8.89     2.1
matmul_rmsnorm_fused:L8.ffn_down        8.88     2.1
matmul_rmsnorm_fused:L17.ffn_down        8.86     2.1
matmul_rmsnorm_fused:L23.ffn_down        8.79     2.1
matmul_rmsnorm_fused:L3.ffn_down        8.74     2.1
matmul_rmsnorm_fused:L14.ffn_down        8.73     2.1
matmul_rmsnorm_fused:L5.ffn_down        8.73     2.1
matmul_rmsnorm_fused:L9.ffn_down        8.71     2.1
matmul_rmsnorm_fused:L0.ffn_down        8.70     2.1
matmul_rmsnorm_fused:L10.ffn_down        8.69     2.1
matmul_rmsnorm_fused:L1.ffn_down        8.69     2.1
matmul_rmsnorm_fused:L19.ffn_down        8.66     2.1
matmul_rmsnorm_fused:L18.ffn_down        8.63     2.1
matmul_rmsnorm_fused:L12.ffn_down        8.63     2.1
rmsnorm                          3.36     0.8
sample_phase2                    3.27     0.8
rope                             0.73     0.2
matmul:o_proj:L24                0.17     0.0
matmul:o_proj:L6                 0.16     0.0
matmul:q_proj:L0                 0.15     0.0
matmul:o_proj:L21                0.15     0.0
matmul:o_proj:L5                 0.15     0.0
matmul:o_proj:L22                0.15     0.0
matmul:o_proj:L2                 0.15     0.0
matmul:q_proj:L8                 0.15     0.0
matmul:o_proj:L12                0.15     0.0
matmul:q_proj:L24                0.15     0.0
matmul:o_proj:L0                 0.15     0.0
matmul:q_proj:L17                0.14     0.0
matmul:q_proj:L12                0.14     0.0
matmul:o_proj:L8                 0.14     0.0
matmul:o_proj:L13                0.14     0.0
matmul:o_proj:L17                0.14     0.0
matmul:o_proj:L16                0.14     0.0
matmul:o_proj:L23                0.14     0.0
matmul:o_proj:L25                0.14     0.0
matmul:o_proj:L4                 0.14     0.0
matmul:o_proj:L15                0.13     0.0
matmul:q_proj:L5                 0.13     0.0
matmul:o_proj:L20                0.13     0.0
matmul:o_proj:L3                 0.13     0.0
matmul:o_proj:L14                0.13     0.0
matmul:q_proj:L4                 0.13     0.0
matmul:q_proj:L7                 0.13     0.0
matmul:q_proj:L23                0.13     0.0
matmul:q_proj:L16                0.13     0.0
matmul:o_proj:L10                0.13     0.0
matmul:o_proj:L7                 0.13     0.0
matmul:q_proj:L3                 0.13     0.0
matmul:o_proj:L11                0.13     0.0
matmul:q_proj:L6                 0.13     0.0
matmul:q_proj:L15                0.13     0.0
matmul:q_proj:L14                0.13     0.0
matmul:o_proj:L9                 0.13     0.0
matmul:q_proj:L22                0.13     0.0
matmul:q_proj:L21                0.13     0.0
matmul:q_proj:L2                 0.12     0.0
matmul:q_proj:L19                0.12     0.0
matmul:q_proj:L10                0.12     0.0
matmul:q_proj:L13                0.12     0.0
matmul:q_proj:L11                0.12     0.0
matmul:o_proj:L19                0.12     0.0
matmul:q_proj:L20                0.12     0.0
matmul:o_proj:L1                 0.12     0.0
matmul:q_proj:L9                 0.12     0.0
matmul:q_proj:L18                0.12     0.0
matmul:q_proj:L1                 0.12     0.0
matmul:q_proj:L25                0.12     0.0
matmul:o_proj:L18                0.12     0.0
sample_phase1                    0.08     0.0
matmul:k_proj:L24                0.06     0.0
matmul:k_proj:L17                0.06     0.0
matmul:v_proj:L17                0.06     0.0
matmul:v_proj:L8                 0.06     0.0
sample_phase3                    0.06     0.0
matmul:k_proj:L8                 0.06     0.0
matmul:v_proj:L24                0.06     0.0
matmul:v_proj:L0                 0.06     0.0
matmul:k_proj:L12                0.05     0.0
matmul:v_proj:L4                 0.05     0.0
matmul:k_proj:L0                 0.05     0.0
matmul:k_proj:L5                 0.05     0.0
matmul:v_proj:L5                 0.05     0.0
matmul:v_proj:L12                0.05     0.0
matmul:k_proj:L4                 0.05     0.0
matmul:v_proj:L15                0.05     0.0
matmul:k_proj:L22                0.05     0.0
matmul:v_proj:L7                 0.05     0.0
matmul:k_proj:L7                 0.05     0.0
matmul:k_proj:L15                0.05     0.0
matmul:k_proj:L2                 0.05     0.0
matmul:k_proj:L16                0.04     0.0
matmul:k_proj:L23                0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:k_proj:L13                0.04     0.0
matmul:k_proj:L3                 0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:k_proj:L20                0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:k_proj:L14                0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:v_proj:L14                0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:k_proj:L19                0.04     0.0
matmul:k_proj:L1                 0.04     0.0
matmul:v_proj:L16                0.04     0.0
matmul:v_proj:L19                0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:k_proj:L18                0.04     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:v_proj:L22                0.04     0.0
matmul:k_proj:L21                0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:k_proj:L11                0.04     0.0
matmul:k_proj:L10                0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:v_proj:L18                0.04     0.0
matmul:v_proj:L11                0.04     0.0
gather                           0.02     0.0
scale                            0.02     0.0
──────────────────────────────────────────────────
TOTAL                          420.96   100.0

[browser:warning] [9206.6ms][Profile] Batch decode (N=4):
[browser:warning] [9206.7ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                       98.33    22.9
fused_ffn                       39.31     9.2
matmul:lm_head                  30.97     7.2
matmul_rmsnorm_fused:L18.ffn_down       10.45     2.4
matmul_rmsnorm_fused:L0.ffn_down       10.35     2.4
matmul_rmsnorm_fused:L13.ffn_down       10.26     2.4
matmul_rmsnorm_fused:L22.ffn_down       10.10     2.4
matmul_rmsnorm_fused:L20.ffn_down       10.10     2.4
matmul_rmsnorm_fused:L5.ffn_down       10.07     2.3
matmul_rmsnorm_fused:L2.ffn_down        9.95     2.3
matmul_rmsnorm_fused:L24.ffn_down        9.65     2.3
matmul_rmsnorm_fused:L9.ffn_down        9.65     2.2
matmul_rmsnorm_fused:L16.ffn_down        9.51     2.2
matmul_rmsnorm_fused:L11.ffn_down        9.51     2.2
matmul_rmsnorm_fused:L7.ffn_down        9.46     2.2
matmul_rmsnorm_fused:L10.ffn_down        9.32     2.2
matmul_rmsnorm_fused:L21.ffn_down        9.13     2.1
matmul_rmsnorm_fused:L25.ffn_down        9.00     2.1
matmul_rmsnorm_fused:L12.ffn_down        8.93     2.1
matmul_rmsnorm_fused:L6.ffn_down        8.82     2.1
matmul_rmsnorm_fused:L15.ffn_down        8.78     2.0
matmul_rmsnorm_fused:L3.ffn_down        8.75     2.0
matmul_rmsnorm_fused:L4.ffn_down        8.73     2.0
matmul_rmsnorm_fused:L19.ffn_down        8.67     2.0
matmul_rmsnorm_fused:L23.ffn_down        8.67     2.0
matmul_rmsnorm_fused:L14.ffn_down        8.67     2.0
matmul_rmsnorm_fused:L17.ffn_down        8.66     2.0
matmul_rmsnorm_fused:L1.ffn_down        8.65     2.0
matmul_rmsnorm_fused:L8.ffn_down        8.65     2.0
rmsnorm                          3.53     0.8
sample_phase2                    3.29     0.8
rope                             0.91     0.2
matmul:q_proj:L0                 0.23     0.1
matmul:o_proj:L10                0.18     0.0
matmul:o_proj:L21                0.17     0.0
matmul:o_proj:L7                 0.17     0.0
matmul:o_proj:L16                0.17     0.0
matmul:q_proj:L10                0.17     0.0
matmul:o_proj:L5                 0.16     0.0
matmul:o_proj:L22                0.15     0.0
matmul:o_proj:L12                0.15     0.0
matmul:o_proj:L0                 0.15     0.0
matmul:q_proj:L25                0.15     0.0
matmul:q_proj:L12                0.15     0.0
matmul:o_proj:L25                0.15     0.0
matmul:q_proj:L14                0.14     0.0
matmul:q_proj:L21                0.14     0.0
matmul:o_proj:L18                0.14     0.0
matmul:o_proj:L20                0.14     0.0
matmul:o_proj:L3                 0.14     0.0
matmul:q_proj:L22                0.13     0.0
matmul:q_proj:L5                 0.13     0.0
matmul:q_proj:L3                 0.13     0.0
matmul:q_proj:L1                 0.13     0.0
matmul:o_proj:L17                0.13     0.0
matmul:o_proj:L19                0.13     0.0
matmul:q_proj:L23                0.13     0.0
matmul:o_proj:L14                0.13     0.0
matmul:o_proj:L9                 0.13     0.0
matmul:o_proj:L4                 0.13     0.0
matmul:q_proj:L16                0.13     0.0
matmul:o_proj:L1                 0.13     0.0
matmul:o_proj:L8                 0.13     0.0
matmul:o_proj:L11                0.13     0.0
matmul:o_proj:L24                0.13     0.0
matmul:q_proj:L19                0.13     0.0
matmul:q_proj:L7                 0.13     0.0
matmul:o_proj:L13                0.13     0.0
matmul:o_proj:L2                 0.13     0.0
matmul:o_proj:L15                0.13     0.0
matmul:q_proj:L11                0.13     0.0
matmul:o_proj:L6                 0.13     0.0
matmul:q_proj:L20                0.12     0.0
matmul:q_proj:L24                0.12     0.0
matmul:o_proj:L23                0.12     0.0
matmul:q_proj:L6                 0.12     0.0
matmul:q_proj:L17                0.12     0.0
matmul:q_proj:L18                0.12     0.0
matmul:q_proj:L13                0.12     0.0
matmul:q_proj:L9                 0.12     0.0
matmul:q_proj:L2                 0.12     0.0
matmul:q_proj:L8                 0.12     0.0
matmul:q_proj:L15                0.12     0.0
matmul:q_proj:L4                 0.12     0.0
sample_phase1                    0.09     0.0
matmul:v_proj:L0                 0.08     0.0
sample_phase3                    0.08     0.0
matmul:k_proj:L0                 0.08     0.0
matmul:k_proj:L10                0.07     0.0
matmul:v_proj:L25                0.07     0.0
matmul:v_proj:L10                0.06     0.0
matmul:k_proj:L25                0.06     0.0
matmul:k_proj:L3                 0.06     0.0
matmul:k_proj:L12                0.06     0.0
matmul:v_proj:L12                0.06     0.0
matmul:v_proj:L3                 0.06     0.0
matmul:k_proj:L21                0.05     0.0
matmul:k_proj:L14                0.05     0.0
matmul:v_proj:L7                 0.05     0.0
matmul:k_proj:L1                 0.05     0.0
matmul:v_proj:L1                 0.05     0.0
matmul:v_proj:L21                0.05     0.0
matmul:k_proj:L22                0.05     0.0
matmul:v_proj:L14                0.05     0.0
matmul:k_proj:L7                 0.05     0.0
matmul:k_proj:L5                 0.05     0.0
matmul:k_proj:L23                0.04     0.0
matmul:k_proj:L11                0.04     0.0
matmul:k_proj:L16                0.04     0.0
matmul:v_proj:L22                0.04     0.0
matmul:k_proj:L19                0.04     0.0
matmul:v_proj:L5                 0.04     0.0
matmul:k_proj:L15                0.04     0.0
matmul:k_proj:L20                0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:k_proj:L17                0.04     0.0
matmul:v_proj:L16                0.04     0.0
matmul:k_proj:L18                0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:v_proj:L18                0.04     0.0
matmul:v_proj:L17                0.04     0.0
matmul:k_proj:L24                0.04     0.0
matmul:k_proj:L4                 0.04     0.0
matmul:k_proj:L13                0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:v_proj:L19                0.04     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:v_proj:L24                0.04     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:k_proj:L2                 0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:k_proj:L8                 0.04     0.0
gather                           0.03     0.0
scale                            0.02     0.0
──────────────────────────────────────────────────
TOTAL                          428.71   100.0

[browser:warning] [9691.6ms][Profile] Batch decode (N=4):
[browser:warning] [9691.8ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      105.19    24.1
fused_ffn                       39.87     9.1
matmul:lm_head                  31.97     7.3
matmul_rmsnorm_fused:L14.ffn_down       10.54     2.4
matmul_rmsnorm_fused:L17.ffn_down       10.49     2.4
matmul_rmsnorm_fused:L8.ffn_down       10.42     2.4
matmul_rmsnorm_fused:L6.ffn_down       10.40     2.4
matmul_rmsnorm_fused:L0.ffn_down       10.34     2.4
matmul_rmsnorm_fused:L20.ffn_down       10.33     2.4
matmul_rmsnorm_fused:L3.ffn_down       10.15     2.3
matmul_rmsnorm_fused:L9.ffn_down        9.90     2.3
matmul_rmsnorm_fused:L11.ffn_down        9.83     2.2
matmul_rmsnorm_fused:L23.ffn_down        9.71     2.2
matmul_rmsnorm_fused:L16.ffn_down        9.59     2.2
matmul_rmsnorm_fused:L25.ffn_down        9.28     2.1
matmul_rmsnorm_fused:L12.ffn_down        8.85     2.0
matmul_rmsnorm_fused:L22.ffn_down        8.79     2.0
matmul_rmsnorm_fused:L10.ffn_down        8.75     2.0
matmul_rmsnorm_fused:L1.ffn_down        8.73     2.0
matmul_rmsnorm_fused:L24.ffn_down        8.69     2.0
matmul_rmsnorm_fused:L5.ffn_down        8.68     2.0
matmul_rmsnorm_fused:L7.ffn_down        8.68     2.0
matmul_rmsnorm_fused:L15.ffn_down        8.67     2.0
matmul_rmsnorm_fused:L19.ffn_down        8.66     2.0
matmul_rmsnorm_fused:L21.ffn_down        8.66     2.0
matmul_rmsnorm_fused:L2.ffn_down        8.66     2.0
matmul_rmsnorm_fused:L13.ffn_down        8.66     2.0
matmul_rmsnorm_fused:L18.ffn_down        8.63     2.0
matmul_rmsnorm_fused:L4.ffn_down        8.62     2.0
sample_phase2                    3.46     0.8
rmsnorm                          3.06     0.7
rope                             0.77     0.2
matmul:o_proj:L0                 0.47     0.1
matmul:q_proj:L0                 0.19     0.0
matmul:q_proj:L17                0.16     0.0
matmul:o_proj:L3                 0.16     0.0
matmul:o_proj:L6                 0.16     0.0
matmul:o_proj:L9                 0.16     0.0
matmul:q_proj:L15                0.15     0.0
matmul:o_proj:L20                0.15     0.0
matmul:o_proj:L23                0.14     0.0
matmul:q_proj:L11                0.14     0.0
matmul:o_proj:L4                 0.14     0.0
matmul:o_proj:L17                0.14     0.0
matmul:q_proj:L9                 0.14     0.0
matmul:q_proj:L1                 0.14     0.0
matmul:q_proj:L23                0.14     0.0
matmul:o_proj:L12                0.14     0.0
matmul:o_proj:L8                 0.14     0.0
matmul:o_proj:L7                 0.14     0.0
matmul:o_proj:L16                0.14     0.0
matmul:o_proj:L18                0.13     0.0
matmul:o_proj:L15                0.13     0.0
matmul:q_proj:L7                 0.13     0.0
matmul:q_proj:L12                0.13     0.0
matmul:o_proj:L13                0.13     0.0
matmul:o_proj:L1                 0.13     0.0
matmul:o_proj:L11                0.13     0.0
matmul:o_proj:L14                0.13     0.0
matmul:o_proj:L22                0.13     0.0
matmul:o_proj:L2                 0.13     0.0
matmul:o_proj:L25                0.13     0.0
matmul:o_proj:L5                 0.13     0.0
matmul:o_proj:L24                0.13     0.0
matmul:o_proj:L19                0.13     0.0
matmul:q_proj:L10                0.13     0.0
matmul:q_proj:L25                0.13     0.0
matmul:o_proj:L10                0.13     0.0
matmul:q_proj:L21                0.13     0.0
matmul:q_proj:L4                 0.13     0.0
matmul:q_proj:L8                 0.13     0.0
matmul:q_proj:L16                0.12     0.0
matmul:q_proj:L18                0.12     0.0
matmul:q_proj:L20                0.12     0.0
matmul:q_proj:L3                 0.12     0.0
matmul:q_proj:L14                0.12     0.0
matmul:q_proj:L13                0.12     0.0
matmul:q_proj:L22                0.12     0.0
matmul:q_proj:L19                0.12     0.0
matmul:q_proj:L24                0.12     0.0
matmul:q_proj:L2                 0.12     0.0
matmul:o_proj:L21                0.12     0.0
matmul:q_proj:L6                 0.12     0.0
matmul:q_proj:L5                 0.12     0.0
sample_phase1                    0.09     0.0
matmul:k_proj:L0                 0.08     0.0
matmul:v_proj:L0                 0.08     0.0
sample_phase3                    0.07     0.0
matmul:k_proj:L17                0.07     0.0
matmul:v_proj:L17                0.06     0.0
matmul:k_proj:L15                0.05     0.0
matmul:k_proj:L1                 0.05     0.0
matmul:v_proj:L15                0.05     0.0
matmul:k_proj:L12                0.05     0.0
matmul:k_proj:L9                 0.05     0.0
matmul:v_proj:L12                0.05     0.0
matmul:v_proj:L1                 0.05     0.0
matmul:v_proj:L9                 0.05     0.0
matmul:k_proj:L10                0.05     0.0
matmul:k_proj:L14                0.05     0.0
matmul:k_proj:L11                0.05     0.0
matmul:v_proj:L11                0.05     0.0
matmul:v_proj:L23                0.05     0.0
matmul:k_proj:L23                0.05     0.0
matmul:v_proj:L7                 0.05     0.0
matmul:k_proj:L21                0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:k_proj:L19                0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:k_proj:L3                 0.04     0.0
matmul:v_proj:L16                0.04     0.0
matmul:k_proj:L7                 0.04     0.0
matmul:k_proj:L16                0.04     0.0
matmul:k_proj:L20                0.04     0.0
matmul:k_proj:L2                 0.04     0.0
matmul:k_proj:L4                 0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:v_proj:L14                0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:k_proj:L24                0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:k_proj:L13                0.04     0.0
matmul:k_proj:L22                0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:k_proj:L5                 0.04     0.0
matmul:v_proj:L18                0.04     0.0
matmul:v_proj:L24                0.04     0.0
matmul:k_proj:L18                0.04     0.0
matmul:v_proj:L22                0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:v_proj:L19                0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:v_proj:L5                 0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:v_proj:L2                 0.04     0.0
gather                           0.04     0.0
scale                            0.03     0.0
──────────────────────────────────────────────────
TOTAL                          437.04   100.0

[browser:warning] [10183.1ms][Profile] Batch decode (N=4):
[browser:warning] [10183.2ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      112.06    25.3
fused_ffn                       40.15     9.1
matmul:lm_head                  30.59     6.9
matmul_rmsnorm_fused:L9.ffn_down       10.57     2.4
matmul_rmsnorm_fused:L12.ffn_down       10.38     2.3
matmul_rmsnorm_fused:L11.ffn_down       10.38     2.3
matmul_rmsnorm_fused:L23.ffn_down       10.35     2.3
matmul_rmsnorm_fused:L14.ffn_down       10.30     2.3
matmul_rmsnorm_fused:L17.ffn_down       10.21     2.3
matmul_rmsnorm_fused:L21.ffn_down       10.19     2.3
matmul_rmsnorm_fused:L6.ffn_down        9.86     2.2
matmul_rmsnorm_fused:L19.ffn_down        9.84     2.2
matmul_rmsnorm_fused:L3.ffn_down        9.80     2.2
matmul_rmsnorm_fused:L0.ffn_down        9.69     2.2
matmul_rmsnorm_fused:L4.ffn_down        9.34     2.1
matmul_rmsnorm_fused:L1.ffn_down        8.92     2.0
matmul_rmsnorm_fused:L25.ffn_down        8.72     2.0
matmul_rmsnorm_fused:L10.ffn_down        8.70     2.0
matmul_rmsnorm_fused:L22.ffn_down        8.69     2.0
matmul_rmsnorm_fused:L5.ffn_down        8.69     2.0
matmul_rmsnorm_fused:L2.ffn_down        8.68     2.0
matmul_rmsnorm_fused:L16.ffn_down        8.68     2.0
matmul_rmsnorm_fused:L13.ffn_down        8.67     2.0
matmul_rmsnorm_fused:L20.ffn_down        8.65     2.0
matmul_rmsnorm_fused:L24.ffn_down        8.65     2.0
matmul_rmsnorm_fused:L18.ffn_down        8.65     2.0
matmul_rmsnorm_fused:L7.ffn_down        8.64     1.9
matmul_rmsnorm_fused:L8.ffn_down        8.62     1.9
matmul_rmsnorm_fused:L15.ffn_down        8.60     1.9
rmsnorm                          3.91     0.9
sample_phase2                    3.28     0.7
rope                             0.81     0.2
matmul:o_proj:L20                0.62     0.1
matmul:o_proj:L1                 0.31     0.1
matmul:o_proj:L4                 0.18     0.0
matmul:q_proj:L4                 0.18     0.0
matmul:q_proj:L0                 0.17     0.0
matmul:q_proj:L1                 0.16     0.0
matmul:o_proj:L6                 0.15     0.0
matmul:o_proj:L0                 0.15     0.0
matmul:q_proj:L12                0.14     0.0
matmul:q_proj:L10                0.14     0.0
matmul:q_proj:L20                0.14     0.0
matmul:o_proj:L21                0.14     0.0
matmul:q_proj:L18                0.14     0.0
matmul:o_proj:L13                0.13     0.0
matmul:o_proj:L10                0.13     0.0
matmul:o_proj:L3                 0.13     0.0
matmul:q_proj:L24                0.13     0.0
matmul:o_proj:L18                0.13     0.0
matmul:o_proj:L12                0.13     0.0
matmul:o_proj:L11                0.13     0.0
matmul:o_proj:L15                0.13     0.0
matmul:o_proj:L14                0.13     0.0
matmul:o_proj:L16                0.13     0.0
matmul:o_proj:L9                 0.13     0.0
matmul:o_proj:L19                0.13     0.0
matmul:o_proj:L17                0.13     0.0
matmul:o_proj:L24                0.13     0.0
matmul:o_proj:L23                0.13     0.0
matmul:q_proj:L15                0.13     0.0
matmul:o_proj:L2                 0.13     0.0
matmul:q_proj:L7                 0.13     0.0
matmul:o_proj:L25                0.13     0.0
matmul:q_proj:L23                0.13     0.0
matmul:q_proj:L6                 0.13     0.0
matmul:q_proj:L11                0.12     0.0
matmul:q_proj:L14                0.12     0.0
matmul:q_proj:L13                0.12     0.0
matmul:o_proj:L8                 0.12     0.0
matmul:q_proj:L3                 0.12     0.0
matmul:q_proj:L21                0.12     0.0
matmul:o_proj:L22                0.12     0.0
matmul:q_proj:L19                0.12     0.0
matmul:q_proj:L9                 0.12     0.0
matmul:q_proj:L17                0.12     0.0
matmul:o_proj:L7                 0.12     0.0
matmul:q_proj:L22                0.12     0.0
matmul:o_proj:L5                 0.12     0.0
matmul:q_proj:L16                0.12     0.0
matmul:q_proj:L2                 0.12     0.0
matmul:q_proj:L25                0.12     0.0
matmul:q_proj:L5                 0.12     0.0
matmul:q_proj:L8                 0.12     0.0
sample_phase1                    0.08     0.0
matmul:k_proj:L4                 0.08     0.0
matmul:v_proj:L4                 0.08     0.0
matmul:k_proj:L1                 0.07     0.0
matmul:v_proj:L1                 0.06     0.0
matmul:k_proj:L0                 0.06     0.0
sample_phase3                    0.06     0.0
matmul:v_proj:L0                 0.06     0.0
matmul:k_proj:L10                0.05     0.0
matmul:k_proj:L12                0.05     0.0
matmul:k_proj:L20                0.05     0.0
matmul:v_proj:L20                0.05     0.0
matmul:k_proj:L18                0.05     0.0
matmul:k_proj:L24                0.05     0.0
matmul:v_proj:L24                0.05     0.0
matmul:v_proj:L12                0.05     0.0
matmul:k_proj:L15                0.05     0.0
matmul:v_proj:L15                0.05     0.0
matmul:v_proj:L18                0.05     0.0
matmul:k_proj:L21                0.05     0.0
matmul:k_proj:L5                 0.05     0.0
matmul:v_proj:L9                 0.05     0.0
matmul:v_proj:L10                0.05     0.0
matmul:v_proj:L16                0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:k_proj:L3                 0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:k_proj:L13                0.04     0.0
matmul:k_proj:L11                0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:k_proj:L7                 0.04     0.0
matmul:v_proj:L22                0.04     0.0
matmul:k_proj:L16                0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:k_proj:L23                0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:v_proj:L5                 0.04     0.0
matmul:k_proj:L22                0.04     0.0
matmul:k_proj:L2                 0.04     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:k_proj:L17                0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:k_proj:L19                0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:v_proj:L19                0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:v_proj:L17                0.04     0.0
matmul:k_proj:L14                0.04     0.0
matmul:v_proj:L14                0.04     0.0
gather                           0.03     0.0
scale                            0.02     0.0
──────────────────────────────────────────────────
TOTAL                          443.44   100.0

[browser:warning] [10682.0ms][Profile] Batch decode (N=4):
[browser:warning] [10682.2ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      118.81    26.4
fused_ffn                       41.18     9.1
matmul:lm_head                  30.78     6.8
matmul_rmsnorm_fused:L14.ffn_down       10.49     2.3
matmul_rmsnorm_fused:L2.ffn_down       10.35     2.3
matmul_rmsnorm_fused:L22.ffn_down       10.19     2.3
matmul_rmsnorm_fused:L16.ffn_down       10.17     2.3
matmul_rmsnorm_fused:L24.ffn_down        9.98     2.2
matmul_rmsnorm_fused:L6.ffn_down        9.97     2.2
matmul_rmsnorm_fused:L8.ffn_down        9.96     2.2
matmul_rmsnorm_fused:L10.ffn_down        9.79     2.2
matmul_rmsnorm_fused:L21.ffn_down        9.68     2.1
matmul_rmsnorm_fused:L19.ffn_down        9.59     2.1
matmul_rmsnorm_fused:L4.ffn_down        9.45     2.1
matmul_rmsnorm_fused:L13.ffn_down        9.39     2.1
matmul_rmsnorm_fused:L0.ffn_down        8.93     2.0
matmul_rmsnorm_fused:L20.ffn_down        8.84     2.0
matmul_rmsnorm_fused:L18.ffn_down        8.76     1.9
matmul_rmsnorm_fused:L9.ffn_down        8.73     1.9
matmul_rmsnorm_fused:L5.ffn_down        8.73     1.9
matmul_rmsnorm_fused:L12.ffn_down        8.68     1.9
matmul_rmsnorm_fused:L25.ffn_down        8.68     1.9
matmul_rmsnorm_fused:L11.ffn_down        8.68     1.9
matmul_rmsnorm_fused:L1.ffn_down        8.67     1.9
matmul_rmsnorm_fused:L17.ffn_down        8.67     1.9
matmul_rmsnorm_fused:L3.ffn_down        8.65     1.9
matmul_rmsnorm_fused:L7.ffn_down        8.64     1.9
matmul_rmsnorm_fused:L23.ffn_down        8.64     1.9
matmul_rmsnorm_fused:L15.ffn_down        8.64     1.9
sample_phase2                    3.28     0.7
rmsnorm                          3.09     0.7
rope                             0.80     0.2
sample_phase1                    0.68     0.2
matmul:o_proj:L11                0.63     0.1
matmul:o_proj:L16                0.50     0.1
matmul:o_proj:L19                0.19     0.0
matmul:o_proj:L13                0.18     0.0
matmul:q_proj:L5                 0.16     0.0
matmul:q_proj:L0                 0.16     0.0
matmul:q_proj:L19                0.16     0.0
matmul:o_proj:L8                 0.16     0.0
matmul:o_proj:L14                0.16     0.0
matmul:q_proj:L11                0.15     0.0
matmul:q_proj:L13                0.15     0.0
matmul:o_proj:L21                0.15     0.0
matmul:o_proj:L2                 0.15     0.0
matmul:o_proj:L0                 0.15     0.0
matmul:o_proj:L5                 0.14     0.0
matmul:q_proj:L23                0.14     0.0
matmul:q_proj:L3                 0.14     0.0
matmul:o_proj:L3                 0.14     0.0
matmul:q_proj:L14                0.14     0.0
matmul:q_proj:L7                 0.13     0.0
matmul:o_proj:L4                 0.13     0.0
matmul:o_proj:L12                0.13     0.0
matmul:q_proj:L25                0.13     0.0
matmul:o_proj:L20                0.13     0.0
matmul:q_proj:L8                 0.13     0.0
matmul:o_proj:L7                 0.13     0.0
matmul:o_proj:L23                0.13     0.0
matmul:o_proj:L15                0.13     0.0
matmul:o_proj:L6                 0.13     0.0
matmul:o_proj:L24                0.13     0.0
matmul:o_proj:L10                0.13     0.0
matmul:o_proj:L25                0.13     0.0
matmul:o_proj:L22                0.13     0.0
matmul:o_proj:L1                 0.13     0.0
matmul:q_proj:L2                 0.13     0.0
matmul:q_proj:L20                0.13     0.0
matmul:q_proj:L21                0.13     0.0
matmul:q_proj:L15                0.13     0.0
matmul:q_proj:L16                0.13     0.0
matmul:q_proj:L6                 0.12     0.0
matmul:o_proj:L9                 0.12     0.0
matmul:q_proj:L18                0.12     0.0
matmul:q_proj:L12                0.12     0.0
matmul:q_proj:L17                0.12     0.0
matmul:q_proj:L22                0.12     0.0
matmul:q_proj:L10                0.12     0.0
matmul:o_proj:L17                0.12     0.0
matmul:o_proj:L18                0.12     0.0
matmul:q_proj:L24                0.12     0.0
matmul:q_proj:L4                 0.12     0.0
matmul:q_proj:L9                 0.12     0.0
matmul:q_proj:L1                 0.12     0.0
matmul:k_proj:L19                0.07     0.0
matmul:k_proj:L5                 0.07     0.0
matmul:v_proj:L19                0.07     0.0
matmul:v_proj:L5                 0.06     0.0
sample_phase3                    0.06     0.0
matmul:k_proj:L13                0.06     0.0
matmul:k_proj:L0                 0.06     0.0
matmul:k_proj:L11                0.06     0.0
matmul:v_proj:L0                 0.06     0.0
matmul:v_proj:L13                0.06     0.0
matmul:k_proj:L23                0.05     0.0
matmul:v_proj:L23                0.05     0.0
matmul:v_proj:L11                0.05     0.0
matmul:k_proj:L3                 0.05     0.0
matmul:v_proj:L3                 0.05     0.0
matmul:k_proj:L25                0.05     0.0
matmul:k_proj:L7                 0.05     0.0
matmul:v_proj:L7                 0.05     0.0
matmul:v_proj:L25                0.05     0.0
matmul:k_proj:L12                0.05     0.0
matmul:k_proj:L4                 0.05     0.0
matmul:k_proj:L10                0.05     0.0
matmul:v_proj:L24                0.05     0.0
matmul:v_proj:L8                 0.05     0.0
matmul:k_proj:L14                0.05     0.0
matmul:k_proj:L15                0.05     0.0
matmul:k_proj:L8                 0.05     0.0
matmul:k_proj:L17                0.04     0.0
matmul:k_proj:L24                0.04     0.0
matmul:v_proj:L14                0.04     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:k_proj:L20                0.04     0.0
matmul:k_proj:L2                 0.04     0.0
matmul:k_proj:L22                0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:k_proj:L16                0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:k_proj:L21                0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:v_proj:L18                0.04     0.0
matmul:v_proj:L16                0.04     0.0
matmul:v_proj:L17                0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:k_proj:L1                 0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:k_proj:L18                0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:v_proj:L22                0.04     0.0
matmul:v_proj:L6                 0.04     0.0
gather                           0.03     0.0
scale                            0.02     0.0
──────────────────────────────────────────────────
TOTAL                          450.12   100.0

[browser:warning] [11205.7ms][Profile] Batch decode (N=4):
[browser:warning] [11205.9ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      126.42    27.5
fused_ffn                       39.96     8.7
matmul:lm_head                  32.51     7.1
matmul_rmsnorm_fused:L6.ffn_down       11.81     2.6
matmul_rmsnorm_fused:L22.ffn_down       11.44     2.5
matmul_rmsnorm_fused:L18.ffn_down       11.21     2.4
matmul_rmsnorm_fused:L14.ffn_down       11.16     2.4
matmul_rmsnorm_fused:L10.ffn_down       10.55     2.3
matmul_rmsnorm_fused:L2.ffn_down       10.34     2.3
matmul_rmsnorm_fused:L1.ffn_down        9.89     2.2
matmul_rmsnorm_fused:L9.ffn_down        9.11     2.0
matmul_rmsnorm_fused:L17.ffn_down        8.89     1.9
matmul_rmsnorm_fused:L0.ffn_down        8.86     1.9
matmul_rmsnorm_fused:L11.ffn_down        8.83     1.9
matmul_rmsnorm_fused:L15.ffn_down        8.78     1.9
matmul_rmsnorm_fused:L21.ffn_down        8.76     1.9
matmul_rmsnorm_fused:L7.ffn_down        8.75     1.9
matmul_rmsnorm_fused:L25.ffn_down        8.74     1.9
matmul_rmsnorm_fused:L16.ffn_down        8.69     1.9
matmul_rmsnorm_fused:L5.ffn_down        8.68     1.9
matmul_rmsnorm_fused:L13.ffn_down        8.67     1.9
matmul_rmsnorm_fused:L24.ffn_down        8.67     1.9
matmul_rmsnorm_fused:L20.ffn_down        8.64     1.9
matmul_rmsnorm_fused:L4.ffn_down        8.64     1.9
matmul_rmsnorm_fused:L12.ffn_down        8.63     1.9
matmul_rmsnorm_fused:L23.ffn_down        8.63     1.9
matmul_rmsnorm_fused:L8.ffn_down        8.63     1.9
matmul_rmsnorm_fused:L19.ffn_down        8.62     1.9
matmul_rmsnorm_fused:L3.ffn_down        8.62     1.9
rmsnorm                          3.51     0.8
sample_phase2                    3.34     0.7
rope                             0.90     0.2
matmul:q_proj:L0                 0.28     0.1
matmul:o_proj:L18                0.21     0.0
matmul:q_proj:L18                0.19     0.0
matmul:o_proj:L0                 0.17     0.0
matmul:q_proj:L15                0.16     0.0
matmul:q_proj:L23                0.16     0.0
matmul:o_proj:L6                 0.15     0.0
matmul:q_proj:L10                0.15     0.0
matmul:o_proj:L2                 0.15     0.0
matmul:o_proj:L11                0.14     0.0
matmul:o_proj:L10                0.14     0.0
matmul:q_proj:L2                 0.14     0.0
matmul:o_proj:L14                0.14     0.0
matmul:o_proj:L22                0.14     0.0
matmul:o_proj:L9                 0.14     0.0
matmul:o_proj:L15                0.14     0.0
matmul:o_proj:L25                0.14     0.0
matmul:o_proj:L23                0.14     0.0
matmul:o_proj:L5                 0.13     0.0
matmul:q_proj:L11                0.13     0.0
matmul:o_proj:L17                0.13     0.0
matmul:q_proj:L7                 0.13     0.0
matmul:o_proj:L12                0.13     0.0
matmul:o_proj:L4                 0.13     0.0
matmul:o_proj:L13                0.13     0.0
matmul:q_proj:L6                 0.13     0.0
matmul:o_proj:L21                0.13     0.0
matmul:o_proj:L1                 0.13     0.0
matmul:o_proj:L20                0.13     0.0
matmul:o_proj:L16                0.13     0.0
matmul:q_proj:L19                0.13     0.0
matmul:o_proj:L8                 0.13     0.0
matmul:q_proj:L3                 0.13     0.0
matmul:q_proj:L21                0.13     0.0
matmul:q_proj:L22                0.13     0.0
matmul:o_proj:L3                 0.13     0.0
matmul:q_proj:L1                 0.12     0.0
matmul:q_proj:L17                0.12     0.0
matmul:o_proj:L7                 0.12     0.0
matmul:q_proj:L24                0.12     0.0
matmul:q_proj:L13                0.12     0.0
matmul:q_proj:L14                0.12     0.0
matmul:q_proj:L9                 0.12     0.0
matmul:o_proj:L24                0.12     0.0
matmul:q_proj:L25                0.12     0.0
matmul:o_proj:L19                0.12     0.0
matmul:q_proj:L5                 0.12     0.0
matmul:q_proj:L8                 0.12     0.0
matmul:q_proj:L16                0.12     0.0
matmul:q_proj:L4                 0.12     0.0
matmul:q_proj:L20                0.12     0.0
matmul:q_proj:L12                0.11     0.0
sample_phase1                    0.11     0.0
matmul:v_proj:L0                 0.10     0.0
matmul:k_proj:L0                 0.10     0.0
sample_phase3                    0.10     0.0
matmul:k_proj:L18                0.07     0.0
matmul:v_proj:L23                0.06     0.0
matmul:v_proj:L15                0.06     0.0
matmul:k_proj:L23                0.06     0.0
matmul:k_proj:L15                0.06     0.0
gather                           0.06     0.0
matmul:k_proj:L10                0.06     0.0
matmul:v_proj:L10                0.06     0.0
matmul:v_proj:L18                0.06     0.0
matmul:k_proj:L11                0.05     0.0
scale                            0.05     0.0
matmul:v_proj:L2                 0.05     0.0
matmul:k_proj:L2                 0.05     0.0
matmul:v_proj:L11                0.05     0.0
matmul:v_proj:L21                0.05     0.0
matmul:v_proj:L3                 0.05     0.0
matmul:k_proj:L12                0.05     0.0
matmul:k_proj:L21                0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:k_proj:L17                0.04     0.0
matmul:k_proj:L1                 0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:k_proj:L19                0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:k_proj:L7                 0.04     0.0
matmul:k_proj:L3                 0.04     0.0
matmul:v_proj:L22                0.04     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:k_proj:L5                 0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:k_proj:L22                0.04     0.0
matmul:k_proj:L4                 0.04     0.0
matmul:k_proj:L13                0.04     0.0
matmul:v_proj:L17                0.04     0.0
matmul:v_proj:L14                0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:v_proj:L16                0.04     0.0
matmul:k_proj:L20                0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:v_proj:L19                0.04     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:k_proj:L14                0.04     0.0
matmul:k_proj:L24                0.04     0.0
matmul:v_proj:L5                 0.04     0.0
matmul:k_proj:L16                0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:v_proj:L24                0.04     0.0
matmul:v_proj:L20                0.04     0.0
──────────────────────────────────────────────────
TOTAL                          458.88   100.0

[browser:warning] [11721.5ms][Profile] Batch decode (N=4):
[browser:warning] [11721.6ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      133.37    28.6
fused_ffn                       41.25     8.8
matmul:lm_head                  30.62     6.6
matmul_rmsnorm_fused:L19.ffn_down       11.79     2.5
matmul_rmsnorm_fused:L3.ffn_down       10.65     2.3
matmul_rmsnorm_fused:L23.ffn_down       10.55     2.3
matmul_rmsnorm_fused:L7.ffn_down       10.43     2.2
matmul_rmsnorm_fused:L11.ffn_down       10.18     2.2
matmul_rmsnorm_fused:L16.ffn_down       10.18     2.2
matmul_rmsnorm_fused:L24.ffn_down       10.12     2.2
matmul_rmsnorm_fused:L8.ffn_down       10.01     2.1
matmul_rmsnorm_fused:L15.ffn_down        9.94     2.1
matmul_rmsnorm_fused:L0.ffn_down        9.59     2.1
matmul_rmsnorm_fused:L12.ffn_down        9.54     2.0
matmul_rmsnorm_fused:L4.ffn_down        9.07     1.9
matmul_rmsnorm_fused:L9.ffn_down        8.92     1.9
matmul_rmsnorm_fused:L25.ffn_down        8.84     1.9
matmul_rmsnorm_fused:L10.ffn_down        8.72     1.9
matmul_rmsnorm_fused:L6.ffn_down        8.70     1.9
matmul_rmsnorm_fused:L14.ffn_down        8.70     1.9
matmul_rmsnorm_fused:L17.ffn_down        8.70     1.9
matmul_rmsnorm_fused:L22.ffn_down        8.68     1.9
matmul_rmsnorm_fused:L2.ffn_down        8.68     1.9
matmul_rmsnorm_fused:L21.ffn_down        8.68     1.9
matmul_rmsnorm_fused:L18.ffn_down        8.67     1.9
matmul_rmsnorm_fused:L5.ffn_down        8.67     1.9
matmul_rmsnorm_fused:L1.ffn_down        8.65     1.9
matmul_rmsnorm_fused:L13.ffn_down        8.65     1.9
matmul_rmsnorm_fused:L20.ffn_down        8.62     1.8
sample_phase2                    3.29     0.7
rmsnorm                          3.15     0.7
rope                             0.74     0.2
matmul:v_proj:L8                 0.62     0.1
matmul:o_proj:L0                 0.49     0.1
matmul:o_proj:L12                0.20     0.0
matmul:q_proj:L0                 0.19     0.0
matmul:o_proj:L4                 0.16     0.0
matmul:o_proj:L24                0.15     0.0
matmul:o_proj:L22                0.15     0.0
matmul:o_proj:L11                0.15     0.0
matmul:o_proj:L8                 0.15     0.0
matmul:o_proj:L16                0.15     0.0
matmul:o_proj:L13                0.15     0.0
matmul:o_proj:L21                0.15     0.0
matmul:q_proj:L20                0.15     0.0
matmul:q_proj:L4                 0.15     0.0
matmul:o_proj:L23                0.14     0.0
matmul:q_proj:L16                0.14     0.0
matmul:o_proj:L20                0.14     0.0
matmul:q_proj:L8                 0.14     0.0
matmul:o_proj:L19                0.14     0.0
matmul:o_proj:L3                 0.14     0.0
matmul:o_proj:L7                 0.13     0.0
matmul:q_proj:L7                 0.13     0.0
matmul:o_proj:L2                 0.13     0.0
matmul:o_proj:L10                0.13     0.0
matmul:o_proj:L18                0.13     0.0
matmul:o_proj:L15                0.13     0.0
matmul:o_proj:L6                 0.13     0.0
matmul:o_proj:L14                0.13     0.0
matmul:q_proj:L12                0.13     0.0
matmul:q_proj:L25                0.13     0.0
matmul:q_proj:L14                0.13     0.0
matmul:o_proj:L25                0.13     0.0
matmul:q_proj:L17                0.12     0.0
matmul:o_proj:L9                 0.12     0.0
matmul:q_proj:L24                0.12     0.0
matmul:q_proj:L15                0.12     0.0
matmul:q_proj:L22                0.12     0.0
matmul:o_proj:L5                 0.12     0.0
matmul:q_proj:L23                0.12     0.0
matmul:q_proj:L9                 0.12     0.0
matmul:q_proj:L3                 0.12     0.0
matmul:q_proj:L10                0.12     0.0
matmul:o_proj:L17                0.12     0.0
matmul:q_proj:L19                0.12     0.0
matmul:q_proj:L6                 0.12     0.0
matmul:q_proj:L18                0.12     0.0
matmul:q_proj:L11                0.12     0.0
matmul:q_proj:L2                 0.12     0.0
matmul:q_proj:L1                 0.12     0.0
matmul:o_proj:L1                 0.12     0.0
matmul:q_proj:L13                0.12     0.0
matmul:q_proj:L5                 0.12     0.0
matmul:q_proj:L21                0.11     0.0
matmul:k_proj:L0                 0.09     0.0
matmul:v_proj:L0                 0.09     0.0
sample_phase3                    0.08     0.0
sample_phase1                    0.08     0.0
matmul:v_proj:L16                0.06     0.0
matmul:k_proj:L16                0.06     0.0
matmul:k_proj:L20                0.05     0.0
matmul:v_proj:L20                0.05     0.0
matmul:k_proj:L15                0.05     0.0
matmul:v_proj:L12                0.05     0.0
matmul:k_proj:L12                0.05     0.0
matmul:k_proj:L21                0.05     0.0
matmul:k_proj:L7                 0.05     0.0
matmul:k_proj:L4                 0.05     0.0
matmul:v_proj:L7                 0.05     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:k_proj:L1                 0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:v_proj:L24                0.04     0.0
matmul:k_proj:L17                0.04     0.0
matmul:k_proj:L11                0.04     0.0
matmul:k_proj:L19                0.04     0.0
matmul:k_proj:L22                0.04     0.0
matmul:k_proj:L24                0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:k_proj:L10                0.04     0.0
matmul:k_proj:L3                 0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:k_proj:L23                0.04     0.0
matmul:k_proj:L2                 0.04     0.0
matmul:k_proj:L14                0.04     0.0
matmul:k_proj:L18                0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:v_proj:L22                0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:k_proj:L5                 0.04     0.0
matmul:k_proj:L13                0.04     0.0
matmul:v_proj:L19                0.04     0.0
matmul:v_proj:L17                0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:v_proj:L14                0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:v_proj:L18                0.04     0.0
matmul:v_proj:L5                 0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:v_proj:L3                 0.04     0.0
gather                           0.04     0.0
scale                            0.04     0.0
──────────────────────────────────────────────────
TOTAL                          466.87   100.0

[browser:warning] [12240.2ms][Profile] Batch decode (N=4):
[browser:warning] [12240.3ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      140.60    29.8
fused_ffn                       39.65     8.4
matmul:lm_head                  30.68     6.5
matmul_rmsnorm_fused:L12.ffn_down       11.94     2.5
matmul_rmsnorm_fused:L22.ffn_down       10.58     2.2
matmul_rmsnorm_fused:L0.ffn_down       10.49     2.2
matmul_rmsnorm_fused:L8.ffn_down       10.40     2.2
matmul_rmsnorm_fused:L23.ffn_down       10.16     2.2
matmul_rmsnorm_fused:L3.ffn_down       10.12     2.1
matmul_rmsnorm_fused:L19.ffn_down        9.98     2.1
matmul_rmsnorm_fused:L6.ffn_down        9.60     2.0
matmul_rmsnorm_fused:L14.ffn_down        9.47     2.0
matmul_rmsnorm_fused:L15.ffn_down        9.23     2.0
matmul_rmsnorm_fused:L5.ffn_down        9.12     1.9
matmul_rmsnorm_fused:L4.ffn_down        9.10     1.9
matmul_rmsnorm_fused:L21.ffn_down        9.07     1.9
matmul_rmsnorm_fused:L20.ffn_down        9.03     1.9
matmul_rmsnorm_fused:L16.ffn_down        8.96     1.9
matmul_rmsnorm_fused:L11.ffn_down        8.89     1.9
matmul_rmsnorm_fused:L7.ffn_down        8.81     1.9
matmul_rmsnorm_fused:L24.ffn_down        8.73     1.9
matmul_rmsnorm_fused:L25.ffn_down        8.72     1.8
matmul_rmsnorm_fused:L9.ffn_down        8.71     1.8
matmul_rmsnorm_fused:L10.ffn_down        8.67     1.8
matmul_rmsnorm_fused:L2.ffn_down        8.66     1.8
matmul_rmsnorm_fused:L13.ffn_down        8.65     1.8
matmul_rmsnorm_fused:L17.ffn_down        8.64     1.8
matmul_rmsnorm_fused:L1.ffn_down        8.63     1.8
matmul_rmsnorm_fused:L18.ffn_down        8.62     1.8
rmsnorm                          3.77     0.8
sample_phase2                    3.27     0.7
rope                             0.89     0.2
matmul:q_proj:L0                 0.18     0.0
matmul:o_proj:L19                0.16     0.0
matmul:q_proj:L7                 0.16     0.0
matmul:q_proj:L15                0.15     0.0
matmul:q_proj:L5                 0.15     0.0
matmul:o_proj:L0                 0.15     0.0
matmul:o_proj:L5                 0.15     0.0
matmul:q_proj:L16                0.15     0.0
matmul:o_proj:L16                0.14     0.0
matmul:q_proj:L21                0.14     0.0
matmul:o_proj:L24                0.14     0.0
matmul:o_proj:L3                 0.14     0.0
matmul:q_proj:L24                0.14     0.0
matmul:o_proj:L21                0.14     0.0
matmul:o_proj:L22                0.14     0.0
matmul:o_proj:L15                0.14     0.0
matmul:q_proj:L13                0.14     0.0
matmul:o_proj:L13                0.14     0.0
matmul:o_proj:L7                 0.13     0.0
matmul:q_proj:L4                 0.13     0.0
matmul:o_proj:L14                0.13     0.0
matmul:o_proj:L11                0.13     0.0
matmul:q_proj:L9                 0.13     0.0
matmul:q_proj:L1                 0.13     0.0
matmul:o_proj:L4                 0.13     0.0
matmul:o_proj:L12                0.13     0.0
matmul:o_proj:L6                 0.13     0.0
matmul:o_proj:L9                 0.13     0.0
matmul:o_proj:L20                0.13     0.0
matmul:o_proj:L10                0.13     0.0
matmul:o_proj:L18                0.13     0.0
matmul:o_proj:L25                0.13     0.0
matmul:o_proj:L8                 0.13     0.0
matmul:q_proj:L23                0.13     0.0
matmul:o_proj:L2                 0.12     0.0
matmul:o_proj:L23                0.12     0.0
matmul:o_proj:L1                 0.12     0.0
matmul:q_proj:L25                0.12     0.0
matmul:o_proj:L17                0.12     0.0
matmul:q_proj:L3                 0.12     0.0
matmul:q_proj:L20                0.12     0.0
matmul:q_proj:L18                0.12     0.0
matmul:q_proj:L6                 0.12     0.0
matmul:q_proj:L12                0.12     0.0
matmul:q_proj:L22                0.12     0.0
matmul:q_proj:L11                0.12     0.0
matmul:q_proj:L19                0.12     0.0
matmul:q_proj:L10                0.12     0.0
matmul:q_proj:L14                0.12     0.0
matmul:q_proj:L8                 0.12     0.0
matmul:q_proj:L17                0.12     0.0
matmul:q_proj:L2                 0.12     0.0
sample_phase1                    0.08     0.0
matmul:v_proj:L0                 0.07     0.0
matmul:k_proj:L15                0.07     0.0
matmul:k_proj:L0                 0.07     0.0
sample_phase3                    0.06     0.0
matmul:v_proj:L7                 0.06     0.0
matmul:k_proj:L7                 0.06     0.0
matmul:k_proj:L5                 0.06     0.0
matmul:v_proj:L5                 0.06     0.0
matmul:v_proj:L16                0.06     0.0
matmul:v_proj:L15                0.06     0.0
matmul:k_proj:L16                0.06     0.0
matmul:k_proj:L21                0.06     0.0
matmul:v_proj:L21                0.06     0.0
matmul:v_proj:L24                0.06     0.0
matmul:k_proj:L24                0.05     0.0
matmul:k_proj:L9                 0.05     0.0
matmul:k_proj:L13                0.05     0.0
matmul:k_proj:L4                 0.05     0.0
matmul:v_proj:L9                 0.05     0.0
matmul:v_proj:L13                0.05     0.0
matmul:v_proj:L4                 0.05     0.0
matmul:k_proj:L1                 0.05     0.0
matmul:v_proj:L1                 0.05     0.0
matmul:k_proj:L11                0.04     0.0
matmul:k_proj:L3                 0.04     0.0
matmul:k_proj:L23                0.04     0.0
matmul:k_proj:L22                0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:k_proj:L20                0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:k_proj:L12                0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:k_proj:L14                0.04     0.0
matmul:k_proj:L2                 0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:k_proj:L17                0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:v_proj:L19                0.04     0.0
matmul:k_proj:L10                0.04     0.0
matmul:v_proj:L22                0.04     0.0
matmul:k_proj:L19                0.04     0.0
matmul:k_proj:L18                0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:v_proj:L17                0.04     0.0
matmul:v_proj:L18                0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:v_proj:L14                0.04     0.0
gather                           0.03     0.0
scale                            0.02     0.0
──────────────────────────────────────────────────
TOTAL                          471.45   100.0

[browser:warning] [12768.8ms][Profile] Batch decode (N=4):
[browser:warning] [12769.0ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      147.51    30.8
fused_ffn                       39.20     8.2
matmul:lm_head                  30.60     6.4
matmul_rmsnorm_fused:L15.ffn_down       11.02     2.3
matmul_rmsnorm_fused:L23.ffn_down       10.70     2.2
matmul_rmsnorm_fused:L10.ffn_down       10.57     2.2
matmul_rmsnorm_fused:L18.ffn_down       10.50     2.2
matmul_rmsnorm_fused:L7.ffn_down       10.31     2.1
matmul_rmsnorm_fused:L5.ffn_down       10.26     2.1
matmul_rmsnorm_fused:L25.ffn_down       10.23     2.1
matmul_rmsnorm_fused:L21.ffn_down       10.05     2.1
matmul_rmsnorm_fused:L8.ffn_down       10.02     2.1
matmul_rmsnorm_fused:L13.ffn_down        9.79     2.0
matmul_rmsnorm_fused:L2.ffn_down        9.79     2.0
matmul_rmsnorm_fused:L0.ffn_down        9.16     1.9
matmul_rmsnorm_fused:L1.ffn_down        8.96     1.9
matmul_rmsnorm_fused:L22.ffn_down        8.88     1.9
matmul_rmsnorm_fused:L16.ffn_down        8.84     1.8
matmul_rmsnorm_fused:L9.ffn_down        8.72     1.8
matmul_rmsnorm_fused:L14.ffn_down        8.71     1.8
matmul_rmsnorm_fused:L3.ffn_down        8.71     1.8
matmul_rmsnorm_fused:L6.ffn_down        8.70     1.8
matmul_rmsnorm_fused:L17.ffn_down        8.68     1.8
matmul_rmsnorm_fused:L24.ffn_down        8.67     1.8
matmul_rmsnorm_fused:L19.ffn_down        8.65     1.8
matmul_rmsnorm_fused:L11.ffn_down        8.65     1.8
matmul_rmsnorm_fused:L20.ffn_down        8.65     1.8
matmul_rmsnorm_fused:L12.ffn_down        8.61     1.8
matmul_rmsnorm_fused:L4.ffn_down        8.61     1.8
rmsnorm                          4.06     0.8
sample_phase2                    3.25     0.7
rope                             0.79     0.2
matmul:o_proj:L16                0.28     0.1
matmul:o_proj:L23                0.17     0.0
matmul:o_proj:L13                0.17     0.0
matmul:q_proj:L16                0.17     0.0
matmul:o_proj:L21                0.16     0.0
matmul:o_proj:L0                 0.16     0.0
matmul:o_proj:L22                0.16     0.0
matmul:o_proj:L8                 0.16     0.0
matmul:o_proj:L15                0.15     0.0
matmul:q_proj:L23                0.15     0.0
matmul:q_proj:L0                 0.15     0.0
matmul:q_proj:L3                 0.15     0.0
matmul:o_proj:L3                 0.14     0.0
matmul:o_proj:L1                 0.14     0.0
matmul:q_proj:L6                 0.14     0.0
matmul:q_proj:L1                 0.14     0.0
matmul:q_proj:L19                0.13     0.0
matmul:o_proj:L6                 0.13     0.0
matmul:q_proj:L8                 0.13     0.0
matmul:o_proj:L19                0.13     0.0
matmul:q_proj:L24                0.13     0.0
matmul:o_proj:L5                 0.13     0.0
matmul:o_proj:L10                0.13     0.0
matmul:o_proj:L7                 0.13     0.0
matmul:q_proj:L21                0.13     0.0
matmul:o_proj:L4                 0.13     0.0
matmul:o_proj:L24                0.13     0.0
matmul:o_proj:L14                0.13     0.0
matmul:o_proj:L12                0.13     0.0
matmul:o_proj:L2                 0.13     0.0
matmul:q_proj:L22                0.13     0.0
matmul:q_proj:L13                0.13     0.0
matmul:q_proj:L10                0.13     0.0
matmul:o_proj:L25                0.12     0.0
matmul:o_proj:L9                 0.12     0.0
matmul:o_proj:L17                0.12     0.0
matmul:q_proj:L11                0.12     0.0
matmul:q_proj:L9                 0.12     0.0
matmul:q_proj:L14                0.12     0.0
matmul:o_proj:L11                0.12     0.0
matmul:o_proj:L20                0.12     0.0
matmul:q_proj:L17                0.12     0.0
matmul:o_proj:L18                0.12     0.0
matmul:q_proj:L15                0.12     0.0
matmul:q_proj:L18                0.12     0.0
matmul:q_proj:L25                0.12     0.0
matmul:q_proj:L12                0.12     0.0
matmul:q_proj:L2                 0.12     0.0
matmul:q_proj:L7                 0.12     0.0
matmul:q_proj:L4                 0.12     0.0
matmul:q_proj:L20                0.12     0.0
matmul:q_proj:L5                 0.12     0.0
sample_phase1                    0.08     0.0
matmul:v_proj:L16                0.07     0.0
matmul:k_proj:L16                0.06     0.0
matmul:k_proj:L23                0.06     0.0
matmul:k_proj:L1                 0.06     0.0
matmul:v_proj:L23                0.06     0.0
matmul:v_proj:L1                 0.06     0.0
matmul:k_proj:L3                 0.06     0.0
matmul:v_proj:L6                 0.05     0.0
sample_phase3                    0.05     0.0
matmul:k_proj:L8                 0.05     0.0
matmul:k_proj:L0                 0.05     0.0
matmul:v_proj:L0                 0.05     0.0
matmul:k_proj:L6                 0.05     0.0
matmul:k_proj:L24                0.05     0.0
matmul:v_proj:L8                 0.05     0.0
matmul:v_proj:L3                 0.05     0.0
matmul:k_proj:L19                0.05     0.0
matmul:v_proj:L24                0.05     0.0
matmul:v_proj:L19                0.05     0.0
matmul:k_proj:L22                0.05     0.0
matmul:k_proj:L15                0.05     0.0
matmul:k_proj:L21                0.04     0.0
matmul:k_proj:L4                 0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:k_proj:L11                0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:k_proj:L10                0.04     0.0
matmul:k_proj:L12                0.04     0.0
matmul:k_proj:L13                0.04     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:k_proj:L14                0.04     0.0
matmul:k_proj:L5                 0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:k_proj:L7                 0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:k_proj:L17                0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:v_proj:L22                0.04     0.0
matmul:k_proj:L2                 0.04     0.0
matmul:k_proj:L18                0.04     0.0
matmul:v_proj:L14                0.04     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:v_proj:L5                 0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:k_proj:L20                0.04     0.0
matmul:v_proj:L17                0.04     0.0
matmul:v_proj:L18                0.04     0.0
matmul:v_proj:L12                0.04     0.0
gather                           0.02     0.0
scale                            0.02     0.0
──────────────────────────────────────────────────
TOTAL                          479.56   100.0

[browser:warning] [13309.4ms][Profile] Batch decode (N=4):
[browser:warning] [13309.6ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      153.16    31.1
fused_ffn                       42.22     8.6
matmul:lm_head                  30.52     6.2
matmul_rmsnorm_fused:L0.ffn_down       11.75     2.4
matmul_rmsnorm_fused:L8.ffn_down       10.92     2.2
matmul_rmsnorm_fused:L15.ffn_down       10.89     2.2
matmul_rmsnorm_fused:L14.ffn_down       10.67     2.2
matmul_rmsnorm_fused:L18.ffn_down       10.54     2.1
matmul_rmsnorm_fused:L20.ffn_down       10.45     2.1
matmul_rmsnorm_fused:L5.ffn_down       10.35     2.1
matmul_rmsnorm_fused:L10.ffn_down       10.22     2.1
matmul_rmsnorm_fused:L3.ffn_down       10.21     2.1
matmul_rmsnorm_fused:L22.ffn_down       10.02     2.0
matmul_rmsnorm_fused:L13.ffn_down        9.46     1.9
matmul_rmsnorm_fused:L6.ffn_down        9.13     1.9
matmul_rmsnorm_fused:L23.ffn_down        9.11     1.9
matmul_rmsnorm_fused:L25.ffn_down        8.90     1.8
matmul_rmsnorm_fused:L12.ffn_down        8.89     1.8
matmul_rmsnorm_fused:L7.ffn_down        8.86     1.8
matmul_rmsnorm_fused:L21.ffn_down        8.76     1.8
matmul_rmsnorm_fused:L17.ffn_down        8.71     1.8
matmul_rmsnorm_fused:L9.ffn_down        8.70     1.8
matmul_rmsnorm_fused:L11.ffn_down        8.70     1.8
matmul_rmsnorm_fused:L24.ffn_down        8.70     1.8
matmul_rmsnorm_fused:L2.ffn_down        8.69     1.8
matmul_rmsnorm_fused:L16.ffn_down        8.68     1.8
matmul_rmsnorm_fused:L19.ffn_down        8.68     1.8
matmul_rmsnorm_fused:L1.ffn_down        8.65     1.8
matmul_rmsnorm_fused:L4.ffn_down        8.63     1.8
sample_phase2                    3.36     0.7
rmsnorm                          3.23     0.7
rope                             0.88     0.2
matmul:o_proj:L20                0.74     0.2
matmul:o_proj:L18                0.68     0.1
matmul:q_proj:L0                 0.24     0.0
matmul:o_proj:L22                0.21     0.0
matmul:o_proj:L8                 0.18     0.0
matmul:q_proj:L16                0.18     0.0
matmul:o_proj:L13                0.17     0.0
matmul:o_proj:L23                0.17     0.0
matmul:q_proj:L23                0.16     0.0
matmul:o_proj:L0                 0.16     0.0
matmul:o_proj:L3                 0.16     0.0
matmul:q_proj:L7                 0.15     0.0
matmul:o_proj:L15                0.15     0.0
matmul:o_proj:L6                 0.15     0.0
matmul:o_proj:L21                0.15     0.0
matmul:o_proj:L24                0.15     0.0
matmul:o_proj:L16                0.15     0.0
matmul:q_proj:L11                0.14     0.0
matmul:o_proj:L9                 0.14     0.0
matmul:q_proj:L21                0.14     0.0
matmul:o_proj:L10                0.14     0.0
matmul:o_proj:L7                 0.14     0.0
matmul:q_proj:L8                 0.14     0.0
matmul:q_proj:L15                0.14     0.0
matmul:o_proj:L19                0.14     0.0
matmul:q_proj:L1                 0.14     0.0
matmul:o_proj:L14                0.14     0.0
matmul:o_proj:L12                0.14     0.0
matmul:q_proj:L13                0.14     0.0
matmul:o_proj:L11                0.14     0.0
matmul:q_proj:L6                 0.14     0.0
matmul:q_proj:L14                0.14     0.0
matmul:q_proj:L10                0.13     0.0
matmul:q_proj:L18                0.13     0.0
matmul:q_proj:L12                0.13     0.0
matmul:q_proj:L19                0.13     0.0
matmul:o_proj:L25                0.13     0.0
matmul:o_proj:L1                 0.13     0.0
matmul:o_proj:L4                 0.13     0.0
matmul:q_proj:L22                0.13     0.0
matmul:o_proj:L2                 0.13     0.0
matmul:q_proj:L9                 0.13     0.0
matmul:o_proj:L17                0.13     0.0
matmul:q_proj:L20                0.13     0.0
matmul:q_proj:L24                0.13     0.0
matmul:q_proj:L17                0.13     0.0
matmul:o_proj:L5                 0.13     0.0
matmul:q_proj:L25                0.12     0.0
matmul:q_proj:L3                 0.12     0.0
matmul:q_proj:L5                 0.12     0.0
matmul:q_proj:L4                 0.12     0.0
matmul:q_proj:L2                 0.12     0.0
sample_phase1                    0.09     0.0
matmul:v_proj:L0                 0.09     0.0
matmul:k_proj:L0                 0.09     0.0
sample_phase3                    0.08     0.0
matmul:k_proj:L16                0.07     0.0
matmul:v_proj:L16                0.07     0.0
matmul:k_proj:L23                0.07     0.0
matmul:v_proj:L23                0.06     0.0
matmul:k_proj:L7                 0.06     0.0
matmul:v_proj:L7                 0.06     0.0
matmul:k_proj:L15                0.06     0.0
matmul:k_proj:L1                 0.05     0.0
matmul:v_proj:L15                0.05     0.0
matmul:k_proj:L11                0.05     0.0
matmul:v_proj:L11                0.05     0.0
matmul:v_proj:L1                 0.05     0.0
matmul:v_proj:L6                 0.05     0.0
matmul:k_proj:L6                 0.05     0.0
matmul:v_proj:L9                 0.05     0.0
matmul:k_proj:L21                0.05     0.0
matmul:k_proj:L9                 0.05     0.0
matmul:v_proj:L21                0.05     0.0
matmul:k_proj:L8                 0.05     0.0
matmul:k_proj:L18                0.05     0.0
matmul:v_proj:L18                0.05     0.0
matmul:k_proj:L13                0.05     0.0
matmul:k_proj:L10                0.05     0.0
matmul:k_proj:L22                0.05     0.0
matmul:v_proj:L8                 0.05     0.0
matmul:v_proj:L10                0.05     0.0
matmul:v_proj:L13                0.05     0.0
matmul:v_proj:L12                0.05     0.0
matmul:k_proj:L14                0.05     0.0
matmul:k_proj:L19                0.05     0.0
matmul:k_proj:L12                0.05     0.0
matmul:k_proj:L24                0.04     0.0
matmul:v_proj:L19                0.04     0.0
matmul:v_proj:L22                0.04     0.0
matmul:k_proj:L17                0.04     0.0
matmul:k_proj:L5                 0.04     0.0
matmul:v_proj:L14                0.04     0.0
matmul:v_proj:L3                 0.04     0.0
gather                           0.04     0.0
matmul:k_proj:L20                0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:v_proj:L24                0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:k_proj:L3                 0.04     0.0
matmul:k_proj:L4                 0.04     0.0
matmul:v_proj:L17                0.04     0.0
matmul:v_proj:L5                 0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:k_proj:L2                 0.04     0.0
matmul:v_proj:L2                 0.04     0.0
scale                            0.04     0.0
──────────────────────────────────────────────────
TOTAL                          492.12   100.0

[browser:warning] [13855.2ms][Profile] Batch decode (N=4):
[browser:warning] [13855.4ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      160.99    32.4
fused_ffn                       39.67     8.0
matmul:lm_head                  30.98     6.2
matmul_rmsnorm_fused:L10.ffn_down       10.64     2.1
matmul_rmsnorm_fused:L25.ffn_down       10.59     2.1
matmul_rmsnorm_fused:L4.ffn_down       10.58     2.1
matmul_rmsnorm_fused:L8.ffn_down       10.50     2.1
matmul_rmsnorm_fused:L23.ffn_down       10.46     2.1
matmul_rmsnorm_fused:L17.ffn_down       10.40     2.1
matmul_rmsnorm_fused:L21.ffn_down       10.32     2.1
matmul_rmsnorm_fused:L6.ffn_down       10.28     2.1
matmul_rmsnorm_fused:L19.ffn_down       10.20     2.1
matmul_rmsnorm_fused:L14.ffn_down       10.05     2.0
matmul_rmsnorm_fused:L2.ffn_down        9.87     2.0
matmul_rmsnorm_fused:L1.ffn_down        9.72     2.0
matmul_rmsnorm_fused:L15.ffn_down        9.48     1.9
matmul_rmsnorm_fused:L12.ffn_down        9.15     1.8
matmul_rmsnorm_fused:L16.ffn_down        8.92     1.8
matmul_rmsnorm_fused:L5.ffn_down        8.79     1.8
matmul_rmsnorm_fused:L11.ffn_down        8.78     1.8
matmul_rmsnorm_fused:L9.ffn_down        8.72     1.8
matmul_rmsnorm_fused:L22.ffn_down        8.72     1.8
matmul_rmsnorm_fused:L7.ffn_down        8.69     1.8
matmul_rmsnorm_fused:L24.ffn_down        8.69     1.8
matmul_rmsnorm_fused:L3.ffn_down        8.68     1.7
matmul_rmsnorm_fused:L13.ffn_down        8.67     1.7
matmul_rmsnorm_fused:L0.ffn_down        8.66     1.7
matmul_rmsnorm_fused:L18.ffn_down        8.64     1.7
matmul_rmsnorm_fused:L20.ffn_down        8.64     1.7
rmsnorm                          3.68     0.7
sample_phase2                    3.39     0.7
rope                             0.77     0.2
matmul:o_proj:L12                0.47     0.1
matmul:o_proj:L1                 0.17     0.0
matmul:o_proj:L14                0.17     0.0
matmul:q_proj:L16                0.16     0.0
matmul:o_proj:L23                0.15     0.0
matmul:o_proj:L19                0.15     0.0
matmul:q_proj:L3                 0.15     0.0
matmul:q_proj:L7                 0.15     0.0
matmul:o_proj:L3                 0.15     0.0
matmul:q_proj:L0                 0.14     0.0
matmul:o_proj:L16                0.14     0.0
matmul:o_proj:L21                0.14     0.0
matmul:q_proj:L12                0.14     0.0
matmul:o_proj:L18                0.14     0.0
matmul:o_proj:L8                 0.14     0.0
matmul:o_proj:L13                0.14     0.0
matmul:o_proj:L6                 0.14     0.0
matmul:q_proj:L11                0.14     0.0
matmul:o_proj:L25                0.14     0.0
matmul:o_proj:L0                 0.14     0.0
matmul:q_proj:L22                0.14     0.0
matmul:o_proj:L7                 0.14     0.0
matmul:q_proj:L18                0.13     0.0
matmul:q_proj:L1                 0.13     0.0
matmul:o_proj:L10                0.13     0.0
matmul:o_proj:L9                 0.13     0.0
matmul:o_proj:L11                0.13     0.0
matmul:o_proj:L4                 0.13     0.0
matmul:o_proj:L2                 0.13     0.0
matmul:q_proj:L24                0.13     0.0
matmul:o_proj:L5                 0.13     0.0
matmul:o_proj:L22                0.13     0.0
matmul:o_proj:L17                0.13     0.0
matmul:q_proj:L20                0.13     0.0
matmul:q_proj:L6                 0.13     0.0
matmul:o_proj:L15                0.13     0.0
matmul:q_proj:L21                0.13     0.0
matmul:q_proj:L8                 0.13     0.0
matmul:q_proj:L13                0.13     0.0
matmul:q_proj:L4                 0.13     0.0
matmul:q_proj:L15                0.13     0.0
matmul:q_proj:L23                0.13     0.0
matmul:q_proj:L2                 0.13     0.0
matmul:q_proj:L5                 0.13     0.0
matmul:q_proj:L25                0.13     0.0
matmul:o_proj:L24                0.12     0.0
matmul:q_proj:L10                0.12     0.0
matmul:q_proj:L17                0.12     0.0
matmul:q_proj:L9                 0.12     0.0
matmul:q_proj:L14                0.12     0.0
matmul:q_proj:L19                0.12     0.0
matmul:o_proj:L20                0.12     0.0
sample_phase1                    0.09     0.0
matmul:v_proj:L16                0.06     0.0
matmul:k_proj:L16                0.06     0.0
matmul:k_proj:L3                 0.06     0.0
matmul:v_proj:L12                0.06     0.0
matmul:k_proj:L12                0.06     0.0
sample_phase3                    0.06     0.0
matmul:k_proj:L22                0.05     0.0
matmul:v_proj:L3                 0.05     0.0
matmul:k_proj:L7                 0.05     0.0
matmul:v_proj:L7                 0.05     0.0
matmul:v_proj:L18                0.05     0.0
matmul:v_proj:L22                0.05     0.0
matmul:k_proj:L18                0.05     0.0
matmul:k_proj:L5                 0.05     0.0
matmul:k_proj:L0                 0.05     0.0
matmul:v_proj:L0                 0.05     0.0
matmul:v_proj:L8                 0.05     0.0
matmul:k_proj:L11                0.05     0.0
matmul:k_proj:L1                 0.05     0.0
matmul:v_proj:L11                0.05     0.0
matmul:v_proj:L10                0.05     0.0
matmul:k_proj:L6                 0.05     0.0
matmul:k_proj:L15                0.04     0.0
matmul:k_proj:L24                0.04     0.0
matmul:k_proj:L20                0.04     0.0
matmul:k_proj:L23                0.04     0.0
matmul:k_proj:L13                0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:k_proj:L14                0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:v_proj:L5                 0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:k_proj:L4                 0.04     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:k_proj:L2                 0.04     0.0
matmul:k_proj:L21                0.04     0.0
matmul:k_proj:L17                0.04     0.0
matmul:v_proj:L24                0.04     0.0
matmul:v_proj:L14                0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:k_proj:L10                0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:v_proj:L17                0.04     0.0
matmul:k_proj:L19                0.04     0.0
matmul:v_proj:L19                0.04     0.0
gather                           0.01     0.0
scale                            0.01     0.0
──────────────────────────────────────────────────
TOTAL                          496.31   100.0

[browser:warning] [14403.9ms][Profile] Batch decode (N=4):
[browser:warning] [14404.0ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      168.38    33.6
fused_ffn                       39.17     7.8
matmul:lm_head                  31.70     6.3
matmul_rmsnorm_fused:L14.ffn_down       10.58     2.1
matmul_rmsnorm_fused:L23.ffn_down       10.58     2.1
matmul_rmsnorm_fused:L20.ffn_down       10.55     2.1
matmul_rmsnorm_fused:L13.ffn_down       10.53     2.1
matmul_rmsnorm_fused:L11.ffn_down       10.52     2.1
matmul_rmsnorm_fused:L7.ffn_down       10.41     2.1
matmul_rmsnorm_fused:L1.ffn_down       10.25     2.0
matmul_rmsnorm_fused:L8.ffn_down        9.97     2.0
matmul_rmsnorm_fused:L4.ffn_down        9.80     2.0
matmul_rmsnorm_fused:L5.ffn_down        9.72     1.9
matmul_rmsnorm_fused:L18.ffn_down        9.59     1.9
matmul_rmsnorm_fused:L22.ffn_down        9.18     1.8
matmul_rmsnorm_fused:L0.ffn_down        9.11     1.8
matmul_rmsnorm_fused:L16.ffn_down        9.08     1.8
matmul_rmsnorm_fused:L21.ffn_down        8.88     1.8
matmul_rmsnorm_fused:L15.ffn_down        8.81     1.8
matmul_rmsnorm_fused:L25.ffn_down        8.73     1.7
matmul_rmsnorm_fused:L19.ffn_down        8.72     1.7
matmul_rmsnorm_fused:L9.ffn_down        8.68     1.7
matmul_rmsnorm_fused:L6.ffn_down        8.68     1.7
matmul_rmsnorm_fused:L10.ffn_down        8.68     1.7
matmul_rmsnorm_fused:L17.ffn_down        8.68     1.7
matmul_rmsnorm_fused:L24.ffn_down        8.66     1.7
matmul_rmsnorm_fused:L2.ffn_down        8.65     1.7
matmul_rmsnorm_fused:L3.ffn_down        8.64     1.7
matmul_rmsnorm_fused:L12.ffn_down        8.61     1.7
sample_phase2                    3.28     0.7
rmsnorm                          3.20     0.6
rope                             0.86     0.2
matmul:o_proj:L0                 0.77     0.2
matmul:o_proj:L16                0.44     0.1
matmul:q_proj:L0                 0.21     0.0
matmul:o_proj:L4                 0.17     0.0
matmul:o_proj:L1                 0.16     0.0
matmul:q_proj:L19                0.15     0.0
matmul:q_proj:L6                 0.15     0.0
matmul:q_proj:L9                 0.15     0.0
matmul:q_proj:L16                0.15     0.0
matmul:o_proj:L22                0.15     0.0
matmul:q_proj:L22                0.15     0.0
matmul:o_proj:L7                 0.15     0.0
matmul:o_proj:L14                0.14     0.0
matmul:o_proj:L21                0.14     0.0
matmul:o_proj:L19                0.14     0.0
matmul:o_proj:L20                0.14     0.0
matmul:o_proj:L13                0.14     0.0
matmul:o_proj:L6                 0.14     0.0
matmul:q_proj:L14                0.14     0.0
matmul:q_proj:L12                0.13     0.0
matmul:o_proj:L5                 0.13     0.0
matmul:o_proj:L12                0.13     0.0
matmul:q_proj:L24                0.13     0.0
matmul:o_proj:L25                0.13     0.0
matmul:o_proj:L24                0.13     0.0
matmul:o_proj:L15                0.13     0.0
matmul:o_proj:L2                 0.13     0.0
matmul:o_proj:L17                0.13     0.0
matmul:q_proj:L21                0.13     0.0
matmul:o_proj:L10                0.13     0.0
matmul:o_proj:L3                 0.13     0.0
matmul:q_proj:L7                 0.13     0.0
matmul:q_proj:L8                 0.13     0.0
matmul:o_proj:L8                 0.13     0.0
matmul:o_proj:L18                0.13     0.0
matmul:q_proj:L20                0.13     0.0
matmul:q_proj:L15                0.13     0.0
matmul:o_proj:L23                0.12     0.0
matmul:o_proj:L11                0.12     0.0
matmul:q_proj:L2                 0.12     0.0
matmul:q_proj:L13                0.12     0.0
matmul:o_proj:L9                 0.12     0.0
matmul:q_proj:L5                 0.12     0.0
matmul:q_proj:L1                 0.12     0.0
matmul:q_proj:L4                 0.12     0.0
matmul:q_proj:L23                0.12     0.0
matmul:q_proj:L18                0.12     0.0
matmul:q_proj:L3                 0.12     0.0
matmul:q_proj:L10                0.12     0.0
matmul:q_proj:L17                0.12     0.0
matmul:q_proj:L25                0.12     0.0
matmul:q_proj:L11                0.12     0.0
matmul:v_proj:L0                 0.09     0.0
matmul:k_proj:L0                 0.08     0.0
sample_phase1                    0.08     0.0
sample_phase3                    0.07     0.0
matmul:k_proj:L16                0.07     0.0
matmul:v_proj:L16                0.06     0.0
matmul:k_proj:L19                0.06     0.0
matmul:v_proj:L6                 0.06     0.0
matmul:k_proj:L6                 0.06     0.0
matmul:k_proj:L22                0.06     0.0
matmul:v_proj:L19                0.06     0.0
matmul:k_proj:L9                 0.06     0.0
matmul:v_proj:L22                0.06     0.0
matmul:v_proj:L9                 0.05     0.0
matmul:k_proj:L24                0.05     0.0
matmul:v_proj:L12                0.05     0.0
matmul:k_proj:L14                0.05     0.0
matmul:v_proj:L14                0.05     0.0
matmul:k_proj:L12                0.05     0.0
matmul:v_proj:L24                0.05     0.0
matmul:v_proj:L8                 0.05     0.0
matmul:k_proj:L15                0.05     0.0
matmul:k_proj:L21                0.05     0.0
matmul:k_proj:L23                0.04     0.0
matmul:k_proj:L7                 0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:k_proj:L5                 0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:k_proj:L20                0.04     0.0
gather                           0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:k_proj:L13                0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:k_proj:L4                 0.04     0.0
matmul:k_proj:L2                 0.04     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:k_proj:L3                 0.04     0.0
matmul:k_proj:L1                 0.04     0.0
matmul:k_proj:L18                0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:k_proj:L17                0.04     0.0
matmul:k_proj:L10                0.04     0.0
matmul:v_proj:L5                 0.04     0.0
matmul:k_proj:L11                0.04     0.0
matmul:v_proj:L17                0.04     0.0
matmul:v_proj:L18                0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:v_proj:L3                 0.04     0.0
scale                            0.03     0.0
──────────────────────────────────────────────────
TOTAL                          501.55   100.0

[browser:warning] [14960.3ms][Profile] Batch decode (N=4):
[browser:warning] [14960.4ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      175.31    34.4
fused_ffn                       40.02     7.8
matmul:lm_head                  30.41     6.0
matmul_rmsnorm_fused:L0.ffn_down       10.45     2.0
matmul_rmsnorm_fused:L17.ffn_down       10.40     2.0
matmul_rmsnorm_fused:L4.ffn_down       10.37     2.0
matmul_rmsnorm_fused:L18.ffn_down       10.35     2.0
matmul_rmsnorm_fused:L16.ffn_down       10.33     2.0
matmul_rmsnorm_fused:L9.ffn_down       10.33     2.0
matmul_rmsnorm_fused:L25.ffn_down       10.29     2.0
matmul_rmsnorm_fused:L22.ffn_down       10.15     2.0
matmul_rmsnorm_fused:L11.ffn_down       10.05     2.0
matmul_rmsnorm_fused:L15.ffn_down        9.99     2.0
matmul_rmsnorm_fused:L7.ffn_down        9.97     2.0
matmul_rmsnorm_fused:L24.ffn_down        9.90     1.9
matmul_rmsnorm_fused:L23.ffn_down        9.70     1.9
matmul_rmsnorm_fused:L10.ffn_down        9.49     1.9
matmul_rmsnorm_fused:L2.ffn_down        9.10     1.8
matmul_rmsnorm_fused:L3.ffn_down        8.99     1.8
matmul_rmsnorm_fused:L1.ffn_down        8.82     1.7
matmul_rmsnorm_fused:L14.ffn_down        8.70     1.7
matmul_rmsnorm_fused:L21.ffn_down        8.69     1.7
matmul_rmsnorm_fused:L6.ffn_down        8.69     1.7
matmul_rmsnorm_fused:L8.ffn_down        8.67     1.7
matmul_rmsnorm_fused:L5.ffn_down        8.67     1.7
matmul_rmsnorm_fused:L13.ffn_down        8.65     1.7
matmul_rmsnorm_fused:L19.ffn_down        8.65     1.7
matmul_rmsnorm_fused:L20.ffn_down        8.62     1.7
matmul_rmsnorm_fused:L12.ffn_down        8.59     1.7
rmsnorm                          3.88     0.8
sample_phase2                    3.25     0.6
rope                             0.82     0.2
matmul:o_proj:L2                 0.17     0.0
matmul:o_proj:L10                0.17     0.0
matmul:o_proj:L16                0.17     0.0
matmul:o_proj:L15                0.16     0.0
matmul:o_proj:L9                 0.16     0.0
matmul:q_proj:L24                0.15     0.0
matmul:o_proj:L11                0.15     0.0
matmul:o_proj:L0                 0.15     0.0
matmul:q_proj:L25                0.15     0.0
matmul:q_proj:L2                 0.14     0.0
matmul:o_proj:L4                 0.14     0.0
matmul:o_proj:L24                0.14     0.0
matmul:o_proj:L3                 0.14     0.0
matmul:o_proj:L5                 0.14     0.0
matmul:q_proj:L3                 0.14     0.0
matmul:q_proj:L8                 0.14     0.0
matmul:o_proj:L12                0.14     0.0
matmul:o_proj:L1                 0.14     0.0
matmul:q_proj:L1                 0.14     0.0
matmul:o_proj:L23                0.14     0.0
matmul:q_proj:L23                0.14     0.0
matmul:o_proj:L7                 0.14     0.0
matmul:q_proj:L0                 0.14     0.0
matmul:o_proj:L17                0.13     0.0
matmul:o_proj:L25                0.13     0.0
matmul:q_proj:L18                0.13     0.0
matmul:q_proj:L11                0.13     0.0
matmul:o_proj:L8                 0.13     0.0
matmul:o_proj:L14                0.13     0.0
matmul:q_proj:L10                0.13     0.0
matmul:o_proj:L18                0.13     0.0
matmul:q_proj:L19                0.13     0.0
matmul:q_proj:L16                0.13     0.0
matmul:o_proj:L13                0.13     0.0
matmul:q_proj:L9                 0.13     0.0
matmul:q_proj:L17                0.13     0.0
matmul:o_proj:L22                0.13     0.0
matmul:o_proj:L21                0.13     0.0
matmul:q_proj:L5                 0.12     0.0
matmul:q_proj:L15                0.12     0.0
matmul:o_proj:L19                0.12     0.0
matmul:o_proj:L6                 0.12     0.0
matmul:q_proj:L4                 0.12     0.0
matmul:q_proj:L22                0.12     0.0
matmul:q_proj:L7                 0.12     0.0
matmul:q_proj:L12                0.12     0.0
matmul:q_proj:L20                0.12     0.0
matmul:q_proj:L14                0.12     0.0
matmul:q_proj:L6                 0.12     0.0
matmul:q_proj:L21                0.12     0.0
matmul:q_proj:L13                0.12     0.0
matmul:o_proj:L20                0.12     0.0
sample_phase1                    0.08     0.0
matmul:k_proj:L24                0.06     0.0
matmul:v_proj:L24                0.06     0.0
matmul:k_proj:L2                 0.06     0.0
matmul:k_proj:L3                 0.06     0.0
matmul:k_proj:L25                0.06     0.0
matmul:v_proj:L23                0.06     0.0
matmul:v_proj:L2                 0.05     0.0
matmul:k_proj:L1                 0.05     0.0
matmul:k_proj:L18                0.05     0.0
matmul:v_proj:L3                 0.05     0.0
matmul:v_proj:L18                0.05     0.0
matmul:k_proj:L8                 0.05     0.0
matmul:v_proj:L8                 0.05     0.0
matmul:v_proj:L25                0.05     0.0
matmul:v_proj:L19                0.05     0.0
matmul:k_proj:L23                0.05     0.0
matmul:k_proj:L19                0.05     0.0
matmul:v_proj:L1                 0.05     0.0
matmul:k_proj:L15                0.05     0.0
sample_phase3                    0.05     0.0
matmul:k_proj:L0                 0.05     0.0
matmul:k_proj:L11                0.05     0.0
matmul:v_proj:L0                 0.05     0.0
matmul:v_proj:L20                0.05     0.0
matmul:v_proj:L11                0.05     0.0
matmul:k_proj:L10                0.05     0.0
matmul:v_proj:L14                0.04     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:k_proj:L5                 0.04     0.0
matmul:k_proj:L16                0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:v_proj:L5                 0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:k_proj:L17                0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:v_proj:L22                0.04     0.0
matmul:v_proj:L17                0.04     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:k_proj:L13                0.04     0.0
matmul:v_proj:L16                0.04     0.0
matmul:k_proj:L4                 0.04     0.0
matmul:k_proj:L22                0.04     0.0
matmul:k_proj:L14                0.04     0.0
matmul:k_proj:L12                0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:k_proj:L20                0.04     0.0
matmul:k_proj:L7                 0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:k_proj:L21                0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:v_proj:L13                0.04     0.0
gather                           0.01     0.0
scale                            0.01     0.0
──────────────────────────────────────────────────
TOTAL                          509.95   100.0

[browser:warning] [15524.1ms][Profile] Batch decode (N=4):
[browser:warning] [15524.3ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      182.42    35.4
fused_ffn                       39.42     7.6
matmul:lm_head                  32.31     6.3
matmul_rmsnorm_fused:L25.ffn_down       10.66     2.1
matmul_rmsnorm_fused:L3.ffn_down       10.64     2.1
matmul_rmsnorm_fused:L24.ffn_down       10.60     2.1
matmul_rmsnorm_fused:L5.ffn_down       10.55     2.0
matmul_rmsnorm_fused:L17.ffn_down       10.54     2.0
matmul_rmsnorm_fused:L4.ffn_down       10.47     2.0
matmul_rmsnorm_fused:L19.ffn_down       10.33     2.0
matmul_rmsnorm_fused:L18.ffn_down       10.17     2.0
matmul_rmsnorm_fused:L11.ffn_down       10.12     2.0
matmul_rmsnorm_fused:L12.ffn_down       10.10     2.0
matmul_rmsnorm_fused:L10.ffn_down        9.25     1.8
matmul_rmsnorm_fused:L9.ffn_down        8.84     1.7
matmul_rmsnorm_fused:L14.ffn_down        8.77     1.7
matmul_rmsnorm_fused:L16.ffn_down        8.75     1.7
matmul_rmsnorm_fused:L1.ffn_down        8.73     1.7
matmul_rmsnorm_fused:L2.ffn_down        8.73     1.7
matmul_rmsnorm_fused:L13.ffn_down        8.71     1.7
matmul_rmsnorm_fused:L22.ffn_down        8.70     1.7
matmul_rmsnorm_fused:L0.ffn_down        8.70     1.7
matmul_rmsnorm_fused:L23.ffn_down        8.69     1.7
matmul_rmsnorm_fused:L7.ffn_down        8.67     1.7
matmul_rmsnorm_fused:L21.ffn_down        8.67     1.7
matmul_rmsnorm_fused:L6.ffn_down        8.65     1.7
matmul_rmsnorm_fused:L8.ffn_down        8.64     1.7
matmul_rmsnorm_fused:L15.ffn_down        8.63     1.7
matmul_rmsnorm_fused:L20.ffn_down        8.63     1.7
rmsnorm                          3.42     0.7
sample_phase2                    3.40     0.7
rope                             0.83     0.2
matmul:o_proj:L11                0.29     0.1
matmul:o_proj:L18                0.19     0.0
matmul:o_proj:L12                0.18     0.0
matmul:q_proj:L0                 0.17     0.0
matmul:o_proj:L19                0.17     0.0
matmul:q_proj:L19                0.17     0.0
matmul:o_proj:L3                 0.17     0.0
matmul:q_proj:L17                0.16     0.0
matmul:o_proj:L10                0.15     0.0
matmul:q_proj:L18                0.15     0.0
matmul:q_proj:L10                0.15     0.0
matmul:o_proj:L15                0.15     0.0
matmul:o_proj:L25                0.14     0.0
matmul:q_proj:L12                0.14     0.0
matmul:q_proj:L4                 0.14     0.0
matmul:o_proj:L23                0.14     0.0
matmul:o_proj:L0                 0.14     0.0
matmul:q_proj:L25                0.14     0.0
matmul:o_proj:L17                0.14     0.0
matmul:q_proj:L5                 0.14     0.0
matmul:q_proj:L1                 0.14     0.0
matmul:o_proj:L24                0.14     0.0
matmul:q_proj:L11                0.14     0.0
matmul:o_proj:L5                 0.14     0.0
matmul:o_proj:L1                 0.13     0.0
matmul:o_proj:L16                0.13     0.0
matmul:o_proj:L9                 0.13     0.0
matmul:o_proj:L4                 0.13     0.0
matmul:o_proj:L22                0.13     0.0
matmul:q_proj:L14                0.13     0.0
matmul:o_proj:L2                 0.13     0.0
matmul:o_proj:L6                 0.13     0.0
matmul:o_proj:L8                 0.13     0.0
matmul:q_proj:L20                0.13     0.0
matmul:o_proj:L13                0.13     0.0
matmul:q_proj:L3                 0.13     0.0
matmul:q_proj:L15                0.13     0.0
matmul:q_proj:L24                0.12     0.0
matmul:q_proj:L6                 0.12     0.0
matmul:q_proj:L22                0.12     0.0
matmul:q_proj:L8                 0.12     0.0
matmul:o_proj:L20                0.12     0.0
matmul:q_proj:L2                 0.12     0.0
matmul:q_proj:L23                0.12     0.0
matmul:q_proj:L13                0.12     0.0
matmul:q_proj:L16                0.12     0.0
matmul:q_proj:L9                 0.12     0.0
matmul:q_proj:L7                 0.12     0.0
matmul:o_proj:L7                 0.12     0.0
matmul:o_proj:L14                0.12     0.0
matmul:q_proj:L21                0.12     0.0
matmul:o_proj:L21                0.11     0.0
sample_phase1                    0.11     0.0
matmul:v_proj:L3                 0.09     0.0
sample_phase3                    0.08     0.0
matmul:v_proj:L0                 0.07     0.0
matmul:k_proj:L19                0.07     0.0
matmul:v_proj:L19                0.07     0.0
matmul:k_proj:L0                 0.07     0.0
matmul:k_proj:L3                 0.06     0.0
matmul:k_proj:L4                 0.06     0.0
matmul:k_proj:L10                0.06     0.0
matmul:v_proj:L10                0.06     0.0
matmul:k_proj:L12                0.06     0.0
matmul:v_proj:L12                0.06     0.0
matmul:v_proj:L4                 0.06     0.0
matmul:k_proj:L17                0.05     0.0
matmul:v_proj:L18                0.05     0.0
matmul:k_proj:L18                0.05     0.0
matmul:v_proj:L25                0.05     0.0
matmul:k_proj:L25                0.05     0.0
matmul:v_proj:L5                 0.05     0.0
matmul:v_proj:L17                0.05     0.0
matmul:k_proj:L1                 0.05     0.0
matmul:k_proj:L5                 0.05     0.0
matmul:k_proj:L11                0.05     0.0
matmul:k_proj:L15                0.05     0.0
matmul:v_proj:L11                0.05     0.0
matmul:k_proj:L14                0.05     0.0
matmul:k_proj:L20                0.04     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:k_proj:L24                0.04     0.0
matmul:k_proj:L22                0.04     0.0
matmul:v_proj:L22                0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:k_proj:L23                0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:k_proj:L2                 0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:v_proj:L14                0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:k_proj:L7                 0.04     0.0
matmul:v_proj:L16                0.04     0.0
matmul:k_proj:L16                0.04     0.0
matmul:k_proj:L13                0.04     0.0
matmul:v_proj:L24                0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:k_proj:L21                0.04     0.0
matmul:v_proj:L21                0.04     0.0
gather                           0.03     0.0
scale                            0.02     0.0
──────────────────────────────────────────────────
TOTAL                          515.85   100.0

[browser:warning] [16109.3ms][Profile] Batch decode (N=4):
[browser:warning] [16109.4ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      190.50    36.6
fused_ffn                       41.88     8.0
matmul:lm_head                  30.41     5.8
matmul_rmsnorm_fused:L7.ffn_down       11.88     2.3
matmul_rmsnorm_fused:L0.ffn_down       11.76     2.3
matmul_rmsnorm_fused:L14.ffn_down       11.25     2.2
matmul_rmsnorm_fused:L21.ffn_down       10.98     2.1
matmul_rmsnorm_fused:L22.ffn_down        9.89     1.9
matmul_rmsnorm_fused:L1.ffn_down        9.40     1.8
matmul_rmsnorm_fused:L13.ffn_down        9.36     1.8
matmul_rmsnorm_fused:L8.ffn_down        9.30     1.8
matmul_rmsnorm_fused:L15.ffn_down        9.30     1.8
matmul_rmsnorm_fused:L6.ffn_down        8.89     1.7
matmul_rmsnorm_fused:L9.ffn_down        8.77     1.7
matmul_rmsnorm_fused:L20.ffn_down        8.74     1.7
matmul_rmsnorm_fused:L19.ffn_down        8.71     1.7
matmul_rmsnorm_fused:L25.ffn_down        8.69     1.7
matmul_rmsnorm_fused:L5.ffn_down        8.68     1.7
matmul_rmsnorm_fused:L10.ffn_down        8.66     1.7
matmul_rmsnorm_fused:L24.ffn_down        8.66     1.7
matmul_rmsnorm_fused:L17.ffn_down        8.65     1.7
matmul_rmsnorm_fused:L3.ffn_down        8.65     1.7
matmul_rmsnorm_fused:L11.ffn_down        8.65     1.7
matmul_rmsnorm_fused:L23.ffn_down        8.64     1.7
matmul_rmsnorm_fused:L16.ffn_down        8.63     1.7
matmul_rmsnorm_fused:L12.ffn_down        8.63     1.7
matmul_rmsnorm_fused:L2.ffn_down        8.62     1.7
matmul_rmsnorm_fused:L4.ffn_down        8.61     1.7
matmul_rmsnorm_fused:L18.ffn_down        8.61     1.7
rmsnorm                          3.95     0.8
sample_phase2                    3.24     0.6
rope                             0.82     0.2
matmul:o_proj:L7                 0.22     0.0
matmul:o_proj:L0                 0.19     0.0
matmul:o_proj:L22                0.19     0.0
matmul:o_proj:L21                0.18     0.0
matmul:o_proj:L15                0.17     0.0
matmul:q_proj:L15                0.17     0.0
matmul:q_proj:L0                 0.17     0.0
matmul:o_proj:L1                 0.17     0.0
matmul:q_proj:L22                0.17     0.0
matmul:q_proj:L14                0.16     0.0
matmul:o_proj:L8                 0.16     0.0
matmul:q_proj:L7                 0.16     0.0
matmul:o_proj:L14                0.15     0.0
matmul:o_proj:L18                0.15     0.0
matmul:o_proj:L20                0.15     0.0
matmul:o_proj:L6                 0.14     0.0
matmul:o_proj:L13                0.14     0.0
matmul:q_proj:L1                 0.14     0.0
matmul:q_proj:L21                0.14     0.0
matmul:o_proj:L12                0.14     0.0
matmul:q_proj:L10                0.13     0.0
matmul:q_proj:L20                0.13     0.0
matmul:q_proj:L8                 0.13     0.0
matmul:o_proj:L25                0.13     0.0
matmul:o_proj:L3                 0.13     0.0
matmul:o_proj:L17                0.13     0.0
matmul:o_proj:L5                 0.13     0.0
matmul:o_proj:L16                0.13     0.0
matmul:q_proj:L13                0.12     0.0
matmul:o_proj:L19                0.12     0.0
matmul:q_proj:L6                 0.12     0.0
matmul:q_proj:L12                0.12     0.0
matmul:q_proj:L18                0.12     0.0
matmul:o_proj:L2                 0.12     0.0
matmul:o_proj:L4                 0.12     0.0
matmul:q_proj:L9                 0.12     0.0
matmul:o_proj:L10                0.12     0.0
matmul:o_proj:L24                0.12     0.0
matmul:o_proj:L9                 0.12     0.0
matmul:o_proj:L11                0.12     0.0
matmul:o_proj:L23                0.12     0.0
matmul:q_proj:L3                 0.12     0.0
matmul:q_proj:L2                 0.12     0.0
matmul:q_proj:L11                0.12     0.0
matmul:q_proj:L19                0.12     0.0
matmul:q_proj:L17                0.12     0.0
matmul:q_proj:L16                0.12     0.0
matmul:q_proj:L23                0.12     0.0
matmul:q_proj:L24                0.12     0.0
matmul:q_proj:L5                 0.12     0.0
matmul:q_proj:L25                0.12     0.0
matmul:q_proj:L4                 0.12     0.0
matmul:v_proj:L0                 0.08     0.0
matmul:v_proj:L15                0.07     0.0
matmul:k_proj:L15                0.07     0.0
matmul:k_proj:L14                0.07     0.0
matmul:v_proj:L22                0.07     0.0
sample_phase1                    0.06     0.0
matmul:v_proj:L14                0.06     0.0
matmul:k_proj:L22                0.06     0.0
matmul:v_proj:L7                 0.06     0.0
matmul:k_proj:L0                 0.05     0.0
matmul:k_proj:L1                 0.05     0.0
matmul:v_proj:L1                 0.05     0.0
matmul:k_proj:L7                 0.05     0.0
sample_phase3                    0.05     0.0
matmul:v_proj:L12                0.05     0.0
matmul:k_proj:L21                0.05     0.0
matmul:k_proj:L25                0.05     0.0
matmul:k_proj:L12                0.05     0.0
matmul:v_proj:L21                0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:k_proj:L10                0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:k_proj:L20                0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:v_proj:L5                 0.04     0.0
matmul:k_proj:L13                0.04     0.0
matmul:k_proj:L18                0.04     0.0
matmul:k_proj:L17                0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:k_proj:L3                 0.04     0.0
matmul:k_proj:L16                0.04     0.0
matmul:k_proj:L23                0.04     0.0
matmul:v_proj:L18                0.04     0.0
matmul:k_proj:L24                0.04     0.0
matmul:k_proj:L2                 0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:v_proj:L24                0.04     0.0
matmul:v_proj:L17                0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:k_proj:L11                0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:v_proj:L16                0.04     0.0
matmul:k_proj:L4                 0.04     0.0
matmul:k_proj:L19                0.04     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:k_proj:L5                 0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:v_proj:L19                0.04     0.0
gather                           0.04     0.0
scale                            0.02     0.0
──────────────────────────────────────────────────
TOTAL                          521.20   100.0

[browser:warning] [16687.1ms][Profile] Batch decode (N=4):
[browser:warning] [16687.1ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      197.20    37.3
fused_ffn                       40.54     7.7
matmul:lm_head                  33.17     6.3
matmul_rmsnorm_fused:L20.ffn_down       14.24     2.7
matmul_rmsnorm_fused:L13.ffn_down       14.18     2.7
matmul_rmsnorm_fused:L6.ffn_down       13.49     2.5
matmul_rmsnorm_fused:L0.ffn_down        8.80     1.7
matmul_rmsnorm_fused:L25.ffn_down        8.80     1.7
matmul_rmsnorm_fused:L21.ffn_down        8.77     1.7
matmul_rmsnorm_fused:L5.ffn_down        8.76     1.7
matmul_rmsnorm_fused:L11.ffn_down        8.72     1.6
matmul_rmsnorm_fused:L18.ffn_down        8.70     1.6
matmul_rmsnorm_fused:L19.ffn_down        8.70     1.6
matmul_rmsnorm_fused:L4.ffn_down        8.69     1.6
matmul_rmsnorm_fused:L12.ffn_down        8.69     1.6
matmul_rmsnorm_fused:L9.ffn_down        8.69     1.6
matmul_rmsnorm_fused:L10.ffn_down        8.67     1.6
matmul_rmsnorm_fused:L14.ffn_down        8.66     1.6
matmul_rmsnorm_fused:L16.ffn_down        8.65     1.6
matmul_rmsnorm_fused:L24.ffn_down        8.65     1.6
matmul_rmsnorm_fused:L17.ffn_down        8.64     1.6
matmul_rmsnorm_fused:L3.ffn_down        8.64     1.6
matmul_rmsnorm_fused:L1.ffn_down        8.64     1.6
matmul_rmsnorm_fused:L2.ffn_down        8.63     1.6
matmul_rmsnorm_fused:L8.ffn_down        8.63     1.6
matmul_rmsnorm_fused:L7.ffn_down        8.62     1.6
matmul_rmsnorm_fused:L23.ffn_down        8.61     1.6
matmul_rmsnorm_fused:L22.ffn_down        8.60     1.6
matmul_rmsnorm_fused:L15.ffn_down        8.60     1.6
sample_phase2                    3.46     0.7
rmsnorm                          3.12     0.6
rope                             0.75     0.1
matmul:o_proj:L6                 0.25     0.0
matmul:q_proj:L0                 0.24     0.0
matmul:o_proj:L20                0.22     0.0
matmul:o_proj:L13                0.19     0.0
matmul:q_proj:L14                0.17     0.0
matmul:o_proj:L0                 0.15     0.0
matmul:o_proj:L12                0.14     0.0
matmul:o_proj:L5                 0.14     0.0
matmul:o_proj:L19                0.14     0.0
matmul:q_proj:L7                 0.14     0.0
matmul:o_proj:L8                 0.14     0.0
sample_phase1                    0.14     0.0
matmul:q_proj:L21                0.13     0.0
matmul:o_proj:L25                0.13     0.0
matmul:o_proj:L18                0.13     0.0
matmul:o_proj:L14                0.13     0.0
matmul:o_proj:L11                0.13     0.0
matmul:q_proj:L20                0.13     0.0
matmul:q_proj:L6                 0.13     0.0
matmul:q_proj:L13                0.13     0.0
matmul:q_proj:L19                0.13     0.0
matmul:q_proj:L12                0.13     0.0
matmul:q_proj:L5                 0.13     0.0
matmul:o_proj:L7                 0.13     0.0
matmul:o_proj:L22                0.13     0.0
matmul:o_proj:L15                0.13     0.0
matmul:o_proj:L4                 0.12     0.0
matmul:o_proj:L24                0.12     0.0
matmul:o_proj:L21                0.12     0.0
matmul:o_proj:L2                 0.12     0.0
matmul:o_proj:L10                0.12     0.0
matmul:o_proj:L9                 0.12     0.0
matmul:o_proj:L1                 0.12     0.0
matmul:o_proj:L23                0.12     0.0
matmul:q_proj:L8                 0.12     0.0
matmul:q_proj:L22                0.12     0.0
matmul:o_proj:L16                0.12     0.0
matmul:q_proj:L18                0.12     0.0
matmul:o_proj:L17                0.12     0.0
matmul:q_proj:L1                 0.12     0.0
matmul:q_proj:L24                0.12     0.0
matmul:q_proj:L17                0.12     0.0
matmul:q_proj:L15                0.12     0.0
matmul:q_proj:L16                0.12     0.0
matmul:q_proj:L9                 0.12     0.0
matmul:q_proj:L11                0.12     0.0
matmul:q_proj:L3                 0.12     0.0
matmul:q_proj:L10                0.12     0.0
matmul:q_proj:L25                0.12     0.0
matmul:q_proj:L23                0.12     0.0
matmul:q_proj:L2                 0.11     0.0
matmul:o_proj:L3                 0.11     0.0
matmul:q_proj:L4                 0.11     0.0
sample_phase3                    0.11     0.0
matmul:k_proj:L0                 0.10     0.0
matmul:v_proj:L0                 0.09     0.0
matmul:k_proj:L14                0.07     0.0
matmul:v_proj:L14                0.06     0.0
gather                           0.06     0.0
matmul:v_proj:L7                 0.05     0.0
matmul:k_proj:L7                 0.05     0.0
scale                            0.05     0.0
matmul:k_proj:L20                0.05     0.0
matmul:k_proj:L6                 0.05     0.0
matmul:k_proj:L5                 0.05     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:k_proj:L19                0.04     0.0
matmul:k_proj:L12                0.04     0.0
matmul:v_proj:L5                 0.04     0.0
matmul:k_proj:L13                0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:k_proj:L21                0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:v_proj:L19                0.04     0.0
matmul:k_proj:L15                0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:k_proj:L11                0.04     0.0
matmul:k_proj:L18                0.04     0.0
matmul:v_proj:L18                0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:k_proj:L17                0.04     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:k_proj:L16                0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:v_proj:L22                0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:k_proj:L22                0.04     0.0
matmul:k_proj:L3                 0.04     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:k_proj:L23                0.04     0.0
matmul:v_proj:L16                0.04     0.0
matmul:k_proj:L2                 0.04     0.0
matmul:v_proj:L17                0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:k_proj:L24                0.04     0.0
matmul:k_proj:L10                0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:k_proj:L1                 0.04     0.0
matmul:k_proj:L4                 0.04     0.0
matmul:v_proj:L24                0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:v_proj:L8                 0.04     0.0
──────────────────────────────────────────────────
TOTAL                          529.39   100.0

[browser:warning] [17349.4ms][Profile] Batch decode (N=4):
[browser:warning] [17349.8ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      206.13    34.0
fused_ffn                       54.58     9.0
matmul:lm_head                  34.28     5.7
rmsnorm                         13.56     2.2
matmul_rmsnorm_fused:L17.ffn_down       13.17     2.2
matmul_rmsnorm_fused:L6.ffn_down       12.23     2.0
matmul_rmsnorm_fused:L0.ffn_down       11.16     1.8
matmul_rmsnorm_fused:L12.ffn_down       10.67     1.8
matmul_rmsnorm_fused:L22.ffn_down       10.40     1.7
matmul_rmsnorm_fused:L24.ffn_down       10.26     1.7
matmul_rmsnorm_fused:L18.ffn_down       10.15     1.7
matmul_rmsnorm_fused:L19.ffn_down       10.10     1.7
matmul_rmsnorm_fused:L4.ffn_down       10.01     1.7
matmul_rmsnorm_fused:L11.ffn_down        9.80     1.6
matmul_rmsnorm_fused:L14.ffn_down        9.77     1.6
matmul_rmsnorm_fused:L20.ffn_down        9.61     1.6
matmul_rmsnorm_fused:L25.ffn_down        9.49     1.6
matmul_rmsnorm_fused:L10.ffn_down        9.32     1.5
matmul_rmsnorm_fused:L8.ffn_down        9.30     1.5
matmul_rmsnorm_fused:L2.ffn_down        9.24     1.5
matmul_rmsnorm_fused:L1.ffn_down        9.05     1.5
matmul_rmsnorm_fused:L23.ffn_down        8.98     1.5
matmul_rmsnorm_fused:L13.ffn_down        8.81     1.5
matmul_rmsnorm_fused:L16.ffn_down        8.79     1.4
matmul_rmsnorm_fused:L21.ffn_down        8.76     1.4
matmul_rmsnorm_fused:L9.ffn_down        8.74     1.4
matmul_rmsnorm_fused:L15.ffn_down        8.73     1.4
matmul_rmsnorm_fused:L5.ffn_down        8.72     1.4
matmul_rmsnorm_fused:L7.ffn_down        8.71     1.4
matmul_rmsnorm_fused:L3.ffn_down        8.68     1.4
matmul:o_proj:L23                3.59     0.6
sample_phase2                    3.24     0.5
matmul:o_proj:L17                3.04     0.5
matmul:o_proj:L3                 2.54     0.4
matmul:q_proj:L18                2.29     0.4
matmul:q_proj:L19                2.18     0.4
rope                             1.80     0.3
matmul:o_proj:L11                1.66     0.3
matmul:o_proj:L24                1.61     0.3
matmul:o_proj:L25                1.46     0.2
matmul:k_proj:L12                1.40     0.2
matmul:o_proj:L9                 1.26     0.2
matmul:o_proj:L14                1.22     0.2
matmul:q_proj:L20                1.07     0.2
matmul:q_proj:L7                 1.05     0.2
matmul:q_proj:L13                1.03     0.2
matmul:v_proj:L21                0.96     0.2
matmul:q_proj:L1                 0.95     0.2
matmul:q_proj:L12                0.86     0.1
matmul:q_proj:L9                 0.81     0.1
matmul:k_proj:L1                 0.78     0.1
matmul:q_proj:L15                0.50     0.1
matmul:v_proj:L23                0.46     0.1
matmul:v_proj:L1                 0.36     0.1
matmul:q_proj:L23                0.29     0.0
matmul:o_proj:L18                0.27     0.0
matmul:o_proj:L4                 0.21     0.0
matmul:o_proj:L6                 0.21     0.0
matmul:k_proj:L21                0.21     0.0
matmul:o_proj:L12                0.20     0.0
matmul:q_proj:L21                0.19     0.0
matmul:k_proj:L23                0.18     0.0
matmul:q_proj:L0                 0.17     0.0
matmul:q_proj:L11                0.17     0.0
matmul:o_proj:L2                 0.16     0.0
matmul:o_proj:L21                0.16     0.0
matmul:o_proj:L16                0.16     0.0
matmul:o_proj:L7                 0.16     0.0
matmul:o_proj:L19                0.16     0.0
matmul:o_proj:L15                0.15     0.0
matmul:v_proj:L20                0.15     0.0
matmul:v_proj:L15                0.15     0.0
matmul:o_proj:L13                0.15     0.0
matmul:q_proj:L3                 0.15     0.0
matmul:o_proj:L1                 0.15     0.0
matmul:o_proj:L0                 0.14     0.0
matmul:q_proj:L17                0.14     0.0
matmul:o_proj:L20                0.14     0.0
matmul:q_proj:L25                0.14     0.0
matmul:q_proj:L16                0.14     0.0
matmul:o_proj:L22                0.14     0.0
matmul:o_proj:L10                0.14     0.0
matmul:k_proj:L19                0.14     0.0
matmul:q_proj:L24                0.14     0.0
matmul:q_proj:L4                 0.13     0.0
matmul:o_proj:L5                 0.13     0.0
matmul:q_proj:L6                 0.13     0.0
matmul:q_proj:L5                 0.13     0.0
matmul:q_proj:L14                0.13     0.0
matmul:q_proj:L22                0.13     0.0
matmul:v_proj:L19                0.13     0.0
matmul:q_proj:L10                0.12     0.0
matmul:o_proj:L8                 0.12     0.0
matmul:q_proj:L2                 0.12     0.0
matmul:q_proj:L8                 0.12     0.0
matmul:k_proj:L20                0.10     0.0
matmul:k_proj:L15                0.09     0.0
matmul:v_proj:L13                0.08     0.0
sample_phase1                    0.08     0.0
matmul:k_proj:L13                0.08     0.0
matmul:k_proj:L7                 0.08     0.0
matmul:v_proj:L7                 0.08     0.0
matmul:k_proj:L18                0.08     0.0
matmul:v_proj:L18                0.08     0.0
matmul:v_proj:L12                0.07     0.0
matmul:k_proj:L11                0.07     0.0
matmul:v_proj:L11                0.07     0.0
matmul:k_proj:L9                 0.06     0.0
matmul:v_proj:L9                 0.05     0.0
matmul:k_proj:L0                 0.05     0.0
matmul:v_proj:L0                 0.05     0.0
matmul:k_proj:L3                 0.05     0.0
sample_phase3                    0.05     0.0
matmul:k_proj:L17                0.05     0.0
matmul:v_proj:L25                0.05     0.0
matmul:v_proj:L3                 0.05     0.0
matmul:k_proj:L25                0.05     0.0
matmul:v_proj:L4                 0.05     0.0
matmul:k_proj:L24                0.05     0.0
matmul:k_proj:L4                 0.05     0.0
matmul:v_proj:L17                0.05     0.0
matmul:v_proj:L16                0.05     0.0
matmul:k_proj:L16                0.05     0.0
matmul:v_proj:L24                0.05     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:k_proj:L14                0.04     0.0
matmul:k_proj:L22                0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:v_proj:L14                0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:k_proj:L10                0.04     0.0
matmul:k_proj:L5                 0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:v_proj:L22                0.04     0.0
matmul:v_proj:L5                 0.04     0.0
matmul:k_proj:L2                 0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:v_proj:L2                 0.04     0.0
gather                           0.01     0.0
scale                            0.01     0.0
──────────────────────────────────────────────────
TOTAL                          606.18   100.0

[browser:warning] [18084.6ms][Profile] Batch decode (N=4):
[browser:warning] [18084.9ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      213.21    32.6
fused_ffn                       73.47    11.2
matmul:lm_head                  34.09     5.2
rmsnorm                         17.28     2.6
matmul_rmsnorm_fused:L5.ffn_down       15.32     2.3
matmul_rmsnorm_fused:L16.ffn_down       14.61     2.2
matmul_rmsnorm_fused:L22.ffn_down       13.13     2.0
matmul_rmsnorm_fused:L24.ffn_down       11.93     1.8
matmul_rmsnorm_fused:L18.ffn_down       11.72     1.8
matmul_rmsnorm_fused:L21.ffn_down       10.95     1.7
matmul_rmsnorm_fused:L2.ffn_down       10.89     1.7
matmul_rmsnorm_fused:L10.ffn_down       10.49     1.6
matmul_rmsnorm_fused:L6.ffn_down       10.36     1.6
matmul_rmsnorm_fused:L12.ffn_down       10.23     1.6
matmul_rmsnorm_fused:L11.ffn_down       10.20     1.6
matmul_rmsnorm_fused:L0.ffn_down        9.85     1.5
matmul_rmsnorm_fused:L7.ffn_down        9.74     1.5
matmul_rmsnorm_fused:L8.ffn_down        9.20     1.4
matmul_rmsnorm_fused:L13.ffn_down        9.13     1.4
matmul_rmsnorm_fused:L20.ffn_down        9.12     1.4
matmul_rmsnorm_fused:L14.ffn_down        9.05     1.4
matmul_rmsnorm_fused:L25.ffn_down        8.86     1.4
matmul_rmsnorm_fused:L23.ffn_down        8.83     1.4
matmul_rmsnorm_fused:L9.ffn_down        8.77     1.3
matmul_rmsnorm_fused:L4.ffn_down        8.70     1.3
matmul_rmsnorm_fused:L3.ffn_down        8.69     1.3
matmul_rmsnorm_fused:L17.ffn_down        8.68     1.3
matmul_rmsnorm_fused:L1.ffn_down        8.67     1.3
matmul_rmsnorm_fused:L15.ffn_down        8.66     1.3
matmul_rmsnorm_fused:L19.ffn_down        8.64     1.3
matmul:q_proj:L6                 6.67     1.0
matmul:q_proj:L17                6.06     0.9
matmul:o_proj:L0                 4.67     0.7
sample_phase2                    3.25     0.5
matmul:o_proj:L11                1.89     0.3
matmul:q_proj:L25                1.60     0.2
rope                             1.54     0.2
matmul:o_proj:L13                1.49     0.2
matmul:o_proj:L2                 1.46     0.2
matmul:o_proj:L18                1.25     0.2
matmul:q_proj:L14                1.21     0.2
matmul:o_proj:L24                1.06     0.2
matmul:q_proj:L8                 1.05     0.2
matmul:o_proj:L19                0.99     0.2
matmul:o_proj:L6                 0.99     0.2
matmul:q_proj:L9                 0.98     0.1
matmul:k_proj:L8                 0.92     0.1
matmul:o_proj:L12                0.85     0.1
matmul:o_proj:L8                 0.83     0.1
matmul:o_proj:L1                 0.72     0.1
matmul:o_proj:L22                0.58     0.1
matmul:v_proj:L23                0.54     0.1
matmul:q_proj:L19                0.51     0.1
matmul:q_proj:L23                0.49     0.1
matmul:v_proj:L17                0.46     0.1
matmul:q_proj:L15                0.42     0.1
matmul:k_proj:L6                 0.40     0.1
matmul:v_proj:L15                0.33     0.1
matmul:k_proj:L15                0.29     0.0
matmul:q_proj:L0                 0.25     0.0
matmul:o_proj:L20                0.25     0.0
matmul:o_proj:L16                0.19     0.0
matmul:o_proj:L5                 0.18     0.0
matmul:k_proj:L17                0.18     0.0
matmul:q_proj:L22                0.18     0.0
matmul:q_proj:L24                0.17     0.0
matmul:v_proj:L25                0.17     0.0
matmul:q_proj:L3                 0.17     0.0
matmul:q_proj:L11                0.16     0.0
matmul:q_proj:L12                0.15     0.0
matmul:q_proj:L21                0.15     0.0
matmul:v_proj:L19                0.15     0.0
matmul:o_proj:L15                0.15     0.0
matmul:o_proj:L21                0.15     0.0
matmul:o_proj:L23                0.15     0.0
matmul:o_proj:L4                 0.14     0.0
matmul:o_proj:L14                0.14     0.0
matmul:o_proj:L17                0.14     0.0
matmul:o_proj:L3                 0.14     0.0
matmul:o_proj:L10                0.14     0.0
matmul:o_proj:L25                0.14     0.0
matmul:o_proj:L9                 0.13     0.0
matmul:q_proj:L10                0.13     0.0
matmul:q_proj:L20                0.13     0.0
matmul:q_proj:L5                 0.13     0.0
matmul:q_proj:L16                0.13     0.0
matmul:q_proj:L4                 0.13     0.0
matmul:o_proj:L7                 0.12     0.0
matmul:q_proj:L18                0.12     0.0
matmul:q_proj:L13                0.12     0.0
matmul:q_proj:L7                 0.12     0.0
matmul:q_proj:L1                 0.12     0.0
matmul:q_proj:L2                 0.12     0.0
matmul:k_proj:L0                 0.10     0.0
matmul:k_proj:L23                0.10     0.0
matmul:v_proj:L0                 0.09     0.0
sample_phase1                    0.08     0.0
matmul:v_proj:L8                 0.08     0.0
matmul:k_proj:L25                0.08     0.0
matmul:v_proj:L6                 0.08     0.0
matmul:k_proj:L22                0.07     0.0
matmul:k_proj:L24                0.07     0.0
matmul:v_proj:L22                0.07     0.0
matmul:k_proj:L12                0.07     0.0
matmul:k_proj:L14                0.07     0.0
matmul:v_proj:L14                0.06     0.0
matmul:k_proj:L3                 0.06     0.0
matmul:v_proj:L24                0.06     0.0
matmul:k_proj:L19                0.05     0.0
matmul:v_proj:L11                0.05     0.0
matmul:k_proj:L11                0.05     0.0
matmul:v_proj:L3                 0.05     0.0
sample_phase3                    0.05     0.0
matmul:k_proj:L9                 0.05     0.0
matmul:k_proj:L21                0.05     0.0
matmul:v_proj:L21                0.05     0.0
matmul:k_proj:L20                0.05     0.0
matmul:k_proj:L10                0.05     0.0
matmul:v_proj:L16                0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:k_proj:L4                 0.04     0.0
matmul:k_proj:L16                0.04     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:v_proj:L5                 0.04     0.0
matmul:k_proj:L5                 0.04     0.0
matmul:k_proj:L13                0.04     0.0
matmul:k_proj:L18                0.04     0.0
matmul:v_proj:L18                0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:k_proj:L7                 0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:k_proj:L1                 0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:k_proj:L2                 0.04     0.0
matmul:v_proj:L1                 0.04     0.0
gather                           0.04     0.0
scale                            0.04     0.0
──────────────────────────────────────────────────
TOTAL                          653.70   100.0

[browser:warning] [18727.8ms][Profile] Batch decode (N=4):
[browser:warning] [18727.8ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      217.66    38.4
fused_ffn                       42.98     7.6
matmul:lm_head                  32.10     5.7
matmul_rmsnorm_fused:L1.ffn_down       10.64     1.9
matmul_rmsnorm_fused:L25.ffn_down       10.58     1.9
matmul_rmsnorm_fused:L13.ffn_down       10.56     1.9
matmul_rmsnorm_fused:L10.ffn_down       10.31     1.8
matmul_rmsnorm_fused:L5.ffn_down       10.21     1.8
matmul_rmsnorm_fused:L6.ffn_down       10.21     1.8
matmul_rmsnorm_fused:L14.ffn_down       10.09     1.8
matmul_rmsnorm_fused:L8.ffn_down        9.83     1.7
matmul_rmsnorm_fused:L12.ffn_down        9.83     1.7
matmul_rmsnorm_fused:L19.ffn_down        9.77     1.7
matmul_rmsnorm_fused:L20.ffn_down        9.76     1.7
matmul_rmsnorm_fused:L4.ffn_down        9.66     1.7
matmul_rmsnorm_fused:L16.ffn_down        9.27     1.6
matmul_rmsnorm_fused:L22.ffn_down        9.18     1.6
matmul_rmsnorm_fused:L7.ffn_down        9.10     1.6
matmul_rmsnorm_fused:L23.ffn_down        8.95     1.6
matmul_rmsnorm_fused:L9.ffn_down        8.75     1.5
matmul_rmsnorm_fused:L21.ffn_down        8.74     1.5
matmul_rmsnorm_fused:L2.ffn_down        8.73     1.5
matmul_rmsnorm_fused:L24.ffn_down        8.72     1.5
matmul_rmsnorm_fused:L3.ffn_down        8.72     1.5
matmul_rmsnorm_fused:L0.ffn_down        8.72     1.5
matmul_rmsnorm_fused:L11.ffn_down        8.71     1.5
matmul_rmsnorm_fused:L15.ffn_down        8.70     1.5
matmul_rmsnorm_fused:L18.ffn_down        8.69     1.5
matmul_rmsnorm_fused:L17.ffn_down        8.68     1.5
rmsnorm                          7.29     1.3
sample_phase2                    3.30     0.6
matmul:q_proj:L5                 1.45     0.3
matmul:q_proj:L0                 0.99     0.2
rope                             0.84     0.1
matmul:o_proj:L11                0.69     0.1
matmul:q_proj:L2                 0.67     0.1
matmul:o_proj:L13                0.66     0.1
matmul:k_proj:L8                 0.60     0.1
matmul:v_proj:L2                 0.59     0.1
matmul:q_proj:L8                 0.47     0.1
matmul:o_proj:L8                 0.40     0.1
matmul:k_proj:L5                 0.35     0.1
matmul:v_proj:L5                 0.35     0.1
matmul:q_proj:L23                0.34     0.1
matmul:k_proj:L2                 0.33     0.1
scale                            0.27     0.0
matmul:q_proj:L11                0.17     0.0
matmul:o_proj:L1                 0.17     0.0
matmul:o_proj:L19                0.16     0.0
matmul:o_proj:L22                0.16     0.0
matmul:o_proj:L12                0.16     0.0
matmul:o_proj:L0                 0.16     0.0
matmul:o_proj:L14                0.16     0.0
matmul:o_proj:L10                0.16     0.0
matmul:q_proj:L21                0.16     0.0
matmul:o_proj:L23                0.15     0.0
matmul:o_proj:L20                0.15     0.0
matmul:v_proj:L23                0.15     0.0
matmul:o_proj:L5                 0.15     0.0
matmul:o_proj:L21                0.15     0.0
matmul:q_proj:L16                0.15     0.0
matmul:o_proj:L9                 0.15     0.0
matmul:o_proj:L16                0.15     0.0
matmul:o_proj:L24                0.15     0.0
matmul:q_proj:L6                 0.15     0.0
matmul:q_proj:L7                 0.14     0.0
matmul:o_proj:L4                 0.14     0.0
matmul:q_proj:L20                0.14     0.0
matmul:o_proj:L6                 0.14     0.0
matmul:o_proj:L25                0.14     0.0
matmul:q_proj:L24                0.14     0.0
matmul:o_proj:L3                 0.14     0.0
matmul:o_proj:L7                 0.14     0.0
matmul:o_proj:L2                 0.14     0.0
matmul:o_proj:L17                0.14     0.0
matmul:q_proj:L13                0.14     0.0
matmul:q_proj:L9                 0.14     0.0
matmul:o_proj:L15                0.13     0.0
matmul:o_proj:L18                0.13     0.0
matmul:q_proj:L22                0.13     0.0
matmul:q_proj:L3                 0.13     0.0
matmul:q_proj:L12                0.13     0.0
matmul:q_proj:L4                 0.13     0.0
matmul:q_proj:L17                0.13     0.0
matmul:q_proj:L10                0.13     0.0
matmul:q_proj:L18                0.13     0.0
matmul:q_proj:L14                0.13     0.0
matmul:q_proj:L25                0.13     0.0
matmul:q_proj:L15                0.13     0.0
matmul:q_proj:L1                 0.13     0.0
matmul:q_proj:L19                0.12     0.0
matmul:v_proj:L7                 0.09     0.0
matmul:v_proj:L0                 0.09     0.0
matmul:k_proj:L0                 0.09     0.0
sample_phase1                    0.08     0.0
sample_phase3                    0.08     0.0
matmul:v_proj:L8                 0.07     0.0
matmul:v_proj:L16                0.07     0.0
matmul:k_proj:L11                0.07     0.0
matmul:k_proj:L16                0.07     0.0
matmul:k_proj:L23                0.06     0.0
matmul:v_proj:L21                0.06     0.0
matmul:k_proj:L21                0.06     0.0
matmul:v_proj:L6                 0.06     0.0
matmul:k_proj:L6                 0.05     0.0
matmul:k_proj:L7                 0.05     0.0
matmul:k_proj:L22                0.05     0.0
matmul:v_proj:L11                0.05     0.0
matmul:k_proj:L24                0.05     0.0
matmul:k_proj:L3                 0.05     0.0
matmul:k_proj:L15                0.05     0.0
matmul:v_proj:L3                 0.05     0.0
matmul:v_proj:L18                0.05     0.0
matmul:k_proj:L20                0.05     0.0
matmul:v_proj:L9                 0.05     0.0
matmul:v_proj:L20                0.05     0.0
matmul:v_proj:L22                0.05     0.0
matmul:k_proj:L9                 0.05     0.0
matmul:k_proj:L13                0.04     0.0
matmul:k_proj:L12                0.04     0.0
matmul:k_proj:L18                0.04     0.0
matmul:k_proj:L14                0.04     0.0
matmul:k_proj:L10                0.04     0.0
matmul:v_proj:L24                0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:k_proj:L4                 0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:v_proj:L14                0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:k_proj:L1                 0.04     0.0
matmul:k_proj:L19                0.04     0.0
matmul:k_proj:L17                0.04     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:v_proj:L17                0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:v_proj:L19                0.04     0.0
gather                           0.04     0.0
──────────────────────────────────────────────────
TOTAL                          566.42   100.0

[browser:warning] [19334.3ms][Profile] Batch decode (N=4):
[browser:warning] [19334.4ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      224.16    40.3
fused_ffn                       39.98     7.2
matmul:lm_head                  31.38     5.6
matmul_rmsnorm_fused:L17.ffn_down       10.38     1.9
matmul_rmsnorm_fused:L15.ffn_down       10.35     1.9
matmul_rmsnorm_fused:L1.ffn_down       10.32     1.9
matmul_rmsnorm_fused:L13.ffn_down       10.25     1.8
matmul_rmsnorm_fused:L4.ffn_down       10.12     1.8
matmul_rmsnorm_fused:L8.ffn_down       10.01     1.8
matmul_rmsnorm_fused:L22.ffn_down        9.85     1.8
matmul_rmsnorm_fused:L25.ffn_down        9.85     1.8
matmul_rmsnorm_fused:L12.ffn_down        9.73     1.7
matmul_rmsnorm_fused:L20.ffn_down        9.63     1.7
matmul_rmsnorm_fused:L7.ffn_down        9.56     1.7
matmul_rmsnorm_fused:L24.ffn_down        9.48     1.7
matmul_rmsnorm_fused:L5.ffn_down        9.36     1.7
matmul_rmsnorm_fused:L19.ffn_down        9.07     1.6
matmul_rmsnorm_fused:L14.ffn_down        9.06     1.6
matmul_rmsnorm_fused:L11.ffn_down        8.97     1.6
matmul_rmsnorm_fused:L21.ffn_down        8.82     1.6
matmul_rmsnorm_fused:L18.ffn_down        8.79     1.6
matmul_rmsnorm_fused:L9.ffn_down        8.75     1.6
matmul_rmsnorm_fused:L2.ffn_down        8.75     1.6
matmul_rmsnorm_fused:L23.ffn_down        8.74     1.6
matmul_rmsnorm_fused:L10.ffn_down        8.73     1.6
matmul_rmsnorm_fused:L6.ffn_down        8.71     1.6
matmul_rmsnorm_fused:L0.ffn_down        8.70     1.6
matmul_rmsnorm_fused:L16.ffn_down        8.69     1.6
matmul_rmsnorm_fused:L3.ffn_down        8.68     1.6
sample_phase2                    3.36     0.6
rmsnorm                          3.14     0.6
rope                             0.78     0.1
matmul:q_proj:L0                 0.27     0.0
matmul:o_proj:L20                0.18     0.0
matmul:o_proj:L1                 0.17     0.0
matmul:o_proj:L24                0.17     0.0
matmul:o_proj:L12                0.17     0.0
matmul:o_proj:L15                0.17     0.0
matmul:o_proj:L0                 0.16     0.0
matmul:q_proj:L8                 0.16     0.0
matmul:o_proj:L22                0.15     0.0
matmul:q_proj:L6                 0.15     0.0
matmul:o_proj:L4                 0.15     0.0
matmul:o_proj:L11                0.15     0.0
matmul:q_proj:L2                 0.15     0.0
matmul:o_proj:L8                 0.15     0.0
matmul:q_proj:L18                0.15     0.0
matmul:o_proj:L14                0.14     0.0
matmul:o_proj:L19                0.14     0.0
matmul:o_proj:L25                0.14     0.0
matmul:o_proj:L18                0.14     0.0
matmul:o_proj:L6                 0.14     0.0
matmul:o_proj:L7                 0.14     0.0
matmul:o_proj:L17                0.14     0.0
matmul:q_proj:L21                0.14     0.0
matmul:q_proj:L14                0.14     0.0
matmul:q_proj:L22                0.13     0.0
matmul:o_proj:L3                 0.13     0.0
matmul:o_proj:L23                0.13     0.0
matmul:o_proj:L13                0.13     0.0
matmul:o_proj:L2                 0.13     0.0
matmul:o_proj:L5                 0.13     0.0
matmul:q_proj:L11                0.13     0.0
matmul:q_proj:L19                0.13     0.0
matmul:o_proj:L16                0.13     0.0
matmul:q_proj:L24                0.13     0.0
matmul:o_proj:L10                0.13     0.0
matmul:q_proj:L3                 0.13     0.0
matmul:o_proj:L9                 0.13     0.0
matmul:q_proj:L9                 0.13     0.0
matmul:o_proj:L21                0.13     0.0
matmul:q_proj:L15                0.13     0.0
matmul:q_proj:L20                0.13     0.0
matmul:q_proj:L4                 0.13     0.0
matmul:q_proj:L25                0.13     0.0
matmul:q_proj:L1                 0.13     0.0
matmul:q_proj:L17                0.13     0.0
matmul:q_proj:L7                 0.13     0.0
matmul:q_proj:L12                0.13     0.0
matmul:q_proj:L13                0.13     0.0
matmul:q_proj:L5                 0.13     0.0
matmul:q_proj:L10                0.12     0.0
matmul:q_proj:L16                0.12     0.0
matmul:q_proj:L23                0.12     0.0
matmul:k_proj:L18                0.10     0.0
matmul:k_proj:L0                 0.10     0.0
sample_phase1                    0.09     0.0
matmul:v_proj:L0                 0.08     0.0
sample_phase3                    0.07     0.0
matmul:k_proj:L8                 0.07     0.0
matmul:k_proj:L2                 0.06     0.0
matmul:v_proj:L2                 0.06     0.0
matmul:v_proj:L8                 0.06     0.0
matmul:k_proj:L6                 0.06     0.0
matmul:v_proj:L6                 0.06     0.0
matmul:v_proj:L18                0.05     0.0
matmul:v_proj:L14                0.05     0.0
matmul:k_proj:L14                0.05     0.0
matmul:v_proj:L11                0.05     0.0
matmul:v_proj:L13                0.05     0.0
matmul:k_proj:L11                0.05     0.0
matmul:k_proj:L4                 0.05     0.0
matmul:k_proj:L21                0.05     0.0
matmul:k_proj:L19                0.05     0.0
matmul:k_proj:L15                0.05     0.0
matmul:k_proj:L20                0.05     0.0
matmul:v_proj:L4                 0.05     0.0
matmul:k_proj:L1                 0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:k_proj:L7                 0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:v_proj:L16                0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:k_proj:L22                0.04     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:k_proj:L24                0.04     0.0
matmul:k_proj:L5                 0.04     0.0
matmul:k_proj:L10                0.04     0.0
matmul:v_proj:L24                0.04     0.0
matmul:k_proj:L17                0.04     0.0
matmul:k_proj:L3                 0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:v_proj:L22                0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:k_proj:L12                0.04     0.0
matmul:k_proj:L16                0.04     0.0
matmul:k_proj:L13                0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:v_proj:L5                 0.04     0.0
matmul:v_proj:L19                0.04     0.0
matmul:k_proj:L23                0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:v_proj:L12                0.04     0.0
gather                           0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:v_proj:L17                0.04     0.0
scale                            0.03     0.0
──────────────────────────────────────────────────
TOTAL                          556.30   100.0

[browser:warning] [19943.7ms][Profile] Batch decode (N=4):
[browser:warning] [19943.8ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      232.98    41.4
fused_ffn                       39.44     7.0
matmul:lm_head                  31.38     5.6
matmul_rmsnorm_fused:L1.ffn_down       10.31     1.8
matmul_rmsnorm_fused:L7.ffn_down       10.24     1.8
matmul_rmsnorm_fused:L20.ffn_down       10.22     1.8
matmul_rmsnorm_fused:L15.ffn_down       10.08     1.8
matmul_rmsnorm_fused:L10.ffn_down       10.06     1.8
matmul_rmsnorm_fused:L25.ffn_down       10.03     1.8
matmul_rmsnorm_fused:L2.ffn_down        9.92     1.8
matmul_rmsnorm_fused:L12.ffn_down        9.91     1.8
matmul_rmsnorm_fused:L5.ffn_down        9.65     1.7
matmul_rmsnorm_fused:L4.ffn_down        9.61     1.7
matmul_rmsnorm_fused:L9.ffn_down        9.53     1.7
matmul_rmsnorm_fused:L17.ffn_down        9.49     1.7
matmul_rmsnorm_fused:L19.ffn_down        8.93     1.6
matmul_rmsnorm_fused:L13.ffn_down        8.91     1.6
matmul_rmsnorm_fused:L21.ffn_down        8.87     1.6
matmul_rmsnorm_fused:L24.ffn_down        8.85     1.6
matmul_rmsnorm_fused:L23.ffn_down        8.83     1.6
matmul_rmsnorm_fused:L3.ffn_down        8.74     1.6
matmul_rmsnorm_fused:L22.ffn_down        8.73     1.6
matmul_rmsnorm_fused:L14.ffn_down        8.72     1.6
matmul_rmsnorm_fused:L18.ffn_down        8.68     1.5
matmul_rmsnorm_fused:L16.ffn_down        8.67     1.5
matmul_rmsnorm_fused:L11.ffn_down        8.66     1.5
matmul_rmsnorm_fused:L8.ffn_down        8.66     1.5
matmul_rmsnorm_fused:L0.ffn_down        8.64     1.5
matmul_rmsnorm_fused:L6.ffn_down        8.63     1.5
sample_phase2                    3.29     0.6
rmsnorm                          3.16     0.6
rope                             0.78     0.1
matmul:q_proj:L0                 0.19     0.0
matmul:o_proj:L4                 0.18     0.0
matmul:o_proj:L12                0.16     0.0
matmul:o_proj:L9                 0.16     0.0
matmul:o_proj:L5                 0.16     0.0
matmul:q_proj:L6                 0.15     0.0
matmul:o_proj:L19                0.15     0.0
matmul:o_proj:L17                0.15     0.0
matmul:q_proj:L24                0.15     0.0
matmul:q_proj:L22                0.15     0.0
matmul:o_proj:L22                0.15     0.0
matmul:q_proj:L14                0.15     0.0
matmul:o_proj:L24                0.14     0.0
matmul:q_proj:L19                0.14     0.0
matmul:o_proj:L20                0.14     0.0
matmul:o_proj:L14                0.14     0.0
matmul:o_proj:L23                0.14     0.0
matmul:o_proj:L7                 0.14     0.0
matmul:q_proj:L3                 0.14     0.0
matmul:q_proj:L11                0.14     0.0
matmul:o_proj:L25                0.14     0.0
matmul:o_proj:L15                0.14     0.0
matmul:o_proj:L11                0.14     0.0
matmul:o_proj:L3                 0.13     0.0
matmul:q_proj:L16                0.13     0.0
matmul:o_proj:L0                 0.13     0.0
matmul:o_proj:L1                 0.13     0.0
matmul:o_proj:L13                0.13     0.0
matmul:o_proj:L2                 0.13     0.0
matmul:o_proj:L21                0.13     0.0
matmul:q_proj:L2                 0.13     0.0
matmul:o_proj:L16                0.13     0.0
matmul:q_proj:L21                0.13     0.0
matmul:o_proj:L6                 0.13     0.0
matmul:o_proj:L18                0.13     0.0
matmul:o_proj:L10                0.13     0.0
matmul:q_proj:L13                0.13     0.0
matmul:q_proj:L23                0.13     0.0
matmul:q_proj:L9                 0.12     0.0
matmul:q_proj:L25                0.12     0.0
matmul:q_proj:L15                0.12     0.0
matmul:q_proj:L5                 0.12     0.0
matmul:q_proj:L4                 0.12     0.0
matmul:q_proj:L12                0.12     0.0
matmul:q_proj:L10                0.12     0.0
matmul:q_proj:L8                 0.12     0.0
matmul:q_proj:L1                 0.12     0.0
matmul:o_proj:L8                 0.12     0.0
matmul:q_proj:L18                0.12     0.0
matmul:q_proj:L20                0.12     0.0
matmul:q_proj:L17                0.12     0.0
matmul:q_proj:L7                 0.12     0.0
sample_phase1                    0.09     0.0
matmul:k_proj:L0                 0.08     0.0
matmul:v_proj:L0                 0.07     0.0
matmul:k_proj:L22                0.07     0.0
matmul:v_proj:L22                0.06     0.0
matmul:k_proj:L24                0.06     0.0
matmul:k_proj:L6                 0.06     0.0
sample_phase3                    0.06     0.0
matmul:k_proj:L14                0.06     0.0
matmul:v_proj:L6                 0.06     0.0
matmul:v_proj:L14                0.05     0.0
matmul:k_proj:L3                 0.05     0.0
matmul:k_proj:L16                0.05     0.0
matmul:k_proj:L11                0.05     0.0
matmul:v_proj:L3                 0.05     0.0
matmul:v_proj:L11                0.05     0.0
matmul:v_proj:L16                0.05     0.0
matmul:k_proj:L5                 0.05     0.0
matmul:k_proj:L19                0.05     0.0
matmul:k_proj:L23                0.05     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:k_proj:L4                 0.04     0.0
matmul:k_proj:L15                0.04     0.0
matmul:v_proj:L24                0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:k_proj:L21                0.04     0.0
matmul:v_proj:L19                0.04     0.0
matmul:k_proj:L1                 0.04     0.0
matmul:k_proj:L2                 0.04     0.0
matmul:k_proj:L18                0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:k_proj:L12                0.04     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:k_proj:L13                0.04     0.0
matmul:k_proj:L10                0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:k_proj:L20                0.04     0.0
matmul:k_proj:L7                 0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:v_proj:L5                 0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:k_proj:L17                0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:v_proj:L18                0.04     0.0
matmul:v_proj:L17                0.04     0.0
gather                           0.03     0.0
scale                            0.02     0.0
──────────────────────────────────────────────────
TOTAL                          562.41   100.0

[browser:warning] [20559.9ms][Profile] Batch decode (N=4):
[browser:warning] [20560.1ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      241.97    42.5
fused_ffn                       38.98     6.9
matmul:lm_head                  30.63     5.4
matmul_rmsnorm_fused:L12.ffn_down       10.32     1.8
matmul_rmsnorm_fused:L18.ffn_down       10.27     1.8
matmul_rmsnorm_fused:L10.ffn_down       10.19     1.8
matmul_rmsnorm_fused:L8.ffn_down       10.18     1.8
matmul_rmsnorm_fused:L6.ffn_down       10.11     1.8
matmul_rmsnorm_fused:L23.ffn_down       10.10     1.8
matmul_rmsnorm_fused:L21.ffn_down        9.77     1.7
matmul_rmsnorm_fused:L25.ffn_down        9.64     1.7
matmul_rmsnorm_fused:L5.ffn_down        9.51     1.7
matmul_rmsnorm_fused:L13.ffn_down        9.45     1.7
matmul_rmsnorm_fused:L19.ffn_down        9.43     1.7
matmul_rmsnorm_fused:L14.ffn_down        9.30     1.6
matmul_rmsnorm_fused:L1.ffn_down        8.98     1.6
matmul_rmsnorm_fused:L17.ffn_down        8.93     1.6
matmul_rmsnorm_fused:L4.ffn_down        8.87     1.6
matmul_rmsnorm_fused:L9.ffn_down        8.71     1.5
matmul_rmsnorm_fused:L24.ffn_down        8.70     1.5
matmul_rmsnorm_fused:L11.ffn_down        8.68     1.5
matmul_rmsnorm_fused:L2.ffn_down        8.67     1.5
matmul_rmsnorm_fused:L16.ffn_down        8.67     1.5
matmul_rmsnorm_fused:L22.ffn_down        8.66     1.5
matmul_rmsnorm_fused:L3.ffn_down        8.65     1.5
matmul_rmsnorm_fused:L0.ffn_down        8.65     1.5
matmul_rmsnorm_fused:L7.ffn_down        8.64     1.5
matmul_rmsnorm_fused:L20.ffn_down        8.64     1.5
matmul_rmsnorm_fused:L15.ffn_down        8.62     1.5
sample_phase2                    3.35     0.6
rmsnorm                          3.11     0.5
rope                             0.77     0.1
matmul:o_proj:L19                0.18     0.0
matmul:o_proj:L13                0.17     0.0
matmul:q_proj:L0                 0.16     0.0
matmul:q_proj:L6                 0.15     0.0
matmul:o_proj:L6                 0.15     0.0
matmul:o_proj:L10                0.15     0.0
matmul:q_proj:L15                0.15     0.0
matmul:o_proj:L25                0.15     0.0
matmul:o_proj:L23                0.15     0.0
matmul:o_proj:L8                 0.14     0.0
matmul:o_proj:L17                0.14     0.0
matmul:o_proj:L11                0.14     0.0
matmul:o_proj:L12                0.14     0.0
matmul:q_proj:L19                0.14     0.0
matmul:q_proj:L2                 0.14     0.0
matmul:o_proj:L21                0.14     0.0
matmul:o_proj:L0                 0.14     0.0
matmul:o_proj:L15                0.13     0.0
matmul:o_proj:L16                0.13     0.0
matmul:o_proj:L4                 0.13     0.0
matmul:q_proj:L17                0.13     0.0
matmul:o_proj:L18                0.13     0.0
matmul:o_proj:L7                 0.13     0.0
matmul:q_proj:L4                 0.13     0.0
matmul:o_proj:L5                 0.13     0.0
matmul:o_proj:L24                0.13     0.0
matmul:q_proj:L13                0.13     0.0
matmul:o_proj:L2                 0.13     0.0
matmul:o_proj:L14                0.13     0.0
matmul:q_proj:L7                 0.13     0.0
matmul:o_proj:L9                 0.13     0.0
matmul:o_proj:L22                0.13     0.0
matmul:q_proj:L25                0.13     0.0
matmul:q_proj:L20                0.13     0.0
matmul:q_proj:L11                0.13     0.0
matmul:o_proj:L1                 0.13     0.0
matmul:q_proj:L24                0.12     0.0
matmul:q_proj:L12                0.12     0.0
matmul:q_proj:L10                0.12     0.0
matmul:q_proj:L16                0.12     0.0
matmul:q_proj:L18                0.12     0.0
matmul:o_proj:L3                 0.12     0.0
matmul:q_proj:L8                 0.12     0.0
matmul:q_proj:L9                 0.12     0.0
matmul:q_proj:L23                0.12     0.0
matmul:q_proj:L3                 0.12     0.0
matmul:q_proj:L5                 0.12     0.0
matmul:o_proj:L20                0.12     0.0
matmul:q_proj:L14                0.12     0.0
matmul:q_proj:L1                 0.12     0.0
matmul:q_proj:L21                0.12     0.0
matmul:q_proj:L22                0.12     0.0
sample_phase1                    0.09     0.0
sample_phase3                    0.08     0.0
matmul:k_proj:L0                 0.07     0.0
matmul:k_proj:L6                 0.07     0.0
matmul:v_proj:L0                 0.07     0.0
matmul:v_proj:L6                 0.07     0.0
matmul:k_proj:L15                0.07     0.0
matmul:v_proj:L15                0.06     0.0
matmul:k_proj:L2                 0.05     0.0
matmul:v_proj:L2                 0.05     0.0
matmul:k_proj:L19                0.05     0.0
matmul:v_proj:L19                0.05     0.0
matmul:k_proj:L18                0.05     0.0
matmul:v_proj:L13                0.05     0.0
matmul:k_proj:L4                 0.05     0.0
matmul:k_proj:L17                0.04     0.0
matmul:k_proj:L23                0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:k_proj:L20                0.04     0.0
matmul:k_proj:L1                 0.04     0.0
matmul:k_proj:L11                0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:k_proj:L12                0.04     0.0
matmul:v_proj:L17                0.04     0.0
matmul:k_proj:L24                0.04     0.0
matmul:k_proj:L13                0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:k_proj:L16                0.04     0.0
matmul:k_proj:L7                 0.04     0.0
matmul:k_proj:L22                0.04     0.0
matmul:k_proj:L5                 0.04     0.0
matmul:v_proj:L5                 0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:v_proj:L14                0.04     0.0
matmul:v_proj:L18                0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:k_proj:L3                 0.04     0.0
matmul:k_proj:L21                0.04     0.0
matmul:k_proj:L10                0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:v_proj:L24                0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:v_proj:L16                0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:k_proj:L14                0.04     0.0
matmul:v_proj:L22                0.04     0.0
matmul:v_proj:L1                 0.04     0.0
gather                           0.04     0.0
scale                            0.03     0.0
──────────────────────────────────────────────────
TOTAL                          568.73   100.0

[browser:warning] [21189.0ms][Profile] Batch decode (N=4):
[browser:warning] [21189.1ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      245.94    42.3
fused_ffn                       40.24     6.9
matmul:lm_head                  32.21     5.5
matmul_rmsnorm_fused:L1.ffn_down       11.00     1.9
matmul_rmsnorm_fused:L6.ffn_down       10.51     1.8
matmul_rmsnorm_fused:L21.ffn_down       10.44     1.8
matmul_rmsnorm_fused:L7.ffn_down       10.30     1.8
matmul_rmsnorm_fused:L16.ffn_down       10.27     1.8
matmul_rmsnorm_fused:L12.ffn_down       10.17     1.8
matmul_rmsnorm_fused:L2.ffn_down       10.04     1.7
matmul_rmsnorm_fused:L10.ffn_down        9.98     1.7
matmul_rmsnorm_fused:L18.ffn_down        9.92     1.7
matmul_rmsnorm_fused:L20.ffn_down        9.66     1.7
matmul_rmsnorm_fused:L8.ffn_down        9.57     1.6
matmul_rmsnorm_fused:L25.ffn_down        9.56     1.6
matmul_rmsnorm_fused:L14.ffn_down        9.27     1.6
matmul_rmsnorm_fused:L0.ffn_down        9.17     1.6
matmul_rmsnorm_fused:L4.ffn_down        9.04     1.6
matmul_rmsnorm_fused:L22.ffn_down        9.01     1.6
matmul_rmsnorm_fused:L19.ffn_down        8.99     1.5
matmul_rmsnorm_fused:L15.ffn_down        8.95     1.5
matmul_rmsnorm_fused:L13.ffn_down        8.74     1.5
matmul_rmsnorm_fused:L9.ffn_down        8.73     1.5
matmul_rmsnorm_fused:L3.ffn_down        8.69     1.5
matmul_rmsnorm_fused:L11.ffn_down        8.68     1.5
matmul_rmsnorm_fused:L5.ffn_down        8.68     1.5
matmul_rmsnorm_fused:L24.ffn_down        8.68     1.5
matmul_rmsnorm_fused:L23.ffn_down        8.65     1.5
matmul_rmsnorm_fused:L17.ffn_down        8.65     1.5
sample_phase2                    3.28     0.6
rmsnorm                          3.20     0.6
rope                             0.81     0.1
matmul:o_proj:L4                 0.20     0.0
matmul:o_proj:L13                0.18     0.0
matmul:o_proj:L25                0.18     0.0
matmul:o_proj:L0                 0.17     0.0
matmul:o_proj:L20                0.16     0.0
matmul:o_proj:L2                 0.16     0.0
matmul:o_proj:L10                0.16     0.0
matmul:o_proj:L1                 0.16     0.0
matmul:o_proj:L14                0.15     0.0
matmul:o_proj:L19                0.15     0.0
matmul:q_proj:L9                 0.15     0.0
matmul:q_proj:L2                 0.15     0.0
matmul:q_proj:L14                0.15     0.0
matmul:o_proj:L11                0.15     0.0
matmul:q_proj:L0                 0.15     0.0
matmul:o_proj:L15                0.14     0.0
matmul:o_proj:L16                0.14     0.0
matmul:q_proj:L23                0.14     0.0
matmul:q_proj:L13                0.14     0.0
matmul:q_proj:L19                0.14     0.0
matmul:o_proj:L21                0.14     0.0
matmul:o_proj:L7                 0.14     0.0
matmul:o_proj:L9                 0.14     0.0
matmul:q_proj:L16                0.14     0.0
matmul:q_proj:L15                0.14     0.0
matmul:o_proj:L12                0.14     0.0
matmul:o_proj:L3                 0.14     0.0
matmul:o_proj:L18                0.14     0.0
matmul:q_proj:L7                 0.14     0.0
matmul:o_proj:L6                 0.14     0.0
matmul:o_proj:L5                 0.14     0.0
matmul:o_proj:L23                0.14     0.0
matmul:o_proj:L24                0.13     0.0
matmul:o_proj:L22                0.13     0.0
matmul:q_proj:L20                0.13     0.0
matmul:o_proj:L17                0.13     0.0
matmul:o_proj:L8                 0.13     0.0
matmul:q_proj:L22                0.13     0.0
matmul:q_proj:L4                 0.13     0.0
matmul:q_proj:L11                0.13     0.0
matmul:q_proj:L12                0.13     0.0
matmul:q_proj:L1                 0.13     0.0
matmul:q_proj:L3                 0.12     0.0
matmul:q_proj:L5                 0.12     0.0
matmul:q_proj:L25                0.12     0.0
matmul:q_proj:L10                0.12     0.0
matmul:q_proj:L8                 0.12     0.0
matmul:q_proj:L6                 0.12     0.0
matmul:q_proj:L17                0.12     0.0
matmul:q_proj:L24                0.12     0.0
matmul:q_proj:L21                0.12     0.0
matmul:q_proj:L18                0.12     0.0
sample_phase1                    0.08     0.0
matmul:v_proj:L9                 0.06     0.0
sample_phase3                    0.06     0.0
matmul:v_proj:L14                0.06     0.0
matmul:k_proj:L9                 0.06     0.0
matmul:k_proj:L2                 0.06     0.0
matmul:k_proj:L14                0.06     0.0
matmul:k_proj:L19                0.06     0.0
matmul:v_proj:L2                 0.06     0.0
matmul:k_proj:L23                0.05     0.0
matmul:v_proj:L19                0.05     0.0
matmul:v_proj:L23                0.05     0.0
matmul:k_proj:L13                0.05     0.0
matmul:v_proj:L13                0.05     0.0
matmul:v_proj:L7                 0.05     0.0
matmul:k_proj:L7                 0.05     0.0
matmul:k_proj:L21                0.05     0.0
matmul:k_proj:L15                0.05     0.0
matmul:k_proj:L0                 0.05     0.0
matmul:v_proj:L25                0.05     0.0
matmul:v_proj:L0                 0.05     0.0
matmul:k_proj:L8                 0.05     0.0
matmul:v_proj:L20                0.05     0.0
matmul:k_proj:L16                0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:k_proj:L18                0.04     0.0
matmul:k_proj:L4                 0.04     0.0
matmul:k_proj:L11                0.04     0.0
matmul:k_proj:L20                0.04     0.0
matmul:k_proj:L1                 0.04     0.0
matmul:k_proj:L22                0.04     0.0
matmul:v_proj:L16                0.04     0.0
matmul:k_proj:L12                0.04     0.0
matmul:v_proj:L22                0.04     0.0
matmul:k_proj:L17                0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:k_proj:L3                 0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:k_proj:L10                0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:k_proj:L24                0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:v_proj:L17                0.04     0.0
matmul:k_proj:L5                 0.04     0.0
matmul:v_proj:L5                 0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:v_proj:L18                0.04     0.0
matmul:v_proj:L24                0.04     0.0
gather                           0.01     0.0
scale                            0.01     0.0
──────────────────────────────────────────────────
TOTAL                          580.97   100.0

[browser:warning] [21817.7ms][Profile] Batch decode (N=4):
[browser:warning] [21817.8ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      255.14    43.8
fused_ffn                       39.12     6.7
matmul:lm_head                  32.33     5.6
matmul_rmsnorm_fused:L13.ffn_down       10.49     1.8
matmul_rmsnorm_fused:L22.ffn_down       10.28     1.8
matmul_rmsnorm_fused:L3.ffn_down       10.26     1.8
matmul_rmsnorm_fused:L23.ffn_down       10.15     1.7
matmul_rmsnorm_fused:L8.ffn_down       10.02     1.7
matmul_rmsnorm_fused:L4.ffn_down        9.74     1.7
matmul_rmsnorm_fused:L2.ffn_down        9.33     1.6
matmul_rmsnorm_fused:L19.ffn_down        9.14     1.6
matmul_rmsnorm_fused:L10.ffn_down        9.14     1.6
matmul_rmsnorm_fused:L20.ffn_down        9.09     1.6
matmul_rmsnorm_fused:L7.ffn_down        9.08     1.6
matmul_rmsnorm_fused:L17.ffn_down        9.05     1.6
matmul_rmsnorm_fused:L1.ffn_down        8.89     1.5
matmul_rmsnorm_fused:L16.ffn_down        8.86     1.5
matmul_rmsnorm_fused:L9.ffn_down        8.85     1.5
matmul_rmsnorm_fused:L0.ffn_down        8.77     1.5
matmul_rmsnorm_fused:L14.ffn_down        8.77     1.5
matmul_rmsnorm_fused:L25.ffn_down        8.70     1.5
matmul_rmsnorm_fused:L6.ffn_down        8.70     1.5
matmul_rmsnorm_fused:L21.ffn_down        8.70     1.5
matmul_rmsnorm_fused:L15.ffn_down        8.70     1.5
matmul_rmsnorm_fused:L5.ffn_down        8.66     1.5
matmul_rmsnorm_fused:L11.ffn_down        8.64     1.5
matmul_rmsnorm_fused:L24.ffn_down        8.63     1.5
matmul_rmsnorm_fused:L12.ffn_down        8.63     1.5
matmul_rmsnorm_fused:L18.ffn_down        8.62     1.5
rmsnorm                          3.33     0.6
sample_phase2                    3.30     0.6
rope                             0.91     0.2
matmul:q_proj:L0                 0.19     0.0
matmul:o_proj:L8                 0.18     0.0
matmul:o_proj:L15                0.16     0.0
matmul:o_proj:L2                 0.16     0.0
matmul:o_proj:L16                0.15     0.0
matmul:o_proj:L17                0.15     0.0
matmul:q_proj:L5                 0.15     0.0
matmul:q_proj:L20                0.15     0.0
matmul:o_proj:L21                0.15     0.0
matmul:q_proj:L15                0.15     0.0
matmul:o_proj:L7                 0.14     0.0
matmul:o_proj:L10                0.14     0.0
matmul:o_proj:L4                 0.14     0.0
matmul:o_proj:L3                 0.14     0.0
matmul:q_proj:L10                0.14     0.0
matmul:o_proj:L1                 0.14     0.0
matmul:q_proj:L21                0.14     0.0
matmul:o_proj:L25                0.14     0.0
matmul:o_proj:L13                0.14     0.0
matmul:o_proj:L14                0.14     0.0
matmul:o_proj:L0                 0.14     0.0
matmul:q_proj:L11                0.14     0.0
matmul:o_proj:L23                0.14     0.0
matmul:o_proj:L20                0.13     0.0
matmul:q_proj:L23                0.13     0.0
matmul:q_proj:L14                0.13     0.0
matmul:o_proj:L9                 0.13     0.0
matmul:q_proj:L16                0.13     0.0
matmul:q_proj:L1                 0.13     0.0
matmul:o_proj:L24                0.13     0.0
matmul:o_proj:L22                0.13     0.0
matmul:o_proj:L5                 0.13     0.0
matmul:q_proj:L24                0.13     0.0
matmul:q_proj:L8                 0.13     0.0
matmul:o_proj:L6                 0.13     0.0
matmul:q_proj:L13                0.13     0.0
matmul:o_proj:L11                0.13     0.0
matmul:o_proj:L19                0.13     0.0
matmul:o_proj:L12                0.13     0.0
matmul:q_proj:L25                0.13     0.0
matmul:q_proj:L7                 0.13     0.0
matmul:q_proj:L12                0.13     0.0
matmul:q_proj:L17                0.12     0.0
matmul:q_proj:L4                 0.12     0.0
matmul:q_proj:L3                 0.12     0.0
matmul:q_proj:L2                 0.12     0.0
matmul:o_proj:L18                0.12     0.0
matmul:q_proj:L18                0.12     0.0
matmul:q_proj:L9                 0.12     0.0
matmul:q_proj:L6                 0.12     0.0
matmul:q_proj:L22                0.12     0.0
matmul:q_proj:L19                0.12     0.0
gather                           0.08     0.0
matmul:k_proj:L0                 0.08     0.0
sample_phase1                    0.08     0.0
matmul:v_proj:L0                 0.08     0.0
sample_phase3                    0.07     0.0
matmul:k_proj:L10                0.06     0.0
matmul:v_proj:L15                0.06     0.0
matmul:v_proj:L10                0.06     0.0
matmul:k_proj:L15                0.06     0.0
matmul:v_proj:L1                 0.06     0.0
matmul:k_proj:L16                0.06     0.0
matmul:k_proj:L1                 0.06     0.0
matmul:v_proj:L16                0.06     0.0
matmul:k_proj:L5                 0.06     0.0
matmul:k_proj:L21                0.06     0.0
matmul:k_proj:L20                0.06     0.0
matmul:v_proj:L5                 0.05     0.0
matmul:v_proj:L21                0.05     0.0
matmul:v_proj:L11                0.05     0.0
matmul:k_proj:L11                0.05     0.0
matmul:v_proj:L20                0.05     0.0
matmul:v_proj:L23                0.05     0.0
matmul:k_proj:L23                0.05     0.0
matmul:v_proj:L24                0.05     0.0
matmul:k_proj:L24                0.05     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:k_proj:L4                 0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:k_proj:L17                0.04     0.0
matmul:k_proj:L14                0.04     0.0
matmul:k_proj:L13                0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:k_proj:L3                 0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:v_proj:L17                0.04     0.0
matmul:k_proj:L7                 0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:v_proj:L14                0.04     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:k_proj:L2                 0.04     0.0
matmul:k_proj:L18                0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:k_proj:L19                0.04     0.0
matmul:k_proj:L12                0.04     0.0
matmul:v_proj:L19                0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:k_proj:L22                0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:v_proj:L22                0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:v_proj:L18                0.04     0.0
matmul:v_proj:L6                 0.04     0.0
scale                            0.04     0.0
──────────────────────────────────────────────────
TOTAL                          581.99   100.0

[browser:warning] [22458.3ms][Profile] Batch decode (N=4):
[browser:warning] [22458.4ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      264.57    44.5
fused_ffn                       39.07     6.6
matmul:lm_head                  30.29     5.1
matmul_rmsnorm_fused:L19.ffn_down       11.50     1.9
matmul_rmsnorm_fused:L13.ffn_down       11.28     1.9
matmul_rmsnorm_fused:L1.ffn_down       11.23     1.9
matmul_rmsnorm_fused:L7.ffn_down       11.23     1.9
matmul_rmsnorm_fused:L10.ffn_down       10.72     1.8
matmul_rmsnorm_fused:L25.ffn_down       10.70     1.8
matmul_rmsnorm_fused:L4.ffn_down        9.88     1.7
matmul_rmsnorm_fused:L22.ffn_down        9.62     1.6
matmul_rmsnorm_fused:L16.ffn_down        9.53     1.6
matmul_rmsnorm_fused:L23.ffn_down        9.20     1.5
matmul_rmsnorm_fused:L3.ffn_down        8.77     1.5
matmul_rmsnorm_fused:L9.ffn_down        8.75     1.5
matmul_rmsnorm_fused:L6.ffn_down        8.72     1.5
matmul_rmsnorm_fused:L21.ffn_down        8.71     1.5
matmul_rmsnorm_fused:L24.ffn_down        8.68     1.5
matmul_rmsnorm_fused:L18.ffn_down        8.68     1.5
matmul_rmsnorm_fused:L2.ffn_down        8.67     1.5
matmul_rmsnorm_fused:L0.ffn_down        8.66     1.5
matmul_rmsnorm_fused:L14.ffn_down        8.66     1.5
matmul_rmsnorm_fused:L5.ffn_down        8.65     1.5
matmul_rmsnorm_fused:L17.ffn_down        8.64     1.5
matmul_rmsnorm_fused:L11.ffn_down        8.64     1.5
matmul_rmsnorm_fused:L8.ffn_down        8.63     1.5
matmul_rmsnorm_fused:L20.ffn_down        8.63     1.5
matmul_rmsnorm_fused:L12.ffn_down        8.62     1.5
matmul_rmsnorm_fused:L15.ffn_down        8.61     1.4
sample_phase2                    3.26     0.5
rmsnorm                          3.01     0.5
rope                             0.75     0.1
matmul:o_proj:L10                0.18     0.0
matmul:q_proj:L17                0.17     0.0
matmul:o_proj:L23                0.17     0.0
matmul:o_proj:L7                 0.16     0.0
matmul:o_proj:L4                 0.16     0.0
matmul:q_proj:L23                0.15     0.0
matmul:q_proj:L4                 0.15     0.0
matmul:q_proj:L14                0.14     0.0
matmul:o_proj:L0                 0.14     0.0
matmul:q_proj:L0                 0.14     0.0
matmul:o_proj:L17                0.14     0.0
matmul:o_proj:L6                 0.14     0.0
matmul:q_proj:L2                 0.14     0.0
matmul:o_proj:L1                 0.14     0.0
matmul:q_proj:L20                0.13     0.0
matmul:o_proj:L9                 0.13     0.0
matmul:o_proj:L16                0.13     0.0
matmul:o_proj:L18                0.13     0.0
matmul:o_proj:L21                0.13     0.0
matmul:o_proj:L3                 0.13     0.0
matmul:o_proj:L13                0.13     0.0
matmul:o_proj:L19                0.13     0.0
matmul:o_proj:L25                0.13     0.0
matmul:o_proj:L24                0.13     0.0
matmul:o_proj:L20                0.13     0.0
matmul:o_proj:L22                0.13     0.0
matmul:o_proj:L12                0.13     0.0
matmul:q_proj:L19                0.13     0.0
matmul:o_proj:L15                0.12     0.0
matmul:q_proj:L7                 0.12     0.0
matmul:o_proj:L14                0.12     0.0
matmul:o_proj:L2                 0.12     0.0
matmul:q_proj:L9                 0.12     0.0
matmul:q_proj:L10                0.12     0.0
matmul:q_proj:L1                 0.12     0.0
matmul:q_proj:L6                 0.12     0.0
matmul:q_proj:L8                 0.12     0.0
matmul:o_proj:L11                0.12     0.0
matmul:q_proj:L15                0.12     0.0
matmul:q_proj:L25                0.12     0.0
matmul:q_proj:L13                0.12     0.0
matmul:q_proj:L22                0.12     0.0
matmul:q_proj:L16                0.12     0.0
matmul:q_proj:L12                0.12     0.0
matmul:q_proj:L24                0.12     0.0
matmul:q_proj:L3                 0.12     0.0
matmul:q_proj:L5                 0.12     0.0
matmul:o_proj:L5                 0.12     0.0
matmul:q_proj:L18                0.12     0.0
matmul:q_proj:L11                0.12     0.0
matmul:q_proj:L21                0.12     0.0
matmul:o_proj:L8                 0.11     0.0
matmul:v_proj:L17                0.09     0.0
matmul:k_proj:L17                0.08     0.0
sample_phase1                    0.08     0.0
matmul:v_proj:L4                 0.06     0.0
sample_phase3                    0.06     0.0
matmul:k_proj:L4                 0.06     0.0
matmul:v_proj:L23                0.06     0.0
matmul:k_proj:L23                0.06     0.0
matmul:k_proj:L2                 0.05     0.0
matmul:k_proj:L14                0.05     0.0
matmul:k_proj:L20                0.05     0.0
matmul:v_proj:L14                0.05     0.0
matmul:v_proj:L2                 0.05     0.0
matmul:v_proj:L20                0.05     0.0
matmul:k_proj:L0                 0.05     0.0
matmul:v_proj:L0                 0.05     0.0
matmul:k_proj:L15                0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:k_proj:L13                0.04     0.0
matmul:k_proj:L19                0.04     0.0
matmul:k_proj:L1                 0.04     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:k_proj:L10                0.04     0.0
matmul:k_proj:L22                0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:k_proj:L16                0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:v_proj:L16                0.04     0.0
matmul:k_proj:L24                0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:k_proj:L18                0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:k_proj:L7                 0.04     0.0
matmul:k_proj:L5                 0.04     0.0
matmul:k_proj:L12                0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:k_proj:L3                 0.04     0.0
matmul:v_proj:L19                0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:v_proj:L22                0.04     0.0
matmul:v_proj:L18                0.04     0.0
matmul:k_proj:L11                0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:k_proj:L21                0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:v_proj:L24                0.04     0.0
matmul:v_proj:L5                 0.04     0.0
gather                           0.02     0.0
scale                            0.01     0.0
──────────────────────────────────────────────────
TOTAL                          594.02   100.0

[browser:warning] [23100.7ms][Profile] Batch decode (N=4):
[browser:warning] [23100.8ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      268.23    45.1
fused_ffn                       39.58     6.6
matmul:lm_head                  30.43     5.1
matmul_rmsnorm_fused:L24.ffn_down       11.87     2.0
matmul_rmsnorm_fused:L18.ffn_down       10.96     1.8
matmul_rmsnorm_fused:L15.ffn_down       10.91     1.8
matmul_rmsnorm_fused:L21.ffn_down       10.35     1.7
matmul_rmsnorm_fused:L0.ffn_down        9.83     1.7
matmul_rmsnorm_fused:L12.ffn_down        9.48     1.6
matmul_rmsnorm_fused:L5.ffn_down        9.42     1.6
matmul_rmsnorm_fused:L9.ffn_down        9.17     1.5
matmul_rmsnorm_fused:L2.ffn_down        9.11     1.5
matmul_rmsnorm_fused:L3.ffn_down        9.07     1.5
matmul_rmsnorm_fused:L6.ffn_down        9.05     1.5
matmul_rmsnorm_fused:L13.ffn_down        8.89     1.5
matmul_rmsnorm_fused:L16.ffn_down        8.76     1.5
matmul_rmsnorm_fused:L1.ffn_down        8.76     1.5
matmul_rmsnorm_fused:L4.ffn_down        8.75     1.5
matmul_rmsnorm_fused:L14.ffn_down        8.71     1.5
matmul_rmsnorm_fused:L25.ffn_down        8.70     1.5
matmul_rmsnorm_fused:L22.ffn_down        8.69     1.5
matmul_rmsnorm_fused:L17.ffn_down        8.69     1.5
matmul_rmsnorm_fused:L11.ffn_down        8.68     1.5
matmul_rmsnorm_fused:L10.ffn_down        8.68     1.5
matmul_rmsnorm_fused:L7.ffn_down        8.67     1.5
matmul_rmsnorm_fused:L23.ffn_down        8.67     1.5
matmul_rmsnorm_fused:L19.ffn_down        8.66     1.5
matmul_rmsnorm_fused:L20.ffn_down        8.66     1.5
matmul_rmsnorm_fused:L8.ffn_down        8.65     1.5
sample_phase2                    3.28     0.6
rmsnorm                          3.05     0.5
rope                             0.70     0.1
matmul:o_proj:L18                0.41     0.1
matmul:o_proj:L22                0.41     0.1
matmul:o_proj:L15                0.19     0.0
matmul:o_proj:L21                0.19     0.0
matmul:o_proj:L12                0.18     0.0
matmul:q_proj:L0                 0.18     0.0
matmul:o_proj:L9                 0.16     0.0
matmul:q_proj:L3                 0.16     0.0
matmul:o_proj:L24                0.16     0.0
matmul:q_proj:L6                 0.16     0.0
matmul:o_proj:L3                 0.15     0.0
matmul:o_proj:L0                 0.15     0.0
matmul:o_proj:L20                0.15     0.0
matmul:o_proj:L1                 0.15     0.0
matmul:o_proj:L6                 0.15     0.0
matmul:q_proj:L2                 0.15     0.0
matmul:o_proj:L2                 0.14     0.0
matmul:q_proj:L1                 0.14     0.0
matmul:o_proj:L23                0.14     0.0
matmul:q_proj:L17                0.14     0.0
matmul:o_proj:L19                0.13     0.0
matmul:o_proj:L14                0.13     0.0
matmul:o_proj:L5                 0.13     0.0
matmul:o_proj:L4                 0.13     0.0
matmul:q_proj:L20                0.13     0.0
matmul:o_proj:L8                 0.13     0.0
matmul:o_proj:L17                0.13     0.0
matmul:o_proj:L11                0.13     0.0
matmul:q_proj:L19                0.13     0.0
matmul:o_proj:L13                0.13     0.0
matmul:q_proj:L8                 0.13     0.0
matmul:q_proj:L9                 0.13     0.0
matmul:q_proj:L5                 0.13     0.0
matmul:q_proj:L21                0.13     0.0
matmul:q_proj:L24                0.13     0.0
matmul:o_proj:L7                 0.13     0.0
matmul:q_proj:L22                0.13     0.0
matmul:q_proj:L18                0.13     0.0
matmul:o_proj:L25                0.12     0.0
matmul:q_proj:L15                0.12     0.0
matmul:q_proj:L25                0.12     0.0
matmul:o_proj:L16                0.12     0.0
matmul:q_proj:L23                0.12     0.0
matmul:q_proj:L11                0.12     0.0
matmul:q_proj:L12                0.12     0.0
matmul:o_proj:L10                0.12     0.0
matmul:q_proj:L10                0.12     0.0
matmul:q_proj:L14                0.12     0.0
matmul:q_proj:L16                0.12     0.0
matmul:q_proj:L4                 0.12     0.0
matmul:q_proj:L13                0.12     0.0
matmul:q_proj:L7                 0.12     0.0
sample_phase1                    0.08     0.0
matmul:k_proj:L0                 0.07     0.0
matmul:v_proj:L0                 0.06     0.0
sample_phase3                    0.06     0.0
matmul:k_proj:L6                 0.06     0.0
matmul:v_proj:L6                 0.06     0.0
matmul:k_proj:L3                 0.06     0.0
matmul:v_proj:L3                 0.06     0.0
matmul:k_proj:L18                0.05     0.0
matmul:k_proj:L1                 0.05     0.0
matmul:k_proj:L20                0.05     0.0
matmul:k_proj:L12                0.05     0.0
matmul:k_proj:L2                 0.05     0.0
matmul:v_proj:L19                0.05     0.0
matmul:v_proj:L2                 0.05     0.0
matmul:k_proj:L25                0.05     0.0
matmul:v_proj:L14                0.05     0.0
matmul:k_proj:L9                 0.05     0.0
matmul:v_proj:L1                 0.05     0.0
matmul:v_proj:L9                 0.05     0.0
matmul:k_proj:L17                0.05     0.0
matmul:k_proj:L19                0.05     0.0
matmul:v_proj:L17                0.04     0.0
matmul:k_proj:L15                0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:k_proj:L23                0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:k_proj:L24                0.04     0.0
matmul:k_proj:L4                 0.04     0.0
matmul:k_proj:L5                 0.04     0.0
matmul:v_proj:L22                0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:k_proj:L21                0.04     0.0
matmul:k_proj:L22                0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:v_proj:L5                 0.04     0.0
matmul:k_proj:L7                 0.04     0.0
matmul:v_proj:L18                0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:k_proj:L11                0.04     0.0
matmul:k_proj:L16                0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:k_proj:L13                0.04     0.0
matmul:k_proj:L14                0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:v_proj:L24                0.04     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:v_proj:L16                0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:k_proj:L10                0.04     0.0
gather                           0.03     0.0
scale                            0.02     0.0
──────────────────────────────────────────────────
TOTAL                          595.37   100.0

[browser:warning] [23751.5ms][Profile] Batch decode (N=4):
[browser:warning] [23751.6ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      274.65    45.4
fused_ffn                       39.04     6.5
matmul:lm_head                  30.08     5.0
matmul_rmsnorm_fused:L1.ffn_down       10.46     1.7
matmul_rmsnorm_fused:L0.ffn_down       10.40     1.7
matmul_rmsnorm_fused:L6.ffn_down       10.31     1.7
matmul_rmsnorm_fused:L21.ffn_down       10.15     1.7
matmul_rmsnorm_fused:L18.ffn_down       10.10     1.7
matmul_rmsnorm_fused:L19.ffn_down        9.87     1.6
matmul_rmsnorm_fused:L2.ffn_down        9.75     1.6
matmul_rmsnorm_fused:L22.ffn_down        9.71     1.6
matmul_rmsnorm_fused:L25.ffn_down        9.59     1.6
matmul_rmsnorm_fused:L13.ffn_down        9.54     1.6
matmul_rmsnorm_fused:L12.ffn_down        9.53     1.6
matmul_rmsnorm_fused:L14.ffn_down        9.27     1.5
matmul_rmsnorm_fused:L7.ffn_down        9.10     1.5
matmul_rmsnorm_fused:L24.ffn_down        9.10     1.5
matmul_rmsnorm_fused:L8.ffn_down        9.07     1.5
matmul_rmsnorm_fused:L16.ffn_down        9.02     1.5
matmul_rmsnorm_fused:L4.ffn_down        9.01     1.5
matmul_rmsnorm_fused:L15.ffn_down        8.98     1.5
matmul_rmsnorm_fused:L9.ffn_down        8.95     1.5
matmul_rmsnorm_fused:L5.ffn_down        8.71     1.4
matmul_rmsnorm_fused:L17.ffn_down        8.68     1.4
matmul_rmsnorm_fused:L3.ffn_down        8.66     1.4
matmul_rmsnorm_fused:L11.ffn_down        8.66     1.4
matmul_rmsnorm_fused:L20.ffn_down        8.66     1.4
matmul_rmsnorm_fused:L23.ffn_down        8.65     1.4
matmul_rmsnorm_fused:L10.ffn_down        8.64     1.4
rmsnorm                          3.72     0.6
sample_phase2                    3.29     0.5
rope                             0.86     0.1
matmul:q_proj:L19                0.67     0.1
matmul:o_proj:L25                0.18     0.0
matmul:o_proj:L13                0.17     0.0
matmul:q_proj:L0                 0.17     0.0
matmul:v_proj:L4                 0.17     0.0
matmul:o_proj:L22                0.16     0.0
matmul:o_proj:L19                0.16     0.0
matmul:o_proj:L1                 0.15     0.0
matmul:q_proj:L13                0.15     0.0
matmul:o_proj:L7                 0.15     0.0
matmul:o_proj:L2                 0.15     0.0
matmul:q_proj:L10                0.15     0.0
matmul:o_proj:L24                0.15     0.0
matmul:q_proj:L15                0.15     0.0
matmul:q_proj:L16                0.14     0.0
matmul:q_proj:L9                 0.14     0.0
matmul:o_proj:L11                0.14     0.0
matmul:o_proj:L0                 0.14     0.0
matmul:o_proj:L4                 0.14     0.0
matmul:q_proj:L3                 0.14     0.0
matmul:o_proj:L21                0.14     0.0
matmul:o_proj:L16                0.14     0.0
matmul:o_proj:L12                0.14     0.0
matmul:q_proj:L1                 0.14     0.0
matmul:o_proj:L6                 0.14     0.0
matmul:o_proj:L3                 0.14     0.0
matmul:o_proj:L5                 0.13     0.0
matmul:q_proj:L20                0.13     0.0
matmul:o_proj:L15                0.13     0.0
matmul:o_proj:L10                0.13     0.0
matmul:o_proj:L20                0.13     0.0
matmul:q_proj:L24                0.13     0.0
matmul:o_proj:L14                0.13     0.0
matmul:q_proj:L2                 0.13     0.0
matmul:o_proj:L23                0.13     0.0
matmul:q_proj:L17                0.13     0.0
matmul:o_proj:L9                 0.13     0.0
matmul:q_proj:L6                 0.13     0.0
matmul:o_proj:L18                0.13     0.0
matmul:o_proj:L17                0.13     0.0
matmul:q_proj:L4                 0.13     0.0
matmul:q_proj:L7                 0.13     0.0
matmul:o_proj:L8                 0.13     0.0
matmul:q_proj:L18                0.12     0.0
matmul:q_proj:L12                0.12     0.0
matmul:q_proj:L22                0.12     0.0
matmul:q_proj:L25                0.12     0.0
matmul:q_proj:L11                0.12     0.0
matmul:q_proj:L23                0.12     0.0
matmul:q_proj:L21                0.12     0.0
matmul:q_proj:L5                 0.12     0.0
matmul:q_proj:L14                0.12     0.0
matmul:q_proj:L8                 0.12     0.0
sample_phase1                    0.09     0.0
matmul:k_proj:L19                0.09     0.0
matmul:v_proj:L13                0.06     0.0
matmul:v_proj:L15                0.06     0.0
matmul:k_proj:L13                0.06     0.0
matmul:k_proj:L10                0.06     0.0
matmul:k_proj:L15                0.06     0.0
matmul:k_proj:L16                0.06     0.0
matmul:k_proj:L3                 0.06     0.0
matmul:k_proj:L9                 0.06     0.0
sample_phase3                    0.06     0.0
matmul:v_proj:L16                0.05     0.0
matmul:v_proj:L9                 0.05     0.0
matmul:v_proj:L10                0.05     0.0
matmul:k_proj:L20                0.05     0.0
matmul:v_proj:L19                0.05     0.0
matmul:v_proj:L1                 0.05     0.0
matmul:k_proj:L1                 0.05     0.0
matmul:v_proj:L3                 0.05     0.0
matmul:k_proj:L0                 0.05     0.0
matmul:v_proj:L0                 0.05     0.0
matmul:v_proj:L2                 0.05     0.0
matmul:v_proj:L20                0.05     0.0
matmul:k_proj:L17                0.05     0.0
matmul:k_proj:L2                 0.05     0.0
matmul:v_proj:L17                0.05     0.0
matmul:k_proj:L5                 0.05     0.0
matmul:k_proj:L23                0.05     0.0
matmul:v_proj:L12                0.05     0.0
matmul:k_proj:L7                 0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:k_proj:L4                 0.04     0.0
matmul:k_proj:L24                0.04     0.0
matmul:k_proj:L12                0.04     0.0
matmul:k_proj:L21                0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:k_proj:L18                0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:k_proj:L14                0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:v_proj:L24                0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:k_proj:L11                0.04     0.0
matmul:v_proj:L22                0.04     0.0
matmul:k_proj:L22                0.04     0.0
matmul:v_proj:L5                 0.04     0.0
matmul:v_proj:L18                0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:v_proj:L14                0.04     0.0
gather                           0.01     0.0
scale                            0.01     0.0
──────────────────────────────────────────────────
TOTAL                          604.69   100.0

[browser:warning] [24424.4ms][Profile] Batch decode (N=4):
[browser:warning] [24424.6ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      284.47    45.5
fused_ffn                       43.95     7.0
matmul:lm_head                  32.17     5.1
matmul_rmsnorm_fused:L22.ffn_down       11.54     1.8
matmul_rmsnorm_fused:L4.ffn_down       11.02     1.8
matmul_rmsnorm_fused:L16.ffn_down       10.95     1.8
matmul_rmsnorm_fused:L2.ffn_down       10.36     1.7
matmul_rmsnorm_fused:L0.ffn_down       10.31     1.6
matmul_rmsnorm_fused:L8.ffn_down       10.04     1.6
matmul_rmsnorm_fused:L12.ffn_down        9.99     1.6
matmul_rmsnorm_fused:L20.ffn_down        9.98     1.6
matmul_rmsnorm_fused:L18.ffn_down        9.69     1.6
matmul_rmsnorm_fused:L24.ffn_down        9.38     1.5
matmul_rmsnorm_fused:L14.ffn_down        9.16     1.5
matmul_rmsnorm_fused:L6.ffn_down        9.11     1.5
matmul_rmsnorm_fused:L23.ffn_down        8.93     1.4
matmul_rmsnorm_fused:L10.ffn_down        8.74     1.4
matmul_rmsnorm_fused:L9.ffn_down        8.73     1.4
matmul_rmsnorm_fused:L21.ffn_down        8.72     1.4
matmul_rmsnorm_fused:L25.ffn_down        8.72     1.4
matmul_rmsnorm_fused:L3.ffn_down        8.67     1.4
matmul_rmsnorm_fused:L17.ffn_down        8.67     1.4
matmul_rmsnorm_fused:L5.ffn_down        8.66     1.4
matmul_rmsnorm_fused:L15.ffn_down        8.66     1.4
matmul_rmsnorm_fused:L1.ffn_down        8.65     1.4
matmul_rmsnorm_fused:L11.ffn_down        8.65     1.4
matmul_rmsnorm_fused:L19.ffn_down        8.65     1.4
matmul_rmsnorm_fused:L7.ffn_down        8.64     1.4
matmul_rmsnorm_fused:L13.ffn_down        8.64     1.4
rmsnorm                          3.89     0.6
sample_phase2                    3.45     0.6
matmul:o_proj:L24                1.81     0.3
matmul:o_proj:L22                1.06     0.2
rope                             0.78     0.1
sample_phase3                    0.44     0.1
matmul:o_proj:L20                0.22     0.0
matmul:q_proj:L21                0.17     0.0
matmul:q_proj:L0                 0.17     0.0
matmul:o_proj:L16                0.16     0.0
matmul:q_proj:L5                 0.16     0.0
matmul:o_proj:L14                0.16     0.0
matmul:o_proj:L18                0.16     0.0
matmul:o_proj:L12                0.16     0.0
matmul:o_proj:L1                 0.15     0.0
matmul:q_proj:L10                0.15     0.0
matmul:o_proj:L23                0.15     0.0
matmul:q_proj:L11                0.15     0.0
matmul:o_proj:L21                0.14     0.0
matmul:q_proj:L7                 0.14     0.0
matmul:o_proj:L4                 0.14     0.0
matmul:o_proj:L19                0.14     0.0
matmul:o_proj:L3                 0.14     0.0
matmul:o_proj:L10                0.14     0.0
matmul:q_proj:L17                0.14     0.0
matmul:q_proj:L23                0.14     0.0
matmul:o_proj:L11                0.13     0.0
matmul:q_proj:L3                 0.13     0.0
matmul:o_proj:L0                 0.13     0.0
matmul:o_proj:L5                 0.13     0.0
matmul:o_proj:L6                 0.13     0.0
matmul:o_proj:L7                 0.13     0.0
matmul:q_proj:L22                0.13     0.0
matmul:o_proj:L25                0.13     0.0
matmul:o_proj:L17                0.13     0.0
matmul:o_proj:L15                0.13     0.0
matmul:o_proj:L8                 0.13     0.0
matmul:o_proj:L9                 0.13     0.0
matmul:q_proj:L25                0.13     0.0
matmul:o_proj:L13                0.13     0.0
matmul:q_proj:L24                0.13     0.0
matmul:q_proj:L4                 0.13     0.0
matmul:q_proj:L1                 0.13     0.0
matmul:q_proj:L13                0.12     0.0
matmul:q_proj:L14                0.12     0.0
matmul:q_proj:L19                0.12     0.0
matmul:q_proj:L20                0.12     0.0
matmul:o_proj:L2                 0.12     0.0
matmul:q_proj:L16                0.12     0.0
matmul:q_proj:L9                 0.12     0.0
matmul:q_proj:L18                0.12     0.0
matmul:q_proj:L6                 0.12     0.0
matmul:q_proj:L2                 0.12     0.0
matmul:q_proj:L8                 0.12     0.0
matmul:q_proj:L15                0.12     0.0
matmul:q_proj:L12                0.12     0.0
sample_phase1                    0.10     0.0
matmul:v_proj:L5                 0.07     0.0
matmul:k_proj:L0                 0.06     0.0
matmul:k_proj:L5                 0.06     0.0
matmul:k_proj:L10                0.06     0.0
matmul:v_proj:L0                 0.06     0.0
matmul:v_proj:L11                0.06     0.0
matmul:v_proj:L10                0.06     0.0
matmul:k_proj:L11                0.06     0.0
matmul:k_proj:L7                 0.06     0.0
matmul:v_proj:L7                 0.05     0.0
matmul:v_proj:L17                0.05     0.0
matmul:k_proj:L17                0.05     0.0
matmul:v_proj:L21                0.05     0.0
matmul:k_proj:L21                0.05     0.0
matmul:k_proj:L3                 0.05     0.0
matmul:k_proj:L22                0.05     0.0
matmul:k_proj:L23                0.05     0.0
matmul:v_proj:L22                0.05     0.0
matmul:v_proj:L3                 0.05     0.0
matmul:k_proj:L1                 0.05     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:k_proj:L15                0.04     0.0
matmul:k_proj:L20                0.04     0.0
matmul:k_proj:L24                0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:k_proj:L13                0.04     0.0
matmul:k_proj:L4                 0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:k_proj:L16                0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:v_proj:L24                0.04     0.0
matmul:k_proj:L12                0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:k_proj:L19                0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:k_proj:L14                0.04     0.0
matmul:k_proj:L18                0.04     0.0
matmul:v_proj:L16                0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:v_proj:L19                0.04     0.0
matmul:v_proj:L18                0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:k_proj:L2                 0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:v_proj:L14                0.04     0.0
gather                           0.03     0.0
scale                            0.02     0.0
──────────────────────────────────────────────────
TOTAL                          624.75   100.0

[browser:warning] [25183.6ms][Profile] Batch decode (N=4):
[browser:warning] [25183.8ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      290.23    42.0
fused_ffn                       60.55     8.8
matmul:lm_head                  33.14     4.8
rmsnorm                         17.54     2.5
matmul_rmsnorm_fused:L4.ffn_down       13.89     2.0
matmul_rmsnorm_fused:L14.ffn_down       12.83     1.9
matmul_rmsnorm_fused:L19.ffn_down       10.46     1.5
matmul_rmsnorm_fused:L21.ffn_down       10.32     1.5
matmul_rmsnorm_fused:L9.ffn_down       10.27     1.5
matmul_rmsnorm_fused:L24.ffn_down       10.00     1.4
matmul_rmsnorm_fused:L11.ffn_down        9.86     1.4
matmul_rmsnorm_fused:L2.ffn_down        9.78     1.4
matmul_rmsnorm_fused:L12.ffn_down        9.68     1.4
matmul_rmsnorm_fused:L5.ffn_down        9.39     1.4
matmul_rmsnorm_fused:L20.ffn_down        9.33     1.4
matmul_rmsnorm_fused:L15.ffn_down        9.30     1.3
matmul_rmsnorm_fused:L17.ffn_down        9.19     1.3
matmul_rmsnorm_fused:L16.ffn_down        8.93     1.3
matmul_rmsnorm_fused:L25.ffn_down        8.88     1.3
matmul_rmsnorm_fused:L3.ffn_down        8.82     1.3
matmul_rmsnorm_fused:L7.ffn_down        8.81     1.3
matmul_rmsnorm_fused:L13.ffn_down        8.78     1.3
matmul_rmsnorm_fused:L23.ffn_down        8.78     1.3
matmul_rmsnorm_fused:L6.ffn_down        8.75     1.3
matmul_rmsnorm_fused:L10.ffn_down        8.71     1.3
matmul_rmsnorm_fused:L8.ffn_down        8.70     1.3
matmul_rmsnorm_fused:L22.ffn_down        8.69     1.3
matmul_rmsnorm_fused:L1.ffn_down        8.68     1.3
matmul_rmsnorm_fused:L18.ffn_down        8.67     1.3
matmul_rmsnorm_fused:L0.ffn_down        8.62     1.2
matmul:o_proj:L22                3.73     0.5
sample_phase2                    3.44     0.5
matmul:q_proj:L0                 3.05     0.4
matmul:o_proj:L7                 2.77     0.4
matmul:o_proj:L4                 2.75     0.4
matmul:o_proj:L9                 2.35     0.3
matmul:q_proj:L10                1.57     0.2
matmul:o_proj:L19                1.03     0.1
matmul:q_proj:L5                 1.00     0.1
matmul:o_proj:L2                 0.98     0.1
rope                             0.92     0.1
gather                           0.91     0.1
matmul:o_proj:L17                0.87     0.1
matmul:o_proj:L20                0.85     0.1
matmul:q_proj:L3                 0.82     0.1
scale                            0.82     0.1
matmul:o_proj:L5                 0.76     0.1
sample_phase3                    0.65     0.1
matmul:o_proj:L6                 0.63     0.1
matmul:o_proj:L15                0.61     0.1
matmul:k_proj:L5                 0.58     0.1
matmul:o_proj:L24                0.44     0.1
matmul:o_proj:L25                0.41     0.1
matmul:v_proj:L10                0.34     0.0
matmul:v_proj:L3                 0.33     0.0
matmul:k_proj:L10                0.31     0.0
matmul:k_proj:L3                 0.30     0.0
matmul:o_proj:L14                0.29     0.0
matmul:q_proj:L15                0.20     0.0
matmul:k_proj:L0                 0.17     0.0
matmul:q_proj:L12                0.17     0.0
matmul:o_proj:L21                0.16     0.0
matmul:q_proj:L22                0.15     0.0
matmul:o_proj:L18                0.15     0.0
matmul:o_proj:L16                0.15     0.0
matmul:o_proj:L3                 0.15     0.0
matmul:o_proj:L23                0.15     0.0
matmul:q_proj:L13                0.15     0.0
matmul:o_proj:L12                0.15     0.0
matmul:o_proj:L13                0.15     0.0
matmul:q_proj:L7                 0.15     0.0
sample_phase1                    0.15     0.0
matmul:o_proj:L0                 0.14     0.0
matmul:q_proj:L16                0.14     0.0
matmul:o_proj:L11                0.14     0.0
matmul:o_proj:L10                0.14     0.0
matmul:q_proj:L9                 0.14     0.0
matmul:o_proj:L8                 0.14     0.0
matmul:q_proj:L24                0.14     0.0
matmul:q_proj:L14                0.14     0.0
matmul:q_proj:L6                 0.14     0.0
matmul:q_proj:L18                0.13     0.0
matmul:q_proj:L4                 0.13     0.0
matmul:q_proj:L25                0.13     0.0
matmul:o_proj:L1                 0.13     0.0
matmul:q_proj:L23                0.13     0.0
matmul:q_proj:L17                0.13     0.0
matmul:q_proj:L20                0.13     0.0
matmul:q_proj:L2                 0.13     0.0
matmul:q_proj:L11                0.13     0.0
matmul:q_proj:L19                0.12     0.0
matmul:q_proj:L21                0.12     0.0
matmul:q_proj:L1                 0.12     0.0
matmul:q_proj:L8                 0.12     0.0
matmul:v_proj:L0                 0.11     0.0
matmul:v_proj:L13                0.06     0.0
matmul:v_proj:L5                 0.06     0.0
matmul:k_proj:L15                0.06     0.0
matmul:k_proj:L24                0.06     0.0
matmul:k_proj:L12                0.06     0.0
matmul:k_proj:L22                0.06     0.0
matmul:v_proj:L12                0.06     0.0
matmul:v_proj:L16                0.06     0.0
matmul:k_proj:L16                0.06     0.0
matmul:v_proj:L22                0.06     0.0
matmul:v_proj:L15                0.06     0.0
matmul:k_proj:L7                 0.05     0.0
matmul:k_proj:L13                0.05     0.0
matmul:v_proj:L6                 0.05     0.0
matmul:v_proj:L7                 0.05     0.0
matmul:k_proj:L18                0.05     0.0
matmul:k_proj:L6                 0.05     0.0
matmul:k_proj:L4                 0.05     0.0
matmul:k_proj:L2                 0.05     0.0
matmul:k_proj:L23                0.05     0.0
matmul:v_proj:L20                0.05     0.0
matmul:v_proj:L24                0.05     0.0
matmul:k_proj:L1                 0.05     0.0
matmul:k_proj:L14                0.05     0.0
matmul:k_proj:L9                 0.05     0.0
matmul:v_proj:L9                 0.05     0.0
matmul:v_proj:L23                0.05     0.0
matmul:v_proj:L2                 0.05     0.0
matmul:k_proj:L19                0.05     0.0
matmul:k_proj:L17                0.05     0.0
matmul:k_proj:L25                0.05     0.0
matmul:v_proj:L18                0.05     0.0
matmul:v_proj:L4                 0.05     0.0
matmul:v_proj:L14                0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:k_proj:L20                0.04     0.0
matmul:v_proj:L17                0.04     0.0
matmul:k_proj:L11                0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:k_proj:L21                0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:v_proj:L19                0.04     0.0
matmul:v_proj:L8                 0.04     0.0
──────────────────────────────────────────────────
TOTAL                          690.52   100.0

[browser:warning] [25862.4ms][Profile] Batch decode (N=4):
[browser:warning] [25862.5ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      296.32    47.0
fused_ffn                       41.26     6.5
matmul:lm_head                  30.09     4.8
matmul_rmsnorm_fused:L13.ffn_down       10.48     1.7
matmul_rmsnorm_fused:L22.ffn_down       10.44     1.7
matmul_rmsnorm_fused:L3.ffn_down       10.32     1.6
matmul_rmsnorm_fused:L6.ffn_down       10.17     1.6
matmul_rmsnorm_fused:L15.ffn_down       10.12     1.6
matmul_rmsnorm_fused:L9.ffn_down       10.10     1.6
matmul_rmsnorm_fused:L5.ffn_down        9.95     1.6
matmul_rmsnorm_fused:L12.ffn_down        9.93     1.6
matmul_rmsnorm_fused:L7.ffn_down        9.70     1.5
matmul_rmsnorm_fused:L18.ffn_down        9.64     1.5
matmul_rmsnorm_fused:L11.ffn_down        9.56     1.5
matmul_rmsnorm_fused:L21.ffn_down        9.29     1.5
matmul_rmsnorm_fused:L2.ffn_down        9.20     1.5
matmul_rmsnorm_fused:L16.ffn_down        9.12     1.4
matmul_rmsnorm_fused:L19.ffn_down        9.05     1.4
matmul_rmsnorm_fused:L25.ffn_down        8.89     1.4
matmul_rmsnorm_fused:L1.ffn_down        8.79     1.4
matmul_rmsnorm_fused:L24.ffn_down        8.79     1.4
matmul_rmsnorm_fused:L10.ffn_down        8.73     1.4
matmul_rmsnorm_fused:L14.ffn_down        8.70     1.4
matmul_rmsnorm_fused:L23.ffn_down        8.70     1.4
matmul_rmsnorm_fused:L17.ffn_down        8.69     1.4
matmul_rmsnorm_fused:L20.ffn_down        8.68     1.4
matmul_rmsnorm_fused:L0.ffn_down        8.68     1.4
matmul_rmsnorm_fused:L8.ffn_down        8.67     1.4
matmul_rmsnorm_fused:L4.ffn_down        8.63     1.4
rmsnorm                          4.32     0.7
sample_phase2                    3.34     0.5
rope                             0.79     0.1
matmul:o_proj:L21                0.77     0.1
matmul:o_proj:L11                0.72     0.1
matmul:o_proj:L25                0.66     0.1
matmul:q_proj:L0                 0.22     0.0
matmul:o_proj:L18                0.17     0.0
matmul:o_proj:L15                0.17     0.0
matmul:q_proj:L4                 0.17     0.0
matmul:o_proj:L2                 0.16     0.0
matmul:o_proj:L12                0.16     0.0
matmul:o_proj:L17                0.16     0.0
matmul:o_proj:L5                 0.16     0.0
matmul:o_proj:L10                0.15     0.0
matmul:q_proj:L17                0.15     0.0
matmul:q_proj:L8                 0.15     0.0
matmul:o_proj:L16                0.15     0.0
matmul:o_proj:L24                0.15     0.0
matmul:q_proj:L10                0.15     0.0
matmul:o_proj:L1                 0.14     0.0
matmul:o_proj:L19                0.14     0.0
matmul:o_proj:L0                 0.14     0.0
matmul:q_proj:L22                0.14     0.0
matmul:o_proj:L23                0.14     0.0
matmul:o_proj:L22                0.14     0.0
matmul:o_proj:L14                0.14     0.0
matmul:o_proj:L4                 0.14     0.0
matmul:o_proj:L8                 0.13     0.0
matmul:q_proj:L7                 0.13     0.0
matmul:o_proj:L6                 0.13     0.0
matmul:q_proj:L25                0.13     0.0
matmul:o_proj:L20                0.13     0.0
matmul:o_proj:L7                 0.13     0.0
matmul:q_proj:L24                0.13     0.0
matmul:o_proj:L13                0.13     0.0
matmul:o_proj:L9                 0.13     0.0
matmul:q_proj:L18                0.13     0.0
matmul:o_proj:L3                 0.13     0.0
matmul:q_proj:L16                0.13     0.0
matmul:q_proj:L11                0.13     0.0
matmul:q_proj:L23                0.13     0.0
matmul:q_proj:L13                0.12     0.0
matmul:q_proj:L14                0.12     0.0
matmul:q_proj:L19                0.12     0.0
matmul:q_proj:L1                 0.12     0.0
matmul:q_proj:L6                 0.12     0.0
matmul:q_proj:L3                 0.12     0.0
matmul:q_proj:L21                0.12     0.0
matmul:q_proj:L9                 0.12     0.0
matmul:q_proj:L20                0.12     0.0
matmul:q_proj:L15                0.12     0.0
matmul:q_proj:L5                 0.12     0.0
matmul:q_proj:L12                0.12     0.0
matmul:q_proj:L2                 0.12     0.0
sample_phase1                    0.08     0.0
matmul:k_proj:L4                 0.07     0.0
sample_phase3                    0.06     0.0
matmul:k_proj:L0                 0.06     0.0
matmul:k_proj:L1                 0.06     0.0
matmul:v_proj:L0                 0.06     0.0
matmul:v_proj:L4                 0.06     0.0
matmul:v_proj:L17                0.06     0.0
matmul:v_proj:L1                 0.06     0.0
matmul:k_proj:L17                0.06     0.0
matmul:k_proj:L10                0.06     0.0
matmul:k_proj:L8                 0.05     0.0
matmul:v_proj:L10                0.05     0.0
matmul:k_proj:L7                 0.05     0.0
matmul:v_proj:L8                 0.05     0.0
matmul:v_proj:L7                 0.05     0.0
matmul:k_proj:L12                0.05     0.0
matmul:k_proj:L15                0.05     0.0
matmul:k_proj:L16                0.05     0.0
matmul:k_proj:L22                0.05     0.0
matmul:k_proj:L24                0.05     0.0
matmul:k_proj:L18                0.05     0.0
matmul:k_proj:L11                0.05     0.0
matmul:k_proj:L14                0.05     0.0
matmul:k_proj:L13                0.05     0.0
matmul:k_proj:L9                 0.05     0.0
matmul:k_proj:L6                 0.05     0.0
matmul:k_proj:L19                0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:k_proj:L21                0.04     0.0
matmul:k_proj:L23                0.04     0.0
matmul:v_proj:L22                0.04     0.0
matmul:v_proj:L19                0.04     0.0
matmul:k_proj:L5                 0.04     0.0
matmul:v_proj:L24                0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:k_proj:L20                0.04     0.0
matmul:v_proj:L16                0.04     0.0
matmul:k_proj:L3                 0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:k_proj:L2                 0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:v_proj:L18                0.04     0.0
matmul:v_proj:L14                0.04     0.0
matmul:v_proj:L5                 0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:v_proj:L20                0.04     0.0
gather                           0.03     0.0
scale                            0.03     0.0
──────────────────────────────────────────────────
TOTAL                          630.73   100.0

[browser:warning] [26553.5ms][Profile] Batch decode (N=4):
[browser:warning] [26553.6ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      301.98    46.9
fused_ffn                       42.24     6.6
matmul:lm_head                  32.03     5.0
matmul_rmsnorm_fused:L15.ffn_down       12.27     1.9
matmul_rmsnorm_fused:L8.ffn_down       12.00     1.9
matmul_rmsnorm_fused:L21.ffn_down       10.65     1.7
matmul_rmsnorm_fused:L14.ffn_down       10.48     1.6
matmul_rmsnorm_fused:L7.ffn_down       10.34     1.6
matmul_rmsnorm_fused:L20.ffn_down       10.27     1.6
matmul_rmsnorm_fused:L12.ffn_down        9.86     1.5
matmul_rmsnorm_fused:L1.ffn_down        9.77     1.5
matmul_rmsnorm_fused:L2.ffn_down        9.71     1.5
matmul_rmsnorm_fused:L24.ffn_down        9.58     1.5
matmul_rmsnorm_fused:L18.ffn_down        9.54     1.5
matmul_rmsnorm_fused:L13.ffn_down        9.47     1.5
matmul_rmsnorm_fused:L4.ffn_down        9.28     1.4
matmul_rmsnorm_fused:L9.ffn_down        9.10     1.4
matmul_rmsnorm_fused:L3.ffn_down        9.09     1.4
matmul_rmsnorm_fused:L25.ffn_down        8.80     1.4
matmul_rmsnorm_fused:L10.ffn_down        8.73     1.4
matmul_rmsnorm_fused:L6.ffn_down        8.73     1.4
matmul_rmsnorm_fused:L5.ffn_down        8.71     1.4
matmul_rmsnorm_fused:L22.ffn_down        8.70     1.4
matmul_rmsnorm_fused:L11.ffn_down        8.69     1.4
matmul_rmsnorm_fused:L19.ffn_down        8.68     1.4
matmul_rmsnorm_fused:L23.ffn_down        8.68     1.3
matmul_rmsnorm_fused:L17.ffn_down        8.68     1.3
matmul_rmsnorm_fused:L0.ffn_down        8.67     1.3
matmul_rmsnorm_fused:L16.ffn_down        8.65     1.3
rmsnorm                          4.26     0.7
sample_phase2                    3.40     0.5
rope                             0.95     0.1
matmul:o_proj:L4                 0.77     0.1
matmul:o_proj:L19                0.28     0.0
matmul:q_proj:L9                 0.20     0.0
matmul:q_proj:L2                 0.20     0.0
matmul:q_proj:L3                 0.19     0.0
matmul:o_proj:L25                0.17     0.0
matmul:o_proj:L15                0.17     0.0
matmul:o_proj:L13                0.17     0.0
matmul:o_proj:L21                0.17     0.0
matmul:q_proj:L16                0.16     0.0
matmul:o_proj:L23                0.16     0.0
matmul:o_proj:L12                0.16     0.0
matmul:q_proj:L19                0.16     0.0
matmul:o_proj:L3                 0.16     0.0
matmul:o_proj:L9                 0.16     0.0
matmul:o_proj:L2                 0.15     0.0
matmul:o_proj:L10                0.15     0.0
matmul:q_proj:L0                 0.15     0.0
matmul:o_proj:L18                0.15     0.0
matmul:o_proj:L1                 0.15     0.0
matmul:o_proj:L20                0.15     0.0
matmul:o_proj:L16                0.15     0.0
matmul:q_proj:L21                0.15     0.0
matmul:o_proj:L8                 0.15     0.0
matmul:q_proj:L10                0.15     0.0
matmul:o_proj:L24                0.15     0.0
matmul:o_proj:L6                 0.14     0.0
matmul:q_proj:L15                0.14     0.0
matmul:o_proj:L14                0.14     0.0
matmul:q_proj:L8                 0.14     0.0
matmul:o_proj:L0                 0.14     0.0
matmul:o_proj:L22                0.14     0.0
matmul:q_proj:L25                0.14     0.0
matmul:o_proj:L5                 0.14     0.0
matmul:o_proj:L7                 0.14     0.0
matmul:q_proj:L12                0.14     0.0
matmul:q_proj:L13                0.13     0.0
matmul:o_proj:L11                0.13     0.0
matmul:q_proj:L7                 0.13     0.0
matmul:q_proj:L23                0.13     0.0
matmul:q_proj:L22                0.13     0.0
matmul:q_proj:L6                 0.13     0.0
matmul:q_proj:L20                0.13     0.0
matmul:q_proj:L1                 0.13     0.0
matmul:q_proj:L24                0.13     0.0
matmul:q_proj:L5                 0.12     0.0
matmul:o_proj:L17                0.12     0.0
matmul:q_proj:L4                 0.12     0.0
matmul:q_proj:L11                0.12     0.0
matmul:q_proj:L18                0.12     0.0
matmul:q_proj:L14                0.12     0.0
matmul:q_proj:L17                0.12     0.0
sample_phase1                    0.09     0.0
matmul:k_proj:L9                 0.08     0.0
matmul:v_proj:L9                 0.08     0.0
matmul:k_proj:L3                 0.08     0.0
matmul:k_proj:L2                 0.08     0.0
matmul:v_proj:L3                 0.07     0.0
matmul:v_proj:L2                 0.07     0.0
matmul:v_proj:L25                0.07     0.0
matmul:k_proj:L19                0.07     0.0
sample_phase3                    0.07     0.0
matmul:k_proj:L10                0.07     0.0
matmul:k_proj:L16                0.06     0.0
matmul:v_proj:L19                0.06     0.0
matmul:v_proj:L10                0.06     0.0
matmul:v_proj:L16                0.06     0.0
matmul:k_proj:L0                 0.06     0.0
matmul:k_proj:L15                0.06     0.0
matmul:k_proj:L25                0.06     0.0
matmul:v_proj:L15                0.06     0.0
matmul:v_proj:L0                 0.05     0.0
matmul:v_proj:L21                0.05     0.0
matmul:k_proj:L21                0.05     0.0
matmul:k_proj:L8                 0.05     0.0
matmul:v_proj:L8                 0.05     0.0
matmul:k_proj:L7                 0.05     0.0
matmul:k_proj:L24                0.05     0.0
matmul:k_proj:L23                0.05     0.0
matmul:k_proj:L1                 0.05     0.0
matmul:k_proj:L4                 0.05     0.0
matmul:v_proj:L12                0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:k_proj:L22                0.04     0.0
matmul:k_proj:L5                 0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:k_proj:L17                0.04     0.0
matmul:k_proj:L13                0.04     0.0
matmul:k_proj:L20                0.04     0.0
matmul:k_proj:L18                0.04     0.0
matmul:v_proj:L24                0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:k_proj:L12                0.04     0.0
matmul:v_proj:L22                0.04     0.0
matmul:k_proj:L11                0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:v_proj:L18                0.04     0.0
matmul:k_proj:L14                0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:v_proj:L5                 0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:v_proj:L14                0.04     0.0
matmul:v_proj:L17                0.04     0.0
gather                           0.03     0.0
scale                            0.02     0.0
──────────────────────────────────────────────────
TOTAL                          643.20   100.0

[browser:warning] [27244.4ms][Profile] Batch decode (N=4):
[browser:warning] [27244.5ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      310.07    48.2
fused_ffn                       41.83     6.5
matmul:lm_head                  30.86     4.8
matmul_rmsnorm_fused:L22.ffn_down       11.55     1.8
matmul_rmsnorm_fused:L5.ffn_down       10.38     1.6
matmul_rmsnorm_fused:L21.ffn_down       10.37     1.6
matmul_rmsnorm_fused:L14.ffn_down       10.34     1.6
matmul_rmsnorm_fused:L12.ffn_down        9.74     1.5
matmul_rmsnorm_fused:L0.ffn_down        9.74     1.5
matmul_rmsnorm_fused:L4.ffn_down        9.65     1.5
matmul_rmsnorm_fused:L8.ffn_down        9.56     1.5
matmul_rmsnorm_fused:L3.ffn_down        9.43     1.5
matmul_rmsnorm_fused:L19.ffn_down        9.39     1.5
matmul_rmsnorm_fused:L16.ffn_down        9.26     1.4
matmul_rmsnorm_fused:L18.ffn_down        9.21     1.4
matmul_rmsnorm_fused:L15.ffn_down        9.16     1.4
matmul_rmsnorm_fused:L11.ffn_down        9.07     1.4
matmul_rmsnorm_fused:L10.ffn_down        9.05     1.4
matmul_rmsnorm_fused:L20.ffn_down        9.03     1.4
matmul_rmsnorm_fused:L2.ffn_down        9.00     1.4
matmul_rmsnorm_fused:L17.ffn_down        8.88     1.4
matmul_rmsnorm_fused:L13.ffn_down        8.86     1.4
matmul_rmsnorm_fused:L9.ffn_down        8.82     1.4
matmul_rmsnorm_fused:L1.ffn_down        8.80     1.4
matmul_rmsnorm_fused:L25.ffn_down        8.79     1.4
matmul_rmsnorm_fused:L7.ffn_down        8.76     1.4
matmul_rmsnorm_fused:L23.ffn_down        8.70     1.4
matmul_rmsnorm_fused:L6.ffn_down        8.66     1.3
matmul_rmsnorm_fused:L24.ffn_down        8.66     1.3
rmsnorm                          3.38     0.5
sample_phase2                    3.32     0.5
rope                             0.92     0.1
matmul:o_proj:L24                0.36     0.1
matmul:q_proj:L0                 0.24     0.0
matmul:o_proj:L0                 0.18     0.0
matmul:q_proj:L19                0.18     0.0
matmul:o_proj:L4                 0.18     0.0
matmul:o_proj:L22                0.18     0.0
matmul:o_proj:L3                 0.18     0.0
matmul:q_proj:L9                 0.17     0.0
matmul:o_proj:L10                0.17     0.0
matmul:q_proj:L13                0.16     0.0
matmul:q_proj:L17                0.16     0.0
matmul:o_proj:L14                0.15     0.0
matmul:o_proj:L12                0.15     0.0
matmul:o_proj:L19                0.15     0.0
matmul:q_proj:L16                0.15     0.0
matmul:o_proj:L18                0.15     0.0
matmul:o_proj:L21                0.15     0.0
matmul:o_proj:L20                0.15     0.0
matmul:q_proj:L10                0.15     0.0
matmul:q_proj:L22                0.14     0.0
matmul:o_proj:L11                0.14     0.0
matmul:o_proj:L15                0.14     0.0
matmul:o_proj:L23                0.14     0.0
matmul:q_proj:L23                0.14     0.0
matmul:o_proj:L9                 0.14     0.0
matmul:o_proj:L13                0.14     0.0
matmul:o_proj:L17                0.14     0.0
matmul:q_proj:L15                0.14     0.0
matmul:o_proj:L8                 0.14     0.0
matmul:o_proj:L5                 0.14     0.0
matmul:o_proj:L25                0.14     0.0
matmul:o_proj:L7                 0.14     0.0
matmul:q_proj:L24                0.14     0.0
matmul:o_proj:L16                0.14     0.0
matmul:o_proj:L2                 0.13     0.0
matmul:q_proj:L3                 0.13     0.0
matmul:q_proj:L6                 0.13     0.0
matmul:q_proj:L18                0.13     0.0
matmul:o_proj:L6                 0.13     0.0
matmul:q_proj:L4                 0.13     0.0
matmul:q_proj:L20                0.13     0.0
matmul:q_proj:L8                 0.13     0.0
matmul:q_proj:L14                0.13     0.0
matmul:o_proj:L1                 0.13     0.0
matmul:q_proj:L11                0.13     0.0
matmul:q_proj:L21                0.13     0.0
matmul:q_proj:L1                 0.13     0.0
matmul:q_proj:L5                 0.12     0.0
matmul:q_proj:L12                0.12     0.0
matmul:q_proj:L7                 0.12     0.0
matmul:q_proj:L25                0.12     0.0
matmul:q_proj:L2                 0.12     0.0
sample_phase1                    0.11     0.0
matmul:k_proj:L0                 0.10     0.0
matmul:v_proj:L0                 0.09     0.0
matmul:v_proj:L19                0.08     0.0
matmul:k_proj:L19                0.08     0.0
sample_phase3                    0.07     0.0
matmul:k_proj:L13                0.07     0.0
matmul:v_proj:L13                0.07     0.0
matmul:k_proj:L9                 0.07     0.0
matmul:v_proj:L9                 0.06     0.0
matmul:k_proj:L17                0.06     0.0
matmul:v_proj:L16                0.06     0.0
matmul:k_proj:L16                0.06     0.0
matmul:v_proj:L17                0.06     0.0
matmul:k_proj:L15                0.06     0.0
matmul:k_proj:L10                0.06     0.0
matmul:v_proj:L10                0.05     0.0
matmul:k_proj:L6                 0.05     0.0
matmul:k_proj:L22                0.05     0.0
matmul:v_proj:L23                0.05     0.0
matmul:v_proj:L22                0.05     0.0
matmul:v_proj:L15                0.05     0.0
matmul:v_proj:L6                 0.05     0.0
matmul:k_proj:L23                0.05     0.0
matmul:k_proj:L18                0.05     0.0
matmul:k_proj:L24                0.05     0.0
matmul:k_proj:L4                 0.05     0.0
matmul:k_proj:L1                 0.05     0.0
matmul:v_proj:L14                0.05     0.0
matmul:k_proj:L20                0.04     0.0
matmul:k_proj:L7                 0.04     0.0
matmul:k_proj:L14                0.04     0.0
matmul:k_proj:L3                 0.04     0.0
matmul:k_proj:L11                0.04     0.0
matmul:v_proj:L18                0.04     0.0
matmul:k_proj:L12                0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:k_proj:L21                0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:v_proj:L24                0.04     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:v_proj:L5                 0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:k_proj:L5                 0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:k_proj:L2                 0.04     0.0
gather                           0.04     0.0
scale                            0.03     0.0
──────────────────────────────────────────────────
TOTAL                          643.92   100.0

[browser:warning] [27939.8ms][Profile] Batch decode (N=4):
[browser:warning] [27939.9ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      316.36    48.8
fused_ffn                       40.05     6.2
matmul:lm_head                  31.10     4.8
matmul_rmsnorm_fused:L22.ffn_down       11.06     1.7
matmul_rmsnorm_fused:L0.ffn_down       10.84     1.7
matmul_rmsnorm_fused:L16.ffn_down       10.57     1.6
matmul_rmsnorm_fused:L11.ffn_down       10.51     1.6
matmul_rmsnorm_fused:L5.ffn_down       10.44     1.6
matmul_rmsnorm_fused:L23.ffn_down       10.43     1.6
matmul_rmsnorm_fused:L6.ffn_down       10.24     1.6
matmul_rmsnorm_fused:L17.ffn_down        9.67     1.5
matmul_rmsnorm_fused:L10.ffn_down        9.66     1.5
matmul_rmsnorm_fused:L4.ffn_down        9.26     1.4
matmul_rmsnorm_fused:L14.ffn_down        8.84     1.4
matmul_rmsnorm_fused:L24.ffn_down        8.84     1.4
matmul_rmsnorm_fused:L7.ffn_down        8.83     1.4
matmul_rmsnorm_fused:L8.ffn_down        8.77     1.4
matmul_rmsnorm_fused:L21.ffn_down        8.75     1.3
matmul_rmsnorm_fused:L13.ffn_down        8.73     1.3
matmul_rmsnorm_fused:L9.ffn_down        8.72     1.3
matmul_rmsnorm_fused:L3.ffn_down        8.71     1.3
matmul_rmsnorm_fused:L25.ffn_down        8.68     1.3
matmul_rmsnorm_fused:L20.ffn_down        8.67     1.3
matmul_rmsnorm_fused:L2.ffn_down        8.66     1.3
matmul_rmsnorm_fused:L1.ffn_down        8.66     1.3
matmul_rmsnorm_fused:L15.ffn_down        8.63     1.3
matmul_rmsnorm_fused:L19.ffn_down        8.62     1.3
matmul_rmsnorm_fused:L18.ffn_down        8.62     1.3
matmul_rmsnorm_fused:L12.ffn_down        8.59     1.3
sample_phase2                    3.24     0.5
rmsnorm                          3.00     0.5
rope                             0.80     0.1
matmul:o_proj:L9                 0.67     0.1
matmul:o_proj:L3                 0.54     0.1
matmul:o_proj:L13                0.54     0.1
matmul:o_proj:L20                0.40     0.1
matmul:o_proj:L14                0.25     0.0
matmul:o_proj:L17                0.17     0.0
matmul:q_proj:L11                0.17     0.0
matmul:q_proj:L0                 0.17     0.0
matmul:o_proj:L16                0.17     0.0
matmul:q_proj:L17                0.16     0.0
matmul:o_proj:L11                0.16     0.0
matmul:o_proj:L0                 0.16     0.0
matmul:q_proj:L5                 0.15     0.0
matmul:q_proj:L23                0.15     0.0
matmul:o_proj:L22                0.15     0.0
matmul:q_proj:L1                 0.15     0.0
matmul:o_proj:L6                 0.15     0.0
matmul:o_proj:L25                0.15     0.0
matmul:o_proj:L15                0.15     0.0
matmul:o_proj:L12                0.14     0.0
matmul:q_proj:L7                 0.14     0.0
matmul:o_proj:L5                 0.14     0.0
matmul:q_proj:L6                 0.14     0.0
matmul:q_proj:L18                0.14     0.0
matmul:o_proj:L23                0.14     0.0
matmul:o_proj:L1                 0.14     0.0
matmul:o_proj:L21                0.14     0.0
matmul:o_proj:L4                 0.14     0.0
matmul:o_proj:L10                0.13     0.0
matmul:o_proj:L7                 0.13     0.0
matmul:q_proj:L14                0.13     0.0
matmul:q_proj:L22                0.13     0.0
matmul:o_proj:L24                0.13     0.0
matmul:q_proj:L16                0.13     0.0
matmul:q_proj:L12                0.13     0.0
matmul:o_proj:L18                0.13     0.0
matmul:q_proj:L24                0.13     0.0
matmul:o_proj:L8                 0.13     0.0
matmul:o_proj:L2                 0.13     0.0
matmul:o_proj:L19                0.13     0.0
matmul:q_proj:L2                 0.13     0.0
matmul:q_proj:L25                0.12     0.0
matmul:q_proj:L10                0.12     0.0
matmul:q_proj:L4                 0.12     0.0
matmul:q_proj:L21                0.12     0.0
matmul:q_proj:L15                0.12     0.0
matmul:q_proj:L8                 0.12     0.0
matmul:q_proj:L20                0.12     0.0
matmul:q_proj:L3                 0.12     0.0
matmul:q_proj:L13                0.12     0.0
matmul:q_proj:L19                0.12     0.0
matmul:q_proj:L9                 0.12     0.0
matmul:v_proj:L5                 0.07     0.0
matmul:k_proj:L5                 0.07     0.0
matmul:v_proj:L11                0.06     0.0
sample_phase1                    0.06     0.0
matmul:k_proj:L11                0.06     0.0
matmul:k_proj:L23                0.06     0.0
matmul:k_proj:L17                0.06     0.0
matmul:v_proj:L17                0.06     0.0
matmul:k_proj:L1                 0.06     0.0
matmul:v_proj:L23                0.06     0.0
matmul:k_proj:L18                0.05     0.0
matmul:v_proj:L1                 0.05     0.0
matmul:k_proj:L7                 0.05     0.0
matmul:v_proj:L7                 0.05     0.0
matmul:v_proj:L18                0.05     0.0
matmul:v_proj:L0                 0.05     0.0
matmul:k_proj:L0                 0.05     0.0
sample_phase3                    0.05     0.0
matmul:k_proj:L22                0.05     0.0
matmul:k_proj:L6                 0.05     0.0
matmul:k_proj:L10                0.05     0.0
matmul:k_proj:L12                0.05     0.0
matmul:v_proj:L22                0.05     0.0
matmul:v_proj:L12                0.05     0.0
matmul:v_proj:L6                 0.05     0.0
matmul:v_proj:L16                0.05     0.0
matmul:k_proj:L16                0.04     0.0
matmul:k_proj:L15                0.04     0.0
matmul:k_proj:L14                0.04     0.0
matmul:k_proj:L4                 0.04     0.0
matmul:k_proj:L24                0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:v_proj:L14                0.04     0.0
matmul:k_proj:L20                0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:k_proj:L19                0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:k_proj:L21                0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:k_proj:L13                0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:v_proj:L24                0.04     0.0
matmul:k_proj:L3                 0.04     0.0
matmul:k_proj:L2                 0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:v_proj:L19                0.04     0.0
gather                           0.01     0.0
scale                            0.01     0.0
──────────────────────────────────────────────────
TOTAL                          648.06   100.0

[browser:warning] [28648.4ms][Profile] Batch decode (N=4):
[browser:warning] [28648.5ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      322.76    48.9
fused_ffn                       41.26     6.3
matmul:lm_head                  33.30     5.0
matmul_rmsnorm_fused:L10.ffn_down       13.04     2.0
matmul_rmsnorm_fused:L21.ffn_down       12.63     1.9
matmul_rmsnorm_fused:L16.ffn_down       11.87     1.8
matmul_rmsnorm_fused:L5.ffn_down       11.60     1.8
matmul_rmsnorm_fused:L24.ffn_down        9.33     1.4
matmul_rmsnorm_fused:L2.ffn_down        9.09     1.4
matmul_rmsnorm_fused:L13.ffn_down        8.87     1.3
matmul_rmsnorm_fused:L25.ffn_down        8.81     1.3
matmul_rmsnorm_fused:L4.ffn_down        8.79     1.3
matmul_rmsnorm_fused:L3.ffn_down        8.79     1.3
matmul_rmsnorm_fused:L9.ffn_down        8.78     1.3
matmul_rmsnorm_fused:L20.ffn_down        8.78     1.3
matmul_rmsnorm_fused:L22.ffn_down        8.78     1.3
matmul_rmsnorm_fused:L1.ffn_down        8.71     1.3
matmul_rmsnorm_fused:L15.ffn_down        8.71     1.3
matmul_rmsnorm_fused:L14.ffn_down        8.69     1.3
matmul_rmsnorm_fused:L17.ffn_down        8.68     1.3
matmul_rmsnorm_fused:L23.ffn_down        8.68     1.3
matmul_rmsnorm_fused:L6.ffn_down        8.67     1.3
matmul_rmsnorm_fused:L8.ffn_down        8.67     1.3
matmul_rmsnorm_fused:L7.ffn_down        8.66     1.3
matmul_rmsnorm_fused:L0.ffn_down        8.66     1.3
matmul_rmsnorm_fused:L18.ffn_down        8.66     1.3
matmul_rmsnorm_fused:L11.ffn_down        8.66     1.3
matmul_rmsnorm_fused:L19.ffn_down        8.63     1.3
matmul_rmsnorm_fused:L12.ffn_down        8.63     1.3
rmsnorm                          4.54     0.7
sample_phase2                    3.34     0.5
matmul:o_proj:L19                0.89     0.1
rope                             0.88     0.1
matmul:o_proj:L8                 0.60     0.1
matmul:q_proj:L0                 0.28     0.0
matmul:o_proj:L16                0.25     0.0
matmul:q_proj:L22                0.20     0.0
matmul:o_proj:L5                 0.20     0.0
matmul:q_proj:L11                0.19     0.0
matmul:o_proj:L23                0.19     0.0
matmul:o_proj:L21                0.19     0.0
matmul:o_proj:L25                0.17     0.0
matmul:o_proj:L22                0.17     0.0
matmul:o_proj:L4                 0.17     0.0
matmul:o_proj:L10                0.16     0.0
matmul:q_proj:L5                 0.16     0.0
matmul:o_proj:L20                0.16     0.0
matmul:o_proj:L2                 0.16     0.0
matmul:o_proj:L15                0.16     0.0
matmul:o_proj:L24                0.16     0.0
matmul:o_proj:L3                 0.15     0.0
matmul:o_proj:L0                 0.15     0.0
matmul:o_proj:L14                0.15     0.0
matmul:o_proj:L9                 0.15     0.0
matmul:q_proj:L4                 0.15     0.0
matmul:q_proj:L14                0.15     0.0
matmul:q_proj:L21                0.14     0.0
matmul:o_proj:L11                0.14     0.0
matmul:q_proj:L25                0.14     0.0
matmul:q_proj:L3                 0.14     0.0
matmul:o_proj:L1                 0.14     0.0
matmul:q_proj:L6                 0.14     0.0
matmul:o_proj:L13                0.13     0.0
matmul:q_proj:L23                0.13     0.0
matmul:q_proj:L10                0.13     0.0
matmul:q_proj:L16                0.13     0.0
matmul:q_proj:L15                0.13     0.0
matmul:o_proj:L12                0.13     0.0
matmul:o_proj:L17                0.13     0.0
matmul:q_proj:L8                 0.13     0.0
matmul:q_proj:L2                 0.13     0.0
matmul:o_proj:L6                 0.13     0.0
matmul:q_proj:L20                0.13     0.0
matmul:q_proj:L1                 0.13     0.0
matmul:q_proj:L19                0.13     0.0
matmul:q_proj:L24                0.12     0.0
matmul:o_proj:L7                 0.12     0.0
matmul:q_proj:L9                 0.12     0.0
matmul:q_proj:L13                0.12     0.0
matmul:q_proj:L17                0.12     0.0
matmul:q_proj:L7                 0.12     0.0
matmul:o_proj:L18                0.12     0.0
matmul:q_proj:L18                0.12     0.0
matmul:q_proj:L12                0.12     0.0
matmul:k_proj:L0                 0.12     0.0
matmul:v_proj:L0                 0.11     0.0
sample_phase1                    0.11     0.0
matmul:k_proj:L22                0.08     0.0
sample_phase3                    0.08     0.0
matmul:v_proj:L22                0.08     0.0
matmul:v_proj:L11                0.08     0.0
matmul:k_proj:L11                0.08     0.0
gather                           0.07     0.0
scale                            0.06     0.0
matmul:k_proj:L5                 0.06     0.0
matmul:v_proj:L5                 0.06     0.0
matmul:k_proj:L4                 0.05     0.0
matmul:k_proj:L1                 0.05     0.0
matmul:k_proj:L20                0.05     0.0
matmul:v_proj:L8                 0.05     0.0
matmul:v_proj:L3                 0.05     0.0
matmul:k_proj:L21                0.05     0.0
matmul:k_proj:L23                0.05     0.0
matmul:k_proj:L3                 0.05     0.0
matmul:v_proj:L21                0.05     0.0
matmul:k_proj:L2                 0.05     0.0
matmul:k_proj:L10                0.05     0.0
matmul:k_proj:L14                0.05     0.0
matmul:v_proj:L4                 0.05     0.0
matmul:k_proj:L6                 0.05     0.0
matmul:k_proj:L25                0.05     0.0
matmul:v_proj:L25                0.05     0.0
matmul:v_proj:L23                0.05     0.0
matmul:k_proj:L8                 0.05     0.0
matmul:k_proj:L15                0.05     0.0
matmul:v_proj:L6                 0.05     0.0
matmul:k_proj:L24                0.05     0.0
matmul:k_proj:L7                 0.05     0.0
matmul:v_proj:L10                0.05     0.0
matmul:k_proj:L9                 0.05     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:k_proj:L19                0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:v_proj:L14                0.04     0.0
matmul:k_proj:L13                0.04     0.0
matmul:v_proj:L16                0.04     0.0
matmul:k_proj:L16                0.04     0.0
matmul:k_proj:L18                0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:k_proj:L17                0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:v_proj:L24                0.04     0.0
matmul:k_proj:L12                0.04     0.0
matmul:v_proj:L19                0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:v_proj:L18                0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:v_proj:L17                0.04     0.0
──────────────────────────────────────────────────
TOTAL                          659.90   100.0

[browser:warning] [29354.3ms][Profile] Batch decode (N=4):
[browser:warning] [29354.5ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      330.90    50.3
fused_ffn                       39.02     5.9
matmul:lm_head                  30.74     4.7
matmul_rmsnorm_fused:L9.ffn_down       12.88     2.0
matmul_rmsnorm_fused:L20.ffn_down       12.44     1.9
matmul_rmsnorm_fused:L4.ffn_down       11.10     1.7
matmul_rmsnorm_fused:L15.ffn_down       10.89     1.7
matmul_rmsnorm_fused:L1.ffn_down        9.57     1.5
matmul_rmsnorm_fused:L12.ffn_down        9.12     1.4
matmul_rmsnorm_fused:L23.ffn_down        8.95     1.4
matmul_rmsnorm_fused:L25.ffn_down        8.82     1.3
matmul_rmsnorm_fused:L10.ffn_down        8.80     1.3
matmul_rmsnorm_fused:L14.ffn_down        8.77     1.3
matmul_rmsnorm_fused:L21.ffn_down        8.76     1.3
matmul_rmsnorm_fused:L3.ffn_down        8.76     1.3
matmul_rmsnorm_fused:L8.ffn_down        8.74     1.3
matmul_rmsnorm_fused:L24.ffn_down        8.69     1.3
matmul_rmsnorm_fused:L22.ffn_down        8.69     1.3
matmul_rmsnorm_fused:L19.ffn_down        8.69     1.3
matmul_rmsnorm_fused:L2.ffn_down        8.67     1.3
matmul_rmsnorm_fused:L13.ffn_down        8.66     1.3
matmul_rmsnorm_fused:L11.ffn_down        8.66     1.3
matmul_rmsnorm_fused:L5.ffn_down        8.65     1.3
matmul_rmsnorm_fused:L6.ffn_down        8.65     1.3
matmul_rmsnorm_fused:L17.ffn_down        8.65     1.3
matmul_rmsnorm_fused:L16.ffn_down        8.64     1.3
matmul_rmsnorm_fused:L18.ffn_down        8.63     1.3
matmul_rmsnorm_fused:L7.ffn_down        8.62     1.3
matmul_rmsnorm_fused:L0.ffn_down        8.62     1.3
sample_phase2                    3.39     0.5
rmsnorm                          3.03     0.5
rope                             0.82     0.1
matmul:q_proj:L0                 0.24     0.0
matmul:q_proj:L10                0.19     0.0
matmul:q_proj:L21                0.19     0.0
matmul:o_proj:L4                 0.18     0.0
matmul:o_proj:L15                0.18     0.0
matmul:o_proj:L21                0.16     0.0
matmul:o_proj:L0                 0.15     0.0
matmul:o_proj:L12                0.15     0.0
matmul:o_proj:L25                0.14     0.0
matmul:o_proj:L14                0.14     0.0
matmul:o_proj:L9                 0.14     0.0
matmul:o_proj:L1                 0.14     0.0
matmul:o_proj:L23                0.14     0.0
matmul:o_proj:L3                 0.14     0.0
matmul:o_proj:L20                0.14     0.0
matmul:o_proj:L10                0.14     0.0
matmul:q_proj:L4                 0.14     0.0
matmul:o_proj:L8                 0.14     0.0
matmul:o_proj:L19                0.13     0.0
matmul:o_proj:L7                 0.13     0.0
matmul:q_proj:L15                0.13     0.0
matmul:o_proj:L2                 0.13     0.0
matmul:q_proj:L9                 0.13     0.0
matmul:o_proj:L11                0.13     0.0
matmul:o_proj:L13                0.13     0.0
matmul:o_proj:L18                0.13     0.0
matmul:q_proj:L11                0.13     0.0
matmul:q_proj:L14                0.13     0.0
matmul:o_proj:L22                0.13     0.0
matmul:q_proj:L7                 0.13     0.0
matmul:q_proj:L19                0.13     0.0
matmul:q_proj:L25                0.13     0.0
matmul:q_proj:L20                0.12     0.0
matmul:o_proj:L16                0.12     0.0
matmul:o_proj:L24                0.12     0.0
matmul:q_proj:L3                 0.12     0.0
matmul:q_proj:L13                0.12     0.0
matmul:o_proj:L17                0.12     0.0
matmul:q_proj:L12                0.12     0.0
matmul:q_proj:L2                 0.12     0.0
matmul:q_proj:L16                0.12     0.0
matmul:q_proj:L18                0.12     0.0
matmul:q_proj:L5                 0.12     0.0
matmul:q_proj:L22                0.12     0.0
matmul:o_proj:L5                 0.12     0.0
matmul:q_proj:L23                0.12     0.0
matmul:q_proj:L1                 0.12     0.0
matmul:q_proj:L24                0.12     0.0
matmul:q_proj:L17                0.12     0.0
sample_phase1                    0.12     0.0
matmul:q_proj:L6                 0.12     0.0
matmul:o_proj:L6                 0.12     0.0
matmul:q_proj:L8                 0.11     0.0
sample_phase3                    0.10     0.0
matmul:v_proj:L0                 0.09     0.0
matmul:k_proj:L0                 0.09     0.0
matmul:v_proj:L10                0.09     0.0
matmul:k_proj:L10                0.09     0.0
matmul:k_proj:L21                0.08     0.0
matmul:v_proj:L21                0.08     0.0
gather                           0.05     0.0
matmul:k_proj:L15                0.05     0.0
matmul:k_proj:L22                0.05     0.0
matmul:k_proj:L4                 0.05     0.0
matmul:k_proj:L20                0.05     0.0
matmul:k_proj:L9                 0.05     0.0
matmul:v_proj:L14                0.05     0.0
matmul:k_proj:L11                0.05     0.0
matmul:k_proj:L24                0.05     0.0
matmul:k_proj:L13                0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:k_proj:L3                 0.04     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:k_proj:L18                0.04     0.0
matmul:k_proj:L17                0.04     0.0
matmul:k_proj:L19                0.04     0.0
scale                            0.04     0.0
matmul:k_proj:L7                 0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:k_proj:L5                 0.04     0.0
matmul:k_proj:L23                0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:k_proj:L12                0.04     0.0
matmul:k_proj:L16                0.04     0.0
matmul:k_proj:L2                 0.04     0.0
matmul:k_proj:L14                0.04     0.0
matmul:k_proj:L1                 0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:v_proj:L18                0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:v_proj:L17                0.04     0.0
matmul:v_proj:L5                 0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:v_proj:L24                0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:v_proj:L16                0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:v_proj:L19                0.04     0.0
matmul:v_proj:L22                0.04     0.0
matmul:k_proj:L8                 0.04     0.0
──────────────────────────────────────────────────
TOTAL                          657.89   100.0

[browser:warning] [30070.6ms][Profile] Batch decode (N=4):
[browser:warning] [30070.8ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      338.32    50.6
fused_ffn                       39.79     5.9
matmul:lm_head                  30.19     4.5
matmul_rmsnorm_fused:L13.ffn_down       12.27     1.8
matmul_rmsnorm_fused:L8.ffn_down       12.25     1.8
matmul_rmsnorm_fused:L24.ffn_down       11.07     1.7
matmul_rmsnorm_fused:L18.ffn_down       10.88     1.6
matmul_rmsnorm_fused:L19.ffn_down       10.82     1.6
matmul_rmsnorm_fused:L2.ffn_down       10.75     1.6
matmul_rmsnorm_fused:L7.ffn_down        9.06     1.4
matmul_rmsnorm_fused:L23.ffn_down        9.06     1.4
matmul_rmsnorm_fused:L0.ffn_down        8.97     1.3
matmul_rmsnorm_fused:L16.ffn_down        8.91     1.3
matmul_rmsnorm_fused:L10.ffn_down        8.83     1.3
matmul_rmsnorm_fused:L5.ffn_down        8.81     1.3
matmul_rmsnorm_fused:L21.ffn_down        8.81     1.3
matmul_rmsnorm_fused:L6.ffn_down        8.78     1.3
matmul_rmsnorm_fused:L17.ffn_down        8.77     1.3
matmul_rmsnorm_fused:L3.ffn_down        8.73     1.3
matmul_rmsnorm_fused:L9.ffn_down        8.71     1.3
matmul_rmsnorm_fused:L1.ffn_down        8.71     1.3
matmul_rmsnorm_fused:L12.ffn_down        8.68     1.3
matmul_rmsnorm_fused:L22.ffn_down        8.67     1.3
matmul_rmsnorm_fused:L14.ffn_down        8.66     1.3
matmul_rmsnorm_fused:L25.ffn_down        8.66     1.3
matmul_rmsnorm_fused:L20.ffn_down        8.65     1.3
matmul_rmsnorm_fused:L11.ffn_down        8.65     1.3
matmul_rmsnorm_fused:L4.ffn_down        8.60     1.3
matmul_rmsnorm_fused:L15.ffn_down        8.60     1.3
rmsnorm                          3.41     0.5
sample_phase2                    3.24     0.5
rope                             0.82     0.1
matmul:o_proj:L19                0.20     0.0
matmul:o_proj:L13                0.18     0.0
matmul:q_proj:L14                0.18     0.0
matmul:o_proj:L8                 0.18     0.0
matmul:q_proj:L3                 0.17     0.0
matmul:o_proj:L2                 0.17     0.0
matmul:q_proj:L25                0.16     0.0
matmul:q_proj:L19                0.16     0.0
matmul:o_proj:L3                 0.15     0.0
matmul:o_proj:L24                0.15     0.0
matmul:q_proj:L8                 0.15     0.0
matmul:o_proj:L1                 0.15     0.0
matmul:o_proj:L18                0.15     0.0
matmul:o_proj:L11                0.15     0.0
matmul:o_proj:L14                0.15     0.0
matmul:q_proj:L17                0.14     0.0
matmul:q_proj:L24                0.14     0.0
matmul:o_proj:L7                 0.14     0.0
matmul:o_proj:L23                0.14     0.0
matmul:o_proj:L22                0.14     0.0
matmul:o_proj:L16                0.14     0.0
matmul:o_proj:L6                 0.13     0.0
matmul:o_proj:L12                0.13     0.0
matmul:o_proj:L0                 0.13     0.0
matmul:q_proj:L7                 0.13     0.0
matmul:o_proj:L17                0.13     0.0
matmul:o_proj:L25                0.13     0.0
matmul:o_proj:L15                0.13     0.0
matmul:q_proj:L18                0.13     0.0
matmul:q_proj:L0                 0.13     0.0
matmul:q_proj:L9                 0.13     0.0
matmul:q_proj:L13                0.13     0.0
matmul:q_proj:L2                 0.13     0.0
matmul:q_proj:L20                0.13     0.0
matmul:q_proj:L6                 0.13     0.0
matmul:q_proj:L22                0.13     0.0
matmul:q_proj:L11                0.12     0.0
matmul:o_proj:L9                 0.12     0.0
matmul:q_proj:L23                0.12     0.0
matmul:q_proj:L5                 0.12     0.0
matmul:o_proj:L4                 0.12     0.0
matmul:o_proj:L20                0.12     0.0
matmul:o_proj:L5                 0.12     0.0
matmul:o_proj:L10                0.12     0.0
matmul:q_proj:L10                0.12     0.0
matmul:q_proj:L1                 0.12     0.0
matmul:q_proj:L21                0.12     0.0
matmul:q_proj:L15                0.12     0.0
matmul:q_proj:L12                0.12     0.0
matmul:q_proj:L4                 0.12     0.0
matmul:o_proj:L21                0.12     0.0
matmul:q_proj:L16                0.11     0.0
matmul:k_proj:L14                0.08     0.0
matmul:v_proj:L14                0.08     0.0
sample_phase3                    0.07     0.0
matmul:k_proj:L3                 0.07     0.0
sample_phase1                    0.06     0.0
matmul:v_proj:L3                 0.06     0.0
matmul:k_proj:L24                0.06     0.0
matmul:k_proj:L25                0.06     0.0
matmul:v_proj:L19                0.06     0.0
matmul:k_proj:L19                0.06     0.0
matmul:v_proj:L24                0.06     0.0
matmul:v_proj:L25                0.06     0.0
matmul:k_proj:L8                 0.06     0.0
matmul:v_proj:L8                 0.06     0.0
matmul:k_proj:L17                0.05     0.0
matmul:k_proj:L15                0.05     0.0
matmul:k_proj:L5                 0.05     0.0
matmul:k_proj:L23                0.05     0.0
matmul:k_proj:L12                0.05     0.0
matmul:k_proj:L18                0.05     0.0
matmul:k_proj:L7                 0.05     0.0
matmul:k_proj:L2                 0.05     0.0
matmul:k_proj:L9                 0.05     0.0
matmul:k_proj:L13                0.05     0.0
matmul:k_proj:L0                 0.05     0.0
matmul:v_proj:L0                 0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:k_proj:L21                0.04     0.0
matmul:k_proj:L22                0.04     0.0
matmul:v_proj:L17                0.04     0.0
matmul:k_proj:L1                 0.04     0.0
matmul:k_proj:L20                0.04     0.0
matmul:k_proj:L10                0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:v_proj:L18                0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:k_proj:L4                 0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:k_proj:L11                0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:v_proj:L5                 0.04     0.0
matmul:v_proj:L22                0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:v_proj:L16                0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:k_proj:L16                0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:v_proj:L20                0.04     0.0
gather                           0.01     0.0
scale                            0.01     0.0
──────────────────────────────────────────────────
TOTAL                          668.95   100.0

[browser:warning] [30793.4ms][Profile] Batch decode (N=4):
[browser:warning] [30793.5ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      343.51    50.8
fused_ffn                       39.84     5.9
matmul:lm_head                  31.04     4.6
matmul_rmsnorm_fused:L5.ffn_down       11.00     1.6
matmul_rmsnorm_fused:L20.ffn_down       10.56     1.6
matmul_rmsnorm_fused:L21.ffn_down       10.35     1.5
matmul_rmsnorm_fused:L15.ffn_down       10.30     1.5
matmul_rmsnorm_fused:L9.ffn_down       10.20     1.5
matmul_rmsnorm_fused:L25.ffn_down       10.19     1.5
matmul_rmsnorm_fused:L16.ffn_down       10.16     1.5
matmul_rmsnorm_fused:L10.ffn_down        9.90     1.5
matmul_rmsnorm_fused:L4.ffn_down        9.51     1.4
matmul_rmsnorm_fused:L14.ffn_down        9.51     1.4
matmul_rmsnorm_fused:L0.ffn_down        9.50     1.4
matmul_rmsnorm_fused:L22.ffn_down        9.30     1.4
matmul_rmsnorm_fused:L11.ffn_down        8.91     1.3
matmul_rmsnorm_fused:L19.ffn_down        8.85     1.3
matmul_rmsnorm_fused:L8.ffn_down        8.84     1.3
matmul_rmsnorm_fused:L13.ffn_down        8.83     1.3
matmul_rmsnorm_fused:L12.ffn_down        8.76     1.3
matmul_rmsnorm_fused:L23.ffn_down        8.74     1.3
matmul_rmsnorm_fused:L7.ffn_down        8.74     1.3
matmul_rmsnorm_fused:L1.ffn_down        8.70     1.3
matmul_rmsnorm_fused:L24.ffn_down        8.69     1.3
matmul_rmsnorm_fused:L3.ffn_down        8.67     1.3
matmul_rmsnorm_fused:L2.ffn_down        8.67     1.3
matmul_rmsnorm_fused:L17.ffn_down        8.66     1.3
matmul_rmsnorm_fused:L6.ffn_down        8.65     1.3
matmul_rmsnorm_fused:L18.ffn_down        8.64     1.3
rmsnorm                          4.04     0.6
sample_phase2                    3.39     0.5
rope                             0.83     0.1
matmul:o_proj:L8                 0.56     0.1
matmul:o_proj:L18                0.43     0.1
matmul:q_proj:L0                 0.22     0.0
matmul:o_proj:L0                 0.17     0.0
matmul:o_proj:L22                0.17     0.0
matmul:o_proj:L16                0.16     0.0
matmul:o_proj:L25                0.16     0.0
matmul:q_proj:L17                0.16     0.0
matmul:q_proj:L11                0.16     0.0
matmul:q_proj:L6                 0.16     0.0
matmul:o_proj:L10                0.16     0.0
matmul:q_proj:L21                0.16     0.0
matmul:o_proj:L20                0.15     0.0
matmul:o_proj:L4                 0.15     0.0
matmul:q_proj:L5                 0.15     0.0
matmul:o_proj:L15                0.15     0.0
matmul:o_proj:L9                 0.15     0.0
matmul:o_proj:L5                 0.15     0.0
matmul:q_proj:L15                0.14     0.0
matmul:q_proj:L16                0.14     0.0
matmul:o_proj:L11                0.14     0.0
matmul:q_proj:L10                0.14     0.0
matmul:o_proj:L14                0.14     0.0
matmul:o_proj:L19                0.14     0.0
matmul:o_proj:L21                0.14     0.0
matmul:o_proj:L3                 0.13     0.0
matmul:o_proj:L13                0.13     0.0
matmul:o_proj:L17                0.13     0.0
matmul:q_proj:L25                0.13     0.0
matmul:o_proj:L12                0.13     0.0
matmul:o_proj:L6                 0.13     0.0
matmul:o_proj:L24                0.13     0.0
matmul:q_proj:L20                0.13     0.0
matmul:q_proj:L14                0.13     0.0
matmul:o_proj:L23                0.13     0.0
matmul:q_proj:L7                 0.12     0.0
matmul:q_proj:L9                 0.12     0.0
matmul:q_proj:L22                0.12     0.0
matmul:q_proj:L13                0.12     0.0
matmul:q_proj:L4                 0.12     0.0
matmul:q_proj:L2                 0.12     0.0
matmul:o_proj:L2                 0.12     0.0
matmul:q_proj:L12                0.12     0.0
matmul:q_proj:L24                0.12     0.0
matmul:o_proj:L7                 0.12     0.0
matmul:q_proj:L3                 0.12     0.0
matmul:q_proj:L23                0.12     0.0
matmul:o_proj:L1                 0.12     0.0
matmul:q_proj:L18                0.12     0.0
matmul:q_proj:L19                0.12     0.0
matmul:q_proj:L8                 0.12     0.0
matmul:q_proj:L1                 0.12     0.0
sample_phase1                    0.10     0.0
matmul:v_proj:L0                 0.09     0.0
matmul:k_proj:L0                 0.08     0.0
sample_phase3                    0.07     0.0
matmul:k_proj:L17                0.07     0.0
matmul:k_proj:L11                0.07     0.0
matmul:k_proj:L21                0.07     0.0
matmul:v_proj:L17                0.07     0.0
matmul:v_proj:L11                0.06     0.0
matmul:k_proj:L6                 0.06     0.0
matmul:v_proj:L6                 0.06     0.0
matmul:k_proj:L5                 0.06     0.0
matmul:v_proj:L5                 0.06     0.0
matmul:v_proj:L16                0.05     0.0
matmul:v_proj:L21                0.05     0.0
matmul:k_proj:L10                0.05     0.0
matmul:k_proj:L16                0.05     0.0
matmul:v_proj:L10                0.05     0.0
matmul:k_proj:L15                0.05     0.0
matmul:v_proj:L15                0.05     0.0
matmul:k_proj:L22                0.05     0.0
matmul:k_proj:L20                0.05     0.0
matmul:k_proj:L9                 0.05     0.0
matmul:k_proj:L19                0.05     0.0
matmul:k_proj:L4                 0.05     0.0
matmul:v_proj:L22                0.04     0.0
matmul:k_proj:L24                0.04     0.0
matmul:k_proj:L23                0.04     0.0
matmul:k_proj:L3                 0.04     0.0
matmul:k_proj:L7                 0.04     0.0
matmul:k_proj:L2                 0.04     0.0
matmul:k_proj:L18                0.04     0.0
matmul:k_proj:L13                0.04     0.0
matmul:k_proj:L14                0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:k_proj:L1                 0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:k_proj:L12                0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:v_proj:L18                0.04     0.0
matmul:v_proj:L24                0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:v_proj:L14                0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:v_proj:L19                0.04     0.0
matmul:v_proj:L1                 0.04     0.0
gather                           0.04     0.0
scale                            0.03     0.0
──────────────────────────────────────────────────
TOTAL                          676.22   100.0

[browser:warning] [31530.2ms][Profile] Batch decode (N=4):
[browser:warning] [31530.5ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      349.18    51.2
fused_ffn                       40.76     6.0
matmul:lm_head                  31.29     4.6
matmul_rmsnorm_fused:L7.ffn_down       11.06     1.6
matmul_rmsnorm_fused:L17.ffn_down       10.63     1.6
matmul_rmsnorm_fused:L16.ffn_down       10.34     1.5
matmul_rmsnorm_fused:L0.ffn_down       10.33     1.5
matmul_rmsnorm_fused:L10.ffn_down       10.32     1.5
matmul_rmsnorm_fused:L15.ffn_down       10.23     1.5
matmul_rmsnorm_fused:L12.ffn_down       10.05     1.5
matmul_rmsnorm_fused:L23.ffn_down        9.78     1.4
matmul_rmsnorm_fused:L22.ffn_down        9.75     1.4
matmul_rmsnorm_fused:L21.ffn_down        9.62     1.4
matmul_rmsnorm_fused:L5.ffn_down        9.23     1.4
matmul_rmsnorm_fused:L11.ffn_down        9.16     1.3
matmul_rmsnorm_fused:L9.ffn_down        9.03     1.3
matmul_rmsnorm_fused:L14.ffn_down        8.83     1.3
matmul_rmsnorm_fused:L2.ffn_down        8.77     1.3
matmul_rmsnorm_fused:L6.ffn_down        8.72     1.3
matmul_rmsnorm_fused:L1.ffn_down        8.72     1.3
matmul_rmsnorm_fused:L25.ffn_down        8.72     1.3
matmul_rmsnorm_fused:L8.ffn_down        8.71     1.3
matmul_rmsnorm_fused:L20.ffn_down        8.70     1.3
matmul_rmsnorm_fused:L13.ffn_down        8.70     1.3
matmul_rmsnorm_fused:L3.ffn_down        8.70     1.3
matmul_rmsnorm_fused:L19.ffn_down        8.67     1.3
matmul_rmsnorm_fused:L4.ffn_down        8.65     1.3
matmul_rmsnorm_fused:L24.ffn_down        8.64     1.3
matmul_rmsnorm_fused:L18.ffn_down        8.63     1.3
rmsnorm                          3.62     0.5
sample_phase2                    3.31     0.5
rope                             0.77     0.1
matmul:o_proj:L25                0.72     0.1
matmul:o_proj:L1                 0.18     0.0
matmul:o_proj:L7                 0.18     0.0
matmul:q_proj:L0                 0.17     0.0
matmul:o_proj:L23                0.17     0.0
matmul:o_proj:L11                0.17     0.0
matmul:o_proj:L0                 0.17     0.0
matmul:o_proj:L5                 0.16     0.0
matmul:o_proj:L8                 0.16     0.0
matmul:q_proj:L8                 0.16     0.0
matmul:q_proj:L2                 0.16     0.0
matmul:q_proj:L22                0.15     0.0
matmul:o_proj:L6                 0.15     0.0
matmul:o_proj:L18                0.15     0.0
matmul:q_proj:L18                0.15     0.0
matmul:o_proj:L3                 0.15     0.0
matmul:o_proj:L13                0.15     0.0
matmul:o_proj:L2                 0.15     0.0
matmul:o_proj:L16                0.15     0.0
matmul:q_proj:L23                0.15     0.0
matmul:o_proj:L12                0.15     0.0
matmul:o_proj:L21                0.15     0.0
matmul:o_proj:L10                0.14     0.0
matmul:o_proj:L22                0.14     0.0
matmul:o_proj:L17                0.14     0.0
matmul:q_proj:L6                 0.14     0.0
matmul:q_proj:L13                0.14     0.0
matmul:o_proj:L24                0.14     0.0
matmul:o_proj:L20                0.14     0.0
matmul:q_proj:L16                0.14     0.0
matmul:o_proj:L19                0.14     0.0
matmul:q_proj:L21                0.14     0.0
matmul:o_proj:L9                 0.14     0.0
matmul:o_proj:L15                0.14     0.0
matmul:q_proj:L4                 0.13     0.0
matmul:o_proj:L4                 0.13     0.0
matmul:q_proj:L1                 0.13     0.0
matmul:o_proj:L14                0.13     0.0
matmul:q_proj:L20                0.13     0.0
matmul:q_proj:L9                 0.13     0.0
matmul:q_proj:L10                0.13     0.0
matmul:q_proj:L12                0.13     0.0
matmul:q_proj:L17                0.13     0.0
matmul:q_proj:L11                0.13     0.0
matmul:q_proj:L7                 0.13     0.0
matmul:q_proj:L5                 0.13     0.0
matmul:q_proj:L15                0.12     0.0
matmul:q_proj:L24                0.12     0.0
matmul:q_proj:L14                0.12     0.0
matmul:q_proj:L3                 0.12     0.0
matmul:q_proj:L25                0.12     0.0
matmul:q_proj:L19                0.12     0.0
sample_phase1                    0.09     0.0
sample_phase3                    0.07     0.0
matmul:k_proj:L2                 0.06     0.0
matmul:v_proj:L2                 0.06     0.0
matmul:k_proj:L22                0.06     0.0
matmul:v_proj:L22                0.06     0.0
matmul:k_proj:L0                 0.06     0.0
matmul:v_proj:L0                 0.06     0.0
matmul:k_proj:L6                 0.06     0.0
matmul:k_proj:L23                0.06     0.0
matmul:v_proj:L23                0.05     0.0
matmul:k_proj:L13                0.05     0.0
matmul:k_proj:L8                 0.05     0.0
matmul:v_proj:L6                 0.05     0.0
matmul:v_proj:L16                0.05     0.0
matmul:k_proj:L16                0.05     0.0
matmul:v_proj:L8                 0.05     0.0
matmul:v_proj:L13                0.05     0.0
matmul:k_proj:L18                0.05     0.0
matmul:k_proj:L3                 0.05     0.0
matmul:k_proj:L21                0.05     0.0
matmul:v_proj:L18                0.05     0.0
matmul:k_proj:L20                0.05     0.0
matmul:k_proj:L4                 0.05     0.0
matmul:k_proj:L10                0.05     0.0
matmul:v_proj:L21                0.05     0.0
matmul:k_proj:L7                 0.05     0.0
matmul:k_proj:L1                 0.05     0.0
matmul:k_proj:L17                0.05     0.0
matmul:k_proj:L24                0.05     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:k_proj:L5                 0.04     0.0
matmul:k_proj:L15                0.04     0.0
matmul:k_proj:L12                0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:k_proj:L11                0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:k_proj:L19                0.04     0.0
matmul:v_proj:L17                0.04     0.0
matmul:v_proj:L5                 0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:v_proj:L14                0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:k_proj:L14                0.04     0.0
matmul:v_proj:L24                0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:v_proj:L19                0.04     0.0
gather                           0.03     0.0
scale                            0.02     0.0
──────────────────────────────────────────────────
TOTAL                          682.33   100.0

[browser:warning] [32289.7ms][Profile] Batch decode (N=4):
[browser:warning] [32289.8ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      356.97    51.8
fused_ffn                       40.13     5.8
matmul:lm_head                  30.52     4.4
matmul_rmsnorm_fused:L10.ffn_down       10.49     1.5
matmul_rmsnorm_fused:L12.ffn_down       10.39     1.5
matmul_rmsnorm_fused:L11.ffn_down       10.38     1.5
matmul_rmsnorm_fused:L13.ffn_down       10.09     1.5
matmul_rmsnorm_fused:L17.ffn_down       10.02     1.5
matmul_rmsnorm_fused:L6.ffn_down        9.89     1.4
matmul_rmsnorm_fused:L8.ffn_down        9.82     1.4
matmul_rmsnorm_fused:L5.ffn_down        9.81     1.4
matmul_rmsnorm_fused:L18.ffn_down        9.79     1.4
matmul_rmsnorm_fused:L16.ffn_down        9.77     1.4
matmul_rmsnorm_fused:L15.ffn_down        9.61     1.4
matmul_rmsnorm_fused:L3.ffn_down        9.61     1.4
matmul_rmsnorm_fused:L20.ffn_down        9.55     1.4
matmul_rmsnorm_fused:L7.ffn_down        9.46     1.4
matmul_rmsnorm_fused:L0.ffn_down        9.03     1.3
matmul_rmsnorm_fused:L23.ffn_down        9.03     1.3
matmul_rmsnorm_fused:L21.ffn_down        8.85     1.3
matmul_rmsnorm_fused:L19.ffn_down        8.83     1.3
matmul_rmsnorm_fused:L22.ffn_down        8.72     1.3
matmul_rmsnorm_fused:L9.ffn_down        8.70     1.3
matmul_rmsnorm_fused:L25.ffn_down        8.70     1.3
matmul_rmsnorm_fused:L14.ffn_down        8.68     1.3
matmul_rmsnorm_fused:L2.ffn_down        8.68     1.3
matmul_rmsnorm_fused:L1.ffn_down        8.67     1.3
matmul_rmsnorm_fused:L24.ffn_down        8.66     1.3
matmul_rmsnorm_fused:L4.ffn_down        8.62     1.3
sample_phase2                    3.35     0.5
rmsnorm                          3.04     0.4
rope                             0.76     0.1
sample_phase1                    0.64     0.1
matmul:o_proj:L15                0.45     0.1
matmul:o_proj:L5                 0.17     0.0
matmul:o_proj:L16                0.17     0.0
matmul:o_proj:L6                 0.17     0.0
matmul:q_proj:L0                 0.16     0.0
matmul:o_proj:L7                 0.16     0.0
matmul:o_proj:L3                 0.15     0.0
matmul:q_proj:L16                0.15     0.0
matmul:q_proj:L17                0.15     0.0
matmul:q_proj:L21                0.15     0.0
matmul:o_proj:L1                 0.15     0.0
matmul:o_proj:L12                0.15     0.0
matmul:q_proj:L24                0.15     0.0
matmul:o_proj:L22                0.15     0.0
matmul:o_proj:L8                 0.15     0.0
matmul:o_proj:L0                 0.14     0.0
matmul:o_proj:L11                0.14     0.0
matmul:o_proj:L2                 0.14     0.0
matmul:q_proj:L18                0.14     0.0
matmul:q_proj:L11                0.14     0.0
matmul:o_proj:L17                0.14     0.0
matmul:o_proj:L23                0.14     0.0
matmul:q_proj:L19                0.13     0.0
matmul:o_proj:L18                0.13     0.0
matmul:q_proj:L1                 0.13     0.0
matmul:q_proj:L23                0.13     0.0
matmul:q_proj:L14                0.13     0.0
matmul:o_proj:L10                0.13     0.0
matmul:o_proj:L13                0.13     0.0
matmul:o_proj:L19                0.13     0.0
matmul:o_proj:L9                 0.13     0.0
matmul:o_proj:L21                0.13     0.0
matmul:o_proj:L14                0.13     0.0
matmul:o_proj:L4                 0.13     0.0
matmul:q_proj:L13                0.13     0.0
matmul:q_proj:L12                0.13     0.0
matmul:o_proj:L25                0.13     0.0
matmul:o_proj:L20                0.12     0.0
matmul:q_proj:L22                0.12     0.0
matmul:q_proj:L20                0.12     0.0
matmul:q_proj:L7                 0.12     0.0
matmul:q_proj:L2                 0.12     0.0
matmul:q_proj:L10                0.12     0.0
matmul:q_proj:L5                 0.12     0.0
matmul:q_proj:L8                 0.12     0.0
matmul:q_proj:L3                 0.12     0.0
matmul:o_proj:L24                0.12     0.0
matmul:q_proj:L9                 0.12     0.0
matmul:q_proj:L6                 0.12     0.0
matmul:q_proj:L4                 0.12     0.0
matmul:q_proj:L15                0.12     0.0
matmul:q_proj:L25                0.12     0.0
matmul:k_proj:L21                0.06     0.0
matmul:k_proj:L16                0.06     0.0
sample_phase3                    0.06     0.0
matmul:v_proj:L21                0.06     0.0
matmul:v_proj:L16                0.06     0.0
matmul:v_proj:L17                0.06     0.0
matmul:k_proj:L19                0.05     0.0
matmul:k_proj:L17                0.05     0.0
matmul:k_proj:L24                0.05     0.0
matmul:k_proj:L18                0.05     0.0
matmul:k_proj:L0                 0.05     0.0
matmul:v_proj:L24                0.05     0.0
matmul:v_proj:L0                 0.05     0.0
matmul:k_proj:L11                0.05     0.0
matmul:v_proj:L18                0.05     0.0
matmul:k_proj:L14                0.05     0.0
matmul:v_proj:L11                0.05     0.0
matmul:k_proj:L23                0.05     0.0
matmul:v_proj:L19                0.05     0.0
matmul:k_proj:L13                0.05     0.0
matmul:v_proj:L14                0.05     0.0
matmul:v_proj:L12                0.05     0.0
matmul:k_proj:L1                 0.05     0.0
matmul:k_proj:L6                 0.05     0.0
matmul:k_proj:L12                0.04     0.0
matmul:k_proj:L2                 0.04     0.0
matmul:k_proj:L10                0.04     0.0
matmul:k_proj:L20                0.04     0.0
matmul:k_proj:L22                0.04     0.0
matmul:k_proj:L3                 0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:k_proj:L15                0.04     0.0
matmul:k_proj:L7                 0.04     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:k_proj:L5                 0.04     0.0
matmul:k_proj:L4                 0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:v_proj:L22                0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:v_proj:L5                 0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:v_proj:L4                 0.04     0.0
gather                           0.01     0.0
scale                            0.01     0.0
──────────────────────────────────────────────────
TOTAL                          689.21   100.0

[browser:warning] [33040.3ms][Profile] Batch decode (N=4):
[browser:warning] [33040.4ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      366.61    52.1
fused_ffn                       39.92     5.7
matmul:lm_head                  30.99     4.4
matmul_rmsnorm_fused:L21.ffn_down       10.47     1.5
matmul_rmsnorm_fused:L2.ffn_down       10.42     1.5
matmul_rmsnorm_fused:L18.ffn_down       10.41     1.5
matmul_rmsnorm_fused:L7.ffn_down       10.40     1.5
matmul_rmsnorm_fused:L16.ffn_down       10.38     1.5
matmul_rmsnorm_fused:L23.ffn_down       10.37     1.5
matmul_rmsnorm_fused:L4.ffn_down       10.36     1.5
matmul_rmsnorm_fused:L13.ffn_down       10.32     1.5
matmul_rmsnorm_fused:L11.ffn_down       10.28     1.5
matmul_rmsnorm_fused:L17.ffn_down       10.05     1.4
matmul_rmsnorm_fused:L8.ffn_down       10.03     1.4
matmul_rmsnorm_fused:L9.ffn_down        9.97     1.4
matmul_rmsnorm_fused:L12.ffn_down        9.92     1.4
matmul_rmsnorm_fused:L25.ffn_down        9.34     1.3
matmul_rmsnorm_fused:L6.ffn_down        9.32     1.3
matmul_rmsnorm_fused:L15.ffn_down        9.20     1.3
matmul_rmsnorm_fused:L3.ffn_down        8.93     1.3
matmul_rmsnorm_fused:L20.ffn_down        8.92     1.3
matmul_rmsnorm_fused:L14.ffn_down        8.82     1.3
matmul_rmsnorm_fused:L1.ffn_down        8.80     1.3
matmul_rmsnorm_fused:L0.ffn_down        8.71     1.2
matmul_rmsnorm_fused:L22.ffn_down        8.71     1.2
matmul_rmsnorm_fused:L10.ffn_down        8.69     1.2
matmul_rmsnorm_fused:L5.ffn_down        8.69     1.2
matmul_rmsnorm_fused:L24.ffn_down        8.67     1.2
matmul_rmsnorm_fused:L19.ffn_down        8.65     1.2
rmsnorm                          3.49     0.5
sample_phase2                    3.27     0.5
rope                             0.74     0.1
matmul:o_proj:L10                0.35     0.1
matmul:o_proj:L11                0.18     0.0
matmul:q_proj:L0                 0.17     0.0
matmul:o_proj:L8                 0.17     0.0
matmul:o_proj:L6                 0.17     0.0
matmul:o_proj:L25                0.16     0.0
matmul:o_proj:L18                0.16     0.0
matmul:q_proj:L18                0.15     0.0
matmul:o_proj:L7                 0.15     0.0
matmul:o_proj:L1                 0.15     0.0
matmul:q_proj:L22                0.15     0.0
matmul:o_proj:L20                0.14     0.0
matmul:o_proj:L23                0.14     0.0
matmul:o_proj:L13                0.14     0.0
matmul:o_proj:L12                0.14     0.0
matmul:o_proj:L0                 0.14     0.0
matmul:o_proj:L3                 0.14     0.0
matmul:o_proj:L2                 0.14     0.0
matmul:o_proj:L22                0.14     0.0
matmul:q_proj:L13                0.14     0.0
matmul:o_proj:L15                0.14     0.0
matmul:o_proj:L9                 0.14     0.0
matmul:q_proj:L5                 0.13     0.0
matmul:q_proj:L15                0.13     0.0
matmul:o_proj:L17                0.13     0.0
matmul:q_proj:L10                0.13     0.0
matmul:o_proj:L21                0.13     0.0
matmul:o_proj:L16                0.13     0.0
matmul:q_proj:L8                 0.13     0.0
matmul:o_proj:L19                0.13     0.0
matmul:o_proj:L5                 0.13     0.0
matmul:q_proj:L14                0.13     0.0
matmul:q_proj:L9                 0.13     0.0
matmul:o_proj:L14                0.13     0.0
matmul:o_proj:L24                0.13     0.0
matmul:q_proj:L17                0.13     0.0
matmul:q_proj:L1                 0.13     0.0
matmul:q_proj:L3                 0.12     0.0
matmul:q_proj:L23                0.12     0.0
matmul:q_proj:L19                0.12     0.0
matmul:q_proj:L2                 0.12     0.0
matmul:o_proj:L4                 0.12     0.0
matmul:q_proj:L25                0.12     0.0
matmul:q_proj:L24                0.12     0.0
matmul:q_proj:L21                0.12     0.0
matmul:q_proj:L16                0.12     0.0
matmul:q_proj:L11                0.12     0.0
matmul:q_proj:L12                0.12     0.0
matmul:q_proj:L4                 0.12     0.0
matmul:q_proj:L20                0.12     0.0
matmul:q_proj:L6                 0.12     0.0
matmul:q_proj:L7                 0.12     0.0
sample_phase1                    0.08     0.0
matmul:v_proj:L0                 0.07     0.0
matmul:k_proj:L0                 0.07     0.0
matmul:v_proj:L1                 0.06     0.0
matmul:k_proj:L18                0.06     0.0
matmul:k_proj:L1                 0.06     0.0
sample_phase3                    0.06     0.0
matmul:k_proj:L15                0.06     0.0
matmul:v_proj:L18                0.06     0.0
matmul:v_proj:L15                0.06     0.0
matmul:v_proj:L13                0.05     0.0
matmul:k_proj:L10                0.05     0.0
matmul:v_proj:L10                0.05     0.0
matmul:k_proj:L19                0.05     0.0
matmul:k_proj:L5                 0.05     0.0
matmul:k_proj:L13                0.05     0.0
matmul:k_proj:L22                0.05     0.0
matmul:v_proj:L22                0.05     0.0
matmul:k_proj:L16                0.05     0.0
matmul:k_proj:L9                 0.05     0.0
matmul:k_proj:L7                 0.05     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:k_proj:L4                 0.04     0.0
matmul:k_proj:L2                 0.04     0.0
matmul:k_proj:L17                0.04     0.0
matmul:k_proj:L11                0.04     0.0
matmul:k_proj:L20                0.04     0.0
matmul:k_proj:L23                0.04     0.0
matmul:v_proj:L19                0.04     0.0
matmul:k_proj:L21                0.04     0.0
matmul:v_proj:L5                 0.04     0.0
matmul:k_proj:L14                0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:k_proj:L3                 0.04     0.0
matmul:v_proj:L16                0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:k_proj:L24                0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:v_proj:L17                0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:k_proj:L12                0.04     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:v_proj:L14                0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:v_proj:L24                0.04     0.0
matmul:v_proj:L25                0.04     0.0
gather                           0.03     0.0
scale                            0.02     0.0
──────────────────────────────────────────────────
TOTAL                          703.78   100.0

[browser:warning] [33801.0ms][Profile] Batch decode (N=4):
[browser:warning] [33801.1ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      373.43    52.4
fused_ffn                       39.96     5.6
matmul:lm_head                  30.74     4.3
matmul_rmsnorm_fused:L18.ffn_down       10.92     1.5
matmul_rmsnorm_fused:L13.ffn_down       10.60     1.5
matmul_rmsnorm_fused:L25.ffn_down       10.56     1.5
matmul_rmsnorm_fused:L19.ffn_down       10.50     1.5
matmul_rmsnorm_fused:L24.ffn_down       10.41     1.5
matmul_rmsnorm_fused:L21.ffn_down       10.40     1.5
matmul_rmsnorm_fused:L20.ffn_down       10.32     1.4
matmul_rmsnorm_fused:L9.ffn_down       10.17     1.4
matmul_rmsnorm_fused:L14.ffn_down       10.15     1.4
matmul_rmsnorm_fused:L16.ffn_down        9.90     1.4
matmul_rmsnorm_fused:L15.ffn_down        9.85     1.4
matmul_rmsnorm_fused:L8.ffn_down        9.82     1.4
matmul_rmsnorm_fused:L4.ffn_down        9.78     1.4
matmul_rmsnorm_fused:L3.ffn_down        9.61     1.3
matmul_rmsnorm_fused:L6.ffn_down        9.41     1.3
matmul_rmsnorm_fused:L23.ffn_down        9.30     1.3
matmul_rmsnorm_fused:L11.ffn_down        9.16     1.3
matmul_rmsnorm_fused:L10.ffn_down        9.05     1.3
matmul_rmsnorm_fused:L1.ffn_down        9.05     1.3
matmul_rmsnorm_fused:L0.ffn_down        8.83     1.2
matmul_rmsnorm_fused:L2.ffn_down        8.79     1.2
matmul_rmsnorm_fused:L7.ffn_down        8.75     1.2
matmul_rmsnorm_fused:L5.ffn_down        8.73     1.2
matmul_rmsnorm_fused:L22.ffn_down        8.66     1.2
matmul_rmsnorm_fused:L17.ffn_down        8.66     1.2
matmul_rmsnorm_fused:L12.ffn_down        8.64     1.2
rmsnorm                          4.37     0.6
sample_phase2                    3.29     0.5
rope                             0.71     0.1
sample_phase3                    0.47     0.1
matmul:q_proj:L0                 0.18     0.0
matmul:o_proj:L14                0.17     0.0
matmul:o_proj:L3                 0.17     0.0
matmul:o_proj:L23                0.17     0.0
matmul:o_proj:L8                 0.17     0.0
matmul:o_proj:L11                0.16     0.0
matmul:o_proj:L6                 0.16     0.0
matmul:o_proj:L9                 0.16     0.0
matmul:o_proj:L4                 0.16     0.0
matmul:o_proj:L15                0.16     0.0
matmul:o_proj:L16                0.16     0.0
matmul:o_proj:L24                0.15     0.0
matmul:o_proj:L19                0.15     0.0
matmul:o_proj:L5                 0.15     0.0
matmul:o_proj:L0                 0.14     0.0
matmul:o_proj:L10                0.14     0.0
matmul:o_proj:L18                0.14     0.0
matmul:q_proj:L4                 0.14     0.0
matmul:o_proj:L25                0.14     0.0
matmul:o_proj:L20                0.14     0.0
matmul:o_proj:L13                0.14     0.0
matmul:o_proj:L1                 0.14     0.0
matmul:o_proj:L21                0.14     0.0
matmul:o_proj:L7                 0.13     0.0
matmul:q_proj:L19                0.13     0.0
matmul:q_proj:L24                0.13     0.0
matmul:o_proj:L2                 0.13     0.0
matmul:o_proj:L17                0.13     0.0
matmul:o_proj:L12                0.13     0.0
matmul:q_proj:L9                 0.13     0.0
matmul:q_proj:L14                0.13     0.0
matmul:q_proj:L1                 0.13     0.0
matmul:o_proj:L22                0.13     0.0
matmul:q_proj:L25                0.13     0.0
matmul:q_proj:L18                0.13     0.0
matmul:q_proj:L20                0.12     0.0
matmul:q_proj:L21                0.12     0.0
matmul:q_proj:L10                0.12     0.0
matmul:q_proj:L22                0.12     0.0
matmul:q_proj:L2                 0.12     0.0
matmul:q_proj:L16                0.12     0.0
matmul:q_proj:L23                0.12     0.0
matmul:q_proj:L8                 0.12     0.0
matmul:q_proj:L15                0.12     0.0
matmul:q_proj:L13                0.12     0.0
matmul:q_proj:L3                 0.12     0.0
matmul:q_proj:L5                 0.12     0.0
matmul:q_proj:L11                0.12     0.0
matmul:q_proj:L6                 0.12     0.0
matmul:q_proj:L7                 0.12     0.0
matmul:q_proj:L17                0.12     0.0
matmul:q_proj:L12                0.12     0.0
sample_phase1                    0.08     0.0
matmul:k_proj:L0                 0.07     0.0
matmul:v_proj:L0                 0.07     0.0
matmul:k_proj:L10                0.05     0.0
matmul:k_proj:L4                 0.05     0.0
matmul:k_proj:L21                0.05     0.0
matmul:k_proj:L5                 0.05     0.0
matmul:k_proj:L19                0.05     0.0
matmul:k_proj:L15                0.05     0.0
matmul:k_proj:L22                0.04     0.0
matmul:k_proj:L18                0.04     0.0
matmul:k_proj:L1                 0.04     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:v_proj:L19                0.04     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:k_proj:L23                0.04     0.0
matmul:v_proj:L14                0.04     0.0
matmul:k_proj:L14                0.04     0.0
matmul:k_proj:L20                0.04     0.0
matmul:k_proj:L7                 0.04     0.0
matmul:v_proj:L16                0.04     0.0
matmul:k_proj:L2                 0.04     0.0
matmul:k_proj:L16                0.04     0.0
matmul:k_proj:L24                0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:k_proj:L3                 0.04     0.0
matmul:k_proj:L13                0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:v_proj:L22                0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:k_proj:L17                0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:k_proj:L12                0.04     0.0
matmul:v_proj:L24                0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:v_proj:L5                 0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:v_proj:L18                0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:v_proj:L17                0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:k_proj:L11                0.04     0.0
gather                           0.04     0.0
scale                            0.03     0.0
──────────────────────────────────────────────────
TOTAL                          712.59   100.0

[browser:warning] [34561.9ms][Profile] Batch decode (N=4):
[browser:warning] [34562.0ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      380.96    53.3
fused_ffn                       40.23     5.6
matmul:lm_head                  30.21     4.2
matmul_rmsnorm_fused:L21.ffn_down       10.44     1.5
matmul_rmsnorm_fused:L22.ffn_down       10.38     1.5
matmul_rmsnorm_fused:L9.ffn_down       10.13     1.4
matmul_rmsnorm_fused:L25.ffn_down       10.12     1.4
matmul_rmsnorm_fused:L24.ffn_down       10.11     1.4
matmul_rmsnorm_fused:L10.ffn_down       10.07     1.4
matmul_rmsnorm_fused:L19.ffn_down       10.00     1.4
matmul_rmsnorm_fused:L17.ffn_down        9.78     1.4
matmul_rmsnorm_fused:L4.ffn_down        9.65     1.4
matmul_rmsnorm_fused:L16.ffn_down        9.61     1.3
matmul_rmsnorm_fused:L14.ffn_down        9.50     1.3
matmul_rmsnorm_fused:L12.ffn_down        9.47     1.3
matmul_rmsnorm_fused:L7.ffn_down        9.43     1.3
matmul_rmsnorm_fused:L18.ffn_down        9.41     1.3
matmul_rmsnorm_fused:L11.ffn_down        9.35     1.3
matmul_rmsnorm_fused:L0.ffn_down        9.09     1.3
matmul_rmsnorm_fused:L20.ffn_down        8.99     1.3
matmul_rmsnorm_fused:L2.ffn_down        8.94     1.3
matmul_rmsnorm_fused:L3.ffn_down        8.86     1.2
matmul_rmsnorm_fused:L15.ffn_down        8.78     1.2
matmul_rmsnorm_fused:L6.ffn_down        8.74     1.2
matmul_rmsnorm_fused:L5.ffn_down        8.69     1.2
matmul_rmsnorm_fused:L8.ffn_down        8.69     1.2
matmul_rmsnorm_fused:L23.ffn_down        8.67     1.2
matmul_rmsnorm_fused:L13.ffn_down        8.67     1.2
matmul_rmsnorm_fused:L1.ffn_down        8.66     1.2
rmsnorm                          4.06     0.6
sample_phase2                    3.28     0.5
rope                             0.72     0.1
matmul:v_proj:L13                0.63     0.1
matmul:q_proj:L0                 0.21     0.0
matmul:o_proj:L12                0.18     0.0
matmul:o_proj:L11                0.17     0.0
matmul:o_proj:L4                 0.17     0.0
matmul:o_proj:L14                0.17     0.0
matmul:o_proj:L9                 0.17     0.0
matmul:o_proj:L16                0.17     0.0
matmul:o_proj:L7                 0.16     0.0
matmul:o_proj:L24                0.16     0.0
matmul:q_proj:L5                 0.16     0.0
matmul:o_proj:L25                0.16     0.0
matmul:o_proj:L17                0.16     0.0
matmul:o_proj:L19                0.16     0.0
matmul:o_proj:L0                 0.16     0.0
matmul:o_proj:L10                0.16     0.0
matmul:o_proj:L22                0.15     0.0
matmul:o_proj:L2                 0.15     0.0
matmul:o_proj:L6                 0.15     0.0
matmul:o_proj:L15                0.14     0.0
matmul:o_proj:L20                0.14     0.0
matmul:o_proj:L21                0.14     0.0
matmul:o_proj:L5                 0.14     0.0
matmul:o_proj:L23                0.13     0.0
matmul:o_proj:L8                 0.13     0.0
matmul:o_proj:L13                0.13     0.0
matmul:o_proj:L1                 0.13     0.0
matmul:o_proj:L3                 0.13     0.0
matmul:q_proj:L1                 0.13     0.0
matmul:q_proj:L23                0.13     0.0
matmul:o_proj:L18                0.13     0.0
matmul:q_proj:L22                0.13     0.0
matmul:q_proj:L10                0.13     0.0
matmul:q_proj:L4                 0.13     0.0
matmul:q_proj:L6                 0.12     0.0
matmul:q_proj:L16                0.12     0.0
matmul:q_proj:L21                0.12     0.0
matmul:q_proj:L12                0.12     0.0
matmul:q_proj:L14                0.12     0.0
matmul:q_proj:L13                0.12     0.0
matmul:q_proj:L9                 0.12     0.0
matmul:q_proj:L3                 0.12     0.0
matmul:q_proj:L25                0.12     0.0
matmul:q_proj:L24                0.12     0.0
matmul:q_proj:L18                0.12     0.0
matmul:q_proj:L19                0.12     0.0
matmul:q_proj:L11                0.12     0.0
matmul:q_proj:L8                 0.12     0.0
matmul:q_proj:L2                 0.12     0.0
matmul:q_proj:L7                 0.12     0.0
matmul:q_proj:L20                0.12     0.0
matmul:q_proj:L17                0.12     0.0
matmul:q_proj:L15                0.12     0.0
sample_phase3                    0.09     0.0
matmul:k_proj:L0                 0.09     0.0
matmul:v_proj:L0                 0.08     0.0
sample_phase1                    0.08     0.0
matmul:v_proj:L5                 0.06     0.0
matmul:k_proj:L5                 0.06     0.0
gather                           0.05     0.0
matmul:k_proj:L12                0.05     0.0
matmul:v_proj:L22                0.05     0.0
matmul:k_proj:L6                 0.05     0.0
matmul:k_proj:L1                 0.05     0.0
matmul:k_proj:L23                0.05     0.0
matmul:k_proj:L4                 0.05     0.0
matmul:k_proj:L7                 0.05     0.0
matmul:k_proj:L22                0.05     0.0
matmul:k_proj:L18                0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:k_proj:L19                0.04     0.0
matmul:k_proj:L15                0.04     0.0
matmul:k_proj:L14                0.04     0.0
matmul:k_proj:L10                0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:k_proj:L17                0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:k_proj:L2                 0.04     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:k_proj:L11                0.04     0.0
matmul:k_proj:L24                0.04     0.0
matmul:v_proj:L18                0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:k_proj:L13                0.04     0.0
matmul:v_proj:L19                0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:k_proj:L20                0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:k_proj:L3                 0.04     0.0
matmul:v_proj:L14                0.04     0.0
matmul:k_proj:L16                0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:v_proj:L24                0.04     0.0
matmul:v_proj:L16                0.04     0.0
matmul:k_proj:L21                0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:v_proj:L17                0.04     0.0
scale                            0.04     0.0
──────────────────────────────────────────────────
TOTAL                          714.17   100.0

[browser:warning] [35343.7ms][Profile] Batch decode (N=4):
[browser:warning] [35343.9ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      389.17    53.0
fused_ffn                       44.66     6.1
matmul:lm_head                  35.05     4.8
matmul_rmsnorm_fused:L15.ffn_down       10.35     1.4
matmul_rmsnorm_fused:L24.ffn_down       10.23     1.4
matmul_rmsnorm_fused:L22.ffn_down       10.14     1.4
matmul_rmsnorm_fused:L10.ffn_down       10.12     1.4
matmul_rmsnorm_fused:L25.ffn_down        9.57     1.3
matmul_rmsnorm_fused:L20.ffn_down        9.55     1.3
matmul_rmsnorm_fused:L14.ffn_down        9.54     1.3
matmul_rmsnorm_fused:L18.ffn_down        9.44     1.3
matmul_rmsnorm_fused:L17.ffn_down        9.27     1.3
matmul_rmsnorm_fused:L8.ffn_down        9.15     1.2
matmul_rmsnorm_fused:L0.ffn_down        9.05     1.2
matmul_rmsnorm_fused:L1.ffn_down        9.02     1.2
matmul_rmsnorm_fused:L6.ffn_down        9.01     1.2
matmul_rmsnorm_fused:L23.ffn_down        9.01     1.2
matmul_rmsnorm_fused:L5.ffn_down        9.00     1.2
matmul_rmsnorm_fused:L11.ffn_down        8.98     1.2
matmul_rmsnorm_fused:L3.ffn_down        8.98     1.2
matmul_rmsnorm_fused:L21.ffn_down        8.83     1.2
matmul_rmsnorm_fused:L16.ffn_down        8.81     1.2
matmul_rmsnorm_fused:L4.ffn_down        8.79     1.2
matmul_rmsnorm_fused:L9.ffn_down        8.77     1.2
matmul_rmsnorm_fused:L2.ffn_down        8.68     1.2
matmul_rmsnorm_fused:L19.ffn_down        8.68     1.2
matmul_rmsnorm_fused:L7.ffn_down        8.65     1.2
matmul_rmsnorm_fused:L13.ffn_down        8.65     1.2
matmul_rmsnorm_fused:L12.ffn_down        8.64     1.2
rmsnorm                          5.50     0.7
sample_phase2                    3.24     0.4
matmul:o_proj:L20                2.19     0.3
matmul:o_proj:L22                1.96     0.3
matmul:o_proj:L18                1.40     0.2
matmul:o_proj:L24                1.01     0.1
matmul:q_proj:L16                0.89     0.1
matmul:o_proj:L14                0.75     0.1
rope                             0.67     0.1
matmul:o_proj:L15                0.18     0.0
matmul:o_proj:L8                 0.17     0.0
matmul:o_proj:L25                0.16     0.0
matmul:o_proj:L10                0.16     0.0
matmul:q_proj:L18                0.16     0.0
matmul:o_proj:L6                 0.16     0.0
matmul:o_proj:L17                0.16     0.0
matmul:q_proj:L17                0.16     0.0
matmul:o_proj:L13                0.15     0.0
matmul:o_proj:L0                 0.15     0.0
matmul:o_proj:L23                0.15     0.0
matmul:o_proj:L12                0.15     0.0
matmul:q_proj:L9                 0.15     0.0
matmul:o_proj:L11                0.15     0.0
matmul:o_proj:L3                 0.14     0.0
matmul:q_proj:L5                 0.14     0.0
matmul:q_proj:L11                0.14     0.0
matmul:o_proj:L1                 0.14     0.0
matmul:q_proj:L2                 0.14     0.0
matmul:o_proj:L5                 0.14     0.0
matmul:o_proj:L21                0.14     0.0
matmul:o_proj:L9                 0.14     0.0
matmul:q_proj:L15                0.14     0.0
matmul:q_proj:L0                 0.14     0.0
matmul:o_proj:L16                0.14     0.0
matmul:q_proj:L23                0.13     0.0
matmul:q_proj:L25                0.13     0.0
matmul:q_proj:L19                0.13     0.0
matmul:o_proj:L19                0.13     0.0
matmul:o_proj:L4                 0.13     0.0
matmul:o_proj:L2                 0.13     0.0
matmul:o_proj:L7                 0.13     0.0
matmul:q_proj:L22                0.13     0.0
matmul:q_proj:L6                 0.13     0.0
matmul:q_proj:L24                0.13     0.0
matmul:q_proj:L10                0.13     0.0
matmul:q_proj:L13                0.12     0.0
matmul:q_proj:L21                0.12     0.0
matmul:q_proj:L12                0.12     0.0
matmul:q_proj:L20                0.12     0.0
matmul:q_proj:L8                 0.12     0.0
matmul:q_proj:L1                 0.12     0.0
matmul:q_proj:L3                 0.12     0.0
matmul:q_proj:L7                 0.12     0.0
matmul:q_proj:L4                 0.12     0.0
matmul:q_proj:L14                0.12     0.0
matmul:k_proj:L16                0.07     0.0
matmul:v_proj:L16                0.07     0.0
matmul:v_proj:L2                 0.07     0.0
sample_phase1                    0.06     0.0
matmul:k_proj:L18                0.06     0.0
matmul:k_proj:L2                 0.06     0.0
matmul:v_proj:L15                0.05     0.0
matmul:v_proj:L18                0.05     0.0
sample_phase3                    0.05     0.0
matmul:k_proj:L15                0.05     0.0
matmul:k_proj:L11                0.05     0.0
matmul:k_proj:L5                 0.05     0.0
matmul:k_proj:L19                0.05     0.0
matmul:k_proj:L6                 0.05     0.0
matmul:k_proj:L22                0.05     0.0
matmul:k_proj:L23                0.05     0.0
matmul:v_proj:L11                0.05     0.0
matmul:k_proj:L17                0.05     0.0
matmul:v_proj:L17                0.05     0.0
matmul:v_proj:L0                 0.05     0.0
matmul:v_proj:L5                 0.05     0.0
matmul:k_proj:L24                0.05     0.0
matmul:k_proj:L0                 0.04     0.0
matmul:k_proj:L7                 0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:v_proj:L19                0.04     0.0
matmul:k_proj:L1                 0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:k_proj:L10                0.04     0.0
matmul:k_proj:L20                0.04     0.0
matmul:v_proj:L24                0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:k_proj:L12                0.04     0.0
matmul:k_proj:L4                 0.04     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:k_proj:L13                0.04     0.0
matmul:k_proj:L3                 0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:k_proj:L21                0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:v_proj:L22                0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:k_proj:L14                0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:v_proj:L14                0.04     0.0
gather                           0.01     0.0
scale                            0.01     0.0
──────────────────────────────────────────────────
TOTAL                          734.39   100.0

[browser:warning] [36301.7ms][Profile] Batch decode (N=4):
[browser:warning] [36302.0ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      396.77    45.1
fused_ffn                       99.30    11.3
matmul:lm_head                  39.11     4.4
rmsnorm                         19.04     2.2
matmul_rmsnorm_fused:L4.ffn_down       12.85     1.5
matmul_rmsnorm_fused:L0.ffn_down       12.17     1.4
matmul_rmsnorm_fused:L8.ffn_down       11.77     1.3
matmul_rmsnorm_fused:L15.ffn_down       11.26     1.3
matmul_rmsnorm_fused:L12.ffn_down       11.22     1.3
matmul_rmsnorm_fused:L13.ffn_down       11.14     1.3
matmul_rmsnorm_fused:L9.ffn_down       10.83     1.2
matmul_rmsnorm_fused:L18.ffn_down       10.76     1.2
matmul_rmsnorm_fused:L25.ffn_down       10.72     1.2
matmul_rmsnorm_fused:L17.ffn_down       10.66     1.2
matmul_rmsnorm_fused:L23.ffn_down       10.60     1.2
matmul_rmsnorm_fused:L16.ffn_down       10.30     1.2
matmul_rmsnorm_fused:L21.ffn_down       10.22     1.2
matmul_rmsnorm_fused:L14.ffn_down       10.18     1.2
matmul_rmsnorm_fused:L5.ffn_down       10.10     1.1
matmul_rmsnorm_fused:L19.ffn_down       10.10     1.1
matmul_rmsnorm_fused:L11.ffn_down        9.82     1.1
matmul_rmsnorm_fused:L1.ffn_down        9.51     1.1
matmul_rmsnorm_fused:L20.ffn_down        9.38     1.1
matmul_rmsnorm_fused:L2.ffn_down        9.36     1.1
matmul_rmsnorm_fused:L24.ffn_down        9.34     1.1
matmul_rmsnorm_fused:L10.ffn_down        9.23     1.0
matmul_rmsnorm_fused:L6.ffn_down        9.23     1.0
matmul_rmsnorm_fused:L22.ffn_down        8.74     1.0
matmul_rmsnorm_fused:L3.ffn_down        8.73     1.0
matmul_rmsnorm_fused:L7.ffn_down        8.67     1.0
matmul:o_proj:L24                3.41     0.4
sample_phase2                    3.27     0.4
matmul:o_proj:L21                3.07     0.3
matmul:o_proj:L25                2.88     0.3
matmul:q_proj:L1                 2.56     0.3
rope                             2.35     0.3
matmul:o_proj:L14                2.12     0.2
matmul:o_proj:L20                2.09     0.2
matmul:o_proj:L4                 2.06     0.2
matmul:o_proj:L7                 2.05     0.2
matmul:o_proj:L0                 2.05     0.2
matmul:o_proj:L12                2.02     0.2
matmul:o_proj:L9                 1.85     0.2
matmul:o_proj:L17                1.39     0.2
matmul:o_proj:L18                1.35     0.2
matmul:q_proj:L12                1.33     0.2
matmul:o_proj:L2                 1.29     0.1
matmul:o_proj:L13                1.24     0.1
matmul:o_proj:L10                1.14     0.1
matmul:o_proj:L16                1.02     0.1
matmul:o_proj:L22                0.97     0.1
matmul:k_proj:L3                 0.93     0.1
matmul:o_proj:L8                 0.88     0.1
matmul:q_proj:L16                0.87     0.1
matmul:q_proj:L5                 0.87     0.1
matmul:q_proj:L3                 0.85     0.1
matmul:q_proj:L9                 0.82     0.1
matmul:q_proj:L20                0.66     0.1
matmul:q_proj:L19                0.60     0.1
matmul:o_proj:L6                 0.53     0.1
matmul:q_proj:L24                0.52     0.1
matmul:o_proj:L5                 0.51     0.1
matmul:v_proj:L17                0.50     0.1
matmul:k_proj:L1                 0.45     0.1
matmul:v_proj:L16                0.44     0.0
matmul:v_proj:L3                 0.36     0.0
matmul:o_proj:L1                 0.35     0.0
matmul:k_proj:L20                0.34     0.0
matmul:v_proj:L1                 0.21     0.0
matmul:q_proj:L22                0.20     0.0
matmul:o_proj:L23                0.20     0.0
matmul:q_proj:L0                 0.19     0.0
matmul:q_proj:L13                0.18     0.0
matmul:o_proj:L15                0.18     0.0
matmul:o_proj:L19                0.17     0.0
matmul:q_proj:L17                0.17     0.0
matmul:k_proj:L16                0.16     0.0
matmul:o_proj:L11                0.16     0.0
matmul:v_proj:L24                0.15     0.0
matmul:v_proj:L13                0.15     0.0
matmul:o_proj:L3                 0.15     0.0
matmul:q_proj:L23                0.14     0.0
matmul:q_proj:L6                 0.14     0.0
matmul:q_proj:L4                 0.14     0.0
matmul:q_proj:L25                0.14     0.0
matmul:q_proj:L21                0.13     0.0
matmul:q_proj:L15                0.13     0.0
matmul:q_proj:L18                0.13     0.0
matmul:q_proj:L2                 0.13     0.0
matmul:q_proj:L8                 0.13     0.0
matmul:q_proj:L7                 0.13     0.0
matmul:q_proj:L14                0.13     0.0
matmul:q_proj:L11                0.13     0.0
matmul:q_proj:L10                0.12     0.0
matmul:k_proj:L17                0.10     0.0
matmul:k_proj:L24                0.09     0.0
matmul:k_proj:L13                0.09     0.0
sample_phase1                    0.09     0.0
matmul:v_proj:L5                 0.09     0.0
matmul:k_proj:L5                 0.09     0.0
matmul:k_proj:L9                 0.08     0.0
matmul:v_proj:L9                 0.07     0.0
matmul:k_proj:L12                0.07     0.0
matmul:v_proj:L22                0.07     0.0
matmul:v_proj:L12                0.06     0.0
sample_phase3                    0.06     0.0
matmul:v_proj:L20                0.06     0.0
matmul:k_proj:L22                0.05     0.0
matmul:v_proj:L0                 0.05     0.0
matmul:k_proj:L19                0.05     0.0
matmul:k_proj:L0                 0.05     0.0
matmul:k_proj:L6                 0.05     0.0
matmul:v_proj:L6                 0.05     0.0
matmul:k_proj:L23                0.05     0.0
matmul:v_proj:L19                0.05     0.0
matmul:v_proj:L23                0.05     0.0
matmul:k_proj:L15                0.05     0.0
matmul:k_proj:L21                0.05     0.0
matmul:k_proj:L25                0.05     0.0
matmul:k_proj:L4                 0.05     0.0
matmul:k_proj:L7                 0.05     0.0
matmul:v_proj:L25                0.05     0.0
matmul:k_proj:L14                0.05     0.0
matmul:k_proj:L2                 0.05     0.0
matmul:k_proj:L11                0.05     0.0
matmul:v_proj:L4                 0.05     0.0
matmul:k_proj:L18                0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:k_proj:L10                0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:v_proj:L14                0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:v_proj:L18                0.04     0.0
gather                           0.01     0.0
scale                            0.01     0.0
──────────────────────────────────────────────────
TOTAL                          879.59   100.0

[browser:warning] [37179.9ms][Profile] Batch decode (N=4):
[browser:warning] [37180.2ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      401.90    50.4
fused_ffn                       65.15     8.2
matmul:lm_head                  37.22     4.7
matmul_rmsnorm_fused:L9.ffn_down       11.46     1.4
matmul_rmsnorm_fused:L4.ffn_down       11.11     1.4
matmul_rmsnorm_fused:L14.ffn_down       11.10     1.4
matmul_rmsnorm_fused:L7.ffn_down       10.53     1.3
matmul_rmsnorm_fused:L18.ffn_down       10.52     1.3
matmul_rmsnorm_fused:L10.ffn_down       10.37     1.3
matmul_rmsnorm_fused:L6.ffn_down       10.32     1.3
matmul_rmsnorm_fused:L11.ffn_down       10.26     1.3
matmul_rmsnorm_fused:L3.ffn_down       10.18     1.3
matmul_rmsnorm_fused:L20.ffn_down       10.04     1.3
matmul_rmsnorm_fused:L2.ffn_down        9.93     1.2
matmul_rmsnorm_fused:L22.ffn_down        9.78     1.2
matmul_rmsnorm_fused:L12.ffn_down        9.53     1.2
matmul_rmsnorm_fused:L13.ffn_down        9.18     1.2
matmul_rmsnorm_fused:L16.ffn_down        9.17     1.1
matmul_rmsnorm_fused:L17.ffn_down        9.16     1.1
matmul_rmsnorm_fused:L15.ffn_down        9.14     1.1
matmul_rmsnorm_fused:L25.ffn_down        9.07     1.1
matmul_rmsnorm_fused:L0.ffn_down        9.07     1.1
matmul_rmsnorm_fused:L1.ffn_down        9.05     1.1
matmul_rmsnorm_fused:L19.ffn_down        8.94     1.1
matmul_rmsnorm_fused:L24.ffn_down        8.85     1.1
matmul_rmsnorm_fused:L21.ffn_down        8.80     1.1
rmsnorm                          8.74     1.1
matmul_rmsnorm_fused:L5.ffn_down        8.74     1.1
matmul_rmsnorm_fused:L23.ffn_down        8.70     1.1
matmul_rmsnorm_fused:L8.ffn_down        8.69     1.1
matmul:o_proj:L22                3.45     0.4
sample_phase2                    3.29     0.4
matmul:o_proj:L7                 2.62     0.3
matmul:q_proj:L2                 1.78     0.2
rope                             1.62     0.2
matmul:o_proj:L12                1.40     0.2
matmul:o_proj:L24                1.40     0.2
matmul:o_proj:L3                 1.29     0.2
matmul:q_proj:L14                1.24     0.2
matmul:o_proj:L4                 1.12     0.1
matmul:o_proj:L14                1.04     0.1
matmul:o_proj:L20                0.92     0.1
matmul:o_proj:L6                 0.76     0.1
matmul:o_proj:L10                0.67     0.1
gather                           0.43     0.1
matmul:q_proj:L10                0.41     0.1
matmul:k_proj:L10                0.33     0.0
matmul:v_proj:L10                0.32     0.0
matmul:o_proj:L5                 0.32     0.0
matmul:v_proj:L14                0.29     0.0
matmul:o_proj:L18                0.28     0.0
matmul:q_proj:L0                 0.26     0.0
matmul:o_proj:L9                 0.21     0.0
matmul:o_proj:L2                 0.19     0.0
matmul:q_proj:L1                 0.18     0.0
matmul:o_proj:L8                 0.17     0.0
matmul:o_proj:L1                 0.17     0.0
matmul:q_proj:L16                0.16     0.0
matmul:o_proj:L11                0.16     0.0
matmul:o_proj:L21                0.16     0.0
matmul:q_proj:L7                 0.16     0.0
matmul:o_proj:L25                0.16     0.0
matmul:o_proj:L15                0.16     0.0
matmul:o_proj:L13                0.15     0.0
matmul:o_proj:L0                 0.15     0.0
matmul:o_proj:L19                0.15     0.0
matmul:o_proj:L17                0.15     0.0
matmul:o_proj:L16                0.14     0.0
matmul:q_proj:L19                0.14     0.0
matmul:q_proj:L12                0.14     0.0
matmul:q_proj:L18                0.14     0.0
matmul:q_proj:L22                0.14     0.0
matmul:q_proj:L5                 0.14     0.0
matmul:q_proj:L11                0.14     0.0
matmul:q_proj:L6                 0.14     0.0
matmul:q_proj:L4                 0.14     0.0
matmul:o_proj:L23                0.13     0.0
matmul:q_proj:L25                0.13     0.0
matmul:q_proj:L9                 0.13     0.0
matmul:q_proj:L15                0.13     0.0
matmul:q_proj:L13                0.13     0.0
matmul:q_proj:L3                 0.13     0.0
matmul:q_proj:L24                0.13     0.0
matmul:q_proj:L21                0.13     0.0
matmul:q_proj:L20                0.13     0.0
matmul:q_proj:L23                0.13     0.0
matmul:q_proj:L17                0.12     0.0
matmul:q_proj:L8                 0.12     0.0
matmul:v_proj:L0                 0.11     0.0
sample_phase1                    0.10     0.0
matmul:k_proj:L0                 0.09     0.0
sample_phase3                    0.07     0.0
matmul:k_proj:L14                0.07     0.0
matmul:k_proj:L16                0.06     0.0
matmul:v_proj:L1                 0.05     0.0
matmul:k_proj:L1                 0.05     0.0
matmul:k_proj:L18                0.05     0.0
matmul:v_proj:L18                0.05     0.0
matmul:k_proj:L7                 0.05     0.0
matmul:k_proj:L2                 0.05     0.0
matmul:v_proj:L7                 0.05     0.0
matmul:v_proj:L2                 0.05     0.0
matmul:k_proj:L19                0.05     0.0
matmul:k_proj:L12                0.05     0.0
matmul:k_proj:L15                0.05     0.0
matmul:k_proj:L4                 0.05     0.0
matmul:v_proj:L16                0.05     0.0
matmul:k_proj:L11                0.05     0.0
matmul:v_proj:L12                0.05     0.0
matmul:v_proj:L22                0.05     0.0
matmul:k_proj:L22                0.05     0.0
matmul:k_proj:L6                 0.05     0.0
matmul:v_proj:L5                 0.05     0.0
matmul:v_proj:L25                0.05     0.0
matmul:k_proj:L5                 0.05     0.0
matmul:v_proj:L15                0.05     0.0
matmul:k_proj:L21                0.05     0.0
matmul:v_proj:L11                0.05     0.0
matmul:v_proj:L24                0.05     0.0
matmul:k_proj:L17                0.05     0.0
matmul:k_proj:L25                0.05     0.0
matmul:k_proj:L24                0.05     0.0
matmul:v_proj:L19                0.05     0.0
matmul:v_proj:L23                0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:k_proj:L20                0.04     0.0
matmul:k_proj:L13                0.04     0.0
matmul:k_proj:L3                 0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:k_proj:L23                0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:v_proj:L17                0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:v_proj:L8                 0.04     0.0
scale                            0.04     0.0
──────────────────────────────────────────────────
TOTAL                          797.88   100.0

[browser:warning] [37989.8ms][Profile] Batch decode (N=4):
[browser:warning] [37990.0ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      409.45    55.5
fused_ffn                       41.82     5.7
matmul:lm_head                  30.23     4.1
matmul_rmsnorm_fused:L6.ffn_down       10.54     1.4
matmul_rmsnorm_fused:L7.ffn_down       10.49     1.4
matmul_rmsnorm_fused:L1.ffn_down       10.40     1.4
matmul_rmsnorm_fused:L4.ffn_down       10.38     1.4
matmul_rmsnorm_fused:L12.ffn_down       10.10     1.4
matmul_rmsnorm_fused:L9.ffn_down       10.09     1.4
matmul_rmsnorm_fused:L2.ffn_down       10.05     1.4
matmul_rmsnorm_fused:L14.ffn_down        9.18     1.2
matmul_rmsnorm_fused:L0.ffn_down        9.17     1.2
matmul_rmsnorm_fused:L19.ffn_down        9.11     1.2
matmul_rmsnorm_fused:L24.ffn_down        8.98     1.2
matmul_rmsnorm_fused:L11.ffn_down        8.85     1.2
matmul_rmsnorm_fused:L21.ffn_down        8.84     1.2
matmul_rmsnorm_fused:L16.ffn_down        8.75     1.2
matmul_rmsnorm_fused:L25.ffn_down        8.73     1.2
matmul_rmsnorm_fused:L5.ffn_down        8.71     1.2
matmul_rmsnorm_fused:L10.ffn_down        8.70     1.2
matmul_rmsnorm_fused:L22.ffn_down        8.69     1.2
matmul_rmsnorm_fused:L17.ffn_down        8.69     1.2
matmul_rmsnorm_fused:L20.ffn_down        8.67     1.2
matmul_rmsnorm_fused:L23.ffn_down        8.66     1.2
matmul_rmsnorm_fused:L8.ffn_down        8.66     1.2
matmul_rmsnorm_fused:L13.ffn_down        8.66     1.2
matmul_rmsnorm_fused:L3.ffn_down        8.65     1.2
matmul_rmsnorm_fused:L15.ffn_down        8.64     1.2
matmul_rmsnorm_fused:L18.ffn_down        8.62     1.2
sample_phase2                    3.30     0.4
rmsnorm                          3.04     0.4
rope                             0.70     0.1
matmul:o_proj:L19                0.37     0.0
matmul:q_proj:L0                 0.22     0.0
matmul:o_proj:L22                0.17     0.0
matmul:o_proj:L14                0.17     0.0
matmul:o_proj:L9                 0.16     0.0
matmul:o_proj:L12                0.16     0.0
matmul:o_proj:L6                 0.16     0.0
matmul:o_proj:L10                0.15     0.0
matmul:o_proj:L0                 0.15     0.0
matmul:o_proj:L5                 0.15     0.0
matmul:o_proj:L2                 0.15     0.0
matmul:o_proj:L20                0.15     0.0
matmul:o_proj:L21                0.15     0.0
matmul:o_proj:L18                0.15     0.0
matmul:o_proj:L13                0.14     0.0
matmul:o_proj:L17                0.14     0.0
matmul:o_proj:L16                0.14     0.0
matmul:o_proj:L25                0.14     0.0
matmul:q_proj:L5                 0.14     0.0
matmul:o_proj:L11                0.14     0.0
matmul:o_proj:L24                0.14     0.0
matmul:o_proj:L15                0.14     0.0
matmul:o_proj:L8                 0.14     0.0
matmul:o_proj:L4                 0.14     0.0
matmul:o_proj:L7                 0.14     0.0
matmul:o_proj:L23                0.14     0.0
matmul:q_proj:L3                 0.14     0.0
matmul:o_proj:L3                 0.13     0.0
matmul:q_proj:L15                0.13     0.0
matmul:o_proj:L1                 0.13     0.0
matmul:q_proj:L20                0.13     0.0
matmul:q_proj:L25                0.13     0.0
matmul:q_proj:L1                 0.13     0.0
matmul:q_proj:L8                 0.13     0.0
matmul:q_proj:L2                 0.13     0.0
matmul:q_proj:L10                0.13     0.0
matmul:q_proj:L7                 0.13     0.0
matmul:q_proj:L23                0.13     0.0
matmul:q_proj:L17                0.12     0.0
matmul:q_proj:L9                 0.12     0.0
matmul:q_proj:L13                0.12     0.0
matmul:q_proj:L4                 0.12     0.0
matmul:q_proj:L22                0.12     0.0
matmul:q_proj:L19                0.12     0.0
matmul:q_proj:L14                0.12     0.0
matmul:q_proj:L24                0.12     0.0
matmul:q_proj:L16                0.12     0.0
matmul:q_proj:L18                0.12     0.0
matmul:q_proj:L11                0.12     0.0
matmul:q_proj:L12                0.12     0.0
matmul:q_proj:L21                0.12     0.0
matmul:q_proj:L6                 0.12     0.0
sample_phase1                    0.09     0.0
sample_phase3                    0.08     0.0
matmul:k_proj:L0                 0.07     0.0
matmul:v_proj:L0                 0.07     0.0
matmul:k_proj:L5                 0.06     0.0
matmul:v_proj:L5                 0.05     0.0
matmul:k_proj:L3                 0.05     0.0
matmul:v_proj:L3                 0.05     0.0
matmul:k_proj:L16                0.05     0.0
matmul:k_proj:L19                0.05     0.0
matmul:k_proj:L15                0.05     0.0
matmul:k_proj:L6                 0.05     0.0
matmul:v_proj:L25                0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:k_proj:L20                0.04     0.0
matmul:k_proj:L1                 0.04     0.0
matmul:k_proj:L7                 0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:v_proj:L18                0.04     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:k_proj:L17                0.04     0.0
matmul:v_proj:L22                0.04     0.0
matmul:k_proj:L10                0.04     0.0
matmul:k_proj:L24                0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:k_proj:L23                0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:k_proj:L2                 0.04     0.0
matmul:k_proj:L12                0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:k_proj:L4                 0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:k_proj:L21                0.04     0.0
matmul:k_proj:L18                0.04     0.0
matmul:v_proj:L16                0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:k_proj:L14                0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:k_proj:L22                0.04     0.0
matmul:k_proj:L13                0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:k_proj:L11                0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:v_proj:L24                0.04     0.0
matmul:v_proj:L17                0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:v_proj:L14                0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:v_proj:L19                0.04     0.0
gather                           0.03     0.0
scale                            0.03     0.0
──────────────────────────────────────────────────
TOTAL                          737.52   100.0

[browser:warning] [38777.3ms][Profile] Batch decode (N=4):
[browser:warning] [38777.4ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      419.17    56.8
fused_ffn                       39.14     5.3
matmul:lm_head                  30.27     4.1
matmul_rmsnorm_fused:L3.ffn_down       10.75     1.5
matmul_rmsnorm_fused:L1.ffn_down       10.46     1.4
matmul_rmsnorm_fused:L4.ffn_down       10.06     1.4
matmul_rmsnorm_fused:L6.ffn_down        9.43     1.3
matmul_rmsnorm_fused:L8.ffn_down        9.15     1.2
matmul_rmsnorm_fused:L21.ffn_down        8.99     1.2
matmul_rmsnorm_fused:L2.ffn_down        8.93     1.2
matmul_rmsnorm_fused:L13.ffn_down        8.79     1.2
matmul_rmsnorm_fused:L10.ffn_down        8.79     1.2
matmul_rmsnorm_fused:L11.ffn_down        8.79     1.2
matmul_rmsnorm_fused:L23.ffn_down        8.78     1.2
matmul_rmsnorm_fused:L15.ffn_down        8.77     1.2
matmul_rmsnorm_fused:L0.ffn_down        8.76     1.2
matmul_rmsnorm_fused:L5.ffn_down        8.72     1.2
matmul_rmsnorm_fused:L25.ffn_down        8.72     1.2
matmul_rmsnorm_fused:L16.ffn_down        8.70     1.2
matmul_rmsnorm_fused:L22.ffn_down        8.68     1.2
matmul_rmsnorm_fused:L17.ffn_down        8.68     1.2
matmul_rmsnorm_fused:L9.ffn_down        8.67     1.2
matmul_rmsnorm_fused:L18.ffn_down        8.66     1.2
matmul_rmsnorm_fused:L14.ffn_down        8.66     1.2
matmul_rmsnorm_fused:L7.ffn_down        8.65     1.2
matmul_rmsnorm_fused:L24.ffn_down        8.64     1.2
matmul_rmsnorm_fused:L20.ffn_down        8.64     1.2
matmul_rmsnorm_fused:L19.ffn_down        8.61     1.2
matmul_rmsnorm_fused:L12.ffn_down        8.60     1.2
sample_phase2                    3.31     0.4
rmsnorm                          2.97     0.4
rope                             0.74     0.1
matmul:q_proj:L0                 0.21     0.0
matmul:o_proj:L6                 0.17     0.0
matmul:o_proj:L16                0.16     0.0
matmul:o_proj:L2                 0.16     0.0
matmul:o_proj:L4                 0.15     0.0
matmul:q_proj:L22                0.15     0.0
matmul:o_proj:L11                0.15     0.0
matmul:q_proj:L11                0.15     0.0
matmul:o_proj:L17                0.15     0.0
matmul:o_proj:L22                0.14     0.0
matmul:o_proj:L8                 0.14     0.0
matmul:q_proj:L18                0.14     0.0
matmul:o_proj:L25                0.14     0.0
matmul:o_proj:L15                0.14     0.0
matmul:o_proj:L0                 0.14     0.0
matmul:o_proj:L18                0.14     0.0
matmul:o_proj:L12                0.14     0.0
matmul:o_proj:L13                0.14     0.0
matmul:o_proj:L21                0.14     0.0
matmul:o_proj:L9                 0.14     0.0
matmul:o_proj:L7                 0.13     0.0
matmul:o_proj:L20                0.13     0.0
matmul:o_proj:L5                 0.13     0.0
matmul:o_proj:L23                0.13     0.0
matmul:o_proj:L1                 0.13     0.0
matmul:q_proj:L2                 0.13     0.0
matmul:o_proj:L3                 0.13     0.0
matmul:o_proj:L24                0.13     0.0
matmul:q_proj:L7                 0.13     0.0
matmul:q_proj:L23                0.13     0.0
matmul:q_proj:L16                0.13     0.0
matmul:q_proj:L4                 0.13     0.0
matmul:o_proj:L14                0.13     0.0
matmul:q_proj:L21                0.13     0.0
matmul:o_proj:L10                0.13     0.0
matmul:q_proj:L17                0.12     0.0
matmul:q_proj:L1                 0.12     0.0
matmul:q_proj:L15                0.12     0.0
matmul:q_proj:L19                0.12     0.0
matmul:q_proj:L12                0.12     0.0
matmul:q_proj:L13                0.12     0.0
matmul:o_proj:L19                0.12     0.0
matmul:q_proj:L8                 0.12     0.0
matmul:q_proj:L6                 0.12     0.0
matmul:q_proj:L24                0.12     0.0
matmul:q_proj:L10                0.12     0.0
matmul:q_proj:L5                 0.12     0.0
matmul:q_proj:L25                0.12     0.0
matmul:q_proj:L20                0.12     0.0
matmul:q_proj:L9                 0.12     0.0
matmul:q_proj:L3                 0.12     0.0
matmul:q_proj:L14                0.12     0.0
sample_phase1                    0.10     0.0
matmul:v_proj:L0                 0.09     0.0
matmul:k_proj:L0                 0.09     0.0
sample_phase3                    0.08     0.0
matmul:v_proj:L22                0.06     0.0
matmul:v_proj:L23                0.06     0.0
matmul:k_proj:L22                0.06     0.0
matmul:k_proj:L23                0.06     0.0
matmul:k_proj:L11                0.05     0.0
matmul:k_proj:L4                 0.05     0.0
matmul:v_proj:L18                0.05     0.0
matmul:k_proj:L7                 0.05     0.0
matmul:v_proj:L11                0.05     0.0
matmul:v_proj:L7                 0.05     0.0
matmul:k_proj:L13                0.05     0.0
matmul:k_proj:L18                0.05     0.0
matmul:k_proj:L2                 0.05     0.0
matmul:k_proj:L1                 0.04     0.0
matmul:v_proj:L16                0.04     0.0
matmul:k_proj:L15                0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:k_proj:L16                0.04     0.0
matmul:k_proj:L17                0.04     0.0
matmul:v_proj:L17                0.04     0.0
matmul:k_proj:L21                0.04     0.0
matmul:k_proj:L19                0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:k_proj:L12                0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:k_proj:L14                0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:k_proj:L3                 0.04     0.0
matmul:v_proj:L1                 0.04     0.0
gather                           0.04     0.0
matmul:k_proj:L20                0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:k_proj:L24                0.04     0.0
matmul:k_proj:L5                 0.04     0.0
matmul:v_proj:L19                0.04     0.0
matmul:v_proj:L14                0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:v_proj:L5                 0.04     0.0
matmul:k_proj:L10                0.04     0.0
matmul:v_proj:L24                0.04     0.0
scale                            0.03     0.0
──────────────────────────────────────────────────
TOTAL                          738.33   100.0

[browser:warning] [39577.5ms][Profile] Batch decode (N=4):
[browser:warning] [39577.6ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      421.53    56.1
fused_ffn                       40.98     5.5
matmul:lm_head                  29.96     4.0
matmul_rmsnorm_fused:L7.ffn_down       10.75     1.4
matmul_rmsnorm_fused:L16.ffn_down       10.73     1.4
matmul_rmsnorm_fused:L13.ffn_down       10.56     1.4
matmul_rmsnorm_fused:L8.ffn_down       10.42     1.4
matmul_rmsnorm_fused:L15.ffn_down       10.35     1.4
matmul_rmsnorm_fused:L23.ffn_down       10.26     1.4
matmul_rmsnorm_fused:L10.ffn_down        9.80     1.3
matmul_rmsnorm_fused:L2.ffn_down        9.77     1.3
matmul_rmsnorm_fused:L21.ffn_down        9.63     1.3
matmul_rmsnorm_fused:L18.ffn_down        9.27     1.2
matmul_rmsnorm_fused:L3.ffn_down        9.16     1.2
matmul_rmsnorm_fused:L5.ffn_down        8.84     1.2
matmul_rmsnorm_fused:L9.ffn_down        8.84     1.2
matmul_rmsnorm_fused:L22.ffn_down        8.81     1.2
matmul_rmsnorm_fused:L25.ffn_down        8.78     1.2
matmul_rmsnorm_fused:L24.ffn_down        8.78     1.2
matmul_rmsnorm_fused:L0.ffn_down        8.77     1.2
matmul_rmsnorm_fused:L12.ffn_down        8.73     1.2
matmul_rmsnorm_fused:L14.ffn_down        8.70     1.2
matmul_rmsnorm_fused:L11.ffn_down        8.69     1.2
matmul_rmsnorm_fused:L17.ffn_down        8.69     1.2
matmul_rmsnorm_fused:L19.ffn_down        8.68     1.2
matmul_rmsnorm_fused:L1.ffn_down        8.67     1.2
matmul_rmsnorm_fused:L6.ffn_down        8.67     1.2
matmul_rmsnorm_fused:L20.ffn_down        8.64     1.1
matmul_rmsnorm_fused:L4.ffn_down        8.63     1.1
rmsnorm                          3.34     0.4
sample_phase2                    3.27     0.4
rope                             0.92     0.1
matmul:o_proj:L12                0.25     0.0
matmul:o_proj:L21                0.18     0.0
matmul:q_proj:L0                 0.17     0.0
matmul:o_proj:L15                0.17     0.0
matmul:o_proj:L13                0.16     0.0
matmul:q_proj:L19                0.16     0.0
matmul:q_proj:L11                0.16     0.0
matmul:q_proj:L14                0.16     0.0
matmul:q_proj:L4                 0.16     0.0
matmul:o_proj:L2                 0.16     0.0
matmul:o_proj:L6                 0.16     0.0
matmul:o_proj:L14                0.15     0.0
matmul:o_proj:L19                0.15     0.0
matmul:o_proj:L23                0.15     0.0
matmul:o_proj:L4                 0.15     0.0
matmul:q_proj:L3                 0.15     0.0
matmul:o_proj:L17                0.15     0.0
matmul:q_proj:L23                0.15     0.0
matmul:q_proj:L6                 0.15     0.0
matmul:o_proj:L0                 0.15     0.0
matmul:o_proj:L11                0.15     0.0
matmul:o_proj:L7                 0.14     0.0
matmul:q_proj:L9                 0.14     0.0
matmul:o_proj:L5                 0.14     0.0
matmul:o_proj:L9                 0.14     0.0
matmul:o_proj:L10                0.14     0.0
matmul:o_proj:L3                 0.14     0.0
matmul:q_proj:L1                 0.14     0.0
matmul:o_proj:L25                0.14     0.0
matmul:o_proj:L1                 0.14     0.0
matmul:o_proj:L8                 0.14     0.0
matmul:o_proj:L18                0.14     0.0
matmul:o_proj:L16                0.13     0.0
matmul:o_proj:L20                0.13     0.0
matmul:q_proj:L2                 0.13     0.0
matmul:q_proj:L17                0.13     0.0
matmul:o_proj:L22                0.13     0.0
matmul:q_proj:L8                 0.13     0.0
matmul:q_proj:L18                0.13     0.0
matmul:q_proj:L20                0.13     0.0
matmul:q_proj:L16                0.13     0.0
matmul:q_proj:L13                0.13     0.0
matmul:q_proj:L10                0.13     0.0
matmul:o_proj:L24                0.12     0.0
matmul:q_proj:L12                0.12     0.0
matmul:q_proj:L7                 0.12     0.0
matmul:q_proj:L5                 0.12     0.0
matmul:q_proj:L24                0.12     0.0
matmul:q_proj:L21                0.12     0.0
matmul:q_proj:L25                0.12     0.0
matmul:q_proj:L15                0.12     0.0
matmul:q_proj:L22                0.12     0.0
sample_phase1                    0.08     0.0
matmul:k_proj:L0                 0.07     0.0
matmul:k_proj:L14                0.07     0.0
matmul:v_proj:L19                0.07     0.0
matmul:k_proj:L19                0.06     0.0
matmul:k_proj:L11                0.06     0.0
matmul:v_proj:L0                 0.06     0.0
matmul:v_proj:L11                0.06     0.0
matmul:k_proj:L4                 0.06     0.0
matmul:k_proj:L23                0.06     0.0
matmul:v_proj:L14                0.06     0.0
matmul:v_proj:L3                 0.06     0.0
sample_phase3                    0.06     0.0
matmul:v_proj:L23                0.06     0.0
matmul:v_proj:L4                 0.06     0.0
matmul:k_proj:L3                 0.06     0.0
matmul:v_proj:L1                 0.06     0.0
matmul:k_proj:L6                 0.06     0.0
matmul:v_proj:L6                 0.06     0.0
matmul:k_proj:L1                 0.06     0.0
matmul:k_proj:L9                 0.05     0.0
matmul:v_proj:L9                 0.05     0.0
matmul:k_proj:L25                0.05     0.0
matmul:v_proj:L2                 0.05     0.0
matmul:k_proj:L2                 0.05     0.0
matmul:k_proj:L17                0.05     0.0
matmul:v_proj:L17                0.05     0.0
matmul:k_proj:L24                0.05     0.0
matmul:v_proj:L20                0.05     0.0
matmul:k_proj:L18                0.04     0.0
matmul:k_proj:L20                0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:k_proj:L15                0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:v_proj:L18                0.04     0.0
matmul:v_proj:L16                0.04     0.0
matmul:k_proj:L12                0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:k_proj:L7                 0.04     0.0
matmul:v_proj:L5                 0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:k_proj:L16                0.04     0.0
matmul:k_proj:L13                0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:k_proj:L21                0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:k_proj:L10                0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:k_proj:L5                 0.04     0.0
matmul:k_proj:L22                0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:v_proj:L24                0.04     0.0
matmul:v_proj:L22                0.04     0.0
gather                           0.03     0.0
scale                            0.02     0.0
──────────────────────────────────────────────────
TOTAL                          751.87   100.0

[browser:warning] [40389.3ms][Profile] Batch decode (N=4):
[browser:warning] [40389.5ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      431.46    56.5
fused_ffn                       39.88     5.2
matmul:lm_head                  29.77     3.9
matmul_rmsnorm_fused:L6.ffn_down       10.57     1.4
matmul_rmsnorm_fused:L19.ffn_down       10.46     1.4
matmul_rmsnorm_fused:L20.ffn_down       10.43     1.4
matmul_rmsnorm_fused:L13.ffn_down       10.36     1.4
matmul_rmsnorm_fused:L0.ffn_down       10.36     1.4
matmul_rmsnorm_fused:L21.ffn_down       10.24     1.3
matmul_rmsnorm_fused:L14.ffn_down       10.22     1.3
matmul_rmsnorm_fused:L1.ffn_down       10.17     1.3
matmul_rmsnorm_fused:L18.ffn_down       10.14     1.3
matmul_rmsnorm_fused:L2.ffn_down        9.98     1.3
matmul_rmsnorm_fused:L16.ffn_down        9.83     1.3
matmul_rmsnorm_fused:L7.ffn_down        9.74     1.3
matmul_rmsnorm_fused:L25.ffn_down        9.39     1.2
matmul_rmsnorm_fused:L9.ffn_down        9.09     1.2
matmul_rmsnorm_fused:L5.ffn_down        9.07     1.2
matmul_rmsnorm_fused:L24.ffn_down        9.04     1.2
matmul_rmsnorm_fused:L10.ffn_down        8.81     1.2
matmul_rmsnorm_fused:L15.ffn_down        8.76     1.1
matmul_rmsnorm_fused:L11.ffn_down        8.75     1.1
matmul_rmsnorm_fused:L22.ffn_down        8.69     1.1
matmul_rmsnorm_fused:L23.ffn_down        8.67     1.1
matmul_rmsnorm_fused:L3.ffn_down        8.67     1.1
matmul_rmsnorm_fused:L17.ffn_down        8.66     1.1
matmul_rmsnorm_fused:L4.ffn_down        8.65     1.1
matmul_rmsnorm_fused:L12.ffn_down        8.62     1.1
matmul_rmsnorm_fused:L8.ffn_down        8.62     1.1
sample_phase2                    3.26     0.4
rmsnorm                          3.03     0.4
rope                             0.73     0.1
matmul:o_proj:L7                 0.23     0.0
matmul:o_proj:L9                 0.18     0.0
matmul:o_proj:L25                0.18     0.0
matmul:o_proj:L24                0.17     0.0
matmul:o_proj:L21                0.16     0.0
matmul:o_proj:L3                 0.16     0.0
matmul:o_proj:L5                 0.16     0.0
matmul:o_proj:L18                0.15     0.0
matmul:o_proj:L11                0.15     0.0
matmul:o_proj:L15                0.15     0.0
matmul:q_proj:L16                0.15     0.0
matmul:o_proj:L0                 0.14     0.0
matmul:o_proj:L8                 0.14     0.0
matmul:o_proj:L23                0.14     0.0
matmul:o_proj:L20                0.14     0.0
matmul:o_proj:L19                0.14     0.0
matmul:q_proj:L2                 0.14     0.0
matmul:q_proj:L15                0.14     0.0
matmul:o_proj:L4                 0.14     0.0
matmul:o_proj:L10                0.14     0.0
matmul:o_proj:L2                 0.14     0.0
matmul:o_proj:L16                0.14     0.0
matmul:q_proj:L11                0.14     0.0
matmul:o_proj:L12                0.14     0.0
matmul:q_proj:L0                 0.14     0.0
matmul:o_proj:L1                 0.13     0.0
matmul:o_proj:L13                0.13     0.0
matmul:q_proj:L3                 0.13     0.0
matmul:o_proj:L6                 0.13     0.0
matmul:q_proj:L17                0.13     0.0
matmul:o_proj:L17                0.13     0.0
matmul:q_proj:L21                0.13     0.0
matmul:o_proj:L22                0.13     0.0
matmul:q_proj:L20                0.13     0.0
matmul:o_proj:L14                0.13     0.0
matmul:q_proj:L7                 0.13     0.0
matmul:q_proj:L14                0.12     0.0
matmul:q_proj:L22                0.12     0.0
matmul:q_proj:L1                 0.12     0.0
matmul:q_proj:L24                0.12     0.0
matmul:q_proj:L19                0.12     0.0
matmul:q_proj:L10                0.12     0.0
matmul:q_proj:L12                0.12     0.0
matmul:q_proj:L25                0.12     0.0
matmul:q_proj:L8                 0.12     0.0
matmul:q_proj:L6                 0.12     0.0
matmul:q_proj:L9                 0.12     0.0
matmul:q_proj:L5                 0.12     0.0
matmul:q_proj:L4                 0.12     0.0
matmul:q_proj:L13                0.12     0.0
matmul:q_proj:L18                0.12     0.0
matmul:q_proj:L23                0.12     0.0
sample_phase1                    0.08     0.0
sample_phase3                    0.07     0.0
matmul:v_proj:L16                0.06     0.0
matmul:k_proj:L16                0.06     0.0
matmul:v_proj:L17                0.05     0.0
matmul:k_proj:L15                0.05     0.0
matmul:k_proj:L17                0.05     0.0
matmul:v_proj:L2                 0.05     0.0
matmul:k_proj:L3                 0.05     0.0
matmul:k_proj:L2                 0.05     0.0
matmul:v_proj:L3                 0.05     0.0
matmul:v_proj:L15                0.05     0.0
matmul:v_proj:L18                0.05     0.0
matmul:k_proj:L11                0.05     0.0
matmul:k_proj:L0                 0.05     0.0
matmul:v_proj:L11                0.04     0.0
matmul:k_proj:L5                 0.04     0.0
matmul:v_proj:L0                 0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:k_proj:L7                 0.04     0.0
matmul:k_proj:L14                0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:k_proj:L21                0.04     0.0
matmul:k_proj:L12                0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:k_proj:L1                 0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:k_proj:L20                0.04     0.0
matmul:k_proj:L19                0.04     0.0
matmul:v_proj:L19                0.04     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:k_proj:L24                0.04     0.0
matmul:k_proj:L22                0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:k_proj:L4                 0.04     0.0
matmul:v_proj:L22                0.04     0.0
matmul:v_proj:L4                 0.04     0.0
matmul:v_proj:L5                 0.04     0.0
matmul:k_proj:L23                0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:k_proj:L10                0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:k_proj:L13                0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:v_proj:L14                0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:k_proj:L18                0.04     0.0
matmul:v_proj:L24                0.04     0.0
gather                           0.01     0.0
scale                            0.01     0.0
──────────────────────────────────────────────────
TOTAL                          763.86   100.0

[browser:warning] [41203.7ms][Profile] Batch decode (N=4):
[browser:warning] [41203.9ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      436.84    56.9
fused_ffn                       39.25     5.1
matmul:lm_head                  30.48     4.0
matmul_rmsnorm_fused:L4.ffn_down       11.08     1.4
matmul_rmsnorm_fused:L13.ffn_down       10.71     1.4
matmul_rmsnorm_fused:L14.ffn_down       10.53     1.4
matmul_rmsnorm_fused:L17.ffn_down       10.52     1.4
matmul_rmsnorm_fused:L16.ffn_down       10.42     1.4
matmul_rmsnorm_fused:L18.ffn_down       10.39     1.4
matmul_rmsnorm_fused:L3.ffn_down       10.34     1.3
matmul_rmsnorm_fused:L0.ffn_down       10.23     1.3
matmul_rmsnorm_fused:L22.ffn_down        9.84     1.3
matmul_rmsnorm_fused:L2.ffn_down        9.67     1.3
matmul_rmsnorm_fused:L21.ffn_down        9.10     1.2
matmul_rmsnorm_fused:L11.ffn_down        8.89     1.2
matmul_rmsnorm_fused:L9.ffn_down        8.87     1.2
matmul_rmsnorm_fused:L5.ffn_down        8.81     1.1
matmul_rmsnorm_fused:L8.ffn_down        8.76     1.1
matmul_rmsnorm_fused:L25.ffn_down        8.74     1.1
matmul_rmsnorm_fused:L10.ffn_down        8.69     1.1
matmul_rmsnorm_fused:L24.ffn_down        8.69     1.1
matmul_rmsnorm_fused:L23.ffn_down        8.68     1.1
matmul_rmsnorm_fused:L19.ffn_down        8.68     1.1
matmul_rmsnorm_fused:L6.ffn_down        8.65     1.1
matmul_rmsnorm_fused:L20.ffn_down        8.65     1.1
matmul_rmsnorm_fused:L7.ffn_down        8.65     1.1
matmul_rmsnorm_fused:L1.ffn_down        8.64     1.1
matmul_rmsnorm_fused:L15.ffn_down        8.63     1.1
matmul_rmsnorm_fused:L12.ffn_down        8.63     1.1
sample_phase2                    3.30     0.4
rmsnorm                          3.08     0.4
rope                             0.83     0.1
matmul:q_proj:L0                 0.21     0.0
matmul:o_proj:L2                 0.18     0.0
matmul:o_proj:L22                0.16     0.0
matmul:q_proj:L10                0.16     0.0
matmul:o_proj:L13                0.15     0.0
matmul:o_proj:L21                0.15     0.0
matmul:q_proj:L14                0.15     0.0
matmul:o_proj:L24                0.15     0.0
matmul:o_proj:L4                 0.15     0.0
matmul:q_proj:L5                 0.15     0.0
matmul:o_proj:L6                 0.15     0.0
matmul:q_proj:L12                0.15     0.0
matmul:o_proj:L16                0.15     0.0
matmul:o_proj:L0                 0.14     0.0
matmul:o_proj:L15                0.14     0.0
matmul:o_proj:L5                 0.14     0.0
matmul:o_proj:L12                0.14     0.0
matmul:o_proj:L19                0.14     0.0
matmul:o_proj:L25                0.14     0.0
matmul:o_proj:L23                0.14     0.0
matmul:o_proj:L8                 0.14     0.0
matmul:o_proj:L7                 0.14     0.0
matmul:o_proj:L11                0.14     0.0
matmul:o_proj:L18                0.14     0.0
matmul:q_proj:L4                 0.13     0.0
matmul:o_proj:L1                 0.13     0.0
matmul:o_proj:L3                 0.13     0.0
matmul:o_proj:L9                 0.13     0.0
matmul:o_proj:L14                0.13     0.0
matmul:q_proj:L15                0.13     0.0
matmul:q_proj:L1                 0.13     0.0
matmul:q_proj:L23                0.13     0.0
matmul:o_proj:L17                0.13     0.0
matmul:o_proj:L10                0.13     0.0
matmul:o_proj:L20                0.13     0.0
matmul:q_proj:L18                0.13     0.0
matmul:q_proj:L22                0.13     0.0
matmul:q_proj:L13                0.13     0.0
matmul:q_proj:L16                0.13     0.0
matmul:q_proj:L19                0.13     0.0
matmul:q_proj:L11                0.12     0.0
matmul:q_proj:L9                 0.12     0.0
matmul:q_proj:L17                0.12     0.0
matmul:q_proj:L8                 0.12     0.0
matmul:q_proj:L6                 0.12     0.0
matmul:q_proj:L7                 0.12     0.0
matmul:q_proj:L24                0.12     0.0
matmul:q_proj:L25                0.12     0.0
matmul:q_proj:L3                 0.12     0.0
matmul:q_proj:L20                0.12     0.0
matmul:q_proj:L21                0.12     0.0
matmul:q_proj:L2                 0.12     0.0
sample_phase1                    0.10     0.0
matmul:v_proj:L0                 0.09     0.0
matmul:k_proj:L0                 0.09     0.0
sample_phase3                    0.07     0.0
matmul:k_proj:L12                0.07     0.0
matmul:v_proj:L12                0.06     0.0
matmul:v_proj:L14                0.06     0.0
matmul:k_proj:L14                0.06     0.0
matmul:v_proj:L10                0.06     0.0
matmul:k_proj:L10                0.06     0.0
matmul:k_proj:L15                0.05     0.0
matmul:k_proj:L1                 0.05     0.0
matmul:v_proj:L1                 0.05     0.0
matmul:v_proj:L15                0.05     0.0
matmul:v_proj:L4                 0.05     0.0
matmul:k_proj:L4                 0.05     0.0
matmul:k_proj:L5                 0.05     0.0
matmul:k_proj:L23                0.05     0.0
matmul:v_proj:L5                 0.05     0.0
matmul:v_proj:L23                0.05     0.0
matmul:k_proj:L18                0.04     0.0
matmul:k_proj:L17                0.04     0.0
matmul:v_proj:L18                0.04     0.0
matmul:k_proj:L22                0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:k_proj:L16                0.04     0.0
matmul:k_proj:L13                0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:v_proj:L16                0.04     0.0
matmul:k_proj:L11                0.04     0.0
matmul:k_proj:L24                0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:k_proj:L7                 0.04     0.0
matmul:k_proj:L19                0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:k_proj:L2                 0.04     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:k_proj:L21                0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:v_proj:L22                0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:k_proj:L3                 0.04     0.0
matmul:v_proj:L17                0.04     0.0
matmul:v_proj:L24                0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:k_proj:L20                0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:v_proj:L19                0.04     0.0
gather                           0.04     0.0
scale                            0.03     0.0
──────────────────────────────────────────────────
TOTAL                          767.16   100.0

[browser:warning] [42020.0ms][Profile] Batch decode (N=4):
[browser:warning] [42020.1ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      439.80    57.2
fused_ffn                       40.07     5.2
matmul:lm_head                  30.82     4.0
matmul_rmsnorm_fused:L7.ffn_down       10.53     1.4
matmul_rmsnorm_fused:L14.ffn_down       10.52     1.4
matmul_rmsnorm_fused:L11.ffn_down       10.43     1.4
matmul_rmsnorm_fused:L15.ffn_down       10.31     1.3
matmul_rmsnorm_fused:L24.ffn_down       10.08     1.3
matmul_rmsnorm_fused:L25.ffn_down        9.82     1.3
matmul_rmsnorm_fused:L10.ffn_down        9.80     1.3
matmul_rmsnorm_fused:L1.ffn_down        9.42     1.2
matmul_rmsnorm_fused:L16.ffn_down        9.18     1.2
matmul_rmsnorm_fused:L19.ffn_down        9.09     1.2
matmul_rmsnorm_fused:L22.ffn_down        9.04     1.2
matmul_rmsnorm_fused:L21.ffn_down        9.03     1.2
matmul_rmsnorm_fused:L9.ffn_down        8.92     1.2
matmul_rmsnorm_fused:L12.ffn_down        8.83     1.1
matmul_rmsnorm_fused:L2.ffn_down        8.77     1.1
matmul_rmsnorm_fused:L23.ffn_down        8.73     1.1
matmul_rmsnorm_fused:L6.ffn_down        8.73     1.1
matmul_rmsnorm_fused:L8.ffn_down        8.73     1.1
matmul_rmsnorm_fused:L20.ffn_down        8.70     1.1
matmul_rmsnorm_fused:L5.ffn_down        8.67     1.1
matmul_rmsnorm_fused:L13.ffn_down        8.66     1.1
matmul_rmsnorm_fused:L3.ffn_down        8.66     1.1
matmul_rmsnorm_fused:L0.ffn_down        8.66     1.1
matmul_rmsnorm_fused:L17.ffn_down        8.64     1.1
matmul_rmsnorm_fused:L18.ffn_down        8.62     1.1
matmul_rmsnorm_fused:L4.ffn_down        8.60     1.1
rmsnorm                          3.84     0.5
sample_phase2                    3.39     0.4
rope                             0.82     0.1
matmul:o_proj:L20                0.54     0.1
matmul:o_proj:L16                0.18     0.0
matmul:o_proj:L3                 0.18     0.0
matmul:o_proj:L1                 0.18     0.0
matmul:q_proj:L22                0.16     0.0
matmul:o_proj:L12                0.16     0.0
matmul:q_proj:L0                 0.16     0.0
matmul:q_proj:L11                0.16     0.0
matmul:o_proj:L14                0.15     0.0
matmul:q_proj:L10                0.15     0.0
matmul:o_proj:L24                0.15     0.0
matmul:q_proj:L24                0.15     0.0
matmul:o_proj:L15                0.15     0.0
matmul:o_proj:L9                 0.15     0.0
matmul:o_proj:L2                 0.15     0.0
matmul:o_proj:L4                 0.15     0.0
matmul:o_proj:L0                 0.15     0.0
matmul:o_proj:L19                0.15     0.0
matmul:o_proj:L22                0.14     0.0
matmul:o_proj:L11                0.14     0.0
matmul:o_proj:L13                0.14     0.0
matmul:o_proj:L21                0.14     0.0
matmul:o_proj:L25                0.14     0.0
matmul:q_proj:L12                0.14     0.0
matmul:o_proj:L8                 0.14     0.0
matmul:q_proj:L25                0.14     0.0
matmul:q_proj:L21                0.14     0.0
matmul:o_proj:L23                0.14     0.0
matmul:o_proj:L7                 0.14     0.0
matmul:o_proj:L10                0.14     0.0
matmul:o_proj:L6                 0.13     0.0
matmul:o_proj:L18                0.13     0.0
matmul:o_proj:L5                 0.13     0.0
matmul:q_proj:L7                 0.13     0.0
matmul:o_proj:L17                0.13     0.0
matmul:q_proj:L16                0.13     0.0
matmul:q_proj:L20                0.13     0.0
matmul:q_proj:L8                 0.13     0.0
matmul:q_proj:L15                0.13     0.0
matmul:q_proj:L23                0.13     0.0
matmul:q_proj:L9                 0.13     0.0
matmul:q_proj:L1                 0.13     0.0
matmul:q_proj:L5                 0.12     0.0
matmul:q_proj:L6                 0.12     0.0
matmul:q_proj:L13                0.12     0.0
matmul:q_proj:L17                0.12     0.0
matmul:q_proj:L2                 0.12     0.0
matmul:q_proj:L3                 0.12     0.0
matmul:q_proj:L19                0.12     0.0
matmul:q_proj:L14                0.12     0.0
matmul:q_proj:L4                 0.12     0.0
matmul:q_proj:L18                0.12     0.0
sample_phase1                    0.10     0.0
matmul:k_proj:L22                0.07     0.0
sample_phase3                    0.07     0.0
matmul:v_proj:L22                0.06     0.0
matmul:k_proj:L7                 0.06     0.0
matmul:v_proj:L10                0.06     0.0
matmul:k_proj:L10                0.06     0.0
matmul:v_proj:L7                 0.06     0.0
matmul:k_proj:L11                0.06     0.0
matmul:k_proj:L24                0.06     0.0
matmul:v_proj:L24                0.06     0.0
matmul:k_proj:L25                0.06     0.0
matmul:v_proj:L11                0.05     0.0
matmul:k_proj:L0                 0.05     0.0
matmul:v_proj:L0                 0.05     0.0
matmul:k_proj:L12                0.05     0.0
matmul:v_proj:L25                0.05     0.0
matmul:v_proj:L12                0.05     0.0
matmul:k_proj:L20                0.05     0.0
matmul:k_proj:L21                0.05     0.0
matmul:k_proj:L14                0.05     0.0
matmul:v_proj:L15                0.05     0.0
matmul:v_proj:L21                0.05     0.0
matmul:v_proj:L19                0.05     0.0
matmul:k_proj:L15                0.05     0.0
matmul:k_proj:L16                0.05     0.0
matmul:v_proj:L16                0.04     0.0
matmul:k_proj:L9                 0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:k_proj:L5                 0.04     0.0
matmul:v_proj:L17                0.04     0.0
matmul:k_proj:L23                0.04     0.0
matmul:v_proj:L9                 0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:k_proj:L2                 0.04     0.0
matmul:v_proj:L23                0.04     0.0
matmul:k_proj:L1                 0.04     0.0
matmul:k_proj:L13                0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:v_proj:L5                 0.04     0.0
matmul:v_proj:L14                0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:k_proj:L17                0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:k_proj:L19                0.04     0.0
matmul:k_proj:L18                0.04     0.0
matmul:k_proj:L4                 0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:k_proj:L3                 0.04     0.0
matmul:v_proj:L18                0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:v_proj:L4                 0.04     0.0
gather                           0.02     0.0
scale                            0.02     0.0
──────────────────────────────────────────────────
TOTAL                          768.30   100.0

[browser:warning] [42842.5ms][Profile] Batch decode (N=4):
[browser:warning] [42842.7ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      446.09    57.5
fused_ffn                       40.83     5.3
matmul:lm_head                  30.32     3.9
matmul_rmsnorm_fused:L22.ffn_down       10.55     1.4
matmul_rmsnorm_fused:L7.ffn_down       10.43     1.3
matmul_rmsnorm_fused:L8.ffn_down       10.40     1.3
matmul_rmsnorm_fused:L3.ffn_down       10.31     1.3
matmul_rmsnorm_fused:L16.ffn_down       10.20     1.3
matmul_rmsnorm_fused:L12.ffn_down       10.11     1.3
matmul_rmsnorm_fused:L18.ffn_down        9.72     1.3
matmul_rmsnorm_fused:L13.ffn_down        9.62     1.2
matmul_rmsnorm_fused:L4.ffn_down        9.59     1.2
matmul_rmsnorm_fused:L17.ffn_down        9.50     1.2
matmul_rmsnorm_fused:L23.ffn_down        9.46     1.2
matmul_rmsnorm_fused:L9.ffn_down        9.35     1.2
matmul_rmsnorm_fused:L2.ffn_down        9.05     1.2
matmul_rmsnorm_fused:L21.ffn_down        8.94     1.2
matmul_rmsnorm_fused:L5.ffn_down        8.81     1.1
matmul_rmsnorm_fused:L10.ffn_down        8.79     1.1
matmul_rmsnorm_fused:L0.ffn_down        8.76     1.1
matmul_rmsnorm_fused:L25.ffn_down        8.72     1.1
matmul_rmsnorm_fused:L15.ffn_down        8.72     1.1
matmul_rmsnorm_fused:L1.ffn_down        8.68     1.1
matmul_rmsnorm_fused:L11.ffn_down        8.67     1.1
matmul_rmsnorm_fused:L6.ffn_down        8.66     1.1
matmul_rmsnorm_fused:L24.ffn_down        8.65     1.1
matmul_rmsnorm_fused:L20.ffn_down        8.65     1.1
matmul_rmsnorm_fused:L14.ffn_down        8.65     1.1
matmul_rmsnorm_fused:L19.ffn_down        8.61     1.1
sample_phase2                    3.29     0.4
rmsnorm                          3.14     0.4
rope                             0.81     0.1
matmul:o_proj:L12                0.22     0.0
matmul:q_proj:L0                 0.22     0.0
matmul:o_proj:L17                0.18     0.0
matmul:o_proj:L9                 0.17     0.0
matmul:o_proj:L13                0.17     0.0
matmul:o_proj:L21                0.16     0.0
matmul:q_proj:L19                0.16     0.0
matmul:q_proj:L5                 0.15     0.0
matmul:o_proj:L0                 0.15     0.0
matmul:o_proj:L14                0.15     0.0
matmul:o_proj:L24                0.15     0.0
matmul:o_proj:L8                 0.15     0.0
matmul:o_proj:L4                 0.15     0.0
matmul:o_proj:L2                 0.15     0.0
matmul:o_proj:L22                0.15     0.0
matmul:o_proj:L23                0.15     0.0
matmul:o_proj:L7                 0.15     0.0
matmul:o_proj:L18                0.14     0.0
matmul:o_proj:L3                 0.14     0.0
matmul:o_proj:L16                0.14     0.0
matmul:q_proj:L13                0.14     0.0
matmul:q_proj:L9                 0.14     0.0
matmul:o_proj:L6                 0.14     0.0
matmul:o_proj:L1                 0.14     0.0
matmul:o_proj:L5                 0.14     0.0
matmul:o_proj:L25                0.14     0.0
matmul:q_proj:L4                 0.14     0.0
matmul:q_proj:L17                0.14     0.0
matmul:o_proj:L15                0.14     0.0
matmul:o_proj:L20                0.14     0.0
matmul:o_proj:L19                0.13     0.0
matmul:q_proj:L3                 0.13     0.0
matmul:q_proj:L22                0.13     0.0
matmul:o_proj:L10                0.13     0.0
matmul:q_proj:L18                0.13     0.0
matmul:q_proj:L8                 0.13     0.0
matmul:o_proj:L11                0.13     0.0
matmul:q_proj:L6                 0.13     0.0
matmul:q_proj:L25                0.13     0.0
matmul:q_proj:L21                0.13     0.0
matmul:q_proj:L7                 0.13     0.0
matmul:q_proj:L12                0.13     0.0
matmul:q_proj:L2                 0.12     0.0
matmul:q_proj:L16                0.12     0.0
matmul:q_proj:L15                0.12     0.0
matmul:q_proj:L20                0.12     0.0
matmul:q_proj:L14                0.12     0.0
matmul:q_proj:L11                0.12     0.0
matmul:q_proj:L23                0.12     0.0
matmul:q_proj:L24                0.12     0.0
matmul:q_proj:L1                 0.12     0.0
matmul:q_proj:L10                0.12     0.0
sample_phase1                    0.09     0.0
matmul:k_proj:L0                 0.09     0.0
matmul:v_proj:L0                 0.08     0.0
sample_phase3                    0.07     0.0
matmul:k_proj:L19                0.07     0.0
matmul:k_proj:L5                 0.06     0.0
matmul:v_proj:L5                 0.06     0.0
matmul:v_proj:L19                0.06     0.0
matmul:k_proj:L9                 0.06     0.0
matmul:v_proj:L9                 0.05     0.0
matmul:k_proj:L4                 0.05     0.0
matmul:v_proj:L13                0.05     0.0
matmul:k_proj:L13                0.05     0.0
matmul:k_proj:L17                0.05     0.0
matmul:v_proj:L4                 0.05     0.0
matmul:v_proj:L17                0.05     0.0
matmul:k_proj:L11                0.05     0.0
matmul:k_proj:L18                0.05     0.0
matmul:k_proj:L3                 0.05     0.0
matmul:k_proj:L10                0.05     0.0
matmul:k_proj:L22                0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:k_proj:L16                0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:k_proj:L7                 0.04     0.0
matmul:v_proj:L18                0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:k_proj:L21                0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:k_proj:L12                0.04     0.0
matmul:k_proj:L24                0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:k_proj:L20                0.04     0.0
matmul:v_proj:L22                0.04     0.0
matmul:v_proj:L14                0.04     0.0
matmul:k_proj:L14                0.04     0.0
matmul:k_proj:L15                0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:k_proj:L23                0.04     0.0
matmul:v_proj:L16                0.04     0.0
matmul:v_proj:L24                0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:k_proj:L2                 0.04     0.0
matmul:k_proj:L1                 0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:v_proj:L23                0.04     0.0
gather                           0.04     0.0
scale                            0.04     0.0
──────────────────────────────────────────────────
TOTAL                          776.14   100.0

[browser:warning] [43684.5ms][Profile] Batch decode (N=4):
[browser:warning] [43684.7ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      453.60    57.4
fused_ffn                       41.14     5.2
matmul:lm_head                  30.84     3.9
matmul_rmsnorm_fused:L22.ffn_down       14.00     1.8
matmul_rmsnorm_fused:L4.ffn_down       13.67     1.7
matmul_rmsnorm_fused:L13.ffn_down       12.14     1.5
matmul_rmsnorm_fused:L17.ffn_down       10.62     1.3
matmul_rmsnorm_fused:L8.ffn_down       10.59     1.3
matmul_rmsnorm_fused:L3.ffn_down       10.55     1.3
matmul_rmsnorm_fused:L5.ffn_down        9.22     1.2
matmul_rmsnorm_fused:L6.ffn_down        9.07     1.1
matmul_rmsnorm_fused:L18.ffn_down        9.06     1.1
matmul_rmsnorm_fused:L2.ffn_down        9.02     1.1
matmul_rmsnorm_fused:L11.ffn_down        8.98     1.1
matmul_rmsnorm_fused:L7.ffn_down        8.83     1.1
matmul_rmsnorm_fused:L9.ffn_down        8.78     1.1
matmul_rmsnorm_fused:L21.ffn_down        8.77     1.1
matmul_rmsnorm_fused:L20.ffn_down        8.73     1.1
matmul_rmsnorm_fused:L25.ffn_down        8.69     1.1
matmul_rmsnorm_fused:L12.ffn_down        8.68     1.1
matmul_rmsnorm_fused:L16.ffn_down        8.66     1.1
matmul_rmsnorm_fused:L24.ffn_down        8.66     1.1
matmul_rmsnorm_fused:L14.ffn_down        8.65     1.1
matmul_rmsnorm_fused:L10.ffn_down        8.65     1.1
matmul_rmsnorm_fused:L1.ffn_down        8.65     1.1
matmul_rmsnorm_fused:L19.ffn_down        8.65     1.1
matmul_rmsnorm_fused:L0.ffn_down        8.64     1.1
matmul_rmsnorm_fused:L23.ffn_down        8.62     1.1
matmul_rmsnorm_fused:L15.ffn_down        8.59     1.1
sample_phase2                    3.26     0.4
rmsnorm                          3.19     0.4
rope                             0.84     0.1
matmul:o_proj:L13                0.21     0.0
matmul:q_proj:L18                0.21     0.0
matmul:o_proj:L22                0.18     0.0
matmul:o_proj:L18                0.18     0.0
matmul:q_proj:L0                 0.18     0.0
matmul:o_proj:L8                 0.18     0.0
matmul:o_proj:L0                 0.17     0.0
matmul:q_proj:L9                 0.17     0.0
matmul:q_proj:L23                0.17     0.0
matmul:o_proj:L17                0.16     0.0
matmul:o_proj:L4                 0.16     0.0
matmul:o_proj:L23                0.15     0.0
matmul:o_proj:L3                 0.15     0.0
matmul:o_proj:L5                 0.15     0.0
matmul:o_proj:L9                 0.15     0.0
matmul:o_proj:L25                0.15     0.0
matmul:o_proj:L6                 0.15     0.0
matmul:o_proj:L10                0.15     0.0
matmul:o_proj:L12                0.14     0.0
matmul:o_proj:L16                0.14     0.0
matmul:o_proj:L21                0.14     0.0
matmul:q_proj:L5                 0.14     0.0
matmul:q_proj:L4                 0.14     0.0
matmul:o_proj:L1                 0.14     0.0
matmul:o_proj:L7                 0.14     0.0
matmul:q_proj:L14                0.14     0.0
matmul:o_proj:L2                 0.14     0.0
matmul:o_proj:L15                0.14     0.0
matmul:q_proj:L8                 0.13     0.0
matmul:q_proj:L13                0.13     0.0
matmul:o_proj:L11                0.13     0.0
matmul:o_proj:L14                0.13     0.0
matmul:o_proj:L20                0.13     0.0
matmul:o_proj:L24                0.13     0.0
matmul:q_proj:L22                0.13     0.0
matmul:q_proj:L6                 0.13     0.0
matmul:q_proj:L10                0.13     0.0
matmul:q_proj:L7                 0.13     0.0
matmul:q_proj:L17                0.13     0.0
matmul:q_proj:L24                0.13     0.0
matmul:q_proj:L3                 0.13     0.0
matmul:q_proj:L2                 0.13     0.0
matmul:q_proj:L11                0.13     0.0
matmul:q_proj:L20                0.12     0.0
matmul:o_proj:L19                0.12     0.0
matmul:q_proj:L25                0.12     0.0
matmul:q_proj:L12                0.12     0.0
matmul:q_proj:L1                 0.12     0.0
matmul:q_proj:L16                0.12     0.0
matmul:q_proj:L21                0.12     0.0
matmul:q_proj:L15                0.12     0.0
matmul:q_proj:L19                0.12     0.0
matmul:k_proj:L18                0.08     0.0
matmul:v_proj:L18                0.08     0.0
sample_phase1                    0.08     0.0
matmul:v_proj:L23                0.07     0.0
matmul:v_proj:L0                 0.07     0.0
matmul:k_proj:L23                0.07     0.0
matmul:k_proj:L0                 0.07     0.0
matmul:v_proj:L9                 0.06     0.0
matmul:k_proj:L9                 0.06     0.0
sample_phase3                    0.06     0.0
matmul:k_proj:L5                 0.05     0.0
matmul:v_proj:L5                 0.05     0.0
matmul:k_proj:L14                0.05     0.0
matmul:v_proj:L14                0.05     0.0
matmul:k_proj:L25                0.05     0.0
matmul:k_proj:L4                 0.05     0.0
matmul:v_proj:L4                 0.05     0.0
matmul:k_proj:L13                0.05     0.0
matmul:k_proj:L22                0.05     0.0
matmul:k_proj:L8                 0.04     0.0
matmul:v_proj:L20                0.04     0.0
matmul:k_proj:L3                 0.04     0.0
matmul:k_proj:L7                 0.04     0.0
matmul:v_proj:L6                 0.04     0.0
matmul:v_proj:L2                 0.04     0.0
matmul:v_proj:L7                 0.04     0.0
matmul:k_proj:L6                 0.04     0.0
matmul:k_proj:L17                0.04     0.0
matmul:v_proj:L17                0.04     0.0
matmul:k_proj:L11                0.04     0.0
matmul:k_proj:L10                0.04     0.0
matmul:v_proj:L13                0.04     0.0
matmul:k_proj:L20                0.04     0.0
matmul:k_proj:L1                 0.04     0.0
matmul:v_proj:L25                0.04     0.0
matmul:k_proj:L16                0.04     0.0
matmul:v_proj:L22                0.04     0.0
matmul:v_proj:L8                 0.04     0.0
matmul:v_proj:L10                0.04     0.0
matmul:v_proj:L16                0.04     0.0
matmul:k_proj:L12                0.04     0.0
matmul:v_proj:L3                 0.04     0.0
matmul:k_proj:L15                0.04     0.0
matmul:v_proj:L12                0.04     0.0
matmul:v_proj:L15                0.04     0.0
matmul:k_proj:L21                0.04     0.0
matmul:v_proj:L11                0.04     0.0
matmul:k_proj:L24                0.04     0.0
matmul:v_proj:L21                0.04     0.0
matmul:k_proj:L19                0.04     0.0
matmul:k_proj:L2                 0.04     0.0
matmul:v_proj:L24                0.04     0.0
matmul:v_proj:L1                 0.04     0.0
matmul:v_proj:L19                0.04     0.0
scale                            0.02     0.0
gather                           0.01     0.0
──────────────────────────────────────────────────
TOTAL                          790.14   100.0

[browser:warning] [44316.0ms][Profile] Batch decode (N=3):
[browser:warning] [44316.1ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      344.47    58.0
fused_ffn                       29.81     5.0
matmul:lm_head                  23.38     3.9
matmul_rmsnorm_fused:L22.ffn_down       11.58     2.0
matmul_rmsnorm_fused:L13.ffn_down        9.75     1.6
matmul_rmsnorm_fused:L8.ffn_down        8.65     1.5
matmul_rmsnorm_fused:L4.ffn_down        8.34     1.4
matmul_rmsnorm_fused:L0.ffn_down        7.31     1.2
matmul_rmsnorm_fused:L17.ffn_down        6.85     1.2
matmul_rmsnorm_fused:L21.ffn_down        6.63     1.1
matmul_rmsnorm_fused:L25.ffn_down        6.57     1.1
matmul_rmsnorm_fused:L3.ffn_down        6.55     1.1
matmul_rmsnorm_fused:L24.ffn_down        6.55     1.1
matmul_rmsnorm_fused:L16.ffn_down        6.54     1.1
matmul_rmsnorm_fused:L9.ffn_down        6.52     1.1
matmul_rmsnorm_fused:L6.ffn_down        6.52     1.1
matmul_rmsnorm_fused:L10.ffn_down        6.51     1.1
matmul_rmsnorm_fused:L12.ffn_down        6.51     1.1
matmul_rmsnorm_fused:L14.ffn_down        6.50     1.1
matmul_rmsnorm_fused:L7.ffn_down        6.50     1.1
matmul_rmsnorm_fused:L1.ffn_down        6.50     1.1
matmul_rmsnorm_fused:L5.ffn_down        6.48     1.1
matmul_rmsnorm_fused:L18.ffn_down        6.48     1.1
matmul_rmsnorm_fused:L20.ffn_down        6.48     1.1
matmul_rmsnorm_fused:L15.ffn_down        6.48     1.1
matmul_rmsnorm_fused:L2.ffn_down        6.48     1.1
matmul_rmsnorm_fused:L11.ffn_down        6.48     1.1
matmul_rmsnorm_fused:L19.ffn_down        6.47     1.1
matmul_rmsnorm_fused:L23.ffn_down        6.46     1.1
sample_phase2                    2.46     0.4
rmsnorm                          2.36     0.4
rope                             0.61     0.1
matmul:o_proj:L22                0.32     0.1
matmul:o_proj:L4                 0.17     0.0
matmul:q_proj:L0                 0.15     0.0
matmul:q_proj:L9                 0.15     0.0
matmul:o_proj:L13                0.15     0.0
matmul:q_proj:L18                0.15     0.0
matmul:o_proj:L3                 0.12     0.0
matmul:o_proj:L0                 0.12     0.0
matmul:o_proj:L25                0.12     0.0
matmul:o_proj:L17                0.12     0.0
matmul:o_proj:L8                 0.12     0.0
matmul:q_proj:L14                0.11     0.0
matmul:o_proj:L1                 0.11     0.0
matmul:o_proj:L18                0.11     0.0
matmul:o_proj:L20                0.11     0.0
matmul:o_proj:L12                0.11     0.0
matmul:o_proj:L9                 0.11     0.0
matmul:o_proj:L14                0.11     0.0
matmul:q_proj:L25                0.11     0.0
matmul:o_proj:L16                0.11     0.0
matmul:o_proj:L19                0.11     0.0
matmul:o_proj:L15                0.10     0.0
matmul:q_proj:L17                0.10     0.0
matmul:o_proj:L21                0.10     0.0
matmul:o_proj:L11                0.10     0.0
matmul:q_proj:L22                0.10     0.0
matmul:q_proj:L8                 0.10     0.0
matmul:o_proj:L7                 0.10     0.0
matmul:o_proj:L2                 0.10     0.0
matmul:q_proj:L23                0.10     0.0
matmul:q_proj:L13                0.10     0.0
matmul:o_proj:L23                0.10     0.0
matmul:q_proj:L11                0.10     0.0
matmul:q_proj:L4                 0.10     0.0
matmul:o_proj:L6                 0.10     0.0
matmul:o_proj:L10                0.09     0.0
matmul:q_proj:L21                0.09     0.0
matmul:o_proj:L5                 0.09     0.0
matmul:q_proj:L16                0.09     0.0
matmul:q_proj:L10                0.09     0.0
matmul:o_proj:L24                0.09     0.0
matmul:q_proj:L20                0.09     0.0
matmul:q_proj:L7                 0.09     0.0
matmul:q_proj:L12                0.09     0.0
matmul:q_proj:L19                0.09     0.0
matmul:q_proj:L5                 0.09     0.0
matmul:q_proj:L15                0.09     0.0
matmul:q_proj:L1                 0.09     0.0
matmul:q_proj:L2                 0.09     0.0
matmul:q_proj:L3                 0.09     0.0
matmul:q_proj:L24                0.09     0.0
matmul:q_proj:L6                 0.09     0.0
matmul:v_proj:L9                 0.07     0.0
matmul:k_proj:L9                 0.07     0.0
sample_phase1                    0.06     0.0
sample_phase3                    0.06     0.0
matmul:k_proj:L18                0.06     0.0
matmul:k_proj:L0                 0.06     0.0
matmul:v_proj:L0                 0.06     0.0
matmul:v_proj:L18                0.05     0.0
matmul:v_proj:L14                0.04     0.0
matmul:k_proj:L14                0.04     0.0
matmul:k_proj:L21                0.04     0.0
matmul:k_proj:L25                0.04     0.0
matmul:k_proj:L8                 0.03     0.0
matmul:v_proj:L25                0.03     0.0
matmul:v_proj:L8                 0.03     0.0
matmul:k_proj:L17                0.03     0.0
matmul:v_proj:L21                0.03     0.0
matmul:v_proj:L17                0.03     0.0
matmul:k_proj:L23                0.03     0.0
matmul:k_proj:L22                0.03     0.0
matmul:k_proj:L4                 0.03     0.0
matmul:k_proj:L12                0.03     0.0
matmul:k_proj:L10                0.03     0.0
matmul:k_proj:L11                0.03     0.0
matmul:v_proj:L4                 0.03     0.0
matmul:k_proj:L13                0.03     0.0
matmul:v_proj:L22                0.03     0.0
matmul:v_proj:L12                0.03     0.0
matmul:k_proj:L2                 0.03     0.0
matmul:v_proj:L7                 0.03     0.0
matmul:v_proj:L23                0.03     0.0
matmul:v_proj:L11                0.03     0.0
matmul:v_proj:L3                 0.03     0.0
matmul:v_proj:L10                0.03     0.0
matmul:k_proj:L20                0.03     0.0
matmul:k_proj:L24                0.03     0.0
matmul:v_proj:L20                0.03     0.0
matmul:k_proj:L7                 0.03     0.0
matmul:v_proj:L13                0.03     0.0
matmul:k_proj:L15                0.03     0.0
matmul:v_proj:L15                0.03     0.0
matmul:k_proj:L19                0.03     0.0
matmul:v_proj:L16                0.03     0.0
matmul:k_proj:L16                0.03     0.0
matmul:k_proj:L1                 0.03     0.0
matmul:v_proj:L19                0.03     0.0
matmul:k_proj:L5                 0.03     0.0
matmul:v_proj:L5                 0.03     0.0
matmul:k_proj:L3                 0.03     0.0
matmul:k_proj:L6                 0.03     0.0
matmul:v_proj:L6                 0.03     0.0
matmul:v_proj:L1                 0.03     0.0
matmul:v_proj:L2                 0.03     0.0
matmul:v_proj:L24                0.03     0.0
gather                           0.03     0.0
scale                            0.02     0.0
──────────────────────────────────────────────────
TOTAL                          593.57   100.0

[browser:log] [44316.4ms][Perf] TTFT: 308ms | Prefill: 192ms | Decode: 40472ms (255 tokens @ 6.3 tok/s)
[browser:log] [44316.6ms][Pipeline] Unloaded
[ok] debug model=gemma-3-1b-it passed=1 failed=0 duration=44124.1ms
[metrics] prompt="Summarize this input in one sentence."
[metrics] load=3343.5ms prefillTokens=9 decodeTokens=256 maxTokens=256
[metrics] ttft=308.1ms prefill=191.8ms decode=40471.5ms total=40780.1ms
[metrics] tok/s total=6.28 prefill=46.92 decode=6.33
