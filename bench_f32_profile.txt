[progress] browser launching WebGPU harness...
[progress] browser resolved modelUrl=/models/local/gemma-3-1b-it
[browser:error] Failed to load resource: the server responded with a status of 404 (Not Found)
[browser:log] [204.4ms][OPFSCache] Cache hit: "gemma-3-1b-it"
[browser:log] [GPU] apple metal-3, f16/subgroups, 4.0GB
[browser:log] [217.9ms][Config] Using manifest-first config (source of truth)
[browser:log] [218.6ms][Pipeline] KernelPath: gemma3-f16-f32a (15 decode steps, 9 kernels, source=config)
[browser:log] [218.7ms][Pipeline] KernelPath gemma3-f16-f32a runtime dtype overrides: activation=f16->f32
[browser:log] [218.8ms][Pipeline] 26L/1152H/4heads (256dim), kernelPath=gemma3-f16-f32a
[browser:log] [219.0ms][Tokenizer] Loading bundled tokenizer from tokenizer.json
[browser:log] [355.3ms][Tokenizer] HuggingFace model.type="BPE", using type="bpe"
[browser:log] [585.3ms][Tokenizer] Loaded HuggingFace 262145 tokens (bpe), 9 special patterns, 514906 merges
[browser:log] [585.4ms][Pipeline] Tokenizer vocabSize=262145 differs from model=262144, using model size
[browser:log] [586.0ms][Loader] Initializing...
[browser:log] [618.1ms][HeapManager] Allocated segment 0: 1024MB
[browser:log] [618.2ms][HeapManager] Segmented heap: 1GB per segment
[browser:log] [618.2ms][HeapManager] Initialized with strategy: SEGMENTED
[browser:log] [618.3ms][Loader] Initialized (f16, subgroups, unified)
[browser:log] [618.5ms][Loader] Loading: gemma-3-1b-it
[browser:log] [618.8ms][Loader] [0.0s] Memory (start): | Heap=2.05 GB/2.05 GB (limit=4.00 GB) | GPU=0 B (0 active, 0 pooled, peak=0 B) | ShardCache=0 B (0 shards) | Layers=0, GPUBuffers=0
[browser:log] [2485.0ms][Loader] Embeddings tensor loaded: name=model.embed_tokens.weight, hasShape=true, shape=[262144,1152], isWeightBuffer=true
[browser:log] [2485.2ms][Loader] Layers: 0-25
[browser:log] [3252.8ms][Loader] Layers: 26 complete (0.77s)
[browser:warning] [3257.6ms][Loader] [FinalNorm] Falling back to role-only final norm selection because tensor groups are missing in manifest.
[browser:log] [3258.5ms][Loader] Complete: 0 B in 1.16s (0 B/s)
[browser:log] [3258.7ms][Loader] [2.6s] Memory (complete): | Heap=1.18 GB/1.19 GB (limit=4.00 GB) | GPU=2.04 GB (340 active, 0 pooled, peak=2.04 GB) | ShardCache=0 B (0 shards) | Layers=26, GPUBuffers=340
[browser:log] [3418.5ms][Pipeline] Model loaded successfully
[browser:warning] [3419.7ms][CommandRecorder] maxQuerySetSize unavailable; using fallback 4096
[browser:log] [3431.3ms][KernelSelect] matmul variant=f16w_f32a reason=path_override
[browser:log] [3436.8ms][KernelSelect] attention variant=prefill_streaming_f16kv reason=path_override:streaming
[browser:warning] [3591.1ms][Profile] Prefill (prefill):
[browser:warning] [3591.4ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
matmul:lm_head                  24.30    19.3
attention                       22.06    17.5
matmul:ffn_down:L0               3.17     2.5
matmul:ffn_gate:L0               2.60     2.1
matmul:ffn_up:L0                 2.58     2.1
matmul:ffn_down:L2               1.36     1.1
rmsnorm                          1.30     1.0
matmul:ffn_up:L6                 1.24     1.0
matmul:ffn_gate:L25              1.23     1.0
matmul:ffn_down:L21              1.18     0.9
matmul:ffn_down:L1               1.08     0.9
matmul:ffn_down:L15              1.05     0.8
matmul:ffn_down:L11              1.01     0.8
matmul:ffn_down:L20              1.00     0.8
matmul:ffn_down:L22              0.91     0.7
matmul:ffn_down:L10              0.85     0.7
matmul:ffn_down:L16              0.83     0.7
matmul:ffn_down:L13              0.83     0.7
matmul:ffn_down:L4               0.83     0.7
matmul:ffn_down:L18              0.83     0.7
matmul:ffn_down:L5               0.83     0.7
matmul:ffn_down:L24              0.83     0.7
matmul:ffn_down:L9               0.83     0.7
matmul:ffn_down:L25              0.83     0.7
matmul:ffn_down:L17              0.82     0.7
matmul:ffn_down:L6               0.82     0.7
matmul:ffn_down:L19              0.82     0.7
matmul:ffn_down:L12              0.82     0.7
matmul:ffn_down:L7               0.82     0.7
matmul:ffn_down:L23              0.82     0.7
matmul:ffn_down:L14              0.82     0.7
matmul:ffn_down:L3               0.82     0.7
matmul:ffn_down:L8               0.82     0.7
matmul:ffn_up:L2                 0.81     0.6
matmul:ffn_gate:L2               0.78     0.6
matmul:ffn_gate:L20              0.74     0.6
matmul:ffn_up:L20                0.73     0.6
matmul:ffn_gate:L21              0.70     0.6
matmul:ffn_up:L21                0.70     0.6
matmul:ffn_up:L1                 0.69     0.5
matmul:ffn_gate:L1               0.69     0.5
matmul:ffn_gate:L3               0.68     0.5
matmul:ffn_gate:L11              0.68     0.5
matmul:ffn_up:L11                0.68     0.5
matmul:ffn_gate:L22              0.67     0.5
matmul:ffn_up:L10                0.66     0.5
matmul:ffn_gate:L9               0.66     0.5
matmul:ffn_up:L4                 0.66     0.5
matmul:ffn_gate:L13              0.66     0.5
matmul:ffn_up:L3                 0.66     0.5
matmul:ffn_up:L18                0.66     0.5
matmul:ffn_gate:L4               0.66     0.5
matmul:ffn_up:L22                0.66     0.5
matmul:ffn_up:L15                0.66     0.5
matmul:ffn_gate:L10              0.66     0.5
matmul:ffn_gate:L15              0.66     0.5
matmul:ffn_up:L9                 0.66     0.5
matmul:ffn_gate:L6               0.66     0.5
matmul:ffn_gate:L18              0.66     0.5
matmul:ffn_up:L14                0.66     0.5
matmul:ffn_up:L19                0.66     0.5
matmul:ffn_up:L25                0.66     0.5
matmul:ffn_up:L5                 0.66     0.5
matmul:ffn_up:L13                0.65     0.5
matmul:ffn_up:L17                0.65     0.5
matmul:ffn_gate:L19              0.65     0.5
matmul:ffn_gate:L7               0.65     0.5
matmul:ffn_gate:L12              0.65     0.5
matmul:ffn_gate:L23              0.65     0.5
matmul:ffn_up:L24                0.65     0.5
matmul:ffn_up:L8                 0.65     0.5
matmul:ffn_gate:L14              0.65     0.5
matmul:ffn_up:L7                 0.65     0.5
matmul:ffn_gate:L24              0.65     0.5
matmul:ffn_gate:L5               0.65     0.5
matmul:ffn_gate:L16              0.65     0.5
matmul:ffn_gate:L8               0.65     0.5
matmul:ffn_up:L12                0.65     0.5
matmul:ffn_up:L23                0.65     0.5
matmul:ffn_gate:L17              0.65     0.5
matmul:ffn_up:L16                0.65     0.5
matmul:o_proj:L0                 0.60     0.5
matmul:q_proj:L0                 0.48     0.4
matmul:q_proj:L1                 0.47     0.4
rope                             0.24     0.2
matmul:o_proj:L2                 0.24     0.2
matmul:k_proj:L0                 0.21     0.2
matmul:v_proj:L0                 0.21     0.2
gelu                             0.21     0.2
matmul:k_proj:L1                 0.20     0.2
matmul:v_proj:L1                 0.20     0.2
cast_f32_to_f16                  0.20     0.2
matmul:q_proj:L12                0.19     0.2
matmul:q_proj:L3                 0.17     0.1
matmul:o_proj:L21                0.16     0.1
matmul:k_proj:L3                 0.16     0.1
matmul:q_proj:L2                 0.15     0.1
matmul:v_proj:L12                0.15     0.1
matmul:q_proj:L21                0.14     0.1
matmul:v_proj:L11                0.14     0.1
matmul:o_proj:L11                0.14     0.1
matmul:o_proj:L3                 0.13     0.1
matmul:o_proj:L1                 0.13     0.1
matmul:q_proj:L22                0.13     0.1
matmul:o_proj:L15                0.13     0.1
matmul:o_proj:L9                 0.13     0.1
matmul:o_proj:L20                0.13     0.1
matmul:o_proj:L13                0.13     0.1
matmul:o_proj:L22                0.13     0.1
matmul:o_proj:L5                 0.13     0.1
matmul:o_proj:L8                 0.13     0.1
matmul:o_proj:L18                0.13     0.1
matmul:q_proj:L23                0.12     0.1
matmul:q_proj:L18                0.12     0.1
matmul:o_proj:L7                 0.12     0.1
matmul:q_proj:L20                0.12     0.1
matmul:q_proj:L5                 0.12     0.1
matmul:o_proj:L14                0.12     0.1
matmul:q_proj:L11                0.12     0.1
matmul:q_proj:L17                0.12     0.1
matmul:q_proj:L19                0.12     0.1
matmul:q_proj:L16                0.12     0.1
matmul:q_proj:L8                 0.12     0.1
matmul:q_proj:L9                 0.12     0.1
matmul:o_proj:L6                 0.12     0.1
matmul:q_proj:L10                0.12     0.1
matmul:q_proj:L7                 0.12     0.1
matmul:q_proj:L14                0.12     0.1
matmul:q_proj:L25                0.12     0.1
matmul:q_proj:L4                 0.12     0.1
matmul:o_proj:L12                0.12     0.1
matmul:q_proj:L6                 0.12     0.1
matmul:o_proj:L10                0.12     0.1
matmul:q_proj:L24                0.12     0.1
matmul:k_proj:L12                0.12     0.1
matmul:q_proj:L13                0.12     0.1
matmul:q_proj:L15                0.12     0.1
matmul:o_proj:L19                0.12     0.1
matmul:o_proj:L23                0.12     0.1
matmul:o_proj:L17                0.12     0.1
matmul:o_proj:L16                0.12     0.1
matmul:o_proj:L24                0.12     0.1
matmul:o_proj:L25                0.12     0.1
matmul:o_proj:L4                 0.12     0.1
matmul:k_proj:L11                0.11     0.1
matmul:v_proj:L3                 0.10     0.1
matmul:v_proj:L21                0.10     0.1
matmul:k_proj:L2                 0.09     0.1
matmul:k_proj:L21                0.09     0.1
matmul:v_proj:L2                 0.08     0.1
matmul:k_proj:L22                0.06     0.0
matmul:k_proj:L7                 0.06     0.0
matmul:k_proj:L16                0.06     0.0
matmul:v_proj:L20                0.06     0.0
matmul:v_proj:L22                0.06     0.0
matmul:k_proj:L5                 0.06     0.0
matmul:k_proj:L6                 0.06     0.0
matmul:v_proj:L18                0.06     0.0
matmul:k_proj:L19                0.06     0.0
matmul:k_proj:L23                0.06     0.0
matmul:k_proj:L9                 0.06     0.0
matmul:v_proj:L23                0.06     0.0
matmul:k_proj:L10                0.06     0.0
matmul:k_proj:L20                0.06     0.0
matmul:k_proj:L25                0.06     0.0
matmul:v_proj:L19                0.06     0.0
matmul:v_proj:L25                0.06     0.0
matmul:v_proj:L17                0.06     0.0
matmul:v_proj:L6                 0.06     0.0
matmul:k_proj:L18                0.06     0.0
matmul:v_proj:L9                 0.06     0.0
matmul:k_proj:L17                0.06     0.0
matmul:v_proj:L5                 0.06     0.0
matmul:v_proj:L4                 0.06     0.0
matmul:v_proj:L16                0.06     0.0
matmul:k_proj:L14                0.06     0.0
matmul:k_proj:L4                 0.06     0.0
matmul:k_proj:L15                0.06     0.0
matmul:v_proj:L10                0.06     0.0
matmul:v_proj:L14                0.06     0.0
matmul:v_proj:L8                 0.06     0.0
matmul:k_proj:L13                0.06     0.0
matmul:k_proj:L8                 0.06     0.0
matmul:k_proj:L24                0.06     0.0
matmul:v_proj:L7                 0.06     0.0
matmul:v_proj:L24                0.06     0.0
matmul:v_proj:L13                0.06     0.0
matmul:v_proj:L15                0.06     0.0
gather                           0.01     0.0
scale                            0.01     0.0
──────────────────────────────────────────────────
TOTAL                          125.93   100.0

[browser:log] [3716.9ms][KernelSelect] attention variant=decode_chunked_f16kv reason=path_override:streaming
[browser:warning] [4190.7ms][Profile] Batch decode (N=4):
[browser:warning] [4191.0ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
matmul:lm_head                  97.92    24.3
attention                       21.08     5.2
rmsnorm                          5.10     1.3
matmul:ffn_down:L14              3.90     1.0
matmul:ffn_down:L12              3.80     0.9
matmul:ffn_down:L13              3.73     0.9
matmul:ffn_down:L1               3.72     0.9
matmul:ffn_down:L2               3.69     0.9
matmul:ffn_down:L25              3.63     0.9
matmul:ffn_down:L3               3.60     0.9
matmul:ffn_down:L24              3.55     0.9
matmul:ffn_down:L8               3.46     0.9
matmul:ffn_down:L23              3.43     0.9
matmul:ffn_down:L22              3.39     0.8
matmul:ffn_down:L21              3.36     0.8
matmul:ffn_down:L11              3.35     0.8
sample_phase2                    3.34     0.8
matmul:ffn_down:L7               3.34     0.8
matmul:ffn_down:L19              3.33     0.8
matmul:ffn_down:L0               3.32     0.8
matmul:ffn_down:L10              3.24     0.8
matmul:ffn_up:L12                3.23     0.8
matmul:ffn_down:L18              3.22     0.8
matmul:ffn_down:L20              3.22     0.8
matmul:ffn_down:L4               3.21     0.8
matmul:ffn_down:L9               3.21     0.8
matmul:ffn_down:L6               3.21     0.8
matmul:ffn_up:L6                 3.21     0.8
matmul:ffn_down:L16              3.21     0.8
matmul:ffn_down:L17              3.20     0.8
matmul:ffn_down:L5               3.20     0.8
matmul:ffn_down:L15              3.20     0.8
matmul:ffn_gate:L5               3.18     0.8
matmul:ffn_gate:L17              3.18     0.8
matmul:ffn_up:L16                3.13     0.8
matmul:ffn_up:L24                2.95     0.7
matmul:ffn_up:L23                2.89     0.7
matmul:ffn_up:L3                 2.83     0.7
matmul:ffn_gate:L14              2.82     0.7
matmul:ffn_up:L13                2.80     0.7
matmul:ffn_up:L1                 2.77     0.7
matmul:ffn_up:L14                2.76     0.7
matmul:ffn_gate:L24              2.75     0.7
matmul:ffn_gate:L2               2.74     0.7
matmul:ffn_gate:L3               2.74     0.7
matmul:ffn_up:L25                2.73     0.7
matmul:ffn_gate:L13              2.73     0.7
matmul:ffn_gate:L25              2.72     0.7
matmul:ffn_gate:L23              2.71     0.7
matmul:ffn_gate:L1               2.71     0.7
matmul:ffn_up:L2                 2.70     0.7
matmul:ffn_gate:L12              2.67     0.7
matmul:ffn_gate:L11              2.65     0.7
matmul:ffn_gate:L4               2.65     0.7
matmul:ffn_up:L0                 2.65     0.7
matmul:ffn_up:L11                2.65     0.7
matmul:ffn_gate:L0               2.64     0.7
matmul:ffn_gate:L22              2.64     0.7
matmul:ffn_up:L22                2.63     0.7
matmul:ffn_up:L8                 2.62     0.7
matmul:ffn_gate:L16              2.62     0.7
matmul:ffn_up:L4                 2.61     0.6
matmul:ffn_gate:L6               2.61     0.6
matmul:ffn_gate:L21              2.61     0.6
matmul:ffn_gate:L8               2.61     0.6
matmul:ffn_gate:L20              2.61     0.6
matmul:ffn_up:L5                 2.61     0.6
matmul:ffn_gate:L9               2.61     0.6
matmul:ffn_up:L10                2.61     0.6
matmul:ffn_gate:L15              2.61     0.6
matmul:ffn_up:L21                2.60     0.6
matmul:ffn_up:L18                2.60     0.6
matmul:ffn_up:L19                2.60     0.6
matmul:ffn_gate:L19              2.60     0.6
matmul:ffn_up:L7                 2.60     0.6
matmul:ffn_up:L9                 2.60     0.6
matmul:ffn_up:L20                2.60     0.6
matmul:ffn_gate:L10              2.60     0.6
matmul:ffn_gate:L7               2.60     0.6
matmul:ffn_gate:L18              2.60     0.6
matmul:ffn_up:L15                2.60     0.6
matmul:ffn_up:L17                2.60     0.6
rope                             1.23     0.3
gelu                             0.97     0.2
cast_f32_to_f16                  0.93     0.2
matmul:k_proj:L19                0.76     0.2
matmul:q_proj:L14                0.65     0.2
matmul:q_proj:L23                0.63     0.2
matmul:o_proj:L14                0.62     0.2
matmul:q_proj:L2                 0.60     0.2
matmul:q_proj:L3                 0.59     0.1
matmul:o_proj:L3                 0.58     0.1
matmul:q_proj:L0                 0.57     0.1
matmul:o_proj:L1                 0.55     0.1
matmul:o_proj:L23                0.54     0.1
matmul:q_proj:L22                0.54     0.1
matmul:q_proj:L25                0.53     0.1
matmul:o_proj:L2                 0.53     0.1
matmul:q_proj:L15                0.53     0.1
matmul:q_proj:L13                0.53     0.1
matmul:q_proj:L4                 0.53     0.1
matmul:o_proj:L13                0.52     0.1
matmul:o_proj:L25                0.52     0.1
matmul:o_proj:L12                0.52     0.1
matmul:o_proj:L4                 0.51     0.1
matmul:o_proj:L24                0.51     0.1
matmul:q_proj:L24                0.51     0.1
matmul:q_proj:L12                0.51     0.1
matmul:o_proj:L22                0.51     0.1
matmul:q_proj:L1                 0.51     0.1
matmul:o_proj:L0                 0.51     0.1
matmul:q_proj:L19                0.51     0.1
matmul:o_proj:L11                0.50     0.1
matmul:q_proj:L11                0.49     0.1
matmul:q_proj:L6                 0.49     0.1
matmul:q_proj:L8                 0.49     0.1
matmul:q_proj:L9                 0.49     0.1
matmul:o_proj:L15                0.49     0.1
matmul:q_proj:L5                 0.49     0.1
matmul:q_proj:L10                0.49     0.1
matmul:q_proj:L20                0.49     0.1
matmul:q_proj:L7                 0.49     0.1
matmul:q_proj:L17                0.49     0.1
matmul:q_proj:L16                0.49     0.1
matmul:o_proj:L9                 0.49     0.1
matmul:q_proj:L21                0.49     0.1
matmul:o_proj:L18                0.49     0.1
matmul:q_proj:L18                0.49     0.1
matmul:o_proj:L6                 0.49     0.1
matmul:o_proj:L5                 0.49     0.1
matmul:o_proj:L8                 0.49     0.1
matmul:o_proj:L20                0.49     0.1
matmul:o_proj:L10                0.48     0.1
matmul:o_proj:L7                 0.48     0.1
matmul:o_proj:L21                0.48     0.1
matmul:o_proj:L16                0.48     0.1
matmul:o_proj:L17                0.48     0.1
matmul:o_proj:L19                0.48     0.1
matmul:v_proj:L14                0.46     0.1
matmul:v_proj:L3                 0.40     0.1
matmul:k_proj:L14                0.39     0.1
matmul:k_proj:L3                 0.39     0.1
matmul:k_proj:L2                 0.35     0.1
matmul:k_proj:L13                0.32     0.1
matmul:v_proj:L2                 0.32     0.1
matmul:k_proj:L25                0.32     0.1
matmul:k_proj:L24                0.31     0.1
matmul:k_proj:L23                0.31     0.1
matmul:k_proj:L15                0.31     0.1
matmul:v_proj:L15                0.30     0.1
matmul:k_proj:L4                 0.30     0.1
matmul:v_proj:L4                 0.29     0.1
matmul:v_proj:L23                0.29     0.1
matmul:v_proj:L1                 0.28     0.1
matmul:k_proj:L1                 0.28     0.1
matmul:v_proj:L13                0.27     0.1
matmul:v_proj:L24                0.27     0.1
matmul:v_proj:L25                0.26     0.1
matmul:k_proj:L22                0.26     0.1
matmul:v_proj:L0                 0.26     0.1
matmul:v_proj:L12                0.25     0.1
matmul:k_proj:L12                0.25     0.1
matmul:v_proj:L22                0.25     0.1
matmul:k_proj:L0                 0.24     0.1
matmul:k_proj:L11                0.24     0.1
matmul:k_proj:L16                0.23     0.1
matmul:k_proj:L6                 0.23     0.1
matmul:v_proj:L11                0.23     0.1
matmul:k_proj:L20                0.23     0.1
matmul:k_proj:L8                 0.23     0.1
matmul:k_proj:L9                 0.23     0.1
matmul:k_proj:L21                0.23     0.1
matmul:k_proj:L5                 0.23     0.1
matmul:v_proj:L9                 0.23     0.1
matmul:k_proj:L18                0.23     0.1
matmul:v_proj:L8                 0.23     0.1
matmul:v_proj:L10                0.23     0.1
matmul:k_proj:L17                0.23     0.1
matmul:k_proj:L10                0.23     0.1
matmul:v_proj:L20                0.23     0.1
matmul:k_proj:L7                 0.23     0.1
matmul:v_proj:L6                 0.23     0.1
matmul:v_proj:L5                 0.22     0.1
matmul:v_proj:L7                 0.22     0.1
matmul:v_proj:L18                0.22     0.1
matmul:v_proj:L21                0.22     0.1
matmul:v_proj:L17                0.22     0.1
matmul:v_proj:L19                0.22     0.1
matmul:v_proj:L16                0.22     0.1
sample_phase1                    0.17     0.0
sample_phase3                    0.06     0.0
gather                           0.03     0.0
scale                            0.02     0.0
──────────────────────────────────────────────────
TOTAL                          402.21   100.0

[browser:warning] [4656.9ms][Profile] Batch decode (N=4):
[browser:warning] [4657.1ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
matmul:lm_head                  99.13    24.3
attention                       28.14     6.9
rmsnorm                          6.17     1.5
matmul:ffn_down:L21              3.85     0.9
matmul:ffn_down:L0               3.70     0.9
matmul:ffn_down:L4               3.59     0.9
matmul:ffn_down:L12              3.55     0.9
matmul:ffn_down:L2               3.55     0.9
matmul:ffn_down:L13              3.52     0.9
matmul:ffn_down:L23              3.51     0.9
sample_phase2                    3.48     0.9
matmul:ffn_down:L24              3.44     0.8
matmul:ffn_down:L10              3.41     0.8
matmul:ffn_down:L16              3.40     0.8
matmul:ffn_down:L22              3.33     0.8
matmul:ffn_down:L20              3.32     0.8
matmul:ffn_down:L25              3.32     0.8
matmul:ffn_down:L9               3.32     0.8
matmul:ffn_down:L8               3.31     0.8
matmul:ffn_down:L15              3.31     0.8
matmul:ffn_down:L3               3.30     0.8
matmul:ffn_down:L1               3.30     0.8
matmul:ffn_down:L11              3.29     0.8
matmul:ffn_up:L15                3.24     0.8
matmul:ffn_down:L18              3.22     0.8
matmul:ffn_down:L19              3.21     0.8
matmul:ffn_down:L6               3.20     0.8
matmul:ffn_down:L7               3.20     0.8
matmul:ffn_down:L14              3.20     0.8
matmul:ffn_down:L5               3.20     0.8
matmul:ffn_down:L17              3.19     0.8
matmul:ffn_up:L7                 3.19     0.8
matmul:ffn_gate:L17              3.18     0.8
matmul:ffn_gate:L6               3.18     0.8
matmul:ffn_gate:L10              3.04     0.7
matmul:ffn_up:L10                2.85     0.7
matmul:ffn_up:L16                2.78     0.7
matmul:ffn_up:L25                2.74     0.7
matmul:ffn_up:L23                2.70     0.7
matmul:ffn_gate:L12              2.69     0.7
matmul:ffn_up:L3                 2.69     0.7
matmul:ffn_up:L12                2.69     0.7
matmul:ffn_gate:L9               2.67     0.7
matmul:ffn_up:L0                 2.67     0.7
matmul:ffn_up:L20                2.66     0.7
matmul:ffn_gate:L0               2.66     0.7
matmul:ffn_gate:L22              2.66     0.7
matmul:ffn_up:L2                 2.66     0.7
matmul:ffn_gate:L1               2.65     0.6
matmul:ffn_up:L22                2.65     0.6
matmul:ffn_gate:L21              2.65     0.6
matmul:ffn_up:L4                 2.65     0.6
matmul:ffn_up:L1                 2.64     0.6
matmul:ffn_gate:L25              2.64     0.6
matmul:ffn_gate:L23              2.64     0.6
matmul:ffn_gate:L2               2.64     0.6
matmul:ffn_up:L13                2.64     0.6
matmul:ffn_up:L9                 2.64     0.6
matmul:ffn_gate:L15              2.64     0.6
matmul:ffn_gate:L4               2.64     0.6
matmul:ffn_up:L21                2.64     0.6
matmul:ffn_gate:L16              2.64     0.6
matmul:ffn_gate:L24              2.64     0.6
matmul:ffn_up:L11                2.63     0.6
matmul:ffn_gate:L5               2.63     0.6
matmul:ffn_up:L24                2.63     0.6
matmul:ffn_gate:L13              2.63     0.6
matmul:ffn_gate:L11              2.62     0.6
matmul:ffn_up:L5                 2.62     0.6
matmul:ffn_gate:L19              2.61     0.6
matmul:ffn_gate:L20              2.60     0.6
matmul:ffn_up:L19                2.60     0.6
matmul:ffn_up:L14                2.60     0.6
matmul:ffn_gate:L14              2.60     0.6
matmul:ffn_up:L18                2.60     0.6
matmul:ffn_gate:L7               2.60     0.6
matmul:ffn_gate:L3               2.60     0.6
matmul:ffn_gate:L18              2.60     0.6
matmul:ffn_up:L8                 2.60     0.6
matmul:ffn_gate:L8               2.60     0.6
matmul:ffn_up:L6                 2.60     0.6
matmul:ffn_up:L17                2.60     0.6
gelu                             1.00     0.2
rope                             0.93     0.2
cast_f32_to_f16                  0.77     0.2
matmul:q_proj:L13                0.58     0.1
matmul:o_proj:L0                 0.56     0.1
matmul:q_proj:L0                 0.56     0.1
matmul:q_proj:L11                0.56     0.1
matmul:q_proj:L23                0.55     0.1
matmul:q_proj:L22                0.55     0.1
matmul:q_proj:L17                0.53     0.1
matmul:o_proj:L15                0.53     0.1
matmul:o_proj:L16                0.53     0.1
matmul:q_proj:L14                0.53     0.1
matmul:q_proj:L24                0.53     0.1
matmul:q_proj:L5                 0.53     0.1
matmul:q_proj:L4                 0.53     0.1
matmul:q_proj:L25                0.53     0.1
matmul:o_proj:L13                0.53     0.1
matmul:q_proj:L2                 0.53     0.1
matmul:q_proj:L21                0.52     0.1
matmul:o_proj:L9                 0.52     0.1
matmul:q_proj:L1                 0.52     0.1
matmul:q_proj:L3                 0.52     0.1
matmul:o_proj:L12                0.52     0.1
matmul:o_proj:L5                 0.52     0.1
matmul:o_proj:L25                0.52     0.1
matmul:q_proj:L12                0.52     0.1
matmul:o_proj:L14                0.52     0.1
matmul:o_proj:L23                0.52     0.1
matmul:o_proj:L11                0.52     0.1
matmul:o_proj:L21                0.51     0.1
matmul:o_proj:L10                0.51     0.1
matmul:o_proj:L22                0.51     0.1
matmul:q_proj:L16                0.51     0.1
matmul:q_proj:L10                0.51     0.1
matmul:o_proj:L2                 0.51     0.1
matmul:o_proj:L24                0.51     0.1
matmul:o_proj:L4                 0.50     0.1
matmul:o_proj:L18                0.50     0.1
matmul:o_proj:L20                0.50     0.1
matmul:q_proj:L9                 0.49     0.1
matmul:q_proj:L15                0.49     0.1
matmul:q_proj:L6                 0.49     0.1
matmul:q_proj:L20                0.49     0.1
matmul:o_proj:L17                0.49     0.1
matmul:q_proj:L8                 0.49     0.1
matmul:q_proj:L7                 0.49     0.1
matmul:q_proj:L18                0.49     0.1
matmul:o_proj:L7                 0.48     0.1
matmul:q_proj:L19                0.48     0.1
matmul:o_proj:L1                 0.48     0.1
matmul:o_proj:L19                0.48     0.1
matmul:o_proj:L6                 0.48     0.1
matmul:o_proj:L3                 0.48     0.1
matmul:o_proj:L8                 0.48     0.1
matmul:v_proj:L0                 0.34     0.1
matmul:k_proj:L22                0.34     0.1
matmul:k_proj:L0                 0.32     0.1
matmul:v_proj:L22                0.32     0.1
matmul:k_proj:L13                0.32     0.1
matmul:k_proj:L1                 0.30     0.1
matmul:v_proj:L1                 0.30     0.1
matmul:k_proj:L23                0.30     0.1
matmul:v_proj:L25                0.29     0.1
matmul:k_proj:L17                0.29     0.1
matmul:k_proj:L5                 0.29     0.1
matmul:v_proj:L5                 0.29     0.1
matmul:k_proj:L3                 0.29     0.1
matmul:k_proj:L25                0.29     0.1
matmul:k_proj:L14                0.28     0.1
matmul:v_proj:L23                0.28     0.1
matmul:v_proj:L3                 0.28     0.1
matmul:v_proj:L14                0.28     0.1
matmul:k_proj:L11                0.27     0.1
matmul:k_proj:L2                 0.27     0.1
matmul:k_proj:L12                0.26     0.1
matmul:v_proj:L12                0.26     0.1
matmul:k_proj:L24                0.26     0.1
matmul:k_proj:L21                0.26     0.1
matmul:v_proj:L13                0.25     0.1
matmul:k_proj:L4                 0.25     0.1
matmul:v_proj:L17                0.25     0.1
matmul:k_proj:L16                0.25     0.1
matmul:k_proj:L10                0.25     0.1
matmul:v_proj:L4                 0.24     0.1
matmul:v_proj:L2                 0.24     0.1
matmul:v_proj:L10                0.24     0.1
matmul:v_proj:L24                0.24     0.1
matmul:v_proj:L21                0.24     0.1
matmul:v_proj:L16                0.24     0.1
matmul:k_proj:L15                0.23     0.1
matmul:k_proj:L9                 0.23     0.1
matmul:v_proj:L11                0.23     0.1
matmul:v_proj:L9                 0.23     0.1
matmul:k_proj:L8                 0.23     0.1
matmul:k_proj:L19                0.23     0.1
matmul:k_proj:L6                 0.23     0.1
matmul:k_proj:L7                 0.23     0.1
matmul:k_proj:L18                0.23     0.1
matmul:k_proj:L20                0.23     0.1
matmul:v_proj:L20                0.22     0.1
matmul:v_proj:L15                0.22     0.1
matmul:v_proj:L7                 0.22     0.1
matmul:v_proj:L8                 0.22     0.1
matmul:v_proj:L18                0.22     0.1
matmul:v_proj:L6                 0.22     0.1
matmul:v_proj:L19                0.22     0.1
sample_phase1                    0.13     0.0
sample_phase3                    0.06     0.0
gather                           0.03     0.0
scale                            0.02     0.0
──────────────────────────────────────────────────
TOTAL                          407.96   100.0

[browser:warning] [5123.0ms][Profile] Batch decode (N=4):
[browser:warning] [5123.4ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
matmul:lm_head                  99.53    24.0
attention                       35.14     8.5
rmsnorm                          6.45     1.6
matmul:ffn_down:L3               4.71     1.1
matmul:ffn_down:L9               3.80     0.9
matmul:ffn_down:L18              3.62     0.9
matmul:ffn_down:L6               3.57     0.9
matmul:ffn_down:L17              3.56     0.9
matmul:ffn_down:L7               3.55     0.9
matmul:ffn_down:L24              3.54     0.9
matmul:ffn_down:L5               3.39     0.8
matmul:ffn_down:L2               3.38     0.8
matmul:ffn_down:L19              3.37     0.8
matmul:ffn_down:L16              3.33     0.8
matmul:ffn_down:L20              3.33     0.8
sample_phase2                    3.32     0.8
matmul:ffn_down:L8               3.31     0.8
matmul:ffn_down:L23              3.31     0.8
matmul:ffn_down:L13              3.31     0.8
matmul:ffn_down:L14              3.22     0.8
matmul:ffn_down:L11              3.21     0.8
matmul:ffn_down:L10              3.21     0.8
matmul:ffn_down:L4               3.21     0.8
matmul:ffn_down:L15              3.21     0.8
matmul:ffn_down:L12              3.21     0.8
matmul:ffn_down:L21              3.20     0.8
matmul:ffn_down:L0               3.20     0.8
matmul:ffn_down:L25              3.20     0.8
matmul:ffn_down:L1               3.20     0.8
matmul:ffn_down:L22              3.20     0.8
matmul:ffn_gate:L1               3.18     0.8
matmul:ffn_up:L22                3.17     0.8
matmul:ffn_gate:L14              2.99     0.7
matmul:ffn_up:L24                2.89     0.7
matmul:ffn_up:L6                 2.69     0.6
matmul:ffn_up:L13                2.68     0.6
matmul:ffn_up:L17                2.68     0.6
matmul:ffn_gate:L7               2.67     0.6
matmul:ffn_up:L7                 2.67     0.6
matmul:ffn_gate:L3               2.67     0.6
matmul:ffn_gate:L9               2.67     0.6
matmul:ffn_up:L8                 2.67     0.6
matmul:ffn_gate:L16              2.66     0.6
matmul:ffn_gate:L24              2.66     0.6
matmul:ffn_up:L9                 2.66     0.6
matmul:ffn_gate:L6               2.65     0.6
matmul:ffn_up:L23                2.65     0.6
matmul:ffn_gate:L17              2.65     0.6
matmul:ffn_gate:L19              2.64     0.6
matmul:ffn_up:L19                2.64     0.6
matmul:ffn_up:L3                 2.64     0.6
matmul:ffn_gate:L18              2.64     0.6
matmul:ffn_gate:L8               2.64     0.6
matmul:ffn_up:L18                2.64     0.6
matmul:ffn_gate:L20              2.63     0.6
matmul:ffn_up:L16                2.63     0.6
matmul:ffn_gate:L13              2.63     0.6
matmul:ffn_up:L20                2.61     0.6
matmul:ffn_up:L2                 2.61     0.6
matmul:ffn_gate:L22              2.61     0.6
matmul:ffn_up:L14                2.61     0.6
matmul:ffn_gate:L0               2.61     0.6
matmul:ffn_gate:L2               2.61     0.6
matmul:ffn_up:L21                2.60     0.6
matmul:ffn_gate:L11              2.60     0.6
matmul:ffn_gate:L23              2.60     0.6
matmul:ffn_gate:L15              2.60     0.6
matmul:ffn_gate:L12              2.60     0.6
matmul:ffn_gate:L10              2.60     0.6
matmul:ffn_up:L5                 2.60     0.6
matmul:ffn_gate:L5               2.60     0.6
matmul:ffn_up:L12                2.60     0.6
matmul:ffn_up:L15                2.60     0.6
matmul:ffn_gate:L25              2.60     0.6
matmul:ffn_up:L11                2.60     0.6
matmul:ffn_gate:L21              2.60     0.6
matmul:ffn_gate:L4               2.60     0.6
matmul:ffn_up:L1                 2.60     0.6
matmul:ffn_up:L10                2.60     0.6
matmul:ffn_up:L4                 2.60     0.6
matmul:ffn_up:L25                2.60     0.6
matmul:ffn_up:L0                 2.60     0.6
matmul:o_proj:L3                 1.09     0.3
gelu                             0.99     0.2
matmul:v_proj:L18                0.89     0.2
rope                             0.88     0.2
matmul:o_proj:L7                 0.78     0.2
matmul:o_proj:L21                0.76     0.2
cast_f32_to_f16                  0.71     0.2
matmul:q_proj:L7                 0.58     0.1
matmul:q_proj:L19                0.56     0.1
matmul:q_proj:L14                0.55     0.1
matmul:q_proj:L18                0.54     0.1
matmul:q_proj:L20                0.54     0.1
matmul:q_proj:L0                 0.54     0.1
matmul:o_proj:L13                0.54     0.1
matmul:o_proj:L0                 0.53     0.1
matmul:q_proj:L8                 0.53     0.1
matmul:o_proj:L18                0.53     0.1
matmul:q_proj:L10                0.52     0.1
matmul:q_proj:L25                0.52     0.1
matmul:o_proj:L17                0.52     0.1
matmul:o_proj:L14                0.52     0.1
matmul:o_proj:L16                0.52     0.1
matmul:o_proj:L8                 0.51     0.1
matmul:q_proj:L17                0.51     0.1
matmul:o_proj:L20                0.51     0.1
matmul:o_proj:L9                 0.51     0.1
matmul:o_proj:L24                0.51     0.1
matmul:q_proj:L9                 0.50     0.1
matmul:q_proj:L24                0.50     0.1
matmul:q_proj:L6                 0.50     0.1
matmul:q_proj:L3                 0.50     0.1
matmul:o_proj:L6                 0.50     0.1
matmul:o_proj:L19                0.50     0.1
matmul:q_proj:L11                0.49     0.1
matmul:q_proj:L13                0.49     0.1
matmul:q_proj:L15                0.49     0.1
matmul:q_proj:L16                0.49     0.1
matmul:q_proj:L5                 0.49     0.1
matmul:q_proj:L12                0.49     0.1
matmul:q_proj:L23                0.49     0.1
matmul:q_proj:L21                0.49     0.1
matmul:q_proj:L2                 0.49     0.1
matmul:q_proj:L22                0.49     0.1
matmul:q_proj:L4                 0.48     0.1
matmul:q_proj:L1                 0.48     0.1
matmul:o_proj:L2                 0.48     0.1
matmul:o_proj:L25                0.48     0.1
matmul:o_proj:L1                 0.48     0.1
matmul:o_proj:L15                0.48     0.1
matmul:o_proj:L10                0.48     0.1
matmul:o_proj:L11                0.48     0.1
matmul:o_proj:L23                0.48     0.1
matmul:o_proj:L22                0.48     0.1
matmul:o_proj:L12                0.48     0.1
matmul:o_proj:L5                 0.48     0.1
matmul:o_proj:L4                 0.48     0.1
matmul:v_proj:L0                 0.36     0.1
matmul:k_proj:L17                0.35     0.1
matmul:k_proj:L18                0.34     0.1
matmul:k_proj:L19                0.33     0.1
matmul:k_proj:L7                 0.33     0.1
matmul:k_proj:L0                 0.33     0.1
matmul:v_proj:L7                 0.32     0.1
matmul:v_proj:L17                0.32     0.1
matmul:v_proj:L19                0.31     0.1
sample_phase3                    0.30     0.1
matmul:k_proj:L25                0.29     0.1
matmul:v_proj:L8                 0.29     0.1
matmul:v_proj:L25                0.29     0.1
matmul:v_proj:L20                0.29     0.1
matmul:k_proj:L8                 0.29     0.1
matmul:k_proj:L20                0.28     0.1
matmul:k_proj:L10                0.28     0.1
matmul:v_proj:L10                0.26     0.1
matmul:k_proj:L6                 0.25     0.1
matmul:v_proj:L6                 0.25     0.1
matmul:v_proj:L14                0.25     0.1
matmul:k_proj:L24                0.25     0.1
matmul:k_proj:L14                0.25     0.1
matmul:k_proj:L3                 0.25     0.1
matmul:v_proj:L24                0.25     0.1
matmul:k_proj:L9                 0.24     0.1
matmul:v_proj:L3                 0.24     0.1
matmul:v_proj:L9                 0.24     0.1
matmul:v_proj:L12                0.24     0.1
matmul:k_proj:L11                0.23     0.1
matmul:k_proj:L21                0.23     0.1
matmul:k_proj:L16                0.23     0.1
matmul:k_proj:L13                0.23     0.1
matmul:k_proj:L12                0.23     0.1
matmul:k_proj:L15                0.23     0.1
matmul:v_proj:L5                 0.23     0.1
matmul:v_proj:L22                0.23     0.1
matmul:k_proj:L22                0.23     0.1
matmul:k_proj:L4                 0.23     0.1
matmul:k_proj:L5                 0.23     0.1
matmul:k_proj:L23                0.23     0.1
matmul:v_proj:L16                0.23     0.1
matmul:v_proj:L11                0.22     0.1
matmul:v_proj:L4                 0.22     0.1
matmul:v_proj:L13                0.22     0.1
matmul:k_proj:L1                 0.22     0.1
matmul:v_proj:L15                0.22     0.1
matmul:v_proj:L23                0.22     0.1
matmul:v_proj:L2                 0.22     0.1
matmul:k_proj:L2                 0.22     0.1
matmul:v_proj:L1                 0.22     0.1
matmul:v_proj:L21                0.22     0.1
sample_phase1                    0.10     0.0
gather                           0.03     0.0
scale                            0.02     0.0
──────────────────────────────────────────────────
TOTAL                          415.58   100.0

[browser:warning] [5603.2ms][Profile] Batch decode (N=4):
[browser:warning] [5603.3ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
matmul:lm_head                  99.93    23.7
attention                       42.35    10.0
rmsnorm                          5.05     1.2
matmul:ffn_down:L7               3.60     0.9
matmul:ffn_down:L0               3.56     0.8
matmul:ffn_down:L12              3.51     0.8
matmul:ffn_down:L15              3.50     0.8
matmul:ffn_down:L20              3.45     0.8
matmul:ffn_down:L10              3.44     0.8
matmul:ffn_down:L14              3.43     0.8
matmul:ffn_down:L11              3.43     0.8
matmul:ffn_down:L5               3.43     0.8
matmul:ffn_down:L2               3.41     0.8
sample_phase2                    3.40     0.8
matmul:ffn_down:L23              3.38     0.8
matmul:ffn_down:L18              3.37     0.8
matmul:ffn_down:L24              3.36     0.8
matmul:ffn_down:L25              3.35     0.8
matmul:ffn_down:L21              3.33     0.8
matmul:ffn_down:L19              3.32     0.8
matmul:ffn_down:L6               3.31     0.8
matmul:ffn_down:L4               3.31     0.8
matmul:ffn_down:L17              3.30     0.8
matmul:ffn_down:L1               3.30     0.8
matmul:ffn_down:L22              3.29     0.8
matmul:ffn_down:L9               3.29     0.8
matmul:ffn_up:L6                 3.26     0.8
matmul:ffn_down:L8               3.22     0.8
matmul:ffn_down:L16              3.21     0.8
matmul:ffn_down:L3               3.20     0.8
matmul:ffn_down:L13              3.20     0.8
matmul:ffn_gate:L4               3.20     0.8
matmul:ffn_up:L22                3.20     0.8
matmul:ffn_up:L1                 3.19     0.8
matmul:ffn_up:L20                2.79     0.7
matmul:ffn_up:L19                2.68     0.6
matmul:ffn_up:L14                2.66     0.6
matmul:ffn_gate:L7               2.66     0.6
matmul:ffn_gate:L20              2.66     0.6
matmul:ffn_gate:L11              2.66     0.6
matmul:ffn_up:L17                2.65     0.6
matmul:ffn_up:L7                 2.65     0.6
matmul:ffn_up:L10                2.65     0.6
matmul:ffn_gate:L17              2.65     0.6
matmul:ffn_up:L12                2.65     0.6
matmul:ffn_up:L18                2.65     0.6
matmul:ffn_up:L11                2.64     0.6
matmul:ffn_up:L0                 2.64     0.6
matmul:ffn_gate:L23              2.64     0.6
matmul:ffn_gate:L10              2.64     0.6
matmul:ffn_gate:L5               2.64     0.6
matmul:ffn_gate:L2               2.64     0.6
matmul:ffn_up:L5                 2.64     0.6
matmul:ffn_gate:L6               2.64     0.6
matmul:ffn_up:L23                2.64     0.6
matmul:ffn_up:L4                 2.64     0.6
matmul:ffn_gate:L0               2.64     0.6
matmul:ffn_gate:L15              2.64     0.6
matmul:ffn_gate:L9               2.63     0.6
matmul:ffn_up:L2                 2.63     0.6
matmul:ffn_gate:L1               2.63     0.6
matmul:ffn_gate:L12              2.63     0.6
matmul:ffn_up:L15                2.63     0.6
matmul:ffn_gate:L25              2.63     0.6
matmul:ffn_up:L9                 2.63     0.6
matmul:ffn_up:L25                2.62     0.6
matmul:ffn_gate:L22              2.62     0.6
matmul:ffn_gate:L18              2.62     0.6
matmul:ffn_gate:L24              2.61     0.6
matmul:ffn_gate:L16              2.60     0.6
matmul:ffn_gate:L21              2.60     0.6
matmul:ffn_gate:L14              2.60     0.6
matmul:ffn_gate:L13              2.60     0.6
matmul:ffn_up:L3                 2.60     0.6
matmul:ffn_up:L13                2.60     0.6
matmul:ffn_up:L24                2.60     0.6
matmul:ffn_up:L21                2.60     0.6
matmul:ffn_gate:L19              2.60     0.6
matmul:ffn_up:L16                2.60     0.6
matmul:ffn_gate:L3               2.60     0.6
matmul:ffn_up:L8                 2.60     0.6
matmul:ffn_gate:L8               2.60     0.6
gelu                             1.07     0.3
rope                             0.95     0.2
matmul:o_proj:L25                0.87     0.2
cast_f32_to_f16                  0.83     0.2
matmul:o_proj:L9                 0.75     0.2
matmul:o_proj:L17                0.57     0.1
matmul:q_proj:L4                 0.57     0.1
matmul:q_proj:L0                 0.57     0.1
matmul:q_proj:L17                0.56     0.1
matmul:q_proj:L1                 0.56     0.1
matmul:q_proj:L9                 0.55     0.1
matmul:q_proj:L18                0.55     0.1
matmul:q_proj:L5                 0.53     0.1
matmul:q_proj:L16                0.52     0.1
matmul:q_proj:L13                0.52     0.1
matmul:q_proj:L25                0.52     0.1
matmul:q_proj:L8                 0.52     0.1
matmul:o_proj:L18                0.52     0.1
matmul:o_proj:L7                 0.52     0.1
matmul:o_proj:L20                0.52     0.1
matmul:o_proj:L1                 0.52     0.1
matmul:q_proj:L21                0.52     0.1
matmul:o_proj:L10                0.52     0.1
matmul:q_proj:L23                0.52     0.1
matmul:o_proj:L0                 0.52     0.1
matmul:o_proj:L23                0.52     0.1
matmul:o_proj:L2                 0.52     0.1
matmul:q_proj:L10                0.52     0.1
matmul:q_proj:L2                 0.52     0.1
matmul:o_proj:L5                 0.51     0.1
matmul:q_proj:L7                 0.51     0.1
matmul:q_proj:L20                0.51     0.1
matmul:q_proj:L15                0.51     0.1
matmul:o_proj:L4                 0.51     0.1
matmul:o_proj:L22                0.50     0.1
matmul:q_proj:L12                0.50     0.1
matmul:o_proj:L12                0.50     0.1
matmul:o_proj:L15                0.50     0.1
matmul:q_proj:L3                 0.50     0.1
matmul:q_proj:L22                0.50     0.1
matmul:q_proj:L24                0.49     0.1
matmul:q_proj:L6                 0.49     0.1
matmul:q_proj:L11                0.49     0.1
matmul:o_proj:L11                0.49     0.1
matmul:q_proj:L19                0.49     0.1
matmul:q_proj:L14                0.49     0.1
matmul:o_proj:L16                0.49     0.1
matmul:o_proj:L24                0.49     0.1
matmul:o_proj:L8                 0.49     0.1
matmul:o_proj:L13                0.48     0.1
matmul:o_proj:L21                0.48     0.1
matmul:o_proj:L14                0.48     0.1
matmul:o_proj:L19                0.48     0.1
matmul:o_proj:L6                 0.48     0.1
matmul:o_proj:L3                 0.48     0.1
matmul:v_proj:L0                 0.35     0.1
matmul:k_proj:L0                 0.32     0.1
matmul:v_proj:L16                0.30     0.1
sample_phase3                    0.30     0.1
matmul:k_proj:L8                 0.30     0.1
matmul:v_proj:L8                 0.30     0.1
matmul:v_proj:L13                0.30     0.1
matmul:k_proj:L21                0.29     0.1
matmul:v_proj:L21                0.29     0.1
matmul:k_proj:L16                0.29     0.1
matmul:k_proj:L13                0.29     0.1
matmul:k_proj:L18                0.29     0.1
matmul:v_proj:L2                 0.29     0.1
matmul:v_proj:L23                0.29     0.1
matmul:v_proj:L5                 0.29     0.1
matmul:v_proj:L10                0.29     0.1
matmul:k_proj:L23                0.29     0.1
matmul:k_proj:L5                 0.28     0.1
matmul:k_proj:L2                 0.28     0.1
matmul:v_proj:L18                0.28     0.1
matmul:k_proj:L9                 0.28     0.1
matmul:k_proj:L10                0.27     0.1
matmul:v_proj:L20                0.27     0.1
matmul:k_proj:L4                 0.27     0.1
matmul:v_proj:L22                0.26     0.1
matmul:v_proj:L7                 0.26     0.1
matmul:k_proj:L25                0.26     0.1
matmul:v_proj:L15                0.25     0.1
matmul:k_proj:L20                0.25     0.1
matmul:k_proj:L7                 0.25     0.1
matmul:k_proj:L15                0.25     0.1
matmul:k_proj:L17                0.24     0.1
matmul:k_proj:L22                0.24     0.1
matmul:k_proj:L12                0.24     0.1
matmul:v_proj:L25                0.24     0.1
matmul:v_proj:L12                0.24     0.1
matmul:v_proj:L1                 0.24     0.1
matmul:k_proj:L1                 0.23     0.1
matmul:v_proj:L9                 0.23     0.1
matmul:k_proj:L19                0.23     0.1
matmul:v_proj:L17                0.23     0.1
matmul:k_proj:L14                0.23     0.1
matmul:k_proj:L6                 0.23     0.1
matmul:k_proj:L3                 0.23     0.1
matmul:v_proj:L4                 0.23     0.1
matmul:k_proj:L24                0.23     0.1
matmul:v_proj:L3                 0.23     0.1
matmul:k_proj:L11                0.23     0.1
matmul:v_proj:L11                0.23     0.1
matmul:v_proj:L6                 0.22     0.1
matmul:v_proj:L14                0.22     0.1
matmul:v_proj:L24                0.22     0.1
matmul:v_proj:L19                0.22     0.1
sample_phase1                    0.18     0.0
gather                           0.03     0.0
scale                            0.02     0.0
──────────────────────────────────────────────────
TOTAL                          421.69   100.0

[browser:warning] [6075.1ms][Profile] Batch decode (N=4):
[browser:warning] [6075.3ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
matmul:lm_head                  99.79    23.2
attention                       49.19    11.5
rmsnorm                          4.89     1.1
matmul:ffn_down:L16              3.59     0.8
matmul:ffn_down:L5               3.55     0.8
matmul:ffn_down:L15              3.55     0.8
matmul:ffn_down:L2               3.48     0.8
matmul:ffn_down:L12              3.47     0.8
matmul:ffn_down:L6               3.47     0.8
matmul:ffn_down:L19              3.47     0.8
matmul:ffn_down:L25              3.45     0.8
sample_phase2                    3.38     0.8
matmul:ffn_down:L21              3.35     0.8
matmul:ffn_down:L22              3.34     0.8
matmul:ffn_down:L18              3.34     0.8
matmul:ffn_down:L24              3.33     0.8
matmul:ffn_down:L11              3.33     0.8
matmul:ffn_down:L13              3.32     0.8
matmul:ffn_down:L8               3.31     0.8
matmul:ffn_down:L14              3.31     0.8
matmul:ffn_down:L4               3.30     0.8
matmul:ffn_down:L9               3.30     0.8
matmul:ffn_down:L1               3.30     0.8
matmul:ffn_down:L23              3.28     0.8
matmul:ffn_down:L0               3.25     0.8
matmul:ffn_down:L20              3.20     0.7
matmul:ffn_down:L3               3.20     0.7
matmul:ffn_down:L7               3.20     0.7
matmul:ffn_down:L17              3.20     0.7
matmul:ffn_down:L10              3.20     0.7
matmul:ffn_up:L3                 3.18     0.7
matmul:ffn_up:L20                3.18     0.7
matmul:ffn_gate:L10              3.18     0.7
matmul:ffn_up:L0                 3.17     0.7
matmul:ffn_up:L6                 3.16     0.7
matmul:ffn_gate:L9               3.00     0.7
matmul:ffn_up:L9                 2.87     0.7
matmul:ffn_up:L15                2.73     0.6
matmul:ffn_gate:L5               2.72     0.6
matmul:ffn_up:L25                2.71     0.6
matmul:ffn_gate:L15              2.71     0.6
matmul:ffn_up:L5                 2.70     0.6
matmul:ffn_up:L12                2.70     0.6
matmul:ffn_gate:L19              2.67     0.6
matmul:ffn_up:L18                2.66     0.6
matmul:ffn_up:L4                 2.66     0.6
matmul:ffn_gate:L6               2.66     0.6
matmul:ffn_gate:L12              2.66     0.6
matmul:ffn_up:L1                 2.66     0.6
matmul:ffn_gate:L8               2.66     0.6
matmul:ffn_up:L11                2.66     0.6
matmul:ffn_gate:L16              2.65     0.6
matmul:ffn_up:L16                2.65     0.6
matmul:ffn_up:L14                2.65     0.6
matmul:ffn_up:L19                2.65     0.6
matmul:ffn_gate:L14              2.65     0.6
matmul:ffn_up:L8                 2.65     0.6
matmul:ffn_gate:L1               2.64     0.6
matmul:ffn_gate:L25              2.64     0.6
matmul:ffn_gate:L23              2.64     0.6
matmul:ffn_up:L23                2.64     0.6
matmul:ffn_up:L2                 2.64     0.6
matmul:ffn_gate:L2               2.64     0.6
matmul:ffn_up:L22                2.63     0.6
matmul:ffn_gate:L0               2.63     0.6
matmul:ffn_gate:L4               2.63     0.6
matmul:ffn_gate:L22              2.62     0.6
matmul:ffn_gate:L11              2.60     0.6
matmul:ffn_gate:L18              2.60     0.6
matmul:ffn_gate:L21              2.60     0.6
matmul:ffn_gate:L24              2.60     0.6
matmul:ffn_gate:L17              2.60     0.6
matmul:ffn_up:L10                2.60     0.6
matmul:ffn_gate:L20              2.60     0.6
matmul:ffn_gate:L13              2.60     0.6
matmul:ffn_gate:L7               2.60     0.6
matmul:ffn_gate:L3               2.60     0.6
matmul:ffn_up:L21                2.60     0.6
matmul:ffn_up:L13                2.60     0.6
matmul:ffn_up:L7                 2.60     0.6
matmul:ffn_up:L17                2.60     0.6
matmul:ffn_up:L24                2.60     0.6
gelu                             1.12     0.3
rope                             0.89     0.2
matmul:k_proj:L20                0.83     0.2
matmul:k_proj:L24                0.80     0.2
cast_f32_to_f16                  0.76     0.2
matmul:q_proj:L0                 0.58     0.1
matmul:k_proj:L0                 0.57     0.1
matmul:q_proj:L5                 0.56     0.1
matmul:q_proj:L23                0.54     0.1
matmul:q_proj:L6                 0.54     0.1
matmul:q_proj:L20                0.54     0.1
matmul:q_proj:L16                0.54     0.1
matmul:o_proj:L5                 0.53     0.1
matmul:o_proj:L6                 0.53     0.1
matmul:o_proj:L2                 0.53     0.1
matmul:q_proj:L17                0.53     0.1
matmul:o_proj:L16                0.53     0.1
matmul:q_proj:L3                 0.53     0.1
matmul:q_proj:L13                0.53     0.1
matmul:q_proj:L19                0.53     0.1
matmul:q_proj:L7                 0.52     0.1
matmul:o_proj:L4                 0.52     0.1
matmul:q_proj:L15                0.52     0.1
matmul:o_proj:L9                 0.52     0.1
matmul:o_proj:L23                0.52     0.1
matmul:o_proj:L0                 0.52     0.1
matmul:q_proj:L12                0.52     0.1
matmul:o_proj:L12                0.51     0.1
matmul:o_proj:L19                0.51     0.1
matmul:o_proj:L15                0.51     0.1
matmul:o_proj:L22                0.50     0.1
matmul:q_proj:L2                 0.50     0.1
matmul:q_proj:L9                 0.50     0.1
matmul:q_proj:L24                0.50     0.1
matmul:q_proj:L25                0.50     0.1
matmul:o_proj:L25                0.50     0.1
matmul:q_proj:L22                0.50     0.1
matmul:o_proj:L1                 0.49     0.1
matmul:q_proj:L14                0.49     0.1
matmul:q_proj:L21                0.49     0.1
matmul:q_proj:L4                 0.49     0.1
matmul:q_proj:L10                0.49     0.1
matmul:o_proj:L8                 0.49     0.1
matmul:q_proj:L1                 0.49     0.1
matmul:q_proj:L8                 0.49     0.1
matmul:o_proj:L10                0.49     0.1
matmul:q_proj:L18                0.49     0.1
matmul:q_proj:L11                0.49     0.1
matmul:o_proj:L11                0.49     0.1
matmul:o_proj:L14                0.48     0.1
matmul:o_proj:L3                 0.48     0.1
matmul:o_proj:L18                0.48     0.1
matmul:o_proj:L20                0.48     0.1
matmul:o_proj:L17                0.48     0.1
matmul:o_proj:L7                 0.48     0.1
matmul:o_proj:L13                0.48     0.1
matmul:o_proj:L24                0.48     0.1
matmul:o_proj:L21                0.48     0.1
matmul:v_proj:L0                 0.37     0.1
matmul:v_proj:L16                0.37     0.1
matmul:k_proj:L6                 0.33     0.1
matmul:k_proj:L16                0.32     0.1
matmul:v_proj:L6                 0.31     0.1
matmul:v_proj:L15                0.31     0.1
matmul:k_proj:L3                 0.30     0.1
matmul:k_proj:L13                0.30     0.1
matmul:v_proj:L13                0.30     0.1
matmul:k_proj:L7                 0.30     0.1
matmul:v_proj:L7                 0.29     0.1
matmul:v_proj:L17                0.29     0.1
matmul:k_proj:L17                0.29     0.1
matmul:v_proj:L20                0.29     0.1
matmul:k_proj:L23                0.29     0.1
matmul:v_proj:L3                 0.29     0.1
matmul:v_proj:L23                0.28     0.1
matmul:v_proj:L9                 0.27     0.1
matmul:v_proj:L12                0.27     0.1
matmul:v_proj:L19                0.27     0.1
matmul:k_proj:L22                0.27     0.1
matmul:v_proj:L25                0.27     0.1
matmul:k_proj:L15                0.25     0.1
matmul:k_proj:L25                0.25     0.1
matmul:v_proj:L5                 0.25     0.1
matmul:k_proj:L12                0.25     0.1
matmul:k_proj:L5                 0.25     0.1
matmul:k_proj:L19                0.25     0.1
matmul:k_proj:L2                 0.25     0.1
matmul:v_proj:L2                 0.25     0.1
matmul:v_proj:L22                0.25     0.1
matmul:k_proj:L9                 0.24     0.1
matmul:k_proj:L14                0.23     0.1
matmul:k_proj:L21                0.23     0.1
matmul:k_proj:L11                0.23     0.1
matmul:k_proj:L4                 0.23     0.1
matmul:v_proj:L4                 0.23     0.1
matmul:k_proj:L8                 0.23     0.1
matmul:v_proj:L24                0.23     0.1
matmul:v_proj:L1                 0.23     0.1
matmul:v_proj:L14                0.23     0.1
matmul:k_proj:L1                 0.23     0.1
matmul:k_proj:L10                0.23     0.1
matmul:k_proj:L18                0.23     0.1
matmul:v_proj:L8                 0.22     0.1
matmul:v_proj:L10                0.22     0.1
matmul:v_proj:L21                0.22     0.1
matmul:v_proj:L11                0.22     0.1
matmul:v_proj:L18                0.22     0.1
sample_phase1                    0.10     0.0
sample_phase3                    0.09     0.0
gather                           0.04     0.0
scale                            0.02     0.0
──────────────────────────────────────────────────
TOTAL                          429.43   100.0

[browser:warning] [6558.2ms][Profile] Batch decode (N=4):
[browser:warning] [6558.7ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
matmul:lm_head                  96.90    22.3
attention                       56.48    13.0
rmsnorm                          4.96     1.1
sample_phase2                    4.84     1.1
matmul:ffn_down:L24              3.78     0.9
matmul:ffn_down:L13              3.60     0.8
matmul:ffn_down:L21              3.58     0.8
matmul:ffn_down:L3               3.56     0.8
matmul:ffn_down:L17              3.52     0.8
matmul:ffn_down:L11              3.47     0.8
matmul:ffn_down:L1               3.46     0.8
matmul:ffn_down:L7               3.46     0.8
matmul:ffn_down:L4               3.45     0.8
matmul:ffn_down:L6               3.42     0.8
matmul:ffn_down:L12              3.36     0.8
matmul:ffn_down:L20              3.36     0.8
matmul:ffn_down:L10              3.36     0.8
matmul:ffn_down:L23              3.36     0.8
matmul:ffn_down:L16              3.36     0.8
matmul:ffn_down:L2               3.32     0.8
matmul:ffn_down:L0               3.29     0.8
matmul:ffn_down:L14              3.29     0.8
matmul:ffn_down:L18              3.24     0.7
matmul:ffn_up:L7                 3.24     0.7
matmul:ffn_down:L22              3.21     0.7
matmul:ffn_down:L15              3.20     0.7
matmul:ffn_down:L19              3.20     0.7
matmul:ffn_down:L5               3.20     0.7
matmul:ffn_down:L8               3.20     0.7
matmul:ffn_down:L9               3.20     0.7
matmul:ffn_down:L25              3.19     0.7
matmul:ffn_gate:L18              3.19     0.7
matmul:ffn_up:L11                3.18     0.7
matmul:ffn_up:L24                2.87     0.7
matmul:ffn_gate:L4               2.75     0.6
matmul:ffn_up:L13                2.73     0.6
matmul:ffn_gate:L13              2.72     0.6
matmul:ffn_gate:L0               2.70     0.6
matmul:ffn_up:L3                 2.70     0.6
matmul:ffn_gate:L3               2.70     0.6
matmul:ffn_gate:L11              2.68     0.6
matmul:ffn_gate:L23              2.68     0.6
matmul:ffn_up:L12                2.68     0.6
matmul:ffn_up:L23                2.67     0.6
matmul:ffn_gate:L24              2.67     0.6
matmul:ffn_gate:L21              2.67     0.6
matmul:ffn_up:L2                 2.67     0.6
matmul:ffn_gate:L7               2.67     0.6
matmul:ffn_up:L0                 2.66     0.6
matmul:ffn_gate:L1               2.65     0.6
matmul:ffn_up:L4                 2.65     0.6
matmul:ffn_up:L21                2.65     0.6
matmul:ffn_up:L14                2.65     0.6
matmul:ffn_up:L1                 2.65     0.6
matmul:ffn_gate:L14              2.64     0.6
matmul:ffn_up:L18                2.63     0.6
matmul:ffn_gate:L17              2.63     0.6
matmul:ffn_up:L17                2.62     0.6
matmul:ffn_gate:L9               2.61     0.6
matmul:ffn_up:L22                2.60     0.6
matmul:ffn_gate:L12              2.60     0.6
matmul:ffn_up:L20                2.60     0.6
matmul:ffn_gate:L20              2.60     0.6
matmul:ffn_gate:L2               2.60     0.6
matmul:ffn_gate:L22              2.60     0.6
matmul:ffn_up:L10                2.60     0.6
matmul:ffn_up:L5                 2.60     0.6
matmul:ffn_gate:L10              2.60     0.6
matmul:ffn_gate:L16              2.60     0.6
matmul:ffn_up:L9                 2.60     0.6
matmul:ffn_gate:L8               2.60     0.6
matmul:ffn_gate:L6               2.60     0.6
matmul:ffn_gate:L19              2.60     0.6
matmul:ffn_gate:L5               2.60     0.6
matmul:ffn_up:L25                2.60     0.6
matmul:ffn_gate:L25              2.60     0.6
matmul:ffn_up:L6                 2.60     0.6
matmul:ffn_up:L19                2.60     0.6
matmul:ffn_up:L8                 2.60     0.6
matmul:ffn_gate:L15              2.60     0.6
matmul:ffn_up:L15                2.60     0.6
matmul:ffn_up:L16                2.59     0.6
gelu                             1.22     0.3
rope                             0.95     0.2
matmul:o_proj:L1                 0.94     0.2
matmul:o_proj:L4                 0.81     0.2
cast_f32_to_f16                  0.78     0.2
matmul:o_proj:L8                 0.77     0.2
matmul:o_proj:L24                0.57     0.1
matmul:o_proj:L13                0.57     0.1
matmul:q_proj:L4                 0.57     0.1
matmul:o_proj:L3                 0.56     0.1
matmul:q_proj:L24                0.55     0.1
matmul:q_proj:L0                 0.55     0.1
matmul:q_proj:L14                0.55     0.1
matmul:o_proj:L11                0.54     0.1
matmul:q_proj:L18                0.53     0.1
matmul:q_proj:L22                0.53     0.1
matmul:q_proj:L8                 0.53     0.1
matmul:q_proj:L25                0.53     0.1
matmul:q_proj:L12                0.53     0.1
matmul:o_proj:L17                0.53     0.1
matmul:q_proj:L23                0.53     0.1
matmul:q_proj:L2                 0.52     0.1
matmul:o_proj:L21                0.52     0.1
matmul:o_proj:L23                0.52     0.1
matmul:o_proj:L14                0.52     0.1
matmul:o_proj:L18                0.52     0.1
matmul:o_proj:L0                 0.51     0.1
matmul:q_proj:L21                0.51     0.1
matmul:o_proj:L7                 0.51     0.1
matmul:q_proj:L3                 0.51     0.1
matmul:q_proj:L7                 0.51     0.1
matmul:q_proj:L13                0.50     0.1
matmul:q_proj:L1                 0.50     0.1
matmul:q_proj:L17                0.50     0.1
matmul:q_proj:L11                0.50     0.1
matmul:q_proj:L19                0.49     0.1
matmul:q_proj:L15                0.49     0.1
matmul:q_proj:L10                0.49     0.1
matmul:q_proj:L16                0.49     0.1
matmul:q_proj:L5                 0.49     0.1
matmul:q_proj:L20                0.49     0.1
matmul:q_proj:L6                 0.49     0.1
matmul:o_proj:L5                 0.48     0.1
matmul:q_proj:L9                 0.48     0.1
matmul:o_proj:L16                0.48     0.1
matmul:o_proj:L22                0.48     0.1
matmul:o_proj:L6                 0.48     0.1
matmul:o_proj:L12                0.48     0.1
matmul:o_proj:L10                0.48     0.1
matmul:o_proj:L9                 0.48     0.1
matmul:o_proj:L15                0.48     0.1
matmul:o_proj:L19                0.48     0.1
matmul:o_proj:L25                0.48     0.1
matmul:o_proj:L2                 0.48     0.1
matmul:o_proj:L20                0.48     0.1
matmul:v_proj:L14                0.35     0.1
matmul:k_proj:L14                0.34     0.1
matmul:k_proj:L4                 0.32     0.1
matmul:v_proj:L13                0.31     0.1
matmul:v_proj:L24                0.31     0.1
matmul:v_proj:L4                 0.31     0.1
matmul:k_proj:L24                0.31     0.1
matmul:v_proj:L8                 0.30     0.1
matmul:k_proj:L23                0.30     0.1
matmul:v_proj:L2                 0.30     0.1
matmul:k_proj:L0                 0.30     0.1
matmul:k_proj:L12                0.30     0.1
matmul:k_proj:L22                0.30     0.1
matmul:v_proj:L22                0.29     0.1
matmul:k_proj:L8                 0.29     0.1
matmul:v_proj:L0                 0.29     0.1
matmul:k_proj:L13                0.29     0.1
matmul:k_proj:L2                 0.29     0.1
matmul:v_proj:L18                0.29     0.1
matmul:v_proj:L12                0.29     0.1
matmul:k_proj:L18                0.29     0.1
matmul:v_proj:L3                 0.27     0.1
matmul:k_proj:L17                0.27     0.1
matmul:v_proj:L23                0.27     0.1
matmul:v_proj:L1                 0.26     0.1
matmul:k_proj:L3                 0.25     0.1
matmul:k_proj:L11                0.25     0.1
matmul:k_proj:L7                 0.25     0.1
matmul:k_proj:L25                0.25     0.1
matmul:k_proj:L21                0.25     0.1
matmul:v_proj:L21                0.25     0.1
matmul:v_proj:L11                0.25     0.1
matmul:k_proj:L1                 0.24     0.1
matmul:v_proj:L7                 0.24     0.1
matmul:v_proj:L17                0.24     0.1
matmul:k_proj:L5                 0.23     0.1
matmul:k_proj:L6                 0.23     0.1
matmul:v_proj:L25                0.23     0.1
matmul:v_proj:L5                 0.23     0.1
matmul:k_proj:L15                0.23     0.1
matmul:k_proj:L19                0.23     0.1
matmul:v_proj:L20                0.23     0.1
matmul:k_proj:L10                0.22     0.1
matmul:k_proj:L9                 0.22     0.1
matmul:k_proj:L16                0.22     0.1
matmul:k_proj:L20                0.22     0.1
matmul:v_proj:L9                 0.22     0.1
matmul:v_proj:L10                0.22     0.1
matmul:v_proj:L6                 0.22     0.1
matmul:v_proj:L19                0.22     0.1
matmul:v_proj:L16                0.22     0.1
matmul:v_proj:L15                0.22     0.1
sample_phase1                    0.19     0.0
sample_phase3                    0.05     0.0
gather                           0.03     0.0
scale                            0.02     0.0
──────────────────────────────────────────────────
TOTAL                          434.31   100.0

[browser:warning] [7060.5ms][Profile] Batch decode (N=4):
[browser:warning] [7060.7ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
matmul:lm_head                  97.08    21.9
attention                       63.72    14.4
rmsnorm                          4.96     1.1
matmul:ffn_down:L19              3.61     0.8
matmul:ffn_down:L23              3.57     0.8
matmul:ffn_down:L14              3.51     0.8
sample_phase2                    3.50     0.8
matmul:ffn_down:L13              3.50     0.8
matmul:ffn_down:L1               3.48     0.8
matmul:ffn_down:L10              3.46     0.8
matmul:ffn_down:L20              3.46     0.8
matmul:ffn_down:L24              3.45     0.8
matmul:ffn_down:L9               3.43     0.8
matmul:ffn_down:L3               3.41     0.8
matmul:ffn_down:L2               3.37     0.8
matmul:ffn_down:L18              3.33     0.8
matmul:ffn_down:L12              3.32     0.7
matmul:ffn_down:L8               3.29     0.7
matmul:ffn_down:L22              3.29     0.7
matmul:ffn_down:L0               3.29     0.7
matmul:ffn_down:L4               3.29     0.7
matmul:ffn_gate:L23              3.21     0.7
matmul:ffn_down:L16              3.21     0.7
matmul:ffn_down:L11              3.21     0.7
matmul:ffn_down:L21              3.21     0.7
matmul:ffn_down:L7               3.21     0.7
matmul:ffn_down:L17              3.21     0.7
matmul:ffn_up:L3                 3.20     0.7
matmul:ffn_down:L6               3.20     0.7
matmul:ffn_down:L15              3.20     0.7
matmul:ffn_down:L25              3.20     0.7
matmul:ffn_down:L5               3.20     0.7
matmul:ffn_up:L13                3.19     0.7
matmul:ffn_gate:L17              3.19     0.7
matmul:ffn_gate:L15              3.19     0.7
matmul:ffn_gate:L7               3.18     0.7
matmul:ffn_gate:L5               3.09     0.7
matmul:ffn_up:L14                3.09     0.7
matmul:ffn_up:L9                 2.98     0.7
matmul:ffn_gate:L9               2.86     0.6
matmul:ffn_up:L24                2.86     0.6
matmul:ffn_up:L19                2.81     0.6
matmul:ffn_up:L0                 2.81     0.6
matmul:ffn_up:L10                2.76     0.6
matmul:ffn_up:L5                 2.75     0.6
matmul:ffn_up:L1                 2.75     0.6
matmul:ffn_gate:L0               2.75     0.6
matmul:ffn_gate:L14              2.69     0.6
matmul:ffn_gate:L20              2.67     0.6
matmul:ffn_gate:L8               2.67     0.6
matmul:ffn_gate:L10              2.66     0.6
matmul:ffn_up:L22                2.65     0.6
matmul:ffn_up:L18                2.65     0.6
matmul:ffn_gate:L4               2.65     0.6
matmul:ffn_up:L4                 2.65     0.6
matmul:ffn_up:L20                2.64     0.6
matmul:ffn_up:L8                 2.64     0.6
matmul:ffn_gate:L19              2.64     0.6
matmul:ffn_gate:L1               2.64     0.6
matmul:ffn_gate:L24              2.63     0.6
matmul:ffn_gate:L13              2.63     0.6
matmul:ffn_gate:L22              2.63     0.6
matmul:ffn_gate:L3               2.63     0.6
matmul:ffn_up:L23                2.62     0.6
matmul:ffn_gate:L18              2.62     0.6
matmul:ffn_up:L12                2.61     0.6
matmul:ffn_up:L2                 2.61     0.6
matmul:ffn_gate:L21              2.60     0.6
matmul:ffn_up:L6                 2.60     0.6
matmul:ffn_up:L11                2.60     0.6
matmul:ffn_gate:L6               2.60     0.6
matmul:ffn_up:L21                2.60     0.6
matmul:ffn_gate:L16              2.60     0.6
matmul:ffn_gate:L11              2.60     0.6
matmul:ffn_up:L17                2.60     0.6
matmul:ffn_up:L15                2.60     0.6
matmul:ffn_up:L7                 2.60     0.6
matmul:ffn_gate:L12              2.60     0.6
matmul:ffn_up:L25                2.60     0.6
matmul:ffn_gate:L25              2.60     0.6
matmul:ffn_gate:L2               2.60     0.6
matmul:ffn_up:L16                2.60     0.6
sample_phase3                    1.98     0.4
matmul:o_proj:L9                 1.03     0.2
rope                             0.86     0.2
matmul:k_proj:L0                 0.82     0.2
matmul:o_proj:L5                 0.79     0.2
cast_f32_to_f16                  0.74     0.2
matmul:q_proj:L0                 0.56     0.1
matmul:q_proj:L14                0.56     0.1
matmul:q_proj:L24                0.54     0.1
matmul:o_proj:L14                0.54     0.1
matmul:q_proj:L20                0.54     0.1
matmul:o_proj:L19                0.54     0.1
matmul:o_proj:L23                0.53     0.1
matmul:q_proj:L25                0.53     0.1
matmul:q_proj:L21                0.52     0.1
matmul:q_proj:L11                0.52     0.1
gelu                             0.52     0.1
matmul:o_proj:L0                 0.52     0.1
matmul:q_proj:L3                 0.52     0.1
matmul:q_proj:L4                 0.52     0.1
matmul:o_proj:L22                0.52     0.1
matmul:o_proj:L1                 0.52     0.1
matmul:o_proj:L25                0.52     0.1
matmul:o_proj:L3                 0.51     0.1
matmul:q_proj:L15                0.51     0.1
matmul:o_proj:L20                0.51     0.1
matmul:o_proj:L4                 0.51     0.1
matmul:q_proj:L10                0.51     0.1
matmul:q_proj:L5                 0.51     0.1
matmul:q_proj:L1                 0.51     0.1
matmul:o_proj:L24                0.51     0.1
matmul:o_proj:L10                0.51     0.1
matmul:q_proj:L19                0.50     0.1
matmul:o_proj:L13                0.50     0.1
matmul:q_proj:L23                0.50     0.1
matmul:q_proj:L13                0.50     0.1
matmul:q_proj:L9                 0.50     0.1
matmul:q_proj:L18                0.50     0.1
matmul:o_proj:L18                0.49     0.1
matmul:q_proj:L8                 0.49     0.1
matmul:q_proj:L7                 0.49     0.1
matmul:q_proj:L17                0.49     0.1
matmul:q_proj:L2                 0.49     0.1
matmul:q_proj:L6                 0.49     0.1
matmul:o_proj:L11                0.49     0.1
matmul:q_proj:L22                0.49     0.1
matmul:q_proj:L16                0.49     0.1
matmul:o_proj:L21                0.49     0.1
matmul:q_proj:L12                0.48     0.1
matmul:o_proj:L12                0.48     0.1
matmul:o_proj:L8                 0.48     0.1
matmul:o_proj:L16                0.48     0.1
matmul:o_proj:L7                 0.48     0.1
matmul:o_proj:L17                0.48     0.1
matmul:o_proj:L6                 0.48     0.1
matmul:o_proj:L2                 0.48     0.1
matmul:o_proj:L15                0.48     0.1
matmul:k_proj:L24                0.31     0.1
matmul:v_proj:L24                0.31     0.1
matmul:v_proj:L14                0.31     0.1
matmul:k_proj:L14                0.31     0.1
matmul:k_proj:L11                0.30     0.1
matmul:v_proj:L4                 0.30     0.1
matmul:k_proj:L21                0.30     0.1
matmul:v_proj:L21                0.29     0.1
matmul:v_proj:L25                0.29     0.1
matmul:v_proj:L11                0.29     0.1
matmul:k_proj:L4                 0.29     0.1
matmul:k_proj:L25                0.29     0.1
matmul:v_proj:L0                 0.29     0.1
matmul:k_proj:L23                0.27     0.1
matmul:k_proj:L5                 0.26     0.1
matmul:k_proj:L19                0.26     0.1
matmul:v_proj:L1                 0.26     0.1
matmul:v_proj:L23                0.25     0.1
matmul:k_proj:L20                0.25     0.1
matmul:k_proj:L1                 0.25     0.1
matmul:k_proj:L10                0.25     0.1
matmul:k_proj:L3                 0.25     0.1
matmul:v_proj:L10                0.25     0.1
matmul:k_proj:L9                 0.25     0.1
matmul:v_proj:L20                0.25     0.1
matmul:v_proj:L9                 0.25     0.1
matmul:v_proj:L5                 0.25     0.1
matmul:v_proj:L19                0.25     0.1
matmul:v_proj:L3                 0.24     0.1
matmul:v_proj:L13                0.24     0.1
matmul:k_proj:L15                0.24     0.1
matmul:k_proj:L13                0.23     0.1
matmul:k_proj:L22                0.23     0.1
matmul:v_proj:L22                0.23     0.1
matmul:v_proj:L18                0.23     0.1
matmul:k_proj:L18                0.23     0.1
matmul:k_proj:L12                0.23     0.1
matmul:k_proj:L2                 0.23     0.1
matmul:k_proj:L17                0.23     0.1
matmul:v_proj:L12                0.23     0.1
matmul:k_proj:L7                 0.23     0.1
matmul:v_proj:L6                 0.23     0.1
matmul:v_proj:L7                 0.22     0.1
matmul:k_proj:L16                0.22     0.1
matmul:k_proj:L8                 0.22     0.1
matmul:v_proj:L8                 0.22     0.1
matmul:v_proj:L17                0.22     0.1
matmul:k_proj:L6                 0.22     0.1
matmul:v_proj:L2                 0.22     0.1
matmul:v_proj:L16                0.22     0.0
matmul:v_proj:L15                0.22     0.0
sample_phase1                    0.12     0.0
gather                           0.02     0.0
scale                            0.01     0.0
──────────────────────────────────────────────────
TOTAL                          443.74   100.0

[browser:warning] [7554.7ms][Profile] Batch decode (N=4):
[browser:warning] [7554.8ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
matmul:lm_head                  99.97    22.2
attention                       70.50    15.6
rmsnorm                          6.40     1.4
matmul:ffn_up:L7                 3.75     0.8
matmul:ffn_down:L16              3.63     0.8
matmul:ffn_down:L12              3.54     0.8
matmul:ffn_down:L22              3.51     0.8
sample_phase2                    3.49     0.8
matmul:ffn_down:L11              3.44     0.8
matmul:ffn_down:L1               3.44     0.8
matmul:ffn_down:L6               3.42     0.8
matmul:ffn_down:L7               3.42     0.8
matmul:ffn_down:L21              3.42     0.8
matmul:ffn_down:L17              3.39     0.8
matmul:ffn_up:L16                3.39     0.8
matmul:ffn_down:L15              3.38     0.7
matmul:ffn_up:L2                 3.35     0.7
matmul:ffn_down:L25              3.32     0.7
matmul:ffn_down:L2               3.28     0.7
matmul:ffn_gate:L12              3.25     0.7
matmul:ffn_down:L8               3.25     0.7
matmul:ffn_down:L10              3.22     0.7
matmul:ffn_up:L11                3.22     0.7
matmul:ffn_down:L20              3.22     0.7
matmul:ffn_down:L13              3.22     0.7
matmul:ffn_down:L18              3.21     0.7
matmul:ffn_down:L24              3.21     0.7
matmul:ffn_down:L14              3.21     0.7
matmul:ffn_down:L19              3.21     0.7
matmul:ffn_down:L9               3.21     0.7
matmul:ffn_down:L4               3.20     0.7
matmul:ffn_down:L5               3.20     0.7
matmul:ffn_down:L3               3.20     0.7
matmul:ffn_down:L0               3.20     0.7
matmul:ffn_down:L23              3.20     0.7
matmul:ffn_gate:L2               2.95     0.7
matmul:ffn_gate:L7               2.82     0.6
matmul:ffn_up:L12                2.77     0.6
matmul:ffn_gate:L3               2.72     0.6
matmul:ffn_gate:L6               2.69     0.6
matmul:ffn_gate:L22              2.68     0.6
matmul:ffn_up:L22                2.68     0.6
matmul:ffn_up:L21                2.67     0.6
matmul:ffn_up:L25                2.67     0.6
matmul:ffn_gate:L21              2.66     0.6
matmul:ffn_gate:L16              2.66     0.6
matmul:ffn_up:L1                 2.65     0.6
matmul:ffn_gate:L11              2.64     0.6
matmul:ffn_gate:L8               2.64     0.6
matmul:ffn_up:L8                 2.64     0.6
matmul:ffn_up:L17                2.62     0.6
matmul:ffn_gate:L17              2.62     0.6
matmul:ffn_up:L6                 2.62     0.6
matmul:ffn_up:L23                2.61     0.6
matmul:ffn_up:L15                2.61     0.6
matmul:ffn_gate:L0               2.61     0.6
matmul:ffn_up:L14                2.61     0.6
matmul:ffn_up:L3                 2.60     0.6
matmul:ffn_up:L4                 2.60     0.6
matmul:ffn_up:L5                 2.60     0.6
matmul:ffn_up:L20                2.60     0.6
matmul:ffn_gate:L9               2.60     0.6
matmul:ffn_up:L0                 2.60     0.6
matmul:ffn_up:L19                2.60     0.6
matmul:ffn_gate:L23              2.60     0.6
matmul:ffn_gate:L20              2.60     0.6
matmul:ffn_gate:L18              2.60     0.6
matmul:ffn_gate:L15              2.60     0.6
matmul:ffn_up:L24                2.60     0.6
matmul:ffn_gate:L1               2.60     0.6
matmul:ffn_gate:L5               2.60     0.6
matmul:ffn_gate:L4               2.60     0.6
matmul:ffn_up:L13                2.60     0.6
matmul:ffn_gate:L25              2.60     0.6
matmul:ffn_up:L10                2.60     0.6
matmul:ffn_gate:L19              2.60     0.6
matmul:ffn_gate:L24              2.60     0.6
matmul:ffn_gate:L14              2.60     0.6
matmul:ffn_up:L9                 2.60     0.6
matmul:ffn_gate:L10              2.60     0.6
matmul:ffn_up:L18                2.60     0.6
matmul:ffn_gate:L13              2.60     0.6
sample_phase1                    1.31     0.3
matmul:o_proj:L17                0.95     0.2
rope                             0.87     0.2
cast_f32_to_f16                  0.73     0.2
matmul:o_proj:L22                0.71     0.2
matmul:o_proj:L2                 0.67     0.1
matmul:o_proj:L3                 0.64     0.1
matmul:q_proj:L0                 0.62     0.1
matmul:o_proj:L7                 0.55     0.1
matmul:q_proj:L17                0.55     0.1
matmul:o_proj:L12                0.54     0.1
matmul:q_proj:L12                0.53     0.1
matmul:q_proj:L22                0.53     0.1
matmul:q_proj:L23                0.53     0.1
matmul:q_proj:L18                0.52     0.1
matmul:q_proj:L13                0.52     0.1
matmul:o_proj:L8                 0.52     0.1
matmul:q_proj:L8                 0.52     0.1
matmul:o_proj:L21                0.51     0.1
matmul:q_proj:L2                 0.51     0.1
matmul:o_proj:L11                0.51     0.1
matmul:q_proj:L7                 0.51     0.1
matmul:o_proj:L16                0.51     0.1
matmul:o_proj:L0                 0.50     0.1
matmul:q_proj:L16                0.50     0.1
matmul:q_proj:L3                 0.50     0.1
matmul:o_proj:L25                0.49     0.1
matmul:q_proj:L25                0.49     0.1
matmul:q_proj:L15                0.49     0.1
matmul:q_proj:L5                 0.49     0.1
matmul:q_proj:L10                0.49     0.1
matmul:q_proj:L11                0.49     0.1
matmul:o_proj:L5                 0.49     0.1
matmul:q_proj:L20                0.49     0.1
matmul:q_proj:L6                 0.49     0.1
matmul:q_proj:L21                0.49     0.1
matmul:q_proj:L24                0.49     0.1
matmul:q_proj:L1                 0.49     0.1
matmul:q_proj:L14                0.49     0.1
matmul:o_proj:L4                 0.49     0.1
matmul:q_proj:L9                 0.49     0.1
matmul:q_proj:L19                0.49     0.1
matmul:o_proj:L24                0.48     0.1
matmul:o_proj:L14                0.48     0.1
matmul:q_proj:L4                 0.48     0.1
matmul:o_proj:L9                 0.48     0.1
matmul:o_proj:L6                 0.48     0.1
matmul:o_proj:L15                0.48     0.1
matmul:o_proj:L1                 0.48     0.1
matmul:o_proj:L20                0.48     0.1
matmul:o_proj:L18                0.48     0.1
matmul:o_proj:L10                0.48     0.1
matmul:o_proj:L23                0.48     0.1
matmul:o_proj:L13                0.48     0.1
matmul:o_proj:L19                0.48     0.1
gelu                             0.47     0.1
matmul:v_proj:L7                 0.32     0.1
matmul:k_proj:L17                0.32     0.1
matmul:v_proj:L17                0.31     0.1
matmul:k_proj:L12                0.31     0.1
matmul:v_proj:L12                0.31     0.1
matmul:v_proj:L22                0.31     0.1
matmul:k_proj:L22                0.30     0.1
matmul:v_proj:L13                0.30     0.1
matmul:v_proj:L21                0.30     0.1
matmul:k_proj:L11                0.30     0.1
matmul:v_proj:L0                 0.30     0.1
matmul:k_proj:L18                0.29     0.1
matmul:k_proj:L0                 0.29     0.1
matmul:v_proj:L23                0.29     0.1
matmul:k_proj:L13                0.29     0.1
matmul:v_proj:L8                 0.29     0.1
matmul:k_proj:L23                0.29     0.1
matmul:v_proj:L11                0.29     0.1
matmul:v_proj:L18                0.29     0.1
matmul:k_proj:L7                 0.28     0.1
matmul:k_proj:L8                 0.28     0.1
matmul:k_proj:L21                0.27     0.1
matmul:k_proj:L3                 0.25     0.1
matmul:k_proj:L16                0.25     0.1
matmul:v_proj:L16                0.25     0.1
matmul:k_proj:L2                 0.25     0.1
matmul:v_proj:L2                 0.24     0.1
matmul:v_proj:L3                 0.24     0.1
matmul:k_proj:L15                0.23     0.1
matmul:k_proj:L5                 0.23     0.1
matmul:v_proj:L1                 0.23     0.1
matmul:k_proj:L25                0.23     0.1
matmul:k_proj:L4                 0.23     0.1
matmul:k_proj:L6                 0.23     0.1
matmul:k_proj:L1                 0.23     0.1
matmul:v_proj:L20                0.23     0.1
matmul:k_proj:L14                0.23     0.1
matmul:k_proj:L24                0.23     0.1
matmul:k_proj:L19                0.23     0.1
matmul:v_proj:L9                 0.23     0.1
matmul:v_proj:L10                0.23     0.1
matmul:v_proj:L6                 0.23     0.1
matmul:k_proj:L9                 0.23     0.1
matmul:k_proj:L20                0.23     0.0
matmul:v_proj:L25                0.23     0.0
matmul:k_proj:L10                0.23     0.0
matmul:v_proj:L15                0.22     0.0
matmul:v_proj:L4                 0.22     0.0
matmul:v_proj:L5                 0.22     0.0
matmul:v_proj:L14                0.22     0.0
matmul:v_proj:L24                0.22     0.0
matmul:v_proj:L19                0.22     0.0
sample_phase3                    0.05     0.0
gather                           0.02     0.0
scale                            0.01     0.0
──────────────────────────────────────────────────
TOTAL                          451.26   100.0

[browser:warning] [8056.1ms][Profile] Batch decode (N=4):
[browser:warning] [8056.3ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
matmul:lm_head                  98.16    21.4
attention                       77.33    16.9
rmsnorm                          8.99     2.0
matmul:ffn_gate:L3               3.80     0.8
matmul:ffn_down:L18              3.72     0.8
matmul:ffn_down:L8               3.55     0.8
matmul:ffn_down:L17              3.54     0.8
matmul:ffn_up:L8                 3.47     0.8
sample_phase2                    3.45     0.8
matmul:ffn_down:L22              3.44     0.8
matmul:ffn_down:L12              3.44     0.7
matmul:ffn_down:L9               3.43     0.7
matmul:ffn_down:L3               3.41     0.7
matmul:ffn_down:L21              3.38     0.7
matmul:ffn_down:L11              3.37     0.7
matmul:ffn_gate:L12              3.33     0.7
matmul:ffn_down:L7               3.31     0.7
matmul:ffn_down:L2               3.31     0.7
matmul:ffn_up:L22                3.27     0.7
matmul:ffn_down:L0               3.26     0.7
matmul:ffn_down:L20              3.22     0.7
matmul:ffn_down:L6               3.22     0.7
matmul:ffn_down:L16              3.22     0.7
matmul:ffn_down:L14              3.21     0.7
matmul:ffn_down:L19              3.21     0.7
matmul:ffn_down:L1               3.21     0.7
matmul:ffn_down:L10              3.21     0.7
matmul:ffn_down:L5               3.20     0.7
matmul:ffn_down:L24              3.20     0.7
matmul:ffn_down:L15              3.20     0.7
matmul:ffn_down:L13              3.20     0.7
matmul:ffn_down:L25              3.20     0.7
matmul:ffn_down:L23              3.20     0.7
matmul:ffn_down:L4               3.19     0.7
matmul:ffn_up:L12                2.93     0.6
matmul:ffn_up:L9                 2.83     0.6
matmul:ffn_gate:L8               2.69     0.6
matmul:ffn_up:L17                2.69     0.6
matmul:ffn_gate:L22              2.69     0.6
matmul:ffn_up:L18                2.68     0.6
matmul:ffn_gate:L18              2.68     0.6
matmul:ffn_up:L7                 2.67     0.6
matmul:ffn_up:L2                 2.66     0.6
matmul:ffn_gate:L17              2.65     0.6
matmul:ffn_gate:L9               2.64     0.6
matmul:ffn_up:L21                2.64     0.6
matmul:ffn_gate:L21              2.64     0.6
matmul:ffn_up:L0                 2.63     0.6
matmul:ffn_up:L3                 2.63     0.6
matmul:ffn_gate:L0               2.61     0.6
matmul:ffn_gate:L20              2.61     0.6
matmul:ffn_gate:L11              2.61     0.6
matmul:ffn_up:L5                 2.61     0.6
matmul:ffn_gate:L1               2.61     0.6
matmul:ffn_gate:L13              2.61     0.6
matmul:ffn_up:L25                2.61     0.6
matmul:ffn_up:L11                2.61     0.6
matmul:ffn_up:L15                2.60     0.6
matmul:ffn_gate:L10              2.60     0.6
matmul:ffn_up:L14                2.60     0.6
matmul:ffn_gate:L23              2.60     0.6
matmul:ffn_up:L13                2.60     0.6
matmul:ffn_gate:L24              2.60     0.6
matmul:ffn_gate:L14              2.60     0.6
matmul:ffn_up:L24                2.60     0.6
matmul:ffn_gate:L4               2.60     0.6
matmul:ffn_gate:L7               2.60     0.6
matmul:ffn_up:L23                2.60     0.6
matmul:ffn_gate:L19              2.60     0.6
matmul:ffn_gate:L2               2.60     0.6
matmul:ffn_up:L19                2.60     0.6
matmul:ffn_up:L10                2.60     0.6
matmul:ffn_gate:L16              2.60     0.6
matmul:ffn_up:L6                 2.60     0.6
matmul:ffn_gate:L15              2.60     0.6
matmul:ffn_up:L4                 2.60     0.6
matmul:ffn_gate:L25              2.60     0.6
matmul:ffn_gate:L5               2.60     0.6
matmul:ffn_up:L1                 2.60     0.6
matmul:ffn_up:L20                2.60     0.6
matmul:ffn_gate:L6               2.60     0.6
matmul:ffn_up:L16                2.60     0.6
matmul:k_proj:L0                 1.35     0.3
sample_phase3                    1.21     0.3
gelu                             1.02     0.2
rope                             0.80     0.2
matmul:k_proj:L17                0.78     0.2
cast_f32_to_f16                  0.69     0.2
matmul:o_proj:L13                0.63     0.1
matmul:o_proj:L4                 0.61     0.1
matmul:o_proj:L3                 0.59     0.1
matmul:o_proj:L18                0.57     0.1
matmul:q_proj:L19                0.57     0.1
matmul:q_proj:L0                 0.56     0.1
matmul:q_proj:L22                0.55     0.1
matmul:o_proj:L8                 0.55     0.1
matmul:q_proj:L9                 0.54     0.1
matmul:o_proj:L22                0.54     0.1
matmul:q_proj:L18                0.53     0.1
matmul:q_proj:L23                0.52     0.1
matmul:o_proj:L0                 0.52     0.1
matmul:o_proj:L9                 0.52     0.1
matmul:q_proj:L12                0.51     0.1
matmul:q_proj:L8                 0.51     0.1
matmul:q_proj:L4                 0.51     0.1
matmul:q_proj:L17                0.51     0.1
matmul:o_proj:L12                0.51     0.1
matmul:q_proj:L13                0.51     0.1
matmul:o_proj:L21                0.50     0.1
matmul:q_proj:L3                 0.50     0.1
matmul:q_proj:L2                 0.49     0.1
matmul:q_proj:L10                0.49     0.1
matmul:q_proj:L7                 0.49     0.1
matmul:q_proj:L20                0.49     0.1
matmul:q_proj:L24                0.49     0.1
matmul:o_proj:L25                0.49     0.1
matmul:o_proj:L24                0.49     0.1
matmul:q_proj:L25                0.49     0.1
matmul:o_proj:L17                0.49     0.1
matmul:q_proj:L21                0.49     0.1
matmul:q_proj:L6                 0.49     0.1
matmul:q_proj:L16                0.49     0.1
matmul:q_proj:L11                0.49     0.1
matmul:q_proj:L14                0.49     0.1
matmul:o_proj:L6                 0.49     0.1
matmul:o_proj:L23                0.49     0.1
matmul:q_proj:L15                0.49     0.1
matmul:q_proj:L5                 0.49     0.1
matmul:o_proj:L5                 0.49     0.1
matmul:q_proj:L1                 0.48     0.1
matmul:o_proj:L20                0.48     0.1
matmul:o_proj:L7                 0.48     0.1
matmul:o_proj:L16                0.48     0.1
matmul:o_proj:L11                0.48     0.1
matmul:o_proj:L15                0.48     0.1
matmul:o_proj:L1                 0.48     0.1
matmul:o_proj:L2                 0.48     0.1
matmul:o_proj:L10                0.48     0.1
matmul:o_proj:L19                0.48     0.1
matmul:o_proj:L14                0.48     0.1
matmul:k_proj:L19                0.31     0.1
matmul:v_proj:L22                0.29     0.1
matmul:k_proj:L22                0.29     0.1
matmul:v_proj:L0                 0.29     0.1
matmul:v_proj:L21                0.29     0.1
matmul:k_proj:L23                0.29     0.1
matmul:v_proj:L23                0.29     0.1
matmul:v_proj:L19                0.29     0.1
matmul:k_proj:L9                 0.29     0.1
matmul:k_proj:L18                0.28     0.1
matmul:k_proj:L21                0.27     0.1
matmul:v_proj:L18                0.27     0.1
matmul:k_proj:L12                0.25     0.1
matmul:v_proj:L8                 0.25     0.1
matmul:k_proj:L13                0.25     0.1
matmul:k_proj:L4                 0.25     0.1
matmul:k_proj:L8                 0.25     0.1
matmul:v_proj:L9                 0.25     0.1
matmul:v_proj:L3                 0.24     0.1
matmul:k_proj:L3                 0.24     0.1
matmul:v_proj:L13                0.24     0.1
matmul:v_proj:L12                0.24     0.1
matmul:v_proj:L4                 0.24     0.1
matmul:k_proj:L7                 0.23     0.1
matmul:k_proj:L16                0.23     0.1
matmul:k_proj:L6                 0.23     0.1
matmul:k_proj:L15                0.23     0.1
matmul:v_proj:L5                 0.23     0.0
matmul:k_proj:L10                0.23     0.0
matmul:k_proj:L20                0.22     0.0
matmul:v_proj:L16                0.22     0.0
matmul:k_proj:L11                0.22     0.0
matmul:v_proj:L11                0.22     0.0
matmul:k_proj:L1                 0.22     0.0
matmul:k_proj:L14                0.22     0.0
matmul:v_proj:L10                0.22     0.0
matmul:v_proj:L17                0.22     0.0
matmul:k_proj:L2                 0.22     0.0
matmul:k_proj:L5                 0.22     0.0
matmul:k_proj:L25                0.22     0.0
matmul:k_proj:L24                0.22     0.0
matmul:v_proj:L6                 0.22     0.0
matmul:v_proj:L1                 0.22     0.0
matmul:v_proj:L25                0.22     0.0
matmul:v_proj:L7                 0.22     0.0
matmul:v_proj:L2                 0.22     0.0
matmul:v_proj:L20                0.22     0.0
matmul:v_proj:L14                0.22     0.0
matmul:v_proj:L15                0.22     0.0
matmul:v_proj:L24                0.22     0.0
sample_phase1                    0.15     0.0
gather                           0.02     0.0
scale                            0.01     0.0
──────────────────────────────────────────────────
TOTAL                          458.78   100.0

[browser:warning] [8561.7ms][Profile] Batch decode (N=4):
[browser:warning] [8561.8ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
matmul:lm_head                  97.39    21.1
attention                       84.63    18.3
rmsnorm                          5.47     1.2
matmul:ffn_down:L20              3.63     0.8
matmul:ffn_down:L16              3.60     0.8
matmul:ffn_down:L11              3.54     0.8
matmul:ffn_down:L6               3.48     0.8
matmul:ffn_down:L21              3.47     0.8
matmul:ffn_down:L25              3.46     0.7
matmul:ffn_down:L17              3.45     0.7
matmul:ffn_down:L2               3.43     0.7
matmul:ffn_down:L19              3.42     0.7
matmul:ffn_down:L8               3.42     0.7
matmul:ffn_down:L24              3.40     0.7
sample_phase2                    3.38     0.7
matmul:ffn_down:L1               3.37     0.7
matmul:ffn_down:L10              3.35     0.7
matmul:ffn_down:L15              3.35     0.7
matmul:ffn_down:L7               3.29     0.7
matmul:ffn_down:L0               3.22     0.7
matmul:ffn_down:L14              3.21     0.7
matmul:ffn_up:L1                 3.21     0.7
matmul:ffn_down:L18              3.21     0.7
matmul:ffn_down:L5               3.21     0.7
matmul:ffn_down:L4               3.21     0.7
matmul:ffn_down:L13              3.21     0.7
matmul:ffn_down:L9               3.21     0.7
matmul:ffn_down:L12              3.20     0.7
matmul:ffn_down:L23              3.20     0.7
matmul:ffn_down:L22              3.20     0.7
matmul:ffn_down:L3               3.19     0.7
matmul:ffn_up:L20                3.18     0.7
matmul:ffn_up:L21                2.93     0.6
matmul:ffn_up:L8                 2.85     0.6
matmul:ffn_gate:L7               2.75     0.6
matmul:ffn_gate:L12              2.74     0.6
matmul:ffn_gate:L11              2.70     0.6
matmul:ffn_up:L11                2.67     0.6
matmul:ffn_gate:L10              2.67     0.6
matmul:ffn_up:L25                2.67     0.6
matmul:ffn_gate:L15              2.66     0.6
matmul:ffn_gate:L20              2.66     0.6
matmul:ffn_up:L17                2.65     0.6
matmul:ffn_up:L10                2.65     0.6
matmul:ffn_gate:L17              2.65     0.6
matmul:ffn_up:L15                2.65     0.6
matmul:ffn_gate:L2               2.65     0.6
matmul:ffn_up:L2                 2.64     0.6
matmul:ffn_gate:L25              2.64     0.6
matmul:ffn_gate:L16              2.64     0.6
matmul:ffn_up:L16                2.64     0.6
matmul:ffn_gate:L1               2.64     0.6
matmul:ffn_gate:L8               2.64     0.6
matmul:ffn_gate:L21              2.64     0.6
matmul:ffn_up:L7                 2.64     0.6
matmul:ffn_up:L6                 2.63     0.6
matmul:ffn_gate:L6               2.63     0.6
matmul:ffn_up:L22                2.61     0.6
matmul:ffn_gate:L24              2.61     0.6
matmul:ffn_up:L19                2.60     0.6
matmul:ffn_gate:L0               2.60     0.6
matmul:ffn_up:L3                 2.60     0.6
matmul:ffn_up:L12                2.60     0.6
matmul:ffn_up:L14                2.60     0.6
matmul:ffn_gate:L9               2.60     0.6
matmul:ffn_gate:L19              2.60     0.6
matmul:ffn_up:L5                 2.60     0.6
matmul:ffn_up:L0                 2.60     0.6
matmul:ffn_gate:L14              2.60     0.6
matmul:ffn_up:L9                 2.60     0.6
matmul:ffn_gate:L18              2.60     0.6
matmul:ffn_gate:L5               2.60     0.6
matmul:ffn_up:L4                 2.60     0.6
matmul:ffn_gate:L23              2.60     0.6
matmul:ffn_gate:L13              2.60     0.6
matmul:ffn_up:L18                2.60     0.6
matmul:ffn_up:L24                2.60     0.6
matmul:ffn_gate:L4               2.60     0.6
matmul:ffn_up:L13                2.60     0.6
matmul:ffn_gate:L3               2.60     0.6
matmul:ffn_up:L23                2.60     0.6
matmul:ffn_gate:L22              2.59     0.6
cast_f32_to_f16                  1.90     0.4
matmul:o_proj:L12                1.57     0.3
gelu                             1.04     0.2
sample_phase3                    0.98     0.2
rope                             0.96     0.2
matmul:k_proj:L0                 0.80     0.2
matmul:o_proj:L11                0.58     0.1
gather                           0.55     0.1
matmul:q_proj:L17                0.55     0.1
matmul:q_proj:L7                 0.55     0.1
matmul:q_proj:L21                0.54     0.1
matmul:q_proj:L0                 0.54     0.1
matmul:q_proj:L2                 0.53     0.1
matmul:q_proj:L18                0.52     0.1
matmul:o_proj:L21                0.52     0.1
matmul:q_proj:L12                0.52     0.1
matmul:o_proj:L25                0.52     0.1
matmul:o_proj:L8                 0.52     0.1
matmul:o_proj:L1                 0.52     0.1
matmul:o_proj:L7                 0.52     0.1
matmul:o_proj:L16                0.52     0.1
matmul:q_proj:L20                0.52     0.1
matmul:q_proj:L16                0.52     0.1
matmul:q_proj:L3                 0.52     0.1
matmul:q_proj:L25                0.51     0.1
matmul:o_proj:L20                0.51     0.1
matmul:q_proj:L11                0.51     0.1
matmul:o_proj:L17                0.51     0.1
matmul:o_proj:L6                 0.51     0.1
matmul:q_proj:L8                 0.51     0.1
matmul:o_proj:L2                 0.50     0.1
matmul:o_proj:L15                0.50     0.1
matmul:q_proj:L1                 0.49     0.1
matmul:q_proj:L22                0.49     0.1
matmul:q_proj:L6                 0.49     0.1
matmul:q_proj:L23                0.49     0.1
matmul:q_proj:L9                 0.49     0.1
matmul:q_proj:L24                0.49     0.1
matmul:q_proj:L14                0.49     0.1
matmul:q_proj:L5                 0.49     0.1
matmul:q_proj:L10                0.49     0.1
matmul:q_proj:L13                0.49     0.1
matmul:q_proj:L19                0.49     0.1
matmul:q_proj:L15                0.49     0.1
matmul:o_proj:L3                 0.48     0.1
matmul:q_proj:L4                 0.48     0.1
matmul:o_proj:L24                0.48     0.1
matmul:o_proj:L9                 0.48     0.1
matmul:o_proj:L4                 0.48     0.1
matmul:o_proj:L23                0.48     0.1
matmul:o_proj:L18                0.48     0.1
matmul:o_proj:L0                 0.48     0.1
matmul:o_proj:L5                 0.48     0.1
matmul:o_proj:L19                0.48     0.1
matmul:o_proj:L22                0.48     0.1
matmul:o_proj:L10                0.48     0.1
matmul:o_proj:L13                0.48     0.1
matmul:o_proj:L14                0.48     0.1
matmul:k_proj:L18                0.29     0.1
matmul:v_proj:L18                0.29     0.1
matmul:v_proj:L2                 0.29     0.1
matmul:k_proj:L2                 0.29     0.1
matmul:v_proj:L7                 0.29     0.1
matmul:v_proj:L0                 0.29     0.1
matmul:k_proj:L16                0.28     0.1
matmul:k_proj:L11                0.28     0.1
matmul:k_proj:L25                0.28     0.1
matmul:v_proj:L11                0.28     0.1
matmul:k_proj:L20                0.28     0.1
matmul:k_proj:L7                 0.28     0.1
matmul:v_proj:L20                0.28     0.1
matmul:v_proj:L16                0.27     0.1
matmul:v_proj:L25                0.27     0.1
matmul:k_proj:L21                0.27     0.1
matmul:k_proj:L3                 0.26     0.1
matmul:v_proj:L8                 0.26     0.1
matmul:v_proj:L12                0.26     0.1
matmul:v_proj:L3                 0.26     0.1
matmul:k_proj:L12                0.25     0.1
matmul:v_proj:L21                0.25     0.1
matmul:k_proj:L17                0.25     0.1
matmul:k_proj:L8                 0.25     0.1
matmul:v_proj:L17                0.24     0.1
matmul:k_proj:L6                 0.23     0.1
matmul:k_proj:L1                 0.23     0.0
matmul:k_proj:L5                 0.23     0.0
matmul:k_proj:L23                0.23     0.0
matmul:k_proj:L19                0.23     0.0
matmul:v_proj:L1                 0.23     0.0
matmul:k_proj:L4                 0.23     0.0
matmul:v_proj:L19                0.23     0.0
matmul:k_proj:L10                0.23     0.0
matmul:v_proj:L22                0.23     0.0
matmul:k_proj:L14                0.23     0.0
matmul:v_proj:L9                 0.23     0.0
matmul:k_proj:L22                0.23     0.0
matmul:k_proj:L24                0.23     0.0
matmul:v_proj:L4                 0.23     0.0
matmul:k_proj:L15                0.23     0.0
matmul:k_proj:L9                 0.23     0.0
matmul:k_proj:L13                0.23     0.0
matmul:v_proj:L6                 0.22     0.0
matmul:v_proj:L10                0.22     0.0
matmul:v_proj:L15                0.22     0.0
matmul:v_proj:L14                0.22     0.0
matmul:v_proj:L24                0.22     0.0
matmul:v_proj:L13                0.22     0.0
matmul:v_proj:L5                 0.22     0.0
matmul:v_proj:L23                0.22     0.0
sample_phase1                    0.12     0.0
scale                            0.02     0.0
──────────────────────────────────────────────────
TOTAL                          462.44   100.0

[browser:warning] [9074.5ms][Profile] Batch decode (N=4):
[browser:warning] [9074.7ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
matmul:lm_head                  98.40    20.9
attention                       91.45    19.4
rmsnorm                          4.43     0.9
matmul:ffn_down:L1               3.46     0.7
matmul:ffn_down:L10              3.45     0.7
matmul:ffn_down:L18              3.45     0.7
matmul:ffn_down:L15              3.45     0.7
matmul:ffn_down:L13              3.44     0.7
matmul:ffn_down:L3               3.44     0.7
matmul:ffn_down:L19              3.44     0.7
matmul:ffn_down:L8               3.42     0.7
matmul:ffn_down:L6               3.42     0.7
matmul:ffn_down:L14              3.38     0.7
matmul:ffn_down:L5               3.38     0.7
matmul:ffn_down:L16              3.38     0.7
matmul:ffn_down:L22              3.38     0.7
matmul:ffn_down:L25              3.37     0.7
matmul:ffn_down:L9               3.37     0.7
matmul:ffn_down:L7               3.37     0.7
matmul:ffn_down:L24              3.37     0.7
matmul:ffn_down:L17              3.37     0.7
matmul:ffn_down:L0               3.37     0.7
matmul:ffn_down:L12              3.37     0.7
sample_phase2                    3.34     0.7
matmul:ffn_down:L4               3.33     0.7
matmul:ffn_gate:L1               3.22     0.7
matmul:ffn_down:L2               3.22     0.7
matmul:ffn_up:L19                3.21     0.7
matmul:ffn_up:L17                3.21     0.7
matmul:ffn_down:L20              3.21     0.7
matmul:ffn_down:L11              3.21     0.7
matmul:ffn_up:L14                3.20     0.7
matmul:ffn_down:L23              3.20     0.7
matmul:ffn_down:L21              3.20     0.7
matmul:ffn_up:L10                3.19     0.7
matmul:ffn_gate:L23              3.18     0.7
matmul:ffn_gate:L12              3.17     0.7
matmul:ffn_up:L8                 3.13     0.7
matmul:ffn_up:L4                 2.81     0.6
matmul:ffn_up:L6                 2.75     0.6
matmul:ffn_up:L0                 2.70     0.6
matmul:ffn_up:L16                2.69     0.6
matmul:ffn_up:L25                2.69     0.6
matmul:ffn_gate:L0               2.67     0.6
matmul:ffn_gate:L16              2.67     0.6
matmul:ffn_up:L5                 2.66     0.6
matmul:ffn_up:L7                 2.66     0.6
matmul:ffn_gate:L7               2.66     0.6
matmul:ffn_up:L22                2.66     0.6
matmul:ffn_up:L9                 2.66     0.6
matmul:ffn_gate:L9               2.65     0.6
matmul:ffn_up:L24                2.65     0.6
matmul:ffn_gate:L8               2.65     0.6
matmul:ffn_gate:L24              2.65     0.6
matmul:ffn_up:L1                 2.65     0.6
matmul:ffn_up:L15                2.64     0.6
matmul:ffn_gate:L22              2.64     0.6
matmul:ffn_gate:L25              2.64     0.6
matmul:ffn_up:L13                2.64     0.6
matmul:ffn_gate:L10              2.64     0.6
matmul:ffn_gate:L4               2.64     0.6
matmul:ffn_gate:L15              2.64     0.6
matmul:ffn_gate:L17              2.64     0.6
matmul:ffn_gate:L6               2.63     0.6
matmul:ffn_gate:L19              2.63     0.6
matmul:ffn_gate:L13              2.63     0.6
matmul:ffn_gate:L14              2.62     0.6
matmul:ffn_up:L3                 2.61     0.6
matmul:ffn_up:L21                2.61     0.6
matmul:ffn_up:L20                2.61     0.6
matmul:ffn_up:L12                2.61     0.6
matmul:ffn_up:L18                2.60     0.6
matmul:ffn_up:L2                 2.60     0.6
matmul:ffn_gate:L5               2.60     0.6
matmul:ffn_up:L23                2.60     0.6
matmul:ffn_gate:L21              2.60     0.6
matmul:ffn_gate:L18              2.60     0.6
matmul:ffn_gate:L11              2.60     0.6
matmul:ffn_up:L11                2.60     0.6
matmul:ffn_gate:L20              2.60     0.6
matmul:ffn_gate:L3               2.60     0.6
matmul:ffn_gate:L2               2.60     0.6
matmul:o_proj:L5                 0.98     0.2
sample_phase3                    0.88     0.2
rope                             0.88     0.2
matmul:k_proj:L0                 0.83     0.2
cast_f32_to_f16                  0.75     0.2
matmul:q_proj:L0                 0.56     0.1
matmul:q_proj:L23                0.55     0.1
gelu                             0.54     0.1
matmul:q_proj:L13                0.53     0.1
matmul:q_proj:L25                0.53     0.1
matmul:q_proj:L14                0.53     0.1
matmul:o_proj:L13                0.53     0.1
matmul:q_proj:L8                 0.53     0.1
matmul:q_proj:L4                 0.53     0.1
matmul:o_proj:L4                 0.52     0.1
matmul:q_proj:L17                0.52     0.1
matmul:q_proj:L20                0.52     0.1
matmul:q_proj:L6                 0.52     0.1
matmul:q_proj:L1                 0.52     0.1
matmul:q_proj:L10                0.52     0.1
matmul:o_proj:L22                0.52     0.1
matmul:q_proj:L11                0.52     0.1
matmul:q_proj:L15                0.52     0.1
matmul:o_proj:L10                0.52     0.1
matmul:o_proj:L8                 0.52     0.1
matmul:o_proj:L15                0.52     0.1
matmul:o_proj:L25                0.52     0.1
matmul:o_proj:L17                0.52     0.1
matmul:o_proj:L24                0.52     0.1
matmul:o_proj:L0                 0.52     0.1
matmul:q_proj:L19                0.51     0.1
matmul:o_proj:L19                0.51     0.1
matmul:o_proj:L6                 0.51     0.1
matmul:o_proj:L1                 0.51     0.1
matmul:q_proj:L16                0.50     0.1
matmul:q_proj:L5                 0.49     0.1
matmul:q_proj:L7                 0.49     0.1
matmul:q_proj:L24                0.49     0.1
matmul:q_proj:L18                0.49     0.1
matmul:q_proj:L22                0.49     0.1
matmul:q_proj:L9                 0.49     0.1
matmul:q_proj:L21                0.49     0.1
matmul:q_proj:L2                 0.49     0.1
matmul:q_proj:L12                0.49     0.1
matmul:o_proj:L18                0.49     0.1
matmul:q_proj:L3                 0.49     0.1
matmul:o_proj:L23                0.48     0.1
matmul:o_proj:L16                0.48     0.1
matmul:o_proj:L14                0.48     0.1
matmul:o_proj:L2                 0.48     0.1
matmul:o_proj:L12                0.48     0.1
matmul:o_proj:L11                0.48     0.1
matmul:o_proj:L9                 0.48     0.1
matmul:o_proj:L20                0.48     0.1
matmul:o_proj:L3                 0.48     0.1
matmul:o_proj:L21                0.48     0.1
matmul:o_proj:L7                 0.48     0.1
matmul:v_proj:L0                 0.30     0.1
matmul:k_proj:L25                0.30     0.1
matmul:v_proj:L23                0.29     0.1
matmul:v_proj:L14                0.29     0.1
matmul:k_proj:L17                0.29     0.1
matmul:k_proj:L10                0.29     0.1
matmul:k_proj:L8                 0.29     0.1
matmul:v_proj:L8                 0.29     0.1
matmul:k_proj:L4                 0.28     0.1
matmul:v_proj:L1                 0.28     0.1
matmul:v_proj:L17                0.28     0.1
matmul:k_proj:L23                0.28     0.1
matmul:v_proj:L4                 0.28     0.1
matmul:k_proj:L15                0.28     0.1
matmul:k_proj:L1                 0.28     0.1
matmul:v_proj:L25                0.28     0.1
matmul:v_proj:L6                 0.28     0.1
matmul:k_proj:L6                 0.28     0.1
matmul:k_proj:L19                0.28     0.1
matmul:v_proj:L15                0.28     0.1
matmul:v_proj:L10                0.28     0.1
matmul:k_proj:L14                0.28     0.1
matmul:v_proj:L19                0.28     0.1
matmul:v_proj:L13                0.28     0.1
matmul:k_proj:L13                0.27     0.1
matmul:k_proj:L22                0.23     0.0
matmul:k_proj:L16                0.23     0.0
matmul:k_proj:L20                0.23     0.0
matmul:k_proj:L11                0.23     0.0
matmul:v_proj:L9                 0.23     0.0
matmul:k_proj:L2                 0.23     0.0
matmul:k_proj:L24                0.23     0.0
matmul:v_proj:L22                0.23     0.0
matmul:v_proj:L11                0.23     0.0
matmul:k_proj:L9                 0.23     0.0
matmul:k_proj:L21                0.23     0.0
matmul:v_proj:L18                0.23     0.0
matmul:v_proj:L24                0.23     0.0
matmul:k_proj:L7                 0.23     0.0
matmul:k_proj:L3                 0.23     0.0
matmul:k_proj:L5                 0.23     0.0
matmul:v_proj:L16                0.23     0.0
matmul:k_proj:L18                0.23     0.0
matmul:v_proj:L12                0.23     0.0
matmul:k_proj:L12                0.22     0.0
matmul:v_proj:L7                 0.22     0.0
matmul:v_proj:L20                0.22     0.0
matmul:v_proj:L3                 0.22     0.0
matmul:v_proj:L2                 0.22     0.0
matmul:v_proj:L21                0.22     0.0
matmul:v_proj:L5                 0.22     0.0
sample_phase1                    0.11     0.0
gather                           0.03     0.0
scale                            0.02     0.0
──────────────────────────────────────────────────
TOTAL                          470.66   100.0

[browser:warning] [9591.6ms][Profile] Batch decode (N=4):
[browser:warning] [9591.8ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                       98.22    20.7
matmul:lm_head                  96.42    20.3
rmsnorm                          5.72     1.2
matmul:ffn_up:L25                3.75     0.8
matmul:ffn_down:L21              3.69     0.8
matmul:ffn_down:L3               3.68     0.8
matmul:ffn_down:L12              3.66     0.8
matmul:ffn_down:L11              3.63     0.8
matmul:ffn_down:L2               3.57     0.8
matmul:ffn_down:L20              3.56     0.7
sample_phase2                    3.53     0.7
matmul:ffn_down:L18              3.46     0.7
matmul:ffn_down:L6               3.45     0.7
matmul:ffn_down:L17              3.45     0.7
matmul:ffn_down:L15              3.44     0.7
matmul:ffn_down:L9               3.41     0.7
matmul:ffn_down:L24              3.41     0.7
matmul:ffn_down:L14              3.38     0.7
matmul:ffn_down:L5               3.38     0.7
matmul:ffn_down:L8               3.38     0.7
matmul:ffn_down:L23              3.37     0.7
matmul:ffn_down:L16              3.33     0.7
matmul:ffn_down:L13              3.32     0.7
matmul:ffn_down:L7               3.32     0.7
matmul:ffn_down:L4               3.32     0.7
matmul:ffn_down:L22              3.32     0.7
matmul:ffn_down:L0               3.23     0.7
matmul:ffn_down:L25              3.22     0.7
matmul:ffn_down:L1               3.22     0.7
matmul:ffn_down:L19              3.21     0.7
matmul:ffn_down:L10              3.20     0.7
matmul:ffn_gate:L16              3.18     0.7
matmul:ffn_gate:L19              3.17     0.7
matmul:ffn_up:L1                 3.12     0.7
matmul:ffn_up:L11                2.71     0.6
matmul:ffn_up:L2                 2.69     0.6
matmul:ffn_gate:L21              2.68     0.6
matmul:ffn_up:L21                2.68     0.6
matmul:ffn_gate:L3               2.68     0.6
matmul:ffn_gate:L12              2.67     0.6
matmul:ffn_up:L3                 2.67     0.6
matmul:ffn_up:L12                2.67     0.6
matmul:ffn_gate:L11              2.67     0.6
matmul:ffn_up:L5                 2.66     0.6
matmul:ffn_gate:L14              2.66     0.6
matmul:ffn_up:L8                 2.66     0.6
matmul:ffn_up:L14                2.65     0.6
matmul:ffn_gate:L5               2.65     0.6
matmul:ffn_up:L20                2.65     0.6
matmul:ffn_up:L15                2.64     0.6
matmul:ffn_gate:L0               2.64     0.6
matmul:ffn_up:L23                2.64     0.6
matmul:ffn_up:L18                2.64     0.6
matmul:ffn_gate:L18              2.64     0.6
matmul:ffn_up:L24                2.64     0.6
matmul:ffn_up:L0                 2.64     0.6
matmul:ffn_up:L9                 2.64     0.6
matmul:ffn_gate:L9               2.64     0.6
matmul:ffn_gate:L24              2.63     0.6
matmul:ffn_up:L6                 2.63     0.6
matmul:ffn_gate:L15              2.63     0.6
matmul:ffn_gate:L6               2.63     0.6
matmul:ffn_gate:L1               2.62     0.6
matmul:ffn_gate:L8               2.61     0.5
matmul:ffn_gate:L4               2.61     0.5
matmul:ffn_gate:L2               2.60     0.5
matmul:ffn_up:L17                2.60     0.5
matmul:ffn_gate:L20              2.60     0.5
matmul:ffn_up:L19                2.60     0.5
matmul:ffn_gate:L23              2.60     0.5
matmul:ffn_gate:L13              2.60     0.5
matmul:ffn_up:L7                 2.60     0.5
matmul:ffn_up:L13                2.60     0.5
matmul:ffn_gate:L10              2.60     0.5
matmul:ffn_gate:L22              2.60     0.5
matmul:ffn_gate:L17              2.60     0.5
matmul:ffn_up:L4                 2.60     0.5
matmul:ffn_up:L10                2.60     0.5
matmul:ffn_gate:L7               2.60     0.5
matmul:ffn_up:L22                2.60     0.5
matmul:ffn_gate:L25              2.60     0.5
matmul:ffn_up:L16                2.60     0.5
rope                             1.47     0.3
cast_f32_to_f16                  0.77     0.2
matmul:q_proj:L0                 0.61     0.1
sample_phase3                    0.59     0.1
matmul:q_proj:L21                0.57     0.1
matmul:q_proj:L3                 0.57     0.1
matmul:q_proj:L12                0.56     0.1
matmul:o_proj:L21                0.56     0.1
matmul:o_proj:L3                 0.55     0.1
matmul:o_proj:L12                0.55     0.1
gelu                             0.54     0.1
matmul:q_proj:L22                0.53     0.1
matmul:o_proj:L24                0.52     0.1
matmul:q_proj:L18                0.52     0.1
matmul:q_proj:L6                 0.52     0.1
matmul:q_proj:L24                0.52     0.1
matmul:o_proj:L9                 0.52     0.1
matmul:q_proj:L15                0.52     0.1
matmul:o_proj:L6                 0.52     0.1
matmul:o_proj:L0                 0.52     0.1
matmul:q_proj:L9                 0.52     0.1
matmul:o_proj:L18                0.52     0.1
matmul:o_proj:L15                0.52     0.1
matmul:o_proj:L10                0.51     0.1
matmul:q_proj:L25                0.49     0.1
matmul:q_proj:L13                0.49     0.1
matmul:q_proj:L4                 0.49     0.1
matmul:q_proj:L7                 0.49     0.1
matmul:q_proj:L8                 0.49     0.1
matmul:q_proj:L10                0.49     0.1
matmul:q_proj:L16                0.49     0.1
matmul:q_proj:L19                0.49     0.1
matmul:q_proj:L23                0.49     0.1
matmul:q_proj:L11                0.49     0.1
matmul:q_proj:L20                0.49     0.1
matmul:q_proj:L14                0.49     0.1
matmul:q_proj:L2                 0.49     0.1
matmul:q_proj:L5                 0.49     0.1
matmul:q_proj:L1                 0.49     0.1
matmul:q_proj:L17                0.49     0.1
matmul:o_proj:L11                0.49     0.1
matmul:o_proj:L2                 0.49     0.1
matmul:o_proj:L22                0.49     0.1
matmul:o_proj:L16                0.49     0.1
matmul:o_proj:L8                 0.49     0.1
matmul:o_proj:L23                0.49     0.1
matmul:o_proj:L7                 0.48     0.1
matmul:o_proj:L14                0.48     0.1
matmul:o_proj:L13                0.48     0.1
matmul:o_proj:L25                0.48     0.1
matmul:o_proj:L17                0.48     0.1
matmul:o_proj:L5                 0.48     0.1
matmul:o_proj:L19                0.48     0.1
matmul:o_proj:L4                 0.48     0.1
matmul:o_proj:L1                 0.48     0.1
matmul:o_proj:L20                0.48     0.1
matmul:k_proj:L0                 0.42     0.1
matmul:v_proj:L0                 0.37     0.1
matmul:k_proj:L21                0.35     0.1
matmul:k_proj:L3                 0.35     0.1
matmul:k_proj:L12                0.35     0.1
matmul:v_proj:L12                0.35     0.1
matmul:v_proj:L3                 0.35     0.1
matmul:v_proj:L21                0.33     0.1
matmul:k_proj:L22                0.30     0.1
matmul:k_proj:L6                 0.29     0.1
matmul:k_proj:L9                 0.29     0.1
matmul:v_proj:L6                 0.29     0.1
matmul:k_proj:L18                0.29     0.1
matmul:v_proj:L18                0.29     0.1
matmul:k_proj:L15                0.29     0.1
matmul:k_proj:L24                0.28     0.1
matmul:v_proj:L24                0.28     0.1
matmul:v_proj:L9                 0.28     0.1
matmul:v_proj:L15                0.28     0.1
matmul:v_proj:L22                0.26     0.1
matmul:k_proj:L19                0.23     0.0
matmul:k_proj:L17                0.23     0.0
matmul:k_proj:L16                0.23     0.0
matmul:k_proj:L4                 0.23     0.0
matmul:k_proj:L10                0.23     0.0
matmul:k_proj:L2                 0.23     0.0
matmul:k_proj:L25                0.23     0.0
matmul:k_proj:L23                0.23     0.0
matmul:k_proj:L8                 0.23     0.0
matmul:v_proj:L13                0.23     0.0
matmul:k_proj:L13                0.23     0.0
matmul:k_proj:L7                 0.23     0.0
matmul:k_proj:L11                0.23     0.0
matmul:v_proj:L19                0.23     0.0
matmul:k_proj:L5                 0.23     0.0
matmul:k_proj:L14                0.23     0.0
matmul:v_proj:L11                0.23     0.0
matmul:v_proj:L4                 0.23     0.0
matmul:k_proj:L20                0.23     0.0
matmul:k_proj:L1                 0.23     0.0
matmul:v_proj:L7                 0.23     0.0
matmul:v_proj:L20                0.23     0.0
matmul:v_proj:L10                0.22     0.0
matmul:v_proj:L25                0.22     0.0
matmul:v_proj:L8                 0.22     0.0
matmul:v_proj:L14                0.22     0.0
matmul:v_proj:L1                 0.22     0.0
matmul:v_proj:L2                 0.22     0.0
matmul:v_proj:L17                0.22     0.0
matmul:v_proj:L23                0.22     0.0
matmul:v_proj:L16                0.22     0.0
matmul:v_proj:L5                 0.22     0.0
sample_phase1                    0.14     0.0
gather                           0.05     0.0
scale                            0.04     0.0
──────────────────────────────────────────────────
TOTAL                          475.56   100.0

[browser:warning] [10125.5ms][Profile] Batch decode (N=4):
[browser:warning] [10125.8ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      105.28    21.8
matmul:lm_head                  98.31    20.3
rmsnorm                          4.37     0.9
matmul:ffn_down:L6               3.61     0.7
matmul:ffn_down:L9               3.57     0.7
matmul:ffn_down:L14              3.54     0.7
matmul:ffn_down:L1               3.49     0.7
matmul:ffn_down:L12              3.46     0.7
matmul:ffn_down:L5               3.46     0.7
matmul:ffn_down:L15              3.45     0.7
matmul:ffn_down:L10              3.45     0.7
matmul:ffn_down:L21              3.45     0.7
matmul:ffn_down:L16              3.40     0.7
matmul:ffn_down:L18              3.38     0.7
matmul:ffn_down:L25              3.38     0.7
matmul:ffn_down:L3               3.38     0.7
matmul:ffn_down:L23              3.37     0.7
sample_phase2                    3.37     0.7
matmul:ffn_down:L19              3.34     0.7
matmul:ffn_down:L20              3.34     0.7
matmul:ffn_down:L4               3.32     0.7
matmul:ffn_down:L24              3.27     0.7
matmul:ffn_down:L7               3.27     0.7
matmul:ffn_down:L0               3.23     0.7
matmul:ffn_down:L13              3.21     0.7
matmul:ffn_down:L11              3.21     0.7
matmul:ffn_up:L7                 3.21     0.7
matmul:ffn_up:L4                 3.21     0.7
matmul:ffn_down:L17              3.21     0.7
matmul:ffn_down:L2               3.20     0.7
matmul:ffn_down:L22              3.20     0.7
matmul:ffn_down:L8               3.20     0.7
matmul:ffn_gate:L20              3.18     0.7
matmul:ffn_gate:L2               3.17     0.7
matmul:ffn_up:L18                3.17     0.7
matmul:ffn_gate:L11              3.17     0.7
matmul:ffn_up:L13                3.17     0.7
matmul:ffn_up:L22                3.17     0.7
matmul:ffn_up:L25                2.70     0.6
matmul:ffn_up:L6                 2.69     0.6
matmul:ffn_gate:L6               2.68     0.6
matmul:ffn_gate:L18              2.68     0.6
matmul:ffn_gate:L25              2.67     0.6
matmul:ffn_up:L3                 2.67     0.6
matmul:ffn_up:L1                 2.66     0.6
matmul:ffn_gate:L3               2.66     0.5
matmul:ffn_gate:L10              2.65     0.5
matmul:ffn_gate:L1               2.64     0.5
matmul:ffn_gate:L16              2.64     0.5
matmul:ffn_gate:L15              2.64     0.5
matmul:ffn_gate:L7               2.64     0.5
matmul:ffn_gate:L4               2.64     0.5
matmul:ffn_up:L10                2.64     0.5
matmul:ffn_gate:L12              2.64     0.5
matmul:ffn_gate:L19              2.64     0.5
matmul:ffn_up:L16                2.64     0.5
matmul:ffn_gate:L21              2.64     0.5
matmul:ffn_up:L19                2.64     0.5
matmul:ffn_gate:L24              2.64     0.5
matmul:ffn_gate:L17              2.64     0.5
matmul:ffn_up:L15                2.64     0.5
matmul:ffn_up:L21                2.63     0.5
matmul:ffn_up:L12                2.63     0.5
matmul:ffn_up:L24                2.63     0.5
matmul:ffn_gate:L23              2.63     0.5
matmul:ffn_up:L23                2.63     0.5
matmul:ffn_up:L17                2.61     0.5
matmul:ffn_up:L20                2.60     0.5
matmul:ffn_gate:L0               2.60     0.5
matmul:ffn_up:L5                 2.60     0.5
matmul:ffn_gate:L22              2.60     0.5
matmul:ffn_up:L2                 2.60     0.5
matmul:ffn_gate:L14              2.60     0.5
matmul:ffn_gate:L5               2.60     0.5
matmul:ffn_up:L9                 2.60     0.5
matmul:ffn_up:L11                2.60     0.5
matmul:ffn_up:L0                 2.60     0.5
matmul:ffn_gate:L9               2.60     0.5
matmul:ffn_gate:L13              2.60     0.5
matmul:ffn_up:L14                2.60     0.5
matmul:ffn_up:L8                 2.60     0.5
matmul:ffn_gate:L8               2.59     0.5
matmul:o_proj:L16                1.10     0.2
matmul:o_proj:L1                 1.07     0.2
rope                             0.96     0.2
cast_f32_to_f16                  0.80     0.2
gelu                             0.60     0.1
matmul:q_proj:L0                 0.57     0.1
matmul:o_proj:L23                0.55     0.1
matmul:o_proj:L6                 0.54     0.1
matmul:q_proj:L15                0.54     0.1
matmul:q_proj:L10                0.53     0.1
matmul:q_proj:L7                 0.53     0.1
matmul:q_proj:L4                 0.53     0.1
matmul:q_proj:L2                 0.53     0.1
matmul:q_proj:L13                0.53     0.1
matmul:q_proj:L6                 0.53     0.1
matmul:q_proj:L16                0.52     0.1
matmul:q_proj:L24                0.52     0.1
matmul:q_proj:L22                0.52     0.1
matmul:q_proj:L17                0.52     0.1
matmul:o_proj:L15                0.52     0.1
matmul:q_proj:L19                0.52     0.1
matmul:q_proj:L21                0.52     0.1
matmul:o_proj:L12                0.52     0.1
matmul:o_proj:L21                0.52     0.1
matmul:o_proj:L10                0.52     0.1
matmul:o_proj:L4                 0.51     0.1
matmul:o_proj:L7                 0.51     0.1
matmul:o_proj:L17                0.51     0.1
matmul:o_proj:L24                0.51     0.1
matmul:o_proj:L19                0.51     0.1
matmul:q_proj:L12                0.49     0.1
matmul:q_proj:L20                0.49     0.1
matmul:q_proj:L23                0.49     0.1
matmul:q_proj:L1                 0.49     0.1
matmul:q_proj:L11                0.49     0.1
matmul:q_proj:L14                0.49     0.1
matmul:q_proj:L5                 0.49     0.1
matmul:q_proj:L3                 0.49     0.1
matmul:q_proj:L25                0.49     0.1
matmul:o_proj:L2                 0.49     0.1
matmul:q_proj:L8                 0.49     0.1
matmul:q_proj:L18                0.49     0.1
matmul:q_proj:L9                 0.49     0.1
matmul:o_proj:L25                0.49     0.1
matmul:o_proj:L22                0.49     0.1
matmul:o_proj:L3                 0.49     0.1
matmul:o_proj:L0                 0.48     0.1
matmul:o_proj:L18                0.48     0.1
matmul:o_proj:L13                0.48     0.1
matmul:o_proj:L11                0.48     0.1
matmul:o_proj:L9                 0.48     0.1
matmul:o_proj:L5                 0.48     0.1
matmul:o_proj:L14                0.48     0.1
matmul:o_proj:L20                0.48     0.1
matmul:o_proj:L8                 0.48     0.1
matmul:v_proj:L0                 0.37     0.1
matmul:k_proj:L0                 0.36     0.1
matmul:k_proj:L15                0.31     0.1
matmul:v_proj:L1                 0.31     0.1
matmul:v_proj:L15                0.30     0.1
matmul:k_proj:L7                 0.30     0.1
matmul:k_proj:L2                 0.30     0.1
matmul:v_proj:L7                 0.30     0.1
matmul:k_proj:L22                0.29     0.1
matmul:k_proj:L13                0.29     0.1
matmul:v_proj:L13                0.29     0.1
matmul:v_proj:L17                0.29     0.1
matmul:k_proj:L4                 0.29     0.1
matmul:k_proj:L21                0.29     0.1
matmul:k_proj:L6                 0.29     0.1
matmul:k_proj:L10                0.29     0.1
matmul:k_proj:L17                0.29     0.1
matmul:k_proj:L24                0.29     0.1
matmul:k_proj:L19                0.29     0.1
matmul:v_proj:L4                 0.29     0.1
matmul:v_proj:L10                0.28     0.1
matmul:v_proj:L19                0.28     0.1
matmul:v_proj:L24                0.28     0.1
matmul:v_proj:L6                 0.28     0.1
matmul:v_proj:L21                0.27     0.1
matmul:k_proj:L1                 0.27     0.1
matmul:v_proj:L12                0.27     0.1
matmul:k_proj:L16                0.25     0.1
matmul:v_proj:L2                 0.24     0.1
matmul:v_proj:L22                0.23     0.0
matmul:v_proj:L16                0.23     0.0
matmul:k_proj:L12                0.23     0.0
matmul:k_proj:L18                0.23     0.0
matmul:k_proj:L23                0.23     0.0
matmul:k_proj:L11                0.23     0.0
sample_phase3                    0.23     0.0
matmul:k_proj:L3                 0.23     0.0
matmul:k_proj:L14                0.23     0.0
matmul:k_proj:L5                 0.23     0.0
matmul:k_proj:L25                0.23     0.0
matmul:v_proj:L11                0.23     0.0
matmul:v_proj:L14                0.23     0.0
matmul:k_proj:L8                 0.22     0.0
matmul:k_proj:L9                 0.22     0.0
matmul:k_proj:L20                0.22     0.0
matmul:v_proj:L23                0.22     0.0
matmul:v_proj:L3                 0.22     0.0
matmul:v_proj:L5                 0.22     0.0
matmul:v_proj:L25                0.22     0.0
matmul:v_proj:L8                 0.22     0.0
matmul:v_proj:L20                0.22     0.0
matmul:v_proj:L18                0.22     0.0
matmul:v_proj:L9                 0.22     0.0
sample_phase1                    0.13     0.0
scale                            0.02     0.0
gather                           0.02     0.0
──────────────────────────────────────────────────
TOTAL                          483.87   100.0

[browser:warning] [10671.3ms][Profile] Batch decode (N=4):
[browser:warning] [10671.5ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      112.75    23.1
matmul:lm_head                  96.78    19.8
rmsnorm                          5.33     1.1
matmul:ffn_down:L17              3.52     0.7
matmul:ffn_down:L4               3.50     0.7
matmul:ffn_down:L2               3.49     0.7
matmul:ffn_down:L24              3.49     0.7
matmul:ffn_down:L8               3.48     0.7
matmul:ffn_down:L22              3.48     0.7
matmul:ffn_down:L6               3.44     0.7
matmul:ffn_down:L9               3.41     0.7
matmul:ffn_down:L7               3.40     0.7
matmul:ffn_down:L13              3.39     0.7
matmul:ffn_down:L11              3.38     0.7
matmul:ffn_down:L15              3.37     0.7
matmul:ffn_down:L0               3.37     0.7
sample_phase2                    3.36     0.7
matmul:ffn_down:L19              3.36     0.7
matmul:ffn_down:L18              3.34     0.7
matmul:ffn_down:L20              3.34     0.7
matmul:ffn_down:L3               3.28     0.7
matmul:ffn_down:L16              3.24     0.7
matmul:ffn_down:L12              3.22     0.7
matmul:ffn_down:L5               3.21     0.7
matmul:ffn_gate:L15              3.21     0.7
matmul:ffn_down:L23              3.21     0.7
matmul:ffn_down:L14              3.21     0.7
matmul:ffn_up:L11                3.21     0.7
matmul:ffn_down:L21              3.21     0.7
matmul:ffn_up:L13                3.20     0.7
matmul:ffn_down:L10              3.20     0.7
matmul:ffn_down:L1               3.20     0.7
matmul:ffn_down:L25              3.20     0.7
matmul:ffn_up:L20                3.16     0.6
matmul:ffn_gate:L2               2.69     0.6
matmul:ffn_gate:L0               2.68     0.5
matmul:ffn_up:L2                 2.66     0.5
matmul:ffn_up:L22                2.66     0.5
matmul:ffn_gate:L20              2.66     0.5
matmul:ffn_gate:L19              2.66     0.5
matmul:ffn_up:L17                2.66     0.5
matmul:ffn_gate:L16              2.65     0.5
matmul:ffn_up:L19                2.65     0.5
matmul:ffn_up:L24                2.65     0.5
matmul:ffn_gate:L11              2.64     0.5
matmul:ffn_gate:L9               2.64     0.5
matmul:ffn_up:L3                 2.64     0.5
matmul:ffn_gate:L18              2.64     0.5
matmul:ffn_up:L7                 2.64     0.5
matmul:ffn_gate:L3               2.64     0.5
matmul:ffn_up:L0                 2.64     0.5
matmul:ffn_gate:L7               2.64     0.5
matmul:ffn_up:L18                2.64     0.5
matmul:ffn_up:L15                2.64     0.5
matmul:ffn_gate:L5               2.63     0.5
matmul:ffn_gate:L13              2.63     0.5
matmul:ffn_up:L16                2.63     0.5
matmul:ffn_up:L9                 2.63     0.5
matmul:ffn_gate:L4               2.63     0.5
matmul:ffn_gate:L24              2.63     0.5
matmul:ffn_gate:L22              2.63     0.5
matmul:ffn_up:L4                 2.63     0.5
matmul:ffn_up:L6                 2.62     0.5
matmul:ffn_up:L5                 2.61     0.5
matmul:ffn_gate:L12              2.61     0.5
matmul:ffn_up:L25                2.61     0.5
matmul:ffn_up:L14                2.61     0.5
matmul:ffn_up:L12                2.61     0.5
matmul:ffn_gate:L17              2.60     0.5
matmul:ffn_gate:L25              2.60     0.5
matmul:ffn_up:L8                 2.60     0.5
matmul:ffn_up:L1                 2.60     0.5
matmul:ffn_gate:L21              2.60     0.5
matmul:ffn_up:L21                2.60     0.5
matmul:ffn_gate:L14              2.60     0.5
matmul:ffn_gate:L23              2.60     0.5
matmul:ffn_gate:L1               2.60     0.5
matmul:ffn_up:L10                2.60     0.5
matmul:ffn_gate:L8               2.60     0.5
matmul:ffn_gate:L6               2.60     0.5
matmul:ffn_gate:L10              2.60     0.5
matmul:ffn_up:L23                2.60     0.5
gelu                             1.03     0.2
rope                             0.96     0.2
matmul:o_proj:L22                0.83     0.2
cast_f32_to_f16                  0.79     0.2
matmul:q_proj:L0                 0.59     0.1
matmul:o_proj:L0                 0.57     0.1
matmul:o_proj:L24                0.56     0.1
matmul:o_proj:L15                0.53     0.1
matmul:q_proj:L12                0.53     0.1
matmul:q_proj:L7                 0.53     0.1
matmul:q_proj:L9                 0.53     0.1
matmul:q_proj:L16                0.53     0.1
matmul:o_proj:L18                0.53     0.1
matmul:q_proj:L3                 0.53     0.1
matmul:q_proj:L25                0.53     0.1
matmul:q_proj:L5                 0.53     0.1
matmul:q_proj:L23                0.52     0.1
matmul:q_proj:L18                0.52     0.1
matmul:q_proj:L20                0.52     0.1
matmul:o_proj:L16                0.52     0.1
matmul:q_proj:L1                 0.52     0.1
matmul:q_proj:L14                0.52     0.1
matmul:o_proj:L12                0.52     0.1
matmul:o_proj:L4                 0.52     0.1
matmul:o_proj:L11                0.52     0.1
matmul:o_proj:L13                0.52     0.1
matmul:o_proj:L3                 0.52     0.1
matmul:o_proj:L7                 0.52     0.1
matmul:o_proj:L5                 0.52     0.1
matmul:o_proj:L20                0.52     0.1
matmul:o_proj:L9                 0.51     0.1
matmul:o_proj:L1                 0.50     0.1
matmul:q_proj:L21                0.49     0.1
matmul:q_proj:L22                0.49     0.1
matmul:q_proj:L24                0.49     0.1
matmul:q_proj:L13                0.49     0.1
matmul:q_proj:L10                0.49     0.1
matmul:q_proj:L8                 0.49     0.1
matmul:q_proj:L17                0.49     0.1
matmul:q_proj:L6                 0.49     0.1
matmul:q_proj:L15                0.49     0.1
matmul:q_proj:L4                 0.49     0.1
matmul:q_proj:L19                0.49     0.1
matmul:o_proj:L23                0.49     0.1
matmul:q_proj:L11                0.49     0.1
matmul:q_proj:L2                 0.49     0.1
matmul:o_proj:L2                 0.48     0.1
matmul:o_proj:L25                0.48     0.1
matmul:o_proj:L19                0.48     0.1
matmul:o_proj:L14                0.48     0.1
matmul:o_proj:L8                 0.48     0.1
matmul:o_proj:L10                0.48     0.1
matmul:o_proj:L21                0.48     0.1
matmul:o_proj:L17                0.48     0.1
matmul:o_proj:L6                 0.48     0.1
matmul:v_proj:L0                 0.34     0.1
matmul:v_proj:L22                0.31     0.1
matmul:k_proj:L0                 0.30     0.1
matmul:k_proj:L9                 0.30     0.1
matmul:v_proj:L25                0.30     0.1
matmul:k_proj:L25                0.30     0.1
matmul:k_proj:L23                0.30     0.1
matmul:v_proj:L9                 0.29     0.1
matmul:v_proj:L24                0.29     0.1
matmul:k_proj:L16                0.29     0.1
matmul:v_proj:L14                0.29     0.1
matmul:k_proj:L18                0.29     0.1
matmul:k_proj:L1                 0.29     0.1
matmul:k_proj:L7                 0.29     0.1
matmul:v_proj:L3                 0.29     0.1
matmul:v_proj:L16                0.29     0.1
matmul:k_proj:L20                0.29     0.1
matmul:k_proj:L3                 0.29     0.1
matmul:k_proj:L5                 0.29     0.1
matmul:v_proj:L7                 0.29     0.1
matmul:v_proj:L23                0.29     0.1
matmul:v_proj:L1                 0.29     0.1
matmul:k_proj:L12                0.28     0.1
matmul:k_proj:L14                0.28     0.1
matmul:v_proj:L18                0.28     0.1
matmul:v_proj:L12                0.28     0.1
matmul:v_proj:L20                0.28     0.1
matmul:v_proj:L5                 0.28     0.1
matmul:k_proj:L22                0.26     0.1
matmul:k_proj:L24                0.26     0.1
matmul:k_proj:L11                0.23     0.0
matmul:k_proj:L10                0.23     0.0
matmul:k_proj:L21                0.23     0.0
matmul:k_proj:L17                0.23     0.0
matmul:k_proj:L13                0.23     0.0
matmul:k_proj:L19                0.23     0.0
matmul:k_proj:L6                 0.23     0.0
matmul:k_proj:L4                 0.23     0.0
matmul:v_proj:L4                 0.23     0.0
matmul:v_proj:L8                 0.23     0.0
matmul:v_proj:L13                0.23     0.0
matmul:k_proj:L8                 0.23     0.0
matmul:v_proj:L11                0.23     0.0
matmul:k_proj:L15                0.22     0.0
matmul:k_proj:L2                 0.22     0.0
matmul:v_proj:L10                0.22     0.0
matmul:v_proj:L2                 0.22     0.0
matmul:v_proj:L6                 0.22     0.0
matmul:v_proj:L19                0.22     0.0
matmul:v_proj:L15                0.22     0.0
matmul:v_proj:L17                0.22     0.0
matmul:v_proj:L21                0.22     0.0
sample_phase1                    0.13     0.0
sample_phase3                    0.08     0.0
gather                           0.05     0.0
scale                            0.03     0.0
──────────────────────────────────────────────────
TOTAL                          487.56   100.0

[browser:warning] [11296.4ms][Profile] Batch decode (N=4):
[browser:warning] [11296.6ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      121.03    21.0
matmul:lm_head                 112.03    19.5
rmsnorm                         21.48     3.7
matmul:ffn_up:L0                 7.17     1.2
matmul:ffn_gate:L12              5.19     0.9
matmul:ffn_up:L6                 5.18     0.9
matmul:ffn_up:L19                4.94     0.9
matmul:ffn_up:L15                4.91     0.9
matmul:ffn_gate:L19              4.05     0.7
matmul:ffn_down:L20              3.95     0.7
matmul:ffn_down:L13              3.93     0.7
matmul:ffn_gate:L8               3.90     0.7
matmul:ffn_gate:L0               3.83     0.7
matmul:ffn_down:L22              3.70     0.6
matmul:ffn_down:L11              3.65     0.6
matmul:ffn_down:L23              3.65     0.6
matmul:ffn_down:L6               3.64     0.6
matmul:ffn_down:L8               3.62     0.6
matmul:ffn_down:L16              3.60     0.6
matmul:ffn_down:L17              3.59     0.6
matmul:ffn_down:L3               3.57     0.6
matmul:ffn_up:L8                 3.57     0.6
matmul:ffn_down:L2               3.55     0.6
matmul:ffn_down:L5               3.54     0.6
matmul:ffn_down:L12              3.53     0.6
sample_phase2                    3.53     0.6
matmul:ffn_down:L10              3.51     0.6
matmul:ffn_down:L25              3.50     0.6
rope                             3.49     0.6
matmul:ffn_gate:L9               3.48     0.6
matmul:ffn_down:L24              3.48     0.6
matmul:ffn_down:L0               3.46     0.6
matmul:ffn_down:L15              3.42     0.6
matmul:ffn_down:L9               3.41     0.6
matmul:ffn_down:L7               3.37     0.6
matmul:ffn_down:L21              3.37     0.6
matmul:ffn_down:L19              3.36     0.6
matmul:ffn_up:L4                 3.31     0.6
matmul:ffn_up:L7                 3.29     0.6
matmul:ffn_down:L1               3.29     0.6
matmul:ffn_down:L4               3.27     0.6
matmul:ffn_down:L18              3.24     0.6
matmul:ffn_down:L14              3.22     0.6
matmul:ffn_gate:L15              3.21     0.6
matmul:ffn_gate:L4               3.02     0.5
matmul:ffn_up:L9                 3.02     0.5
matmul:ffn_up:L12                2.88     0.5
matmul:ffn_up:L3                 2.86     0.5
matmul:ffn_gate:L3               2.86     0.5
matmul:ffn_up:L24                2.83     0.5
matmul:ffn_gate:L24              2.81     0.5
matmul:ffn_gate:L22              2.79     0.5
matmul:ffn_up:L10                2.78     0.5
matmul:ffn_gate:L7               2.75     0.5
matmul:ffn_gate:L20              2.70     0.5
matmul:ffn_up:L20                2.69     0.5
matmul:ffn_gate:L10              2.69     0.5
matmul:ffn_gate:L11              2.68     0.5
matmul:ffn_up:L11                2.67     0.5
matmul:ffn_up:L22                2.66     0.5
matmul:ffn_up:L17                2.65     0.5
matmul:ffn_gate:L6               2.65     0.5
matmul:ffn_gate:L13              2.65     0.5
matmul:ffn_gate:L5               2.64     0.5
matmul:ffn_up:L16                2.64     0.5
matmul:ffn_up:L13                2.64     0.5
matmul:ffn_gate:L23              2.64     0.5
matmul:ffn_gate:L16              2.64     0.5
matmul:ffn_up:L5                 2.64     0.5
matmul:ffn_gate:L17              2.64     0.5
matmul:ffn_up:L21                2.64     0.5
matmul:ffn_up:L23                2.63     0.5
matmul:ffn_up:L1                 2.63     0.5
matmul:ffn_gate:L21              2.61     0.5
matmul:ffn_gate:L1               2.61     0.5
matmul:ffn_gate:L14              2.61     0.5
matmul:ffn_gate:L25              2.61     0.5
matmul:ffn_up:L14                2.61     0.5
matmul:ffn_up:L2                 2.60     0.5
matmul:ffn_gate:L2               2.60     0.5
matmul:ffn_gate:L18              2.60     0.5
matmul:ffn_up:L25                2.60     0.5
matmul:ffn_up:L18                2.60     0.5
matmul:q_proj:L3                 1.89     0.3
matmul:o_proj:L15                1.56     0.3
matmul:o_proj:L19                1.50     0.3
sample_phase3                    1.48     0.3
matmul:q_proj:L21                1.42     0.2
matmul:q_proj:L7                 1.41     0.2
matmul:q_proj:L17                1.41     0.2
matmul:o_proj:L0                 1.37     0.2
sample_phase1                    1.30     0.2
matmul:v_proj:L0                 1.16     0.2
matmul:k_proj:L23                1.12     0.2
matmul:k_proj:L14                1.08     0.2
cast_f32_to_f16                  1.07     0.2
matmul:q_proj:L12                1.04     0.2
matmul:q_proj:L23                1.01     0.2
matmul:q_proj:L14                0.97     0.2
matmul:o_proj:L4                 0.90     0.2
matmul:o_proj:L1                 0.85     0.1
matmul:o_proj:L22                0.84     0.1
matmul:q_proj:L24                0.84     0.1
matmul:q_proj:L10                0.82     0.1
gelu                             0.72     0.1
matmul:o_proj:L6                 0.68     0.1
matmul:o_proj:L24                0.65     0.1
matmul:k_proj:L12                0.57     0.1
matmul:k_proj:L21                0.56     0.1
matmul:q_proj:L13                0.56     0.1
matmul:v_proj:L3                 0.56     0.1
matmul:o_proj:L3                 0.56     0.1
matmul:o_proj:L12                0.56     0.1
matmul:o_proj:L7                 0.55     0.1
matmul:q_proj:L0                 0.55     0.1
matmul:q_proj:L4                 0.55     0.1
matmul:v_proj:L23                0.55     0.1
matmul:q_proj:L6                 0.54     0.1
matmul:o_proj:L10                0.54     0.1
matmul:o_proj:L16                0.54     0.1
matmul:q_proj:L1                 0.53     0.1
matmul:q_proj:L20                0.53     0.1
matmul:q_proj:L16                0.53     0.1
matmul:q_proj:L11                0.53     0.1
matmul:q_proj:L8                 0.53     0.1
matmul:q_proj:L18                0.53     0.1
matmul:q_proj:L25                0.53     0.1
matmul:o_proj:L8                 0.52     0.1
matmul:o_proj:L21                0.52     0.1
matmul:o_proj:L17                0.52     0.1
matmul:o_proj:L23                0.52     0.1
matmul:o_proj:L20                0.52     0.1
matmul:o_proj:L5                 0.52     0.1
matmul:o_proj:L13                0.52     0.1
matmul:q_proj:L9                 0.51     0.1
matmul:k_proj:L7                 0.51     0.1
matmul:o_proj:L11                0.51     0.1
matmul:v_proj:L14                0.50     0.1
matmul:q_proj:L19                0.49     0.1
matmul:q_proj:L5                 0.49     0.1
matmul:q_proj:L22                0.49     0.1
matmul:q_proj:L15                0.49     0.1
matmul:q_proj:L2                 0.49     0.1
matmul:o_proj:L14                0.49     0.1
matmul:o_proj:L9                 0.48     0.1
matmul:o_proj:L25                0.48     0.1
matmul:o_proj:L18                0.48     0.1
matmul:o_proj:L2                 0.48     0.1
gather                           0.47     0.1
matmul:k_proj:L0                 0.44     0.1
matmul:v_proj:L24                0.41     0.1
matmul:v_proj:L12                0.39     0.1
matmul:v_proj:L17                0.37     0.1
matmul:k_proj:L3                 0.37     0.1
matmul:v_proj:L21                0.33     0.1
scale                            0.32     0.1
matmul:k_proj:L13                0.31     0.1
matmul:v_proj:L4                 0.30     0.1
matmul:v_proj:L6                 0.30     0.1
matmul:v_proj:L13                0.30     0.1
matmul:k_proj:L25                0.30     0.1
matmul:k_proj:L20                0.30     0.1
matmul:k_proj:L11                0.30     0.1
matmul:k_proj:L6                 0.30     0.1
matmul:v_proj:L20                0.30     0.1
matmul:k_proj:L1                 0.30     0.1
matmul:k_proj:L16                0.29     0.1
matmul:v_proj:L25                0.29     0.1
matmul:k_proj:L18                0.29     0.1
matmul:v_proj:L18                0.29     0.1
matmul:v_proj:L11                0.29     0.1
matmul:v_proj:L16                0.29     0.1
matmul:k_proj:L4                 0.29     0.1
matmul:v_proj:L1                 0.29     0.1
matmul:v_proj:L8                 0.29     0.1
matmul:k_proj:L8                 0.28     0.0
matmul:k_proj:L10                0.28     0.0
matmul:v_proj:L10                0.27     0.0
matmul:v_proj:L7                 0.27     0.0
matmul:k_proj:L17                0.25     0.0
matmul:k_proj:L24                0.25     0.0
matmul:k_proj:L9                 0.25     0.0
matmul:v_proj:L9                 0.24     0.0
matmul:v_proj:L22                0.24     0.0
matmul:k_proj:L19                0.24     0.0
matmul:v_proj:L19                0.23     0.0
matmul:v_proj:L15                0.23     0.0
matmul:k_proj:L5                 0.23     0.0
matmul:k_proj:L15                0.23     0.0
matmul:v_proj:L5                 0.23     0.0
matmul:k_proj:L22                0.23     0.0
matmul:k_proj:L2                 0.23     0.0
matmul:v_proj:L2                 0.22     0.0
──────────────────────────────────────────────────
TOTAL                          575.76   100.0

[browser:warning] [11882.6ms][Profile] Batch decode (N=4):
[browser:warning] [11883.0ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      127.32    24.9
matmul:lm_head                  97.36    19.0
rmsnorm                          8.24     1.6
matmul:ffn_down:L6               3.67     0.7
matmul:ffn_down:L14              3.63     0.7
matmul:ffn_down:L10              3.62     0.7
matmul:ffn_down:L23              3.61     0.7
matmul:ffn_down:L18              3.60     0.7
sample_phase2                    3.53     0.7
matmul:ffn_down:L0               3.49     0.7
matmul:ffn_down:L7               3.47     0.7
matmul:ffn_down:L16              3.47     0.7
matmul:ffn_down:L1               3.43     0.7
matmul:ffn_down:L15              3.41     0.7
matmul:ffn_down:L17              3.41     0.7
matmul:ffn_down:L9               3.38     0.7
matmul:ffn_down:L25              3.38     0.7
matmul:ffn_down:L8               3.37     0.7
matmul:ffn_down:L3               3.35     0.7
matmul:ffn_down:L24              3.32     0.6
matmul:ffn_down:L20              3.26     0.6
matmul:ffn_down:L4               3.24     0.6
matmul:ffn_down:L22              3.23     0.6
matmul:ffn_down:L21              3.21     0.6
matmul:ffn_down:L13              3.21     0.6
matmul:ffn_down:L19              3.21     0.6
matmul:ffn_down:L12              3.20     0.6
matmul:ffn_down:L11              3.20     0.6
matmul:ffn_down:L5               3.20     0.6
matmul:ffn_down:L2               3.19     0.6
matmul:ffn_gate:L10              3.17     0.6
matmul:ffn_gate:L14              2.79     0.5
matmul:ffn_gate:L23              2.78     0.5
matmul:ffn_up:L23                2.75     0.5
matmul:ffn_gate:L22              2.72     0.5
matmul:ffn_gate:L0               2.71     0.5
matmul:ffn_up:L0                 2.70     0.5
matmul:ffn_up:L14                2.70     0.5
matmul:ffn_up:L1                 2.69     0.5
matmul:ffn_gate:L15              2.67     0.5
matmul:ffn_up:L15                2.67     0.5
matmul:ffn_up:L25                2.67     0.5
matmul:ffn_up:L9                 2.66     0.5
matmul:ffn_gate:L24              2.66     0.5
matmul:ffn_gate:L7               2.65     0.5
matmul:ffn_up:L7                 2.65     0.5
matmul:ffn_gate:L18              2.65     0.5
matmul:ffn_up:L20                2.64     0.5
matmul:ffn_up:L10                2.64     0.5
matmul:ffn_up:L18                2.64     0.5
matmul:ffn_gate:L1               2.64     0.5
matmul:ffn_gate:L17              2.64     0.5
matmul:ffn_gate:L8               2.64     0.5
matmul:ffn_gate:L25              2.64     0.5
matmul:ffn_up:L24                2.64     0.5
matmul:ffn_up:L17                2.64     0.5
matmul:ffn_up:L6                 2.64     0.5
matmul:ffn_up:L8                 2.63     0.5
matmul:ffn_gate:L6               2.63     0.5
matmul:ffn_gate:L9               2.63     0.5
matmul:ffn_gate:L20              2.62     0.5
matmul:ffn_up:L19                2.62     0.5
matmul:ffn_gate:L19              2.61     0.5
matmul:ffn_up:L22                2.61     0.5
matmul:ffn_gate:L21              2.61     0.5
matmul:ffn_up:L3                 2.61     0.5
matmul:ffn_gate:L5               2.60     0.5
matmul:ffn_gate:L16              2.60     0.5
matmul:ffn_up:L21                2.60     0.5
matmul:ffn_gate:L4               2.60     0.5
matmul:ffn_gate:L11              2.60     0.5
matmul:ffn_gate:L2               2.60     0.5
matmul:ffn_up:L11                2.60     0.5
matmul:ffn_up:L16                2.60     0.5
matmul:ffn_gate:L13              2.60     0.5
matmul:ffn_up:L2                 2.60     0.5
matmul:ffn_gate:L12              2.60     0.5
matmul:ffn_up:L4                 2.60     0.5
matmul:ffn_up:L13                2.60     0.5
matmul:ffn_up:L12                2.60     0.5
matmul:ffn_gate:L3               2.60     0.5
matmul:ffn_up:L5                 2.60     0.5
matmul:q_proj:L4                 1.85     0.4
rope                             1.60     0.3
matmul:q_proj:L11                1.44     0.3
matmul:k_proj:L7                 1.15     0.2
matmul:o_proj:L14                1.08     0.2
matmul:q_proj:L0                 0.99     0.2
matmul:q_proj:L7                 0.89     0.2
cast_f32_to_f16                  0.87     0.2
sample_phase3                    0.82     0.2
matmul:v_proj:L14                0.67     0.1
matmul:k_proj:L11                0.62     0.1
matmul:k_proj:L0                 0.61     0.1
matmul:o_proj:L23                0.60     0.1
matmul:o_proj:L0                 0.58     0.1
matmul:o_proj:L24                0.57     0.1
matmul:q_proj:L15                0.57     0.1
matmul:q_proj:L24                0.56     0.1
matmul:o_proj:L7                 0.55     0.1
matmul:q_proj:L19                0.54     0.1
matmul:o_proj:L15                0.54     0.1
matmul:q_proj:L17                0.53     0.1
matmul:q_proj:L2                 0.53     0.1
matmul:q_proj:L10                0.53     0.1
matmul:q_proj:L1                 0.53     0.1
matmul:q_proj:L8                 0.53     0.1
gelu                             0.53     0.1
matmul:o_proj:L8                 0.52     0.1
matmul:o_proj:L18                0.52     0.1
matmul:o_proj:L17                0.52     0.1
matmul:o_proj:L25                0.52     0.1
matmul:o_proj:L1                 0.52     0.1
matmul:o_proj:L10                0.52     0.1
matmul:q_proj:L9                 0.52     0.1
matmul:o_proj:L6                 0.51     0.1
matmul:k_proj:L4                 0.50     0.1
matmul:q_proj:L23                0.49     0.1
matmul:q_proj:L18                0.49     0.1
matmul:q_proj:L20                0.49     0.1
matmul:q_proj:L22                0.49     0.1
matmul:q_proj:L16                0.49     0.1
matmul:q_proj:L25                0.49     0.1
matmul:o_proj:L22                0.49     0.1
matmul:o_proj:L19                0.49     0.1
matmul:q_proj:L14                0.49     0.1
matmul:q_proj:L13                0.49     0.1
matmul:q_proj:L21                0.49     0.1
matmul:q_proj:L6                 0.49     0.1
matmul:q_proj:L5                 0.49     0.1
matmul:q_proj:L12                0.49     0.1
matmul:o_proj:L16                0.49     0.1
matmul:o_proj:L20                0.49     0.1
matmul:q_proj:L3                 0.49     0.1
matmul:o_proj:L4                 0.48     0.1
matmul:o_proj:L9                 0.48     0.1
matmul:o_proj:L11                0.48     0.1
matmul:o_proj:L5                 0.48     0.1
matmul:o_proj:L21                0.48     0.1
matmul:o_proj:L13                0.48     0.1
matmul:o_proj:L2                 0.48     0.1
matmul:o_proj:L12                0.48     0.1
matmul:o_proj:L3                 0.48     0.1
matmul:v_proj:L0                 0.40     0.1
matmul:k_proj:L15                0.35     0.1
matmul:v_proj:L24                0.35     0.1
matmul:v_proj:L7                 0.35     0.1
matmul:k_proj:L24                0.34     0.1
matmul:v_proj:L15                0.33     0.1
matmul:k_proj:L19                0.30     0.1
matmul:v_proj:L1                 0.30     0.1
matmul:k_proj:L2                 0.30     0.1
matmul:k_proj:L1                 0.30     0.1
matmul:v_proj:L8                 0.30     0.1
matmul:v_proj:L19                0.29     0.1
matmul:v_proj:L17                0.29     0.1
matmul:k_proj:L8                 0.29     0.1
matmul:k_proj:L9                 0.29     0.1
matmul:v_proj:L9                 0.29     0.1
matmul:v_proj:L2                 0.29     0.1
matmul:k_proj:L17                0.29     0.1
matmul:k_proj:L10                0.29     0.1
matmul:v_proj:L10                0.28     0.1
matmul:v_proj:L4                 0.26     0.1
matmul:k_proj:L14                0.25     0.0
matmul:v_proj:L11                0.24     0.0
matmul:k_proj:L20                0.24     0.0
matmul:k_proj:L25                0.23     0.0
matmul:k_proj:L5                 0.23     0.0
matmul:k_proj:L23                0.23     0.0
matmul:k_proj:L16                0.23     0.0
matmul:k_proj:L21                0.23     0.0
matmul:v_proj:L18                0.23     0.0
matmul:k_proj:L22                0.23     0.0
matmul:v_proj:L23                0.23     0.0
matmul:k_proj:L6                 0.23     0.0
matmul:k_proj:L18                0.23     0.0
matmul:v_proj:L22                0.23     0.0
matmul:k_proj:L13                0.23     0.0
matmul:v_proj:L25                0.23     0.0
matmul:k_proj:L12                0.23     0.0
matmul:v_proj:L16                0.23     0.0
matmul:v_proj:L13                0.22     0.0
matmul:v_proj:L20                0.22     0.0
matmul:v_proj:L12                0.22     0.0
matmul:v_proj:L6                 0.22     0.0
matmul:v_proj:L5                 0.22     0.0
matmul:k_proj:L3                 0.22     0.0
matmul:v_proj:L21                0.22     0.0
matmul:v_proj:L3                 0.22     0.0
sample_phase1                    0.13     0.0
scale                            0.07     0.0
gather                           0.07     0.0
──────────────────────────────────────────────────
TOTAL                          512.36   100.0

[browser:warning] [12568.9ms][Profile] Batch decode (N=4):
[browser:warning] [12569.1ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      135.68    21.8
matmul:lm_head                 124.86    20.1
rmsnorm                         25.66     4.1
matmul:ffn_up:L17                5.85     0.9
matmul:ffn_down:L15              5.65     0.9
matmul:ffn_up:L22                5.64     0.9
matmul:ffn_up:L8                 5.09     0.8
matmul:ffn_gate:L11              4.90     0.8
matmul:ffn_up:L11                4.65     0.7
matmul:ffn_down:L14              4.20     0.7
matmul:ffn_gate:L24              4.13     0.7
matmul:ffn_up:L4                 4.09     0.7
matmul:ffn_up:L0                 4.07     0.7
matmul:ffn_up:L12                4.01     0.6
matmul:ffn_down:L22              3.95     0.6
matmul:ffn_down:L12              3.91     0.6
matmul:ffn_up:L3                 3.91     0.6
rope                             3.90     0.6
matmul:ffn_gate:L19              3.87     0.6
matmul:ffn_down:L9               3.86     0.6
matmul:ffn_down:L11              3.84     0.6
matmul:ffn_down:L5               3.83     0.6
matmul:ffn_down:L8               3.77     0.6
matmul:ffn_down:L17              3.75     0.6
matmul:ffn_gate:L0               3.75     0.6
matmul:ffn_down:L19              3.71     0.6
matmul:ffn_gate:L10              3.64     0.6
matmul:ffn_down:L4               3.63     0.6
matmul:ffn_down:L25              3.59     0.6
matmul:ffn_down:L23              3.57     0.6
matmul:ffn_down:L20              3.56     0.6
matmul:ffn_down:L18              3.54     0.6
matmul:ffn_down:L0               3.52     0.6
matmul:ffn_down:L6               3.49     0.6
matmul:ffn_down:L2               3.48     0.6
matmul:ffn_down:L21              3.48     0.6
matmul:ffn_down:L13              3.45     0.6
sample_phase2                    3.39     0.5
matmul:ffn_up:L5                 3.34     0.5
matmul:ffn_down:L16              3.33     0.5
matmul:ffn_down:L1               3.30     0.5
matmul:ffn_up:L19                3.30     0.5
matmul:ffn_down:L3               3.27     0.5
matmul:ffn_down:L24              3.26     0.5
matmul:ffn_down:L10              3.26     0.5
cast_f32_to_f16                  3.23     0.5
matmul:ffn_up:L10                3.22     0.5
matmul:ffn_down:L7               3.21     0.5
matmul:ffn_gate:L20              3.20     0.5
matmul:ffn_gate:L12              3.19     0.5
gelu                             3.12     0.5
matmul:ffn_up:L1                 3.11     0.5
matmul:ffn_gate:L17              3.05     0.5
matmul:ffn_gate:L3               2.99     0.5
matmul:ffn_gate:L1               2.92     0.5
matmul:ffn_up:L24                2.86     0.5
matmul:ffn_up:L14                2.85     0.5
matmul:ffn_up:L15                2.84     0.5
matmul:ffn_gate:L22              2.74     0.4
matmul:ffn_up:L20                2.69     0.4
matmul:ffn_gate:L14              2.69     0.4
matmul:ffn_up:L9                 2.69     0.4
matmul:ffn_gate:L9               2.68     0.4
matmul:ffn_up:L2                 2.67     0.4
matmul:ffn_gate:L21              2.66     0.4
matmul:ffn_up:L21                2.66     0.4
matmul:ffn_up:L23                2.66     0.4
matmul:ffn_up:L6                 2.65     0.4
matmul:ffn_gate:L15              2.65     0.4
matmul:ffn_up:L25                2.65     0.4
matmul:ffn_gate:L23              2.65     0.4
matmul:ffn_gate:L25              2.65     0.4
matmul:ffn_gate:L13              2.65     0.4
matmul:ffn_gate:L4               2.65     0.4
matmul:ffn_gate:L6               2.65     0.4
matmul:ffn_up:L16                2.64     0.4
matmul:ffn_gate:L2               2.64     0.4
matmul:ffn_up:L13                2.64     0.4
matmul:ffn_gate:L18              2.64     0.4
matmul:ffn_gate:L8               2.64     0.4
matmul:ffn_gate:L16              2.64     0.4
matmul:ffn_up:L18                2.63     0.4
matmul:ffn_gate:L5               2.61     0.4
matmul:ffn_gate:L7               2.60     0.4
matmul:ffn_up:L7                 2.60     0.4
matmul:o_proj:L24                2.28     0.4
matmul:k_proj:L6                 1.65     0.3
matmul:q_proj:L13                1.51     0.2
matmul:o_proj:L3                 1.49     0.2
matmul:q_proj:L15                1.44     0.2
matmul:o_proj:L17                1.40     0.2
matmul:q_proj:L10                1.25     0.2
matmul:o_proj:L12                1.19     0.2
matmul:o_proj:L8                 1.15     0.2
matmul:o_proj:L11                1.12     0.2
matmul:q_proj:L18                1.11     0.2
matmul:o_proj:L10                1.06     0.2
matmul:k_proj:L25                0.92     0.1
matmul:q_proj:L6                 0.88     0.1
matmul:v_proj:L21                0.86     0.1
matmul:q_proj:L9                 0.86     0.1
matmul:o_proj:L19                0.84     0.1
matmul:q_proj:L23                0.81     0.1
matmul:q_proj:L21                0.80     0.1
matmul:q_proj:L12                0.80     0.1
matmul:q_proj:L2                 0.79     0.1
matmul:k_proj:L10                0.63     0.1
matmul:v_proj:L6                 0.63     0.1
matmul:o_proj:L0                 0.62     0.1
matmul:v_proj:L20                0.61     0.1
matmul:q_proj:L16                0.58     0.1
matmul:v_proj:L9                 0.58     0.1
matmul:k_proj:L21                0.58     0.1
matmul:v_proj:L18                0.57     0.1
matmul:o_proj:L9                 0.56     0.1
matmul:q_proj:L0                 0.56     0.1
matmul:k_proj:L15                0.54     0.1
matmul:q_proj:L24                0.54     0.1
matmul:o_proj:L23                0.54     0.1
matmul:q_proj:L19                0.54     0.1
matmul:o_proj:L15                0.54     0.1
matmul:k_proj:L9                 0.54     0.1
matmul:o_proj:L22                0.53     0.1
matmul:o_proj:L21                0.53     0.1
matmul:q_proj:L5                 0.53     0.1
matmul:q_proj:L14                0.53     0.1
matmul:o_proj:L4                 0.53     0.1
matmul:o_proj:L25                0.53     0.1
matmul:q_proj:L7                 0.53     0.1
matmul:q_proj:L25                0.52     0.1
matmul:q_proj:L1                 0.52     0.1
matmul:q_proj:L22                0.52     0.1
matmul:q_proj:L3                 0.52     0.1
matmul:o_proj:L2                 0.52     0.1
matmul:o_proj:L20                0.52     0.1
matmul:o_proj:L18                0.52     0.1
matmul:q_proj:L20                0.52     0.1
matmul:o_proj:L13                0.52     0.1
matmul:o_proj:L1                 0.51     0.1
matmul:o_proj:L6                 0.51     0.1
matmul:o_proj:L16                0.51     0.1
matmul:q_proj:L17                0.50     0.1
matmul:v_proj:L2                 0.50     0.1
matmul:q_proj:L8                 0.49     0.1
matmul:q_proj:L4                 0.49     0.1
matmul:q_proj:L11                0.49     0.1
matmul:o_proj:L5                 0.48     0.1
matmul:o_proj:L14                0.48     0.1
matmul:o_proj:L7                 0.48     0.1
matmul:k_proj:L0                 0.46     0.1
matmul:v_proj:L16                0.46     0.1
matmul:k_proj:L2                 0.44     0.1
matmul:v_proj:L25                0.43     0.1
matmul:k_proj:L12                0.42     0.1
matmul:v_proj:L15                0.40     0.1
sample_phase1                    0.39     0.1
matmul:v_proj:L0                 0.38     0.1
matmul:k_proj:L16                0.38     0.1
matmul:k_proj:L20                0.37     0.1
matmul:k_proj:L18                0.34     0.1
matmul:v_proj:L10                0.34     0.1
matmul:v_proj:L13                0.32     0.1
matmul:k_proj:L24                0.32     0.1
matmul:k_proj:L19                0.31     0.1
matmul:k_proj:L5                 0.31     0.0
matmul:k_proj:L3                 0.31     0.0
matmul:v_proj:L24                0.30     0.0
matmul:k_proj:L22                0.30     0.0
matmul:v_proj:L19                0.30     0.0
matmul:v_proj:L14                0.30     0.0
matmul:v_proj:L12                0.30     0.0
matmul:k_proj:L14                0.30     0.0
matmul:k_proj:L7                 0.30     0.0
matmul:v_proj:L22                0.29     0.0
matmul:v_proj:L3                 0.29     0.0
matmul:v_proj:L5                 0.29     0.0
matmul:v_proj:L23                0.29     0.0
matmul:k_proj:L1                 0.29     0.0
matmul:k_proj:L13                0.29     0.0
matmul:v_proj:L7                 0.29     0.0
matmul:v_proj:L1                 0.28     0.0
matmul:k_proj:L23                0.26     0.0
matmul:k_proj:L17                0.24     0.0
matmul:v_proj:L17                0.24     0.0
matmul:v_proj:L4                 0.23     0.0
matmul:k_proj:L4                 0.23     0.0
matmul:k_proj:L11                0.23     0.0
matmul:v_proj:L8                 0.23     0.0
matmul:v_proj:L11                0.23     0.0
matmul:k_proj:L8                 0.23     0.0
sample_phase3                    0.13     0.0
gather                           0.04     0.0
scale                            0.03     0.0
──────────────────────────────────────────────────
TOTAL                          621.70   100.0

[browser:warning] [13184.7ms][Profile] Batch decode (N=4):
[browser:warning] [13185.0ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      141.27    25.6
matmul:lm_head                 105.00    19.0
rmsnorm                         14.08     2.6
matmul:ffn_up:L7                 4.91     0.9
matmul:ffn_gate:L14              4.06     0.7
matmul:ffn_down:L25              4.04     0.7
matmul:ffn_gate:L11              3.91     0.7
matmul:ffn_down:L17              3.76     0.7
matmul:ffn_gate:L4               3.72     0.7
matmul:ffn_down:L24              3.64     0.7
matmul:ffn_down:L9               3.61     0.7
matmul:ffn_down:L5               3.53     0.6
matmul:ffn_gate:L17              3.50     0.6
matmul:ffn_down:L1               3.50     0.6
matmul:ffn_down:L0               3.48     0.6
matmul:ffn_down:L16              3.46     0.6
matmul:ffn_down:L8               3.45     0.6
matmul:ffn_down:L21              3.44     0.6
matmul:ffn_down:L7               3.44     0.6
matmul:ffn_down:L2               3.44     0.6
matmul:ffn_down:L20              3.44     0.6
matmul:ffn_down:L14              3.40     0.6
matmul:ffn_up:L0                 3.35     0.6
matmul:ffn_down:L15              3.32     0.6
sample_phase2                    3.28     0.6
matmul:ffn_down:L18              3.25     0.6
matmul:ffn_gate:L21              3.24     0.6
matmul:ffn_down:L22              3.23     0.6
matmul:ffn_down:L6               3.22     0.6
matmul:ffn_down:L10              3.22     0.6
matmul:ffn_down:L13              3.21     0.6
matmul:ffn_down:L19              3.21     0.6
matmul:ffn_down:L23              3.21     0.6
matmul:ffn_down:L11              3.21     0.6
matmul:ffn_down:L12              3.21     0.6
matmul:ffn_down:L3               3.20     0.6
matmul:ffn_down:L4               3.20     0.6
matmul:ffn_gate:L2               3.19     0.6
matmul:ffn_up:L4                 3.09     0.6
matmul:ffn_gate:L7               2.83     0.5
matmul:ffn_up:L17                2.83     0.5
matmul:ffn_gate:L3               2.79     0.5
matmul:ffn_up:L3                 2.72     0.5
matmul:ffn_gate:L25              2.72     0.5
matmul:ffn_gate:L9               2.71     0.5
matmul:ffn_up:L9                 2.71     0.5
matmul:ffn_gate:L0               2.70     0.5
matmul:ffn_gate:L1               2.69     0.5
matmul:ffn_up:L25                2.68     0.5
matmul:ffn_up:L14                2.68     0.5
matmul:ffn_gate:L18              2.66     0.5
matmul:ffn_up:L8                 2.66     0.5
matmul:ffn_up:L1                 2.65     0.5
matmul:ffn_up:L24                2.65     0.5
matmul:ffn_up:L18                2.65     0.5
matmul:ffn_up:L22                2.64     0.5
matmul:ffn_gate:L22              2.64     0.5
matmul:ffn_up:L2                 2.63     0.5
matmul:ffn_gate:L10              2.63     0.5
matmul:ffn_up:L21                2.63     0.5
matmul:ffn_gate:L15              2.62     0.5
matmul:ffn_up:L11                2.61     0.5
matmul:ffn_gate:L8               2.61     0.5
matmul:ffn_gate:L24              2.60     0.5
matmul:ffn_gate:L23              2.60     0.5
matmul:ffn_up:L15                2.60     0.5
matmul:ffn_gate:L5               2.60     0.5
matmul:ffn_up:L23                2.60     0.5
matmul:ffn_up:L10                2.60     0.5
matmul:ffn_gate:L6               2.60     0.5
matmul:ffn_up:L16                2.60     0.5
matmul:ffn_gate:L20              2.60     0.5
matmul:ffn_gate:L16              2.60     0.5
matmul:ffn_up:L6                 2.60     0.5
matmul:ffn_up:L19                2.60     0.5
matmul:ffn_up:L5                 2.60     0.5
matmul:ffn_up:L20                2.60     0.5
matmul:ffn_gate:L12              2.60     0.5
matmul:ffn_gate:L13              2.60     0.5
matmul:ffn_up:L13                2.60     0.5
matmul:ffn_up:L12                2.60     0.5
matmul:ffn_gate:L19              2.60     0.5
rope                             2.53     0.5
gelu                             1.88     0.3
cast_f32_to_f16                  1.63     0.3
matmul:o_proj:L17                1.17     0.2
matmul:o_proj:L7                 1.02     0.2
matmul:k_proj:L0                 1.01     0.2
matmul:o_proj:L11                0.90     0.2
matmul:q_proj:L18                0.88     0.2
matmul:q_proj:L1                 0.84     0.2
sample_phase3                    0.82     0.1
matmul:v_proj:L6                 0.77     0.1
matmul:k_proj:L13                0.67     0.1
matmul:v_proj:L0                 0.66     0.1
matmul:q_proj:L22                0.62     0.1
matmul:v_proj:L18                0.62     0.1
matmul:o_proj:L0                 0.61     0.1
matmul:o_proj:L9                 0.59     0.1
matmul:o_proj:L25                0.59     0.1
matmul:o_proj:L1                 0.58     0.1
matmul:k_proj:L18                0.58     0.1
matmul:q_proj:L10                0.57     0.1
matmul:v_proj:L1                 0.57     0.1
matmul:o_proj:L18                0.57     0.1
matmul:q_proj:L25                0.55     0.1
matmul:q_proj:L9                 0.54     0.1
matmul:q_proj:L0                 0.54     0.1
matmul:q_proj:L2                 0.54     0.1
matmul:q_proj:L3                 0.53     0.1
matmul:q_proj:L15                0.53     0.1
matmul:o_proj:L2                 0.53     0.1
matmul:q_proj:L8                 0.53     0.1
matmul:q_proj:L17                0.53     0.1
matmul:o_proj:L22                0.52     0.1
matmul:o_proj:L10                0.52     0.1
matmul:k_proj:L1                 0.52     0.1
matmul:o_proj:L3                 0.52     0.1
matmul:o_proj:L15                0.52     0.1
matmul:o_proj:L21                0.51     0.1
matmul:q_proj:L13                0.51     0.1
matmul:o_proj:L8                 0.51     0.1
matmul:o_proj:L14                0.50     0.1
matmul:q_proj:L6                 0.50     0.1
matmul:q_proj:L21                0.50     0.1
matmul:q_proj:L11                0.50     0.1
matmul:q_proj:L16                0.49     0.1
matmul:o_proj:L4                 0.49     0.1
matmul:q_proj:L24                0.49     0.1
matmul:q_proj:L7                 0.49     0.1
matmul:q_proj:L23                0.49     0.1
matmul:o_proj:L24                0.49     0.1
matmul:q_proj:L20                0.49     0.1
matmul:q_proj:L14                0.49     0.1
matmul:q_proj:L19                0.49     0.1
matmul:o_proj:L16                0.49     0.1
matmul:q_proj:L4                 0.49     0.1
matmul:q_proj:L12                0.49     0.1
matmul:q_proj:L5                 0.49     0.1
matmul:o_proj:L20                0.48     0.1
matmul:o_proj:L23                0.48     0.1
matmul:o_proj:L6                 0.48     0.1
matmul:o_proj:L19                0.48     0.1
matmul:o_proj:L13                0.48     0.1
matmul:o_proj:L5                 0.48     0.1
matmul:o_proj:L12                0.48     0.1
matmul:k_proj:L10                0.36     0.1
matmul:v_proj:L10                0.35     0.1
matmul:k_proj:L6                 0.32     0.1
matmul:k_proj:L2                 0.32     0.1
matmul:k_proj:L25                0.32     0.1
matmul:v_proj:L25                0.31     0.1
matmul:v_proj:L2                 0.31     0.1
matmul:k_proj:L9                 0.30     0.1
matmul:k_proj:L15                0.29     0.1
matmul:k_proj:L17                0.29     0.1
matmul:v_proj:L3                 0.29     0.1
matmul:k_proj:L3                 0.29     0.1
matmul:v_proj:L9                 0.29     0.1
matmul:k_proj:L8                 0.29     0.1
matmul:v_proj:L22                0.29     0.1
matmul:v_proj:L17                0.29     0.1
matmul:k_proj:L22                0.28     0.1
matmul:v_proj:L8                 0.28     0.1
matmul:v_proj:L15                0.28     0.1
matmul:k_proj:L11                0.26     0.0
matmul:k_proj:L21                0.24     0.0
matmul:k_proj:L16                0.23     0.0
matmul:v_proj:L13                0.23     0.0
matmul:k_proj:L7                 0.23     0.0
matmul:k_proj:L24                0.23     0.0
matmul:v_proj:L11                0.23     0.0
matmul:v_proj:L16                0.23     0.0
matmul:v_proj:L7                 0.23     0.0
matmul:k_proj:L23                0.23     0.0
matmul:k_proj:L20                0.23     0.0
matmul:k_proj:L14                0.23     0.0
matmul:v_proj:L21                0.23     0.0
matmul:k_proj:L19                0.23     0.0
matmul:v_proj:L24                0.23     0.0
matmul:v_proj:L20                0.23     0.0
matmul:v_proj:L4                 0.23     0.0
matmul:k_proj:L5                 0.23     0.0
matmul:k_proj:L4                 0.22     0.0
matmul:k_proj:L12                0.22     0.0
matmul:v_proj:L14                0.22     0.0
matmul:v_proj:L23                0.22     0.0
matmul:v_proj:L5                 0.22     0.0
matmul:v_proj:L19                0.22     0.0
matmul:v_proj:L12                0.22     0.0
sample_phase1                    0.09     0.0
gather                           0.02     0.0
scale                            0.01     0.0
──────────────────────────────────────────────────
TOTAL                          551.62   100.0

[browser:warning] [13763.1ms][Profile] Batch decode (N=4):
[browser:warning] [13763.3ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      148.51    28.7
matmul:lm_head                  96.35    18.6
rmsnorm                          3.90     0.8
matmul:ffn_down:L19              3.81     0.7
matmul:ffn_down:L4               3.76     0.7
matmul:ffn_down:L12              3.72     0.7
matmul:ffn_down:L20              3.62     0.7
matmul:ffn_down:L3               3.59     0.7
matmul:ffn_down:L11              3.57     0.7
sample_phase2                    3.40     0.7
matmul:ffn_down:L18              3.23     0.6
matmul:ffn_down:L1               3.21     0.6
matmul:ffn_down:L2               3.21     0.6
matmul:ffn_down:L10              3.21     0.6
matmul:ffn_down:L13              3.21     0.6
matmul:ffn_down:L16              3.21     0.6
matmul:ffn_down:L14              3.20     0.6
matmul:ffn_down:L8               3.20     0.6
matmul:ffn_down:L17              3.20     0.6
matmul:ffn_down:L0               3.20     0.6
matmul:ffn_down:L9               3.20     0.6
matmul:ffn_down:L6               3.20     0.6
matmul:ffn_down:L25              3.20     0.6
matmul:ffn_down:L24              3.20     0.6
matmul:ffn_down:L7               3.20     0.6
matmul:ffn_down:L5               3.19     0.6
matmul:ffn_down:L22              3.19     0.6
matmul:ffn_down:L15              3.19     0.6
matmul:ffn_down:L21              3.19     0.6
matmul:ffn_down:L23              3.19     0.6
matmul:ffn_gate:L12              2.76     0.5
matmul:ffn_up:L12                2.76     0.5
matmul:ffn_gate:L4               2.73     0.5
matmul:ffn_gate:L3               2.72     0.5
matmul:ffn_up:L4                 2.71     0.5
matmul:ffn_up:L19                2.71     0.5
matmul:ffn_up:L3                 2.70     0.5
matmul:ffn_up:L20                2.70     0.5
matmul:ffn_up:L11                2.70     0.5
matmul:ffn_gate:L20              2.69     0.5
matmul:ffn_gate:L11              2.69     0.5
matmul:ffn_gate:L19              2.64     0.5
matmul:ffn_up:L1                 2.61     0.5
matmul:ffn_up:L14                2.61     0.5
matmul:ffn_up:L17                2.60     0.5
matmul:ffn_up:L6                 2.60     0.5
matmul:ffn_up:L8                 2.60     0.5
matmul:ffn_gate:L5               2.60     0.5
matmul:ffn_gate:L1               2.60     0.5
matmul:ffn_gate:L24              2.60     0.5
matmul:ffn_up:L25                2.60     0.5
matmul:ffn_gate:L25              2.60     0.5
matmul:ffn_up:L2                 2.60     0.5
matmul:ffn_gate:L0               2.60     0.5
matmul:ffn_gate:L16              2.60     0.5
matmul:ffn_up:L21                2.60     0.5
matmul:ffn_up:L18                2.60     0.5
matmul:ffn_gate:L10              2.60     0.5
matmul:ffn_gate:L18              2.60     0.5
matmul:ffn_gate:L8               2.60     0.5
matmul:ffn_gate:L15              2.60     0.5
matmul:ffn_gate:L14              2.60     0.5
matmul:ffn_up:L10                2.60     0.5
matmul:ffn_up:L24                2.60     0.5
matmul:ffn_up:L0                 2.60     0.5
matmul:ffn_up:L22                2.60     0.5
matmul:ffn_up:L13                2.60     0.5
matmul:ffn_gate:L17              2.60     0.5
matmul:ffn_up:L7                 2.60     0.5
matmul:ffn_gate:L2               2.60     0.5
matmul:ffn_gate:L6               2.60     0.5
matmul:ffn_gate:L21              2.60     0.5
matmul:ffn_up:L9                 2.60     0.5
matmul:ffn_gate:L23              2.60     0.5
matmul:ffn_up:L16                2.60     0.5
matmul:ffn_gate:L22              2.60     0.5
matmul:ffn_gate:L9               2.60     0.5
matmul:ffn_up:L15                2.60     0.5
matmul:ffn_gate:L7               2.60     0.5
matmul:ffn_up:L5                 2.60     0.5
matmul:ffn_up:L23                2.60     0.5
matmul:ffn_gate:L13              2.59     0.5
rope                             1.01     0.2
cast_f32_to_f16                  0.84     0.2
matmul:o_proj:L4                 0.63     0.1
matmul:o_proj:L12                0.63     0.1
matmul:q_proj:L20                0.62     0.1
matmul:q_proj:L0                 0.61     0.1
matmul:o_proj:L20                0.59     0.1
matmul:q_proj:L4                 0.58     0.1
matmul:q_proj:L12                0.57     0.1
matmul:q_proj:L13                0.56     0.1
matmul:q_proj:L5                 0.56     0.1
matmul:q_proj:L21                0.54     0.1
matmul:o_proj:L19                0.52     0.1
matmul:o_proj:L3                 0.51     0.1
matmul:q_proj:L14                0.49     0.1
matmul:q_proj:L18                0.49     0.1
matmul:q_proj:L19                0.49     0.1
matmul:q_proj:L3                 0.49     0.1
matmul:q_proj:L10                0.49     0.1
matmul:q_proj:L11                0.49     0.1
matmul:o_proj:L17                0.49     0.1
matmul:o_proj:L22                0.49     0.1
matmul:q_proj:L24                0.49     0.1
matmul:q_proj:L23                0.49     0.1
matmul:q_proj:L2                 0.49     0.1
matmul:o_proj:L21                0.49     0.1
matmul:o_proj:L13                0.49     0.1
matmul:q_proj:L7                 0.49     0.1
gelu                             0.49     0.1
matmul:q_proj:L17                0.49     0.1
matmul:q_proj:L8                 0.49     0.1
matmul:q_proj:L25                0.49     0.1
matmul:o_proj:L6                 0.49     0.1
matmul:o_proj:L23                0.49     0.1
matmul:q_proj:L6                 0.49     0.1
matmul:o_proj:L24                0.49     0.1
matmul:q_proj:L22                0.48     0.1
matmul:o_proj:L18                0.48     0.1
matmul:o_proj:L25                0.48     0.1
matmul:q_proj:L16                0.48     0.1
matmul:o_proj:L0                 0.48     0.1
matmul:q_proj:L15                0.48     0.1
matmul:q_proj:L1                 0.48     0.1
matmul:o_proj:L2                 0.48     0.1
matmul:o_proj:L8                 0.48     0.1
matmul:o_proj:L15                0.48     0.1
matmul:q_proj:L9                 0.48     0.1
matmul:o_proj:L5                 0.48     0.1
matmul:o_proj:L14                0.48     0.1
matmul:o_proj:L11                0.48     0.1
matmul:o_proj:L7                 0.48     0.1
matmul:o_proj:L10                0.48     0.1
matmul:o_proj:L9                 0.48     0.1
matmul:o_proj:L1                 0.48     0.1
matmul:o_proj:L16                0.48     0.1
matmul:v_proj:L0                 0.45     0.1
matmul:v_proj:L20                0.42     0.1
matmul:k_proj:L20                0.41     0.1
matmul:k_proj:L0                 0.40     0.1
matmul:v_proj:L4                 0.39     0.1
matmul:k_proj:L5                 0.37     0.1
matmul:v_proj:L13                0.36     0.1
matmul:k_proj:L13                0.36     0.1
matmul:k_proj:L4                 0.36     0.1
matmul:v_proj:L12                0.36     0.1
matmul:k_proj:L12                0.36     0.1
matmul:k_proj:L21                0.30     0.1
matmul:v_proj:L5                 0.29     0.1
matmul:v_proj:L21                0.29     0.1
matmul:k_proj:L17                0.23     0.0
matmul:k_proj:L19                0.23     0.0
matmul:k_proj:L11                0.23     0.0
matmul:k_proj:L3                 0.23     0.0
matmul:k_proj:L15                0.23     0.0
matmul:v_proj:L3                 0.23     0.0
matmul:v_proj:L11                0.23     0.0
matmul:v_proj:L8                 0.23     0.0
matmul:k_proj:L2                 0.23     0.0
matmul:k_proj:L14                0.23     0.0
matmul:k_proj:L18                0.23     0.0
matmul:v_proj:L23                0.23     0.0
matmul:k_proj:L22                0.23     0.0
matmul:v_proj:L19                0.23     0.0
matmul:k_proj:L9                 0.23     0.0
matmul:k_proj:L10                0.23     0.0
matmul:k_proj:L7                 0.23     0.0
matmul:v_proj:L10                0.23     0.0
matmul:k_proj:L25                0.23     0.0
matmul:k_proj:L16                0.22     0.0
matmul:v_proj:L18                0.22     0.0
matmul:k_proj:L6                 0.22     0.0
matmul:k_proj:L1                 0.22     0.0
matmul:k_proj:L24                0.22     0.0
matmul:v_proj:L2                 0.22     0.0
matmul:k_proj:L23                0.22     0.0
matmul:v_proj:L24                0.22     0.0
matmul:v_proj:L22                0.22     0.0
matmul:v_proj:L15                0.22     0.0
matmul:v_proj:L7                 0.22     0.0
matmul:v_proj:L1                 0.22     0.0
matmul:k_proj:L8                 0.22     0.0
matmul:v_proj:L16                0.22     0.0
matmul:v_proj:L6                 0.22     0.0
matmul:v_proj:L14                0.22     0.0
matmul:v_proj:L17                0.22     0.0
matmul:v_proj:L25                0.22     0.0
matmul:v_proj:L9                 0.22     0.0
sample_phase1                    0.17     0.0
sample_phase3                    0.08     0.0
gather                           0.06     0.0
scale                            0.04     0.0
──────────────────────────────────────────────────
TOTAL                          517.44   100.0

[browser:warning] [14331.0ms][Profile] Batch decode (N=4):
[browser:warning] [14331.2ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      155.97    29.7
matmul:lm_head                  96.39    18.3
rmsnorm                          4.19     0.8
matmul:ffn_down:L12              3.91     0.7
matmul:ffn_down:L4               3.90     0.7
matmul:ffn_down:L20              3.88     0.7
sample_phase2                    3.41     0.6
matmul:ffn_down:L5               3.40     0.6
matmul:ffn_down:L19              3.38     0.6
matmul:ffn_up:L1                 3.38     0.6
matmul:ffn_down:L8               3.37     0.6
matmul:ffn_down:L3               3.34     0.6
matmul:ffn_down:L21              3.24     0.6
matmul:ffn_down:L16              3.22     0.6
matmul:ffn_down:L18              3.22     0.6
matmul:ffn_down:L11              3.21     0.6
matmul:ffn_down:L13              3.21     0.6
matmul:ffn_down:L10              3.21     0.6
matmul:ffn_down:L14              3.21     0.6
matmul:ffn_down:L1               3.21     0.6
matmul:ffn_down:L2               3.21     0.6
matmul:ffn_down:L9               3.21     0.6
matmul:ffn_down:L6               3.20     0.6
matmul:ffn_down:L17              3.20     0.6
matmul:ffn_down:L7               3.20     0.6
matmul:ffn_down:L24              3.20     0.6
matmul:ffn_down:L22              3.20     0.6
matmul:ffn_down:L15              3.19     0.6
matmul:ffn_down:L25              3.19     0.6
matmul:ffn_down:L23              3.19     0.6
matmul:ffn_down:L0               3.19     0.6
matmul:ffn_up:L12                2.75     0.5
matmul:ffn_gate:L4               2.73     0.5
matmul:ffn_up:L4                 2.73     0.5
matmul:ffn_gate:L20              2.71     0.5
matmul:ffn_gate:L12              2.71     0.5
matmul:ffn_up:L20                2.70     0.5
matmul:ffn_gate:L5               2.67     0.5
matmul:ffn_up:L19                2.66     0.5
matmul:ffn_up:L5                 2.65     0.5
matmul:ffn_up:L21                2.64     0.5
matmul:ffn_gate:L21              2.64     0.5
matmul:ffn_gate:L13              2.63     0.5
matmul:ffn_up:L13                2.63     0.5
matmul:ffn_up:L6                 2.61     0.5
matmul:ffn_up:L9                 2.61     0.5
matmul:ffn_gate:L11              2.61     0.5
matmul:ffn_gate:L24              2.61     0.5
matmul:ffn_gate:L14              2.61     0.5
matmul:ffn_gate:L1               2.61     0.5
matmul:ffn_up:L25                2.60     0.5
matmul:ffn_up:L8                 2.60     0.5
matmul:ffn_gate:L22              2.60     0.5
matmul:ffn_up:L10                2.60     0.5
matmul:ffn_gate:L19              2.60     0.5
matmul:ffn_gate:L18              2.60     0.5
matmul:ffn_up:L7                 2.60     0.5
matmul:ffn_gate:L7               2.60     0.5
matmul:ffn_up:L15                2.60     0.5
matmul:ffn_gate:L6               2.60     0.5
matmul:ffn_gate:L9               2.60     0.5
matmul:ffn_up:L11                2.60     0.5
matmul:ffn_gate:L25              2.60     0.5
matmul:ffn_up:L23                2.60     0.5
matmul:ffn_up:L22                2.60     0.5
matmul:ffn_gate:L8               2.60     0.5
matmul:ffn_up:L16                2.60     0.5
matmul:ffn_gate:L10              2.60     0.5
matmul:ffn_up:L2                 2.60     0.5
matmul:ffn_gate:L0               2.60     0.5
matmul:ffn_up:L0                 2.60     0.5
matmul:ffn_gate:L16              2.60     0.5
matmul:ffn_gate:L23              2.60     0.5
matmul:ffn_gate:L3               2.60     0.5
matmul:ffn_up:L14                2.60     0.5
matmul:ffn_up:L3                 2.60     0.5
matmul:ffn_up:L18                2.60     0.5
matmul:ffn_gate:L15              2.60     0.5
matmul:ffn_up:L24                2.60     0.5
matmul:ffn_gate:L17              2.60     0.5
matmul:ffn_up:L17                2.60     0.5
matmul:ffn_gate:L2               2.60     0.5
rope                             0.94     0.2
gelu                             0.88     0.2
cast_f32_to_f16                  0.81     0.2
matmul:q_proj:L13                0.66     0.1
matmul:q_proj:L5                 0.62     0.1
matmul:q_proj:L21                0.60     0.1
matmul:q_proj:L0                 0.60     0.1
matmul:o_proj:L20                0.58     0.1
matmul:o_proj:L12                0.58     0.1
matmul:o_proj:L5                 0.56     0.1
matmul:o_proj:L4                 0.56     0.1
matmul:q_proj:L20                0.53     0.1
matmul:o_proj:L21                0.52     0.1
matmul:q_proj:L4                 0.52     0.1
matmul:o_proj:L13                0.52     0.1
matmul:q_proj:L17                0.50     0.1
matmul:q_proj:L9                 0.50     0.1
matmul:q_proj:L2                 0.49     0.1
matmul:q_proj:L12                0.49     0.1
matmul:o_proj:L1                 0.49     0.1
matmul:q_proj:L11                0.49     0.1
matmul:o_proj:L7                 0.49     0.1
matmul:q_proj:L3                 0.49     0.1
matmul:q_proj:L6                 0.49     0.1
matmul:q_proj:L19                0.49     0.1
matmul:o_proj:L17                0.49     0.1
matmul:q_proj:L7                 0.49     0.1
matmul:q_proj:L22                0.49     0.1
matmul:q_proj:L14                0.49     0.1
matmul:q_proj:L24                0.49     0.1
matmul:q_proj:L18                0.49     0.1
matmul:o_proj:L22                0.49     0.1
matmul:q_proj:L25                0.49     0.1
matmul:q_proj:L16                0.49     0.1
matmul:o_proj:L19                0.49     0.1
matmul:o_proj:L16                0.48     0.1
matmul:q_proj:L8                 0.48     0.1
matmul:v_proj:L13                0.48     0.1
matmul:q_proj:L15                0.48     0.1
matmul:o_proj:L25                0.48     0.1
matmul:q_proj:L23                0.48     0.1
matmul:q_proj:L10                0.48     0.1
matmul:o_proj:L11                0.48     0.1
matmul:q_proj:L1                 0.48     0.1
matmul:o_proj:L2                 0.48     0.1
matmul:o_proj:L10                0.48     0.1
matmul:o_proj:L3                 0.48     0.1
matmul:o_proj:L0                 0.48     0.1
matmul:o_proj:L18                0.48     0.1
matmul:o_proj:L23                0.48     0.1
matmul:o_proj:L9                 0.48     0.1
matmul:o_proj:L8                 0.48     0.1
matmul:o_proj:L24                0.48     0.1
matmul:o_proj:L15                0.48     0.1
matmul:o_proj:L14                0.48     0.1
matmul:o_proj:L6                 0.48     0.1
matmul:k_proj:L13                0.47     0.1
matmul:k_proj:L0                 0.43     0.1
matmul:v_proj:L0                 0.43     0.1
matmul:k_proj:L21                0.41     0.1
matmul:k_proj:L5                 0.41     0.1
matmul:v_proj:L21                0.41     0.1
matmul:v_proj:L5                 0.40     0.1
matmul:v_proj:L20                0.29     0.1
matmul:k_proj:L20                0.28     0.1
matmul:k_proj:L4                 0.28     0.1
matmul:v_proj:L4                 0.28     0.1
matmul:v_proj:L17                0.23     0.0
matmul:k_proj:L23                0.23     0.0
matmul:k_proj:L6                 0.23     0.0
matmul:v_proj:L3                 0.23     0.0
matmul:k_proj:L3                 0.23     0.0
matmul:k_proj:L11                0.23     0.0
matmul:k_proj:L19                0.23     0.0
matmul:k_proj:L14                0.23     0.0
matmul:k_proj:L18                0.23     0.0
matmul:v_proj:L12                0.23     0.0
matmul:v_proj:L11                0.23     0.0
matmul:k_proj:L9                 0.23     0.0
matmul:k_proj:L12                0.23     0.0
matmul:k_proj:L16                0.23     0.0
matmul:k_proj:L7                 0.23     0.0
matmul:v_proj:L7                 0.23     0.0
matmul:v_proj:L8                 0.22     0.0
matmul:k_proj:L17                0.22     0.0
matmul:v_proj:L9                 0.22     0.0
matmul:k_proj:L24                0.22     0.0
matmul:v_proj:L19                0.22     0.0
matmul:k_proj:L10                0.22     0.0
matmul:k_proj:L15                0.22     0.0
matmul:k_proj:L22                0.22     0.0
matmul:k_proj:L1                 0.22     0.0
matmul:k_proj:L8                 0.22     0.0
matmul:k_proj:L25                0.22     0.0
matmul:k_proj:L2                 0.22     0.0
matmul:v_proj:L22                0.22     0.0
matmul:v_proj:L6                 0.22     0.0
matmul:v_proj:L14                0.22     0.0
matmul:v_proj:L1                 0.22     0.0
matmul:v_proj:L10                0.22     0.0
matmul:v_proj:L18                0.22     0.0
matmul:v_proj:L24                0.22     0.0
matmul:v_proj:L16                0.22     0.0
matmul:v_proj:L25                0.22     0.0
matmul:v_proj:L2                 0.22     0.0
matmul:v_proj:L23                0.22     0.0
matmul:v_proj:L15                0.22     0.0
sample_phase1                    0.15     0.0
sample_phase3                    0.07     0.0
gather                           0.04     0.0
scale                            0.04     0.0
──────────────────────────────────────────────────
TOTAL                          525.87   100.0

[browser:warning] [14918.6ms][Profile] Batch decode (N=4):
[browser:warning] [14918.9ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      162.49    30.2
matmul:lm_head                 100.22    18.6
rmsnorm                          3.89     0.7
matmul:ffn_down:L10              3.61     0.7
matmul:ffn_down:L2               3.60     0.7
matmul:ffn_down:L18              3.56     0.7
matmul:ffn_down:L13              3.50     0.7
matmul:ffn_down:L12              3.47     0.6
matmul:ffn_down:L20              3.44     0.6
matmul:ffn_down:L11              3.43     0.6
matmul:ffn_down:L25              3.39     0.6
matmul:ffn_down:L4               3.39     0.6
matmul:ffn_down:L3               3.37     0.6
matmul:ffn_down:L19              3.37     0.6
sample_phase2                    3.32     0.6
matmul:ffn_down:L16              3.22     0.6
matmul:ffn_down:L21              3.21     0.6
matmul:ffn_down:L7               3.21     0.6
matmul:ffn_down:L24              3.21     0.6
matmul:ffn_down:L14              3.21     0.6
matmul:ffn_down:L1               3.21     0.6
matmul:ffn_down:L6               3.21     0.6
matmul:ffn_down:L9               3.21     0.6
matmul:ffn_down:L0               3.20     0.6
matmul:ffn_down:L23              3.20     0.6
matmul:ffn_down:L8               3.20     0.6
matmul:ffn_down:L5               3.20     0.6
matmul:ffn_down:L17              3.20     0.6
matmul:ffn_down:L15              3.20     0.6
matmul:ffn_down:L22              3.19     0.6
matmul:ffn_up:L21                3.10     0.6
matmul:ffn_up:L2                 2.75     0.5
matmul:ffn_gate:L21              2.73     0.5
matmul:ffn_up:L10                2.71     0.5
matmul:ffn_gate:L20              2.71     0.5
matmul:ffn_gate:L2               2.71     0.5
matmul:ffn_gate:L4               2.69     0.5
matmul:ffn_gate:L18              2.69     0.5
matmul:ffn_gate:L19              2.68     0.5
matmul:ffn_up:L25                2.68     0.5
matmul:ffn_up:L18                2.68     0.5
matmul:ffn_gate:L10              2.67     0.5
matmul:ffn_gate:L12              2.67     0.5
matmul:ffn_gate:L11              2.67     0.5
matmul:ffn_up:L3                 2.66     0.5
matmul:ffn_up:L4                 2.66     0.5
matmul:ffn_up:L19                2.66     0.5
matmul:ffn_up:L12                2.65     0.5
matmul:ffn_up:L20                2.65     0.5
matmul:ffn_up:L9                 2.62     0.5
matmul:ffn_gate:L3               2.62     0.5
matmul:ffn_up:L11                2.62     0.5
matmul:ffn_gate:L0               2.61     0.5
matmul:ffn_up:L0                 2.61     0.5
matmul:ffn_up:L22                2.61     0.5
matmul:ffn_gate:L15              2.60     0.5
matmul:ffn_up:L5                 2.60     0.5
matmul:ffn_up:L7                 2.60     0.5
matmul:ffn_up:L1                 2.60     0.5
matmul:ffn_gate:L5               2.60     0.5
matmul:ffn_up:L6                 2.60     0.5
matmul:ffn_gate:L16              2.60     0.5
matmul:ffn_up:L14                2.60     0.5
matmul:ffn_gate:L9               2.60     0.5
matmul:ffn_gate:L25              2.60     0.5
matmul:ffn_gate:L8               2.60     0.5
matmul:ffn_gate:L7               2.60     0.5
matmul:ffn_gate:L1               2.60     0.5
matmul:ffn_gate:L14              2.60     0.5
matmul:ffn_up:L8                 2.60     0.5
matmul:ffn_up:L23                2.60     0.5
matmul:ffn_gate:L24              2.60     0.5
matmul:ffn_gate:L17              2.60     0.5
matmul:ffn_up:L16                2.60     0.5
matmul:ffn_gate:L6               2.60     0.5
matmul:ffn_up:L15                2.60     0.5
matmul:ffn_gate:L23              2.60     0.5
matmul:ffn_gate:L22              2.60     0.5
matmul:ffn_up:L17                2.60     0.5
matmul:ffn_up:L24                2.60     0.5
matmul:ffn_gate:L13              2.60     0.5
matmul:ffn_up:L13                2.60     0.5
sample_phase1                    2.03     0.4
rope                             0.89     0.2
cast_f32_to_f16                  0.78     0.1
sample_phase3                    0.60     0.1
matmul:q_proj:L3                 0.59     0.1
matmul:q_proj:L19                0.58     0.1
matmul:q_proj:L11                0.57     0.1
matmul:o_proj:L4                 0.56     0.1
matmul:o_proj:L12                0.56     0.1
matmul:o_proj:L20                0.55     0.1
matmul:o_proj:L11                0.55     0.1
matmul:q_proj:L0                 0.53     0.1
matmul:o_proj:L2                 0.53     0.1
matmul:q_proj:L4                 0.53     0.1
matmul:q_proj:L20                0.53     0.1
matmul:q_proj:L5                 0.52     0.1
matmul:q_proj:L21                0.52     0.1
matmul:q_proj:L12                0.52     0.1
matmul:o_proj:L19                0.52     0.1
matmul:q_proj:L13                0.52     0.1
matmul:o_proj:L18                0.52     0.1
matmul:o_proj:L3                 0.50     0.1
matmul:q_proj:L14                0.50     0.1
gelu                             0.50     0.1
matmul:q_proj:L8                 0.49     0.1
matmul:q_proj:L17                0.49     0.1
matmul:q_proj:L10                0.49     0.1
matmul:q_proj:L18                0.49     0.1
matmul:q_proj:L24                0.49     0.1
matmul:q_proj:L6                 0.49     0.1
matmul:o_proj:L14                0.49     0.1
matmul:q_proj:L2                 0.49     0.1
matmul:q_proj:L1                 0.49     0.1
matmul:q_proj:L25                0.49     0.1
matmul:q_proj:L7                 0.49     0.1
matmul:q_proj:L23                0.49     0.1
matmul:q_proj:L9                 0.49     0.1
matmul:o_proj:L5                 0.49     0.1
matmul:q_proj:L16                0.49     0.1
matmul:q_proj:L22                0.49     0.1
matmul:o_proj:L22                0.48     0.1
matmul:o_proj:L9                 0.48     0.1
matmul:o_proj:L24                0.48     0.1
matmul:o_proj:L15                0.48     0.1
matmul:q_proj:L15                0.48     0.1
matmul:o_proj:L0                 0.48     0.1
matmul:o_proj:L7                 0.48     0.1
matmul:o_proj:L21                0.48     0.1
matmul:o_proj:L10                0.48     0.1
matmul:o_proj:L13                0.48     0.1
matmul:o_proj:L1                 0.48     0.1
matmul:o_proj:L23                0.48     0.1
matmul:o_proj:L6                 0.48     0.1
matmul:o_proj:L16                0.48     0.1
matmul:o_proj:L8                 0.48     0.1
matmul:o_proj:L25                0.48     0.1
matmul:o_proj:L17                0.48     0.1
matmul:k_proj:L3                 0.36     0.1
matmul:v_proj:L11                0.36     0.1
matmul:v_proj:L19                0.35     0.1
matmul:k_proj:L11                0.35     0.1
matmul:v_proj:L3                 0.35     0.1
matmul:k_proj:L19                0.35     0.1
matmul:v_proj:L0                 0.30     0.1
matmul:k_proj:L13                0.30     0.1
matmul:k_proj:L0                 0.29     0.1
matmul:v_proj:L13                0.29     0.1
matmul:k_proj:L5                 0.29     0.1
matmul:v_proj:L20                0.29     0.1
matmul:k_proj:L21                0.29     0.1
matmul:k_proj:L12                0.29     0.1
matmul:k_proj:L20                0.29     0.1
matmul:k_proj:L4                 0.29     0.1
matmul:v_proj:L12                0.29     0.1
matmul:v_proj:L5                 0.29     0.1
matmul:v_proj:L21                0.29     0.1
matmul:v_proj:L4                 0.28     0.1
matmul:k_proj:L14                0.24     0.0
matmul:k_proj:L18                0.23     0.0
matmul:v_proj:L14                0.23     0.0
matmul:k_proj:L24                0.23     0.0
matmul:k_proj:L22                0.23     0.0
matmul:k_proj:L17                0.23     0.0
matmul:k_proj:L15                0.23     0.0
matmul:v_proj:L22                0.23     0.0
matmul:k_proj:L10                0.23     0.0
matmul:k_proj:L16                0.23     0.0
matmul:k_proj:L1                 0.23     0.0
matmul:k_proj:L9                 0.23     0.0
matmul:k_proj:L8                 0.22     0.0
matmul:k_proj:L25                0.22     0.0
matmul:k_proj:L7                 0.22     0.0
matmul:k_proj:L6                 0.22     0.0
matmul:v_proj:L18                0.22     0.0
matmul:k_proj:L2                 0.22     0.0
matmul:v_proj:L17                0.22     0.0
matmul:v_proj:L8                 0.22     0.0
matmul:v_proj:L2                 0.22     0.0
matmul:v_proj:L1                 0.22     0.0
matmul:v_proj:L9                 0.22     0.0
matmul:v_proj:L10                0.22     0.0
matmul:v_proj:L25                0.22     0.0
matmul:k_proj:L23                0.22     0.0
matmul:v_proj:L15                0.22     0.0
matmul:v_proj:L7                 0.22     0.0
matmul:v_proj:L6                 0.22     0.0
matmul:v_proj:L24                0.22     0.0
matmul:v_proj:L16                0.22     0.0
matmul:v_proj:L23                0.22     0.0
gather                           0.02     0.0
scale                            0.02     0.0
──────────────────────────────────────────────────
TOTAL                          537.84   100.0

[browser:warning] [15520.2ms][Profile] Batch decode (N=4):
[browser:warning] [15520.3ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      170.18    31.5
matmul:lm_head                  95.93    17.8
rmsnorm                          3.92     0.7
matmul:ffn_down:L16              3.47     0.6
matmul:ffn_down:L3               3.47     0.6
matmul:ffn_down:L18              3.46     0.6
matmul:ffn_down:L15              3.45     0.6
matmul:ffn_down:L9               3.45     0.6
matmul:ffn_down:L25              3.45     0.6
matmul:ffn_down:L7               3.44     0.6
matmul:ffn_down:L22              3.41     0.6
matmul:ffn_up:L8                 3.39     0.6
matmul:ffn_down:L23              3.39     0.6
matmul:ffn_down:L0               3.39     0.6
matmul:ffn_down:L1               3.38     0.6
matmul:ffn_down:L10              3.37     0.6
matmul:ffn_down:L24              3.37     0.6
sample_phase2                    3.36     0.6
matmul:ffn_down:L14              3.35     0.6
matmul:ffn_down:L8               3.34     0.6
matmul:ffn_down:L2               3.21     0.6
matmul:ffn_down:L6               3.21     0.6
matmul:ffn_down:L13              3.21     0.6
matmul:ffn_down:L11              3.20     0.6
matmul:ffn_down:L21              3.20     0.6
matmul:ffn_down:L20              3.20     0.6
matmul:ffn_down:L17              3.20     0.6
matmul:ffn_down:L19              3.20     0.6
matmul:ffn_down:L4               3.20     0.6
matmul:ffn_down:L5               3.20     0.6
matmul:ffn_down:L12              3.19     0.6
matmul:ffn_up:L15                2.72     0.5
matmul:ffn_gate:L23              2.71     0.5
matmul:ffn_up:L24                2.69     0.5
matmul:ffn_gate:L24              2.68     0.5
matmul:ffn_gate:L0               2.68     0.5
matmul:ffn_up:L22                2.67     0.5
matmul:ffn_up:L23                2.66     0.5
matmul:ffn_up:L1                 2.66     0.5
matmul:ffn_up:L0                 2.65     0.5
matmul:ffn_up:L3                 2.65     0.5
matmul:ffn_gate:L18              2.65     0.5
matmul:ffn_gate:L9               2.65     0.5
matmul:ffn_up:L18                2.64     0.5
matmul:ffn_gate:L1               2.64     0.5
matmul:ffn_gate:L3               2.64     0.5
matmul:ffn_up:L9                 2.64     0.5
matmul:ffn_gate:L8               2.64     0.5
matmul:ffn_gate:L15              2.64     0.5
matmul:ffn_gate:L7               2.64     0.5
matmul:ffn_up:L7                 2.64     0.5
matmul:ffn_up:L10                2.63     0.5
matmul:ffn_gate:L10              2.63     0.5
matmul:ffn_gate:L4               2.63     0.5
matmul:ffn_gate:L17              2.63     0.5
matmul:ffn_gate:L16              2.62     0.5
matmul:ffn_up:L2                 2.61     0.5
matmul:ffn_gate:L25              2.61     0.5
matmul:ffn_up:L25                2.61     0.5
matmul:ffn_up:L16                2.61     0.5
matmul:ffn_up:L13                2.61     0.5
matmul:ffn_up:L17                2.61     0.5
matmul:ffn_up:L21                2.61     0.5
matmul:ffn_gate:L13              2.60     0.5
matmul:ffn_up:L20                2.60     0.5
matmul:ffn_gate:L12              2.60     0.5
matmul:ffn_gate:L11              2.60     0.5
matmul:ffn_up:L19                2.60     0.5
matmul:ffn_gate:L22              2.60     0.5
matmul:ffn_up:L5                 2.60     0.5
matmul:ffn_up:L12                2.60     0.5
matmul:ffn_gate:L6               2.60     0.5
matmul:ffn_up:L6                 2.60     0.5
matmul:ffn_up:L11                2.60     0.5
matmul:ffn_gate:L2               2.60     0.5
matmul:ffn_gate:L14              2.60     0.5
matmul:ffn_gate:L5               2.60     0.5
matmul:ffn_up:L14                2.60     0.5
matmul:ffn_gate:L21              2.60     0.5
matmul:ffn_gate:L20              2.60     0.5
matmul:ffn_up:L4                 2.60     0.5
matmul:ffn_gate:L19              2.60     0.5
rope                             1.04     0.2
cast_f32_to_f16                  0.82     0.2
matmul:q_proj:L0                 0.55     0.1
matmul:o_proj:L1                 0.54     0.1
matmul:o_proj:L18                0.54     0.1
matmul:q_proj:L11                0.54     0.1
matmul:q_proj:L9                 0.53     0.1
matmul:o_proj:L9                 0.53     0.1
matmul:o_proj:L7                 0.53     0.1
matmul:q_proj:L23                0.53     0.1
matmul:q_proj:L17                0.53     0.1
matmul:q_proj:L16                0.53     0.1
matmul:q_proj:L19                0.53     0.1
matmul:q_proj:L24                0.53     0.1
matmul:q_proj:L10                0.52     0.1
matmul:q_proj:L25                0.52     0.1
matmul:q_proj:L8                 0.52     0.1
matmul:o_proj:L10                0.52     0.1
matmul:q_proj:L1                 0.52     0.1
matmul:o_proj:L23                0.52     0.1
matmul:q_proj:L2                 0.52     0.1
matmul:q_proj:L4                 0.52     0.1
matmul:o_proj:L24                0.52     0.1
matmul:o_proj:L17                0.52     0.1
matmul:o_proj:L15                0.52     0.1
matmul:q_proj:L15                0.52     0.1
matmul:o_proj:L3                 0.52     0.1
matmul:o_proj:L25                0.52     0.1
matmul:o_proj:L8                 0.52     0.1
matmul:o_proj:L16                0.52     0.1
gelu                             0.50     0.1
matmul:q_proj:L18                0.49     0.1
matmul:q_proj:L7                 0.49     0.1
matmul:q_proj:L14                0.49     0.1
matmul:o_proj:L4                 0.49     0.1
matmul:q_proj:L6                 0.49     0.1
matmul:q_proj:L3                 0.49     0.1
matmul:q_proj:L13                0.49     0.1
matmul:q_proj:L21                0.49     0.1
matmul:o_proj:L2                 0.49     0.1
matmul:o_proj:L22                0.49     0.1
matmul:q_proj:L20                0.49     0.1
matmul:o_proj:L19                0.49     0.1
matmul:o_proj:L5                 0.49     0.1
matmul:q_proj:L22                0.49     0.1
matmul:q_proj:L12                0.49     0.1
matmul:o_proj:L6                 0.48     0.1
matmul:o_proj:L13                0.48     0.1
matmul:q_proj:L5                 0.48     0.1
matmul:o_proj:L14                0.48     0.1
matmul:o_proj:L21                0.48     0.1
matmul:o_proj:L0                 0.48     0.1
matmul:o_proj:L12                0.48     0.1
matmul:o_proj:L11                0.48     0.1
matmul:o_proj:L20                0.48     0.1
matmul:k_proj:L9                 0.30     0.1
matmul:k_proj:L19                0.30     0.1
matmul:k_proj:L0                 0.30     0.1
matmul:v_proj:L0                 0.30     0.1
matmul:k_proj:L8                 0.30     0.1
matmul:v_proj:L8                 0.29     0.1
matmul:v_proj:L1                 0.29     0.1
matmul:v_proj:L10                0.29     0.1
matmul:k_proj:L16                0.29     0.1
matmul:v_proj:L11                0.29     0.1
matmul:k_proj:L10                0.29     0.1
matmul:v_proj:L9                 0.29     0.1
matmul:k_proj:L24                0.29     0.1
matmul:k_proj:L23                0.29     0.1
matmul:v_proj:L24                0.29     0.1
matmul:v_proj:L16                0.29     0.1
matmul:k_proj:L17                0.29     0.1
matmul:k_proj:L2                 0.29     0.1
matmul:v_proj:L19                0.29     0.1
matmul:k_proj:L25                0.28     0.1
matmul:k_proj:L1                 0.28     0.1
matmul:v_proj:L2                 0.28     0.1
matmul:v_proj:L15                0.28     0.1
matmul:v_proj:L25                0.28     0.1
matmul:v_proj:L23                0.28     0.1
matmul:v_proj:L17                0.28     0.1
matmul:k_proj:L11                0.28     0.1
matmul:k_proj:L15                0.28     0.1
matmul:k_proj:L4                 0.24     0.0
matmul:k_proj:L18                0.23     0.0
matmul:k_proj:L14                0.23     0.0
matmul:k_proj:L22                0.23     0.0
matmul:k_proj:L7                 0.23     0.0
matmul:v_proj:L18                0.23     0.0
matmul:k_proj:L5                 0.23     0.0
matmul:k_proj:L3                 0.23     0.0
matmul:v_proj:L6                 0.23     0.0
matmul:k_proj:L12                0.23     0.0
matmul:v_proj:L20                0.23     0.0
matmul:k_proj:L6                 0.23     0.0
matmul:k_proj:L21                0.23     0.0
matmul:v_proj:L7                 0.23     0.0
matmul:v_proj:L3                 0.23     0.0
matmul:v_proj:L22                0.22     0.0
matmul:k_proj:L20                0.22     0.0
matmul:k_proj:L13                0.22     0.0
matmul:v_proj:L4                 0.22     0.0
matmul:v_proj:L14                0.22     0.0
matmul:v_proj:L12                0.22     0.0
matmul:v_proj:L5                 0.22     0.0
matmul:v_proj:L13                0.22     0.0
matmul:v_proj:L21                0.22     0.0
sample_phase1                    0.10     0.0
sample_phase3                    0.06     0.0
gather                           0.03     0.0
scale                            0.02     0.0
──────────────────────────────────────────────────
TOTAL                          539.62   100.0

[browser:warning] [16106.2ms][Profile] Batch decode (N=4):
[browser:warning] [16106.5ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      176.89    32.5
matmul:lm_head                  95.48    17.6
rmsnorm                          3.80     0.7
matmul:ffn_down:L5               3.64     0.7
matmul:ffn_down:L3               3.48     0.6
matmul:ffn_down:L19              3.48     0.6
matmul:ffn_down:L11              3.47     0.6
matmul:ffn_down:L6               3.46     0.6
matmul:ffn_down:L21              3.46     0.6
sample_phase2                    3.42     0.6
matmul:ffn_down:L22              3.39     0.6
matmul:ffn_down:L13              3.38     0.6
matmul:ffn_down:L14              3.38     0.6
matmul:ffn_down:L10              3.37     0.6
matmul:ffn_down:L18              3.33     0.6
matmul:ffn_down:L4               3.22     0.6
matmul:ffn_down:L2               3.22     0.6
matmul:ffn_down:L12              3.21     0.6
matmul:ffn_down:L17              3.21     0.6
matmul:ffn_down:L24              3.21     0.6
matmul:ffn_down:L20              3.21     0.6
matmul:ffn_down:L9               3.20     0.6
matmul:ffn_down:L16              3.20     0.6
matmul:ffn_down:L8               3.20     0.6
matmul:ffn_down:L7               3.20     0.6
matmul:ffn_down:L1               3.20     0.6
matmul:ffn_down:L25              3.20     0.6
matmul:ffn_down:L23              3.19     0.6
matmul:ffn_down:L0               3.19     0.6
matmul:ffn_down:L15              3.19     0.6
matmul:ffn_up:L5                 2.70     0.5
matmul:ffn_gate:L10              2.66     0.5
matmul:ffn_gate:L3               2.65     0.5
matmul:ffn_gate:L22              2.65     0.5
matmul:ffn_gate:L18              2.64     0.5
matmul:ffn_up:L22                2.64     0.5
matmul:ffn_gate:L5               2.64     0.5
matmul:ffn_up:L21                2.64     0.5
matmul:ffn_up:L10                2.64     0.5
matmul:ffn_gate:L7               2.64     0.5
matmul:ffn_up:L18                2.64     0.5
matmul:ffn_gate:L21              2.64     0.5
matmul:ffn_up:L13                2.64     0.5
matmul:ffn_up:L3                 2.64     0.5
matmul:ffn_up:L7                 2.63     0.5
matmul:ffn_gate:L14              2.63     0.5
matmul:ffn_gate:L12              2.63     0.5
matmul:ffn_up:L14                2.63     0.5
matmul:ffn_gate:L13              2.63     0.5
matmul:ffn_up:L12                2.62     0.5
matmul:ffn_gate:L20              2.61     0.5
matmul:ffn_gate:L11              2.61     0.5
matmul:ffn_gate:L0               2.61     0.5
matmul:ffn_gate:L16              2.61     0.5
matmul:ffn_gate:L4               2.61     0.5
matmul:ffn_gate:L24              2.60     0.5
matmul:ffn_up:L4                 2.60     0.5
matmul:ffn_gate:L8               2.60     0.5
matmul:ffn_up:L15                2.60     0.5
matmul:ffn_up:L9                 2.60     0.5
matmul:ffn_up:L6                 2.60     0.5
matmul:ffn_gate:L9               2.60     0.5
matmul:ffn_gate:L6               2.60     0.5
matmul:ffn_up:L1                 2.60     0.5
matmul:ffn_up:L20                2.60     0.5
matmul:ffn_up:L25                2.60     0.5
matmul:ffn_up:L23                2.60     0.5
matmul:ffn_gate:L15              2.60     0.5
matmul:ffn_gate:L19              2.60     0.5
matmul:ffn_gate:L17              2.60     0.5
matmul:ffn_up:L8                 2.60     0.5
matmul:ffn_gate:L1               2.60     0.5
matmul:ffn_up:L11                2.60     0.5
matmul:ffn_gate:L23              2.60     0.5
matmul:ffn_up:L17                2.60     0.5
matmul:ffn_up:L19                2.60     0.5
matmul:ffn_up:L2                 2.60     0.5
matmul:ffn_gate:L25              2.60     0.5
matmul:ffn_up:L24                2.60     0.5
matmul:ffn_gate:L2               2.60     0.5
matmul:ffn_up:L0                 2.60     0.5
matmul:ffn_up:L16                2.59     0.5
rope                             0.89     0.2
cast_f32_to_f16                  0.77     0.1
matmul:q_proj:L0                 0.63     0.1
matmul:q_proj:L18                0.57     0.1
matmul:q_proj:L6                 0.56     0.1
matmul:o_proj:L5                 0.53     0.1
matmul:o_proj:L21                0.53     0.1
matmul:q_proj:L15                0.53     0.1
matmul:q_proj:L11                0.53     0.1
matmul:o_proj:L7                 0.52     0.1
matmul:q_proj:L14                0.52     0.1
matmul:q_proj:L20                0.52     0.1
matmul:q_proj:L7                 0.52     0.1
matmul:o_proj:L6                 0.52     0.1
matmul:q_proj:L12                0.52     0.1
matmul:q_proj:L22                0.52     0.1
matmul:o_proj:L14                0.52     0.1
matmul:o_proj:L18                0.52     0.1
matmul:o_proj:L12                0.52     0.1
matmul:o_proj:L3                 0.52     0.1
matmul:o_proj:L13                0.51     0.1
matmul:o_proj:L20                0.51     0.1
matmul:o_proj:L22                0.51     0.1
matmul:q_proj:L2                 0.51     0.1
matmul:q_proj:L4                 0.50     0.1
matmul:q_proj:L23                0.49     0.1
matmul:q_proj:L5                 0.49     0.1
matmul:o_proj:L11                0.49     0.1
matmul:q_proj:L19                0.49     0.1
matmul:q_proj:L21                0.49     0.1
matmul:q_proj:L17                0.49     0.1
matmul:q_proj:L3                 0.49     0.1
matmul:q_proj:L10                0.49     0.1
matmul:q_proj:L13                0.49     0.1
matmul:o_proj:L15                0.49     0.1
matmul:q_proj:L24                0.49     0.1
matmul:q_proj:L25                0.49     0.1
matmul:o_proj:L24                0.49     0.1
matmul:o_proj:L23                0.49     0.1
matmul:q_proj:L16                0.49     0.1
matmul:o_proj:L17                0.49     0.1
matmul:q_proj:L8                 0.49     0.1
matmul:o_proj:L0                 0.48     0.1
matmul:q_proj:L1                 0.48     0.1
matmul:o_proj:L2                 0.48     0.1
matmul:q_proj:L9                 0.48     0.1
matmul:o_proj:L10                0.48     0.1
matmul:o_proj:L25                0.48     0.1
matmul:o_proj:L9                 0.48     0.1
matmul:o_proj:L16                0.48     0.1
matmul:o_proj:L19                0.48     0.1
matmul:o_proj:L4                 0.48     0.1
matmul:o_proj:L1                 0.48     0.1
matmul:o_proj:L8                 0.48     0.1
gelu                             0.44     0.1
matmul:v_proj:L0                 0.43     0.1
matmul:k_proj:L0                 0.42     0.1
matmul:v_proj:L22                0.39     0.1
matmul:k_proj:L22                0.36     0.1
matmul:k_proj:L6                 0.36     0.1
matmul:v_proj:L6                 0.36     0.1
matmul:v_proj:L3                 0.31     0.1
matmul:v_proj:L11                0.29     0.1
matmul:k_proj:L7                 0.29     0.1
matmul:k_proj:L15                0.29     0.1
matmul:v_proj:L7                 0.29     0.1
matmul:k_proj:L11                0.29     0.1
matmul:k_proj:L14                0.29     0.1
matmul:v_proj:L14                0.29     0.1
matmul:v_proj:L15                0.28     0.1
matmul:k_proj:L12                0.28     0.1
matmul:v_proj:L20                0.28     0.1
matmul:k_proj:L20                0.28     0.1
matmul:v_proj:L12                0.28     0.1
matmul:v_proj:L18                0.28     0.1
matmul:k_proj:L3                 0.28     0.1
matmul:k_proj:L18                0.26     0.0
matmul:k_proj:L2                 0.26     0.0
matmul:k_proj:L5                 0.24     0.0
matmul:k_proj:L21                0.23     0.0
matmul:k_proj:L8                 0.23     0.0
matmul:v_proj:L2                 0.23     0.0
matmul:v_proj:L5                 0.23     0.0
matmul:k_proj:L25                0.23     0.0
matmul:k_proj:L4                 0.23     0.0
matmul:k_proj:L13                0.23     0.0
matmul:k_proj:L17                0.23     0.0
matmul:k_proj:L19                0.23     0.0
matmul:k_proj:L16                0.23     0.0
matmul:v_proj:L10                0.23     0.0
matmul:v_proj:L21                0.23     0.0
matmul:k_proj:L24                0.22     0.0
matmul:k_proj:L10                0.22     0.0
matmul:v_proj:L13                0.22     0.0
matmul:k_proj:L23                0.22     0.0
matmul:v_proj:L4                 0.22     0.0
matmul:k_proj:L1                 0.22     0.0
matmul:v_proj:L23                0.22     0.0
matmul:k_proj:L9                 0.22     0.0
matmul:v_proj:L17                0.22     0.0
matmul:v_proj:L25                0.22     0.0
matmul:v_proj:L19                0.22     0.0
matmul:v_proj:L8                 0.22     0.0
matmul:v_proj:L9                 0.22     0.0
matmul:v_proj:L1                 0.22     0.0
matmul:v_proj:L16                0.22     0.0
matmul:v_proj:L24                0.22     0.0
sample_phase1                    0.14     0.0
sample_phase3                    0.08     0.0
gather                           0.05     0.0
scale                            0.04     0.0
──────────────────────────────────────────────────
TOTAL                          543.87   100.0

[browser:warning] [16700.6ms][Profile] Batch decode (N=4):
[browser:warning] [16700.8ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      183.97    33.4
matmul:lm_head                  95.17    17.3
rmsnorm                          3.83     0.7
matmul:ffn_down:L9               3.48     0.6
matmul:ffn_down:L14              3.48     0.6
matmul:ffn_down:L2               3.47     0.6
sample_phase2                    3.46     0.6
matmul:ffn_down:L8               3.43     0.6
matmul:ffn_down:L21              3.42     0.6
matmul:ffn_down:L11              3.39     0.6
matmul:ffn_down:L6               3.39     0.6
matmul:ffn_down:L4               3.39     0.6
matmul:ffn_down:L15              3.38     0.6
matmul:ffn_down:L24              3.38     0.6
matmul:ffn_down:L22              3.38     0.6
matmul:ffn_down:L19              3.37     0.6
matmul:ffn_down:L0               3.37     0.6
matmul:ffn_down:L17              3.29     0.6
matmul:ffn_down:L16              3.23     0.6
matmul:ffn_down:L12              3.23     0.6
matmul:ffn_down:L13              3.22     0.6
matmul:ffn_down:L7               3.22     0.6
matmul:ffn_down:L18              3.21     0.6
matmul:ffn_down:L1               3.21     0.6
matmul:ffn_down:L10              3.21     0.6
matmul:ffn_down:L25              3.20     0.6
matmul:ffn_down:L20              3.20     0.6
matmul:ffn_down:L3               3.20     0.6
matmul:ffn_down:L5               3.20     0.6
matmul:ffn_down:L23              3.19     0.6
matmul:ffn_gate:L15              2.70     0.5
matmul:ffn_up:L22                2.67     0.5
matmul:ffn_gate:L0               2.66     0.5
matmul:ffn_up:L9                 2.66     0.5
matmul:ffn_up:L0                 2.66     0.5
matmul:ffn_up:L14                2.65     0.5
matmul:ffn_up:L4                 2.65     0.5
matmul:ffn_up:L24                2.65     0.5
matmul:ffn_gate:L6               2.65     0.5
matmul:ffn_up:L8                 2.64     0.5
matmul:ffn_up:L12                2.64     0.5
matmul:ffn_up:L2                 2.64     0.5
matmul:ffn_gate:L19              2.64     0.5
matmul:ffn_up:L6                 2.64     0.5
matmul:ffn_gate:L21              2.64     0.5
matmul:ffn_gate:L12              2.64     0.5
matmul:ffn_gate:L8               2.64     0.5
matmul:ffn_gate:L14              2.64     0.5
matmul:ffn_gate:L17              2.64     0.5
matmul:ffn_up:L17                2.64     0.5
matmul:ffn_up:L21                2.64     0.5
matmul:ffn_up:L15                2.64     0.5
matmul:ffn_gate:L2               2.63     0.5
matmul:ffn_up:L19                2.63     0.5
matmul:ffn_up:L5                 2.61     0.5
matmul:ffn_gate:L5               2.61     0.5
matmul:ffn_up:L1                 2.61     0.5
matmul:ffn_up:L13                2.61     0.5
matmul:ffn_gate:L4               2.61     0.5
matmul:ffn_gate:L10              2.60     0.5
matmul:ffn_gate:L9               2.60     0.5
matmul:ffn_gate:L25              2.60     0.5
matmul:ffn_gate:L18              2.60     0.5
matmul:ffn_gate:L23              2.60     0.5
matmul:ffn_up:L23                2.60     0.5
matmul:ffn_up:L7                 2.60     0.5
matmul:ffn_gate:L24              2.60     0.5
matmul:ffn_gate:L1               2.60     0.5
matmul:ffn_up:L18                2.60     0.5
matmul:ffn_gate:L11              2.60     0.5
matmul:ffn_up:L11                2.60     0.5
matmul:ffn_up:L20                2.60     0.5
matmul:ffn_up:L16                2.60     0.5
matmul:ffn_up:L3                 2.60     0.5
matmul:ffn_gate:L22              2.60     0.5
matmul:ffn_gate:L16              2.60     0.5
matmul:ffn_gate:L20              2.60     0.5
matmul:ffn_gate:L7               2.60     0.5
matmul:ffn_up:L10                2.60     0.5
matmul:ffn_gate:L13              2.60     0.5
matmul:ffn_up:L25                2.60     0.5
matmul:ffn_gate:L3               2.60     0.5
rope                             0.93     0.2
cast_f32_to_f16                  0.80     0.1
matmul:q_proj:L0                 0.58     0.1
matmul:q_proj:L17                0.56     0.1
matmul:o_proj:L19                0.55     0.1
matmul:q_proj:L25                0.53     0.1
matmul:q_proj:L16                0.53     0.1
matmul:q_proj:L20                0.53     0.1
matmul:q_proj:L12                0.53     0.1
matmul:o_proj:L2                 0.53     0.1
matmul:q_proj:L10                0.53     0.1
matmul:q_proj:L5                 0.53     0.1
matmul:q_proj:L22                0.53     0.1
matmul:q_proj:L3                 0.52     0.1
matmul:q_proj:L7                 0.52     0.1
matmul:q_proj:L15                0.52     0.1
matmul:q_proj:L23                0.52     0.1
matmul:o_proj:L14                0.52     0.1
matmul:q_proj:L1                 0.52     0.1
matmul:o_proj:L21                0.52     0.1
matmul:o_proj:L8                 0.52     0.1
matmul:o_proj:L6                 0.52     0.1
matmul:o_proj:L12                0.52     0.1
matmul:o_proj:L17                0.51     0.1
matmul:o_proj:L25                0.51     0.1
matmul:o_proj:L15                0.51     0.1
matmul:o_proj:L1                 0.51     0.1
gelu                             0.49     0.1
matmul:o_proj:L23                0.49     0.1
matmul:o_proj:L10                0.49     0.1
matmul:q_proj:L11                0.49     0.1
matmul:q_proj:L9                 0.49     0.1
matmul:q_proj:L19                0.49     0.1
matmul:q_proj:L21                0.49     0.1
matmul:o_proj:L22                0.49     0.1
matmul:q_proj:L13                0.49     0.1
matmul:q_proj:L14                0.49     0.1
matmul:q_proj:L8                 0.49     0.1
matmul:o_proj:L5                 0.49     0.1
matmul:q_proj:L18                0.49     0.1
matmul:q_proj:L6                 0.49     0.1
matmul:o_proj:L3                 0.49     0.1
matmul:q_proj:L24                0.49     0.1
matmul:o_proj:L18                0.49     0.1
matmul:o_proj:L7                 0.49     0.1
matmul:q_proj:L4                 0.49     0.1
matmul:q_proj:L2                 0.49     0.1
matmul:o_proj:L4                 0.48     0.1
matmul:o_proj:L24                0.48     0.1
matmul:o_proj:L9                 0.48     0.1
matmul:o_proj:L0                 0.48     0.1
matmul:o_proj:L16                0.48     0.1
matmul:o_proj:L20                0.48     0.1
matmul:o_proj:L11                0.48     0.1
matmul:o_proj:L13                0.48     0.1
matmul:k_proj:L0                 0.37     0.1
matmul:v_proj:L0                 0.37     0.1
matmul:v_proj:L8                 0.30     0.1
matmul:v_proj:L3                 0.30     0.1
matmul:k_proj:L16                0.30     0.1
matmul:k_proj:L3                 0.30     0.1
matmul:k_proj:L22                0.30     0.1
matmul:k_proj:L15                0.30     0.1
matmul:k_proj:L20                0.29     0.1
matmul:k_proj:L12                0.29     0.1
matmul:v_proj:L15                0.29     0.1
matmul:k_proj:L5                 0.29     0.1
matmul:v_proj:L7                 0.29     0.1
matmul:k_proj:L25                0.29     0.1
matmul:v_proj:L25                0.29     0.1
matmul:v_proj:L12                0.29     0.1
matmul:v_proj:L22                0.29     0.1
matmul:k_proj:L23                0.29     0.1
matmul:k_proj:L7                 0.28     0.1
matmul:k_proj:L17                0.28     0.1
matmul:v_proj:L10                0.28     0.1
matmul:v_proj:L20                0.28     0.1
matmul:k_proj:L10                0.28     0.1
matmul:k_proj:L1                 0.28     0.1
matmul:v_proj:L16                0.28     0.1
matmul:v_proj:L23                0.28     0.1
matmul:v_proj:L1                 0.28     0.1
matmul:v_proj:L5                 0.28     0.1
matmul:v_proj:L17                0.28     0.1
matmul:k_proj:L8                 0.27     0.0
matmul:v_proj:L4                 0.23     0.0
matmul:k_proj:L13                0.23     0.0
matmul:k_proj:L24                0.23     0.0
matmul:k_proj:L2                 0.23     0.0
matmul:k_proj:L18                0.23     0.0
matmul:k_proj:L4                 0.23     0.0
matmul:k_proj:L14                0.23     0.0
matmul:v_proj:L6                 0.23     0.0
matmul:v_proj:L2                 0.23     0.0
matmul:k_proj:L9                 0.23     0.0
matmul:k_proj:L19                0.23     0.0
matmul:v_proj:L19                0.23     0.0
matmul:k_proj:L21                0.23     0.0
matmul:k_proj:L6                 0.23     0.0
matmul:v_proj:L14                0.22     0.0
matmul:k_proj:L11                0.22     0.0
matmul:v_proj:L13                0.22     0.0
matmul:v_proj:L9                 0.22     0.0
matmul:v_proj:L11                0.22     0.0
matmul:v_proj:L18                0.22     0.0
matmul:v_proj:L21                0.22     0.0
matmul:v_proj:L24                0.22     0.0
sample_phase1                    0.12     0.0
sample_phase3                    0.07     0.0
gather                           0.04     0.0
scale                            0.03     0.0
──────────────────────────────────────────────────
TOTAL                          551.42   100.0

[browser:warning] [17308.3ms][Profile] Batch decode (N=4):
[browser:warning] [17308.5ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      190.11    33.6
matmul:lm_head                  99.89    17.7
rmsnorm                          4.18     0.7
matmul:ffn_up:L14                3.87     0.7
matmul:ffn_down:L3               3.61     0.6
matmul:ffn_down:L14              3.56     0.6
matmul:ffn_down:L18              3.55     0.6
matmul:ffn_down:L25              3.46     0.6
matmul:ffn_down:L10              3.45     0.6
matmul:ffn_down:L16              3.45     0.6
sample_phase2                    3.41     0.6
matmul:ffn_down:L20              3.40     0.6
matmul:ffn_down:L11              3.40     0.6
matmul:ffn_down:L1               3.38     0.6
matmul:ffn_down:L6               3.38     0.6
matmul:ffn_down:L23              3.37     0.6
matmul:ffn_down:L8               3.36     0.6
matmul:ffn_down:L7               3.25     0.6
matmul:ffn_down:L21              3.24     0.6
matmul:ffn_down:L13              3.22     0.6
matmul:ffn_gate:L2               3.21     0.6
matmul:ffn_down:L9               3.21     0.6
matmul:ffn_down:L19              3.21     0.6
matmul:ffn_down:L2               3.21     0.6
matmul:ffn_down:L24              3.21     0.6
matmul:ffn_down:L17              3.20     0.6
matmul:ffn_down:L12              3.20     0.6
matmul:ffn_down:L4               3.20     0.6
matmul:ffn_down:L22              3.20     0.6
matmul:ffn_down:L0               3.19     0.6
matmul:ffn_down:L15              3.19     0.6
matmul:ffn_down:L5               3.19     0.6
matmul:ffn_up:L21                2.71     0.5
matmul:ffn_up:L20                2.68     0.5
matmul:ffn_gate:L11              2.68     0.5
matmul:ffn_gate:L6               2.67     0.5
matmul:ffn_gate:L18              2.67     0.5
matmul:ffn_gate:L23              2.67     0.5
matmul:ffn_up:L18                2.66     0.5
matmul:ffn_gate:L3               2.66     0.5
matmul:ffn_up:L6                 2.65     0.5
matmul:ffn_gate:L14              2.65     0.5
matmul:ffn_up:L1                 2.65     0.5
matmul:ffn_up:L3                 2.65     0.5
matmul:ffn_gate:L8               2.64     0.5
matmul:ffn_up:L25                2.64     0.5
matmul:ffn_up:L11                2.64     0.5
matmul:ffn_up:L8                 2.64     0.5
matmul:ffn_gate:L16              2.64     0.5
matmul:ffn_up:L16                2.63     0.5
matmul:ffn_gate:L1               2.63     0.5
matmul:ffn_up:L23                2.63     0.5
matmul:ffn_gate:L24              2.61     0.5
matmul:ffn_gate:L4               2.61     0.5
matmul:ffn_up:L9                 2.61     0.5
matmul:ffn_up:L2                 2.60     0.5
matmul:ffn_gate:L21              2.60     0.5
matmul:ffn_gate:L10              2.60     0.5
matmul:ffn_up:L5                 2.60     0.5
matmul:ffn_gate:L5               2.60     0.5
matmul:ffn_gate:L0               2.60     0.5
matmul:ffn_gate:L7               2.60     0.5
matmul:ffn_up:L13                2.60     0.5
matmul:ffn_gate:L17              2.60     0.5
matmul:ffn_up:L4                 2.60     0.5
matmul:ffn_up:L10                2.60     0.5
matmul:ffn_up:L17                2.60     0.5
matmul:ffn_gate:L19              2.60     0.5
matmul:ffn_up:L15                2.60     0.5
matmul:ffn_up:L12                2.60     0.5
matmul:ffn_gate:L13              2.60     0.5
matmul:ffn_gate:L9               2.60     0.5
matmul:ffn_up:L24                2.60     0.5
matmul:ffn_gate:L20              2.60     0.5
matmul:ffn_up:L7                 2.60     0.5
matmul:ffn_up:L22                2.60     0.5
matmul:ffn_up:L0                 2.60     0.5
matmul:ffn_gate:L12              2.60     0.5
matmul:ffn_gate:L22              2.60     0.5
matmul:ffn_up:L19                2.60     0.5
matmul:ffn_gate:L25              2.60     0.5
matmul:ffn_gate:L15              2.60     0.5
rope                             1.00     0.2
gelu                             0.97     0.2
cast_f32_to_f16                  0.86     0.2
matmul:q_proj:L0                 0.65     0.1
matmul:o_proj:L11                0.61     0.1
matmul:q_proj:L19                0.57     0.1
matmul:o_proj:L18                0.56     0.1
matmul:q_proj:L4                 0.56     0.1
matmul:q_proj:L14                0.55     0.1
matmul:q_proj:L15                0.55     0.1
matmul:o_proj:L8                 0.54     0.1
matmul:o_proj:L3                 0.54     0.1
matmul:q_proj:L17                0.53     0.1
matmul:o_proj:L14                0.53     0.1
matmul:q_proj:L21                0.53     0.1
matmul:q_proj:L2                 0.53     0.1
matmul:q_proj:L12                0.53     0.1
matmul:q_proj:L24                0.53     0.1
matmul:q_proj:L7                 0.53     0.1
matmul:q_proj:L11                0.52     0.1
matmul:q_proj:L9                 0.52     0.1
matmul:o_proj:L16                0.52     0.1
matmul:o_proj:L1                 0.52     0.1
matmul:o_proj:L4                 0.52     0.1
matmul:o_proj:L23                0.51     0.1
matmul:q_proj:L20                0.49     0.1
matmul:q_proj:L25                0.49     0.1
matmul:q_proj:L22                0.49     0.1
matmul:q_proj:L8                 0.49     0.1
matmul:q_proj:L10                0.49     0.1
matmul:q_proj:L23                0.49     0.1
matmul:q_proj:L18                0.49     0.1
matmul:q_proj:L16                0.49     0.1
matmul:q_proj:L5                 0.49     0.1
matmul:q_proj:L13                0.49     0.1
matmul:o_proj:L24                0.49     0.1
matmul:o_proj:L10                0.49     0.1
matmul:q_proj:L3                 0.49     0.1
matmul:o_proj:L7                 0.49     0.1
matmul:o_proj:L9                 0.49     0.1
matmul:q_proj:L6                 0.48     0.1
matmul:o_proj:L20                0.48     0.1
matmul:q_proj:L1                 0.48     0.1
matmul:o_proj:L17                0.48     0.1
matmul:o_proj:L19                0.48     0.1
matmul:o_proj:L6                 0.48     0.1
matmul:o_proj:L2                 0.48     0.1
matmul:o_proj:L0                 0.48     0.1
matmul:o_proj:L22                0.48     0.1
matmul:o_proj:L13                0.48     0.1
matmul:o_proj:L15                0.48     0.1
matmul:o_proj:L21                0.48     0.1
matmul:o_proj:L25                0.48     0.1
matmul:o_proj:L12                0.48     0.1
matmul:o_proj:L5                 0.48     0.1
sample_phase1                    0.40     0.1
matmul:k_proj:L0                 0.37     0.1
matmul:v_proj:L0                 0.36     0.1
matmul:k_proj:L19                0.35     0.1
matmul:v_proj:L19                0.35     0.1
matmul:k_proj:L4                 0.34     0.1
matmul:k_proj:L15                0.34     0.1
matmul:v_proj:L4                 0.34     0.1
matmul:v_proj:L15                0.33     0.1
matmul:k_proj:L17                0.30     0.1
matmul:v_proj:L17                0.30     0.1
matmul:k_proj:L21                0.29     0.1
matmul:k_proj:L9                 0.29     0.1
matmul:v_proj:L7                 0.29     0.1
matmul:v_proj:L9                 0.29     0.1
matmul:v_proj:L12                0.29     0.1
matmul:k_proj:L2                 0.29     0.1
matmul:v_proj:L21                0.29     0.1
matmul:k_proj:L14                0.29     0.1
matmul:k_proj:L24                0.29     0.1
matmul:k_proj:L7                 0.29     0.1
matmul:k_proj:L11                0.29     0.1
matmul:v_proj:L11                0.28     0.1
matmul:v_proj:L14                0.28     0.1
matmul:k_proj:L12                0.28     0.0
matmul:v_proj:L24                0.28     0.0
matmul:v_proj:L2                 0.28     0.0
matmul:k_proj:L16                0.23     0.0
matmul:k_proj:L25                0.23     0.0
matmul:k_proj:L23                0.23     0.0
matmul:k_proj:L8                 0.23     0.0
matmul:k_proj:L22                0.23     0.0
matmul:v_proj:L16                0.23     0.0
matmul:v_proj:L8                 0.23     0.0
matmul:v_proj:L3                 0.23     0.0
matmul:k_proj:L20                0.23     0.0
matmul:v_proj:L22                0.23     0.0
matmul:k_proj:L10                0.23     0.0
matmul:k_proj:L18                0.23     0.0
matmul:k_proj:L6                 0.23     0.0
matmul:v_proj:L13                0.23     0.0
matmul:k_proj:L13                0.22     0.0
matmul:k_proj:L1                 0.22     0.0
matmul:v_proj:L20                0.22     0.0
matmul:v_proj:L25                0.22     0.0
matmul:v_proj:L10                0.22     0.0
matmul:k_proj:L3                 0.22     0.0
matmul:v_proj:L18                0.22     0.0
matmul:k_proj:L5                 0.22     0.0
matmul:v_proj:L1                 0.22     0.0
matmul:v_proj:L5                 0.22     0.0
matmul:v_proj:L23                0.22     0.0
matmul:v_proj:L6                 0.22     0.0
sample_phase3                    0.06     0.0
gather                           0.04     0.0
scale                            0.03     0.0
──────────────────────────────────────────────────
TOTAL                          565.79   100.0

[browser:warning] [17917.6ms][Profile] Batch decode (N=4):
[browser:warning] [17917.7ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      197.92    35.0
matmul:lm_head                  95.64    16.9
rmsnorm                          3.90     0.7
matmul:ffn_down:L16              3.68     0.7
matmul:ffn_down:L8               3.59     0.6
matmul:ffn_down:L1               3.54     0.6
matmul:ffn_down:L23              3.53     0.6
matmul:ffn_down:L6               3.46     0.6
matmul:ffn_down:L21              3.46     0.6
sample_phase2                    3.43     0.6
matmul:ffn_down:L4               3.39     0.6
matmul:ffn_down:L14              3.39     0.6
matmul:ffn_down:L18              3.38     0.6
matmul:ffn_down:L11              3.36     0.6
matmul:ffn_down:L9               3.23     0.6
matmul:ffn_down:L13              3.23     0.6
matmul:ffn_down:L15              3.21     0.6
matmul:ffn_down:L22              3.21     0.6
matmul:ffn_down:L10              3.21     0.6
matmul:ffn_down:L19              3.20     0.6
matmul:ffn_down:L25              3.20     0.6
matmul:ffn_down:L2               3.20     0.6
matmul:ffn_down:L7               3.20     0.6
matmul:ffn_down:L12              3.20     0.6
matmul:ffn_down:L20              3.20     0.6
matmul:ffn_down:L17              3.20     0.6
matmul:ffn_down:L3               3.20     0.6
matmul:ffn_down:L5               3.20     0.6
matmul:ffn_down:L24              3.19     0.6
matmul:ffn_down:L0               3.19     0.6
matmul:ffn_up:L1                 2.73     0.5
matmul:ffn_gate:L23              2.71     0.5
matmul:ffn_gate:L1               2.69     0.5
matmul:ffn_up:L23                2.69     0.5
matmul:ffn_up:L16                2.68     0.5
matmul:ffn_gate:L11              2.67     0.5
matmul:ffn_up:L18                2.67     0.5
matmul:ffn_gate:L9               2.67     0.5
matmul:ffn_gate:L16              2.67     0.5
matmul:ffn_up:L9                 2.65     0.5
matmul:ffn_up:L14                2.64     0.5
matmul:ffn_gate:L14              2.64     0.5
matmul:ffn_gate:L21              2.64     0.5
matmul:ffn_up:L21                2.64     0.5
matmul:ffn_up:L11                2.64     0.5
matmul:ffn_gate:L4               2.64     0.5
matmul:ffn_up:L4                 2.63     0.5
matmul:ffn_gate:L5               2.63     0.5
matmul:ffn_up:L25                2.61     0.5
matmul:ffn_gate:L24              2.61     0.5
matmul:ffn_gate:L18              2.61     0.5
matmul:ffn_up:L8                 2.60     0.5
matmul:ffn_up:L19                2.60     0.5
matmul:ffn_gate:L22              2.60     0.5
matmul:ffn_gate:L12              2.60     0.5
matmul:ffn_gate:L20              2.60     0.5
matmul:ffn_up:L2                 2.60     0.5
matmul:ffn_gate:L7               2.60     0.5
matmul:ffn_up:L7                 2.60     0.5
matmul:ffn_up:L12                2.60     0.5
matmul:ffn_gate:L0               2.60     0.5
matmul:ffn_gate:L6               2.60     0.5
matmul:ffn_up:L6                 2.60     0.5
matmul:ffn_up:L22                2.60     0.5
matmul:ffn_gate:L2               2.60     0.5
matmul:ffn_gate:L25              2.60     0.5
matmul:ffn_up:L24                2.60     0.5
matmul:ffn_up:L5                 2.60     0.5
matmul:ffn_gate:L15              2.60     0.5
matmul:ffn_gate:L3               2.60     0.5
matmul:ffn_gate:L17              2.60     0.5
matmul:ffn_up:L20                2.60     0.5
matmul:ffn_up:L13                2.60     0.5
matmul:ffn_gate:L10              2.60     0.5
matmul:ffn_gate:L19              2.60     0.5
matmul:ffn_up:L15                2.60     0.5
matmul:ffn_gate:L8               2.60     0.5
matmul:ffn_up:L0                 2.60     0.5
matmul:ffn_up:L17                2.60     0.5
matmul:ffn_up:L3                 2.60     0.5
matmul:ffn_gate:L13              2.60     0.5
matmul:ffn_up:L10                2.60     0.5
rope                             0.98     0.2
cast_f32_to_f16                  0.81     0.1
matmul:q_proj:L0                 0.60     0.1
matmul:q_proj:L2                 0.57     0.1
matmul:q_proj:L17                0.56     0.1
matmul:q_proj:L24                0.56     0.1
matmul:o_proj:L16                0.56     0.1
matmul:q_proj:L9                 0.55     0.1
matmul:q_proj:L14                0.55     0.1
matmul:o_proj:L9                 0.54     0.1
matmul:q_proj:L5                 0.53     0.1
matmul:q_proj:L22                0.53     0.1
matmul:q_proj:L12                0.53     0.1
matmul:o_proj:L21                0.53     0.1
matmul:q_proj:L7                 0.53     0.1
matmul:q_proj:L19                0.52     0.1
matmul:o_proj:L4                 0.52     0.1
matmul:o_proj:L23                0.52     0.1
matmul:o_proj:L14                0.52     0.1
matmul:o_proj:L2                 0.51     0.1
matmul:q_proj:L15                0.50     0.1
matmul:q_proj:L16                0.49     0.1
matmul:o_proj:L11                0.49     0.1
matmul:q_proj:L21                0.49     0.1
matmul:q_proj:L23                0.49     0.1
matmul:o_proj:L12                0.49     0.1
matmul:q_proj:L20                0.49     0.1
matmul:q_proj:L3                 0.49     0.1
matmul:q_proj:L6                 0.49     0.1
matmul:o_proj:L19                0.49     0.1
matmul:q_proj:L1                 0.49     0.1
matmul:q_proj:L13                0.49     0.1
matmul:q_proj:L10                0.49     0.1
matmul:q_proj:L11                0.49     0.1
matmul:o_proj:L22                0.49     0.1
matmul:q_proj:L4                 0.49     0.1
matmul:o_proj:L25                0.49     0.1
matmul:o_proj:L17                0.49     0.1
matmul:o_proj:L7                 0.49     0.1
matmul:q_proj:L18                0.49     0.1
matmul:o_proj:L6                 0.48     0.1
matmul:q_proj:L25                0.48     0.1
matmul:o_proj:L20                0.48     0.1
matmul:q_proj:L8                 0.48     0.1
matmul:o_proj:L13                0.48     0.1
matmul:o_proj:L24                0.48     0.1
matmul:o_proj:L0                 0.48     0.1
matmul:o_proj:L18                0.48     0.1
matmul:o_proj:L5                 0.48     0.1
matmul:o_proj:L15                0.48     0.1
matmul:o_proj:L1                 0.48     0.1
matmul:o_proj:L3                 0.48     0.1
matmul:o_proj:L8                 0.48     0.1
matmul:o_proj:L10                0.48     0.1
gelu                             0.47     0.1
matmul:k_proj:L0                 0.42     0.1
matmul:v_proj:L0                 0.42     0.1
matmul:k_proj:L17                0.36     0.1
matmul:v_proj:L17                0.36     0.1
matmul:k_proj:L24                0.36     0.1
matmul:v_proj:L24                0.34     0.1
matmul:k_proj:L2                 0.34     0.1
matmul:k_proj:L9                 0.34     0.1
matmul:v_proj:L2                 0.34     0.1
matmul:v_proj:L9                 0.33     0.1
matmul:k_proj:L22                0.30     0.1
matmul:k_proj:L14                0.30     0.1
matmul:v_proj:L5                 0.29     0.1
matmul:k_proj:L7                 0.29     0.1
matmul:v_proj:L12                0.29     0.1
matmul:k_proj:L12                0.29     0.1
matmul:k_proj:L19                0.29     0.1
matmul:v_proj:L7                 0.28     0.1
matmul:k_proj:L5                 0.28     0.1
matmul:v_proj:L19                0.28     0.0
matmul:v_proj:L22                0.26     0.0
matmul:v_proj:L14                0.24     0.0
matmul:v_proj:L16                0.23     0.0
matmul:k_proj:L11                0.23     0.0
matmul:k_proj:L16                0.23     0.0
matmul:k_proj:L15                0.23     0.0
matmul:k_proj:L21                0.23     0.0
matmul:k_proj:L13                0.23     0.0
matmul:k_proj:L25                0.23     0.0
matmul:v_proj:L15                0.23     0.0
matmul:k_proj:L23                0.23     0.0
matmul:k_proj:L1                 0.23     0.0
matmul:k_proj:L6                 0.23     0.0
matmul:v_proj:L4                 0.23     0.0
matmul:v_proj:L18                0.23     0.0
matmul:v_proj:L1                 0.23     0.0
matmul:v_proj:L8                 0.23     0.0
matmul:k_proj:L8                 0.22     0.0
matmul:k_proj:L10                0.22     0.0
matmul:k_proj:L18                0.22     0.0
matmul:v_proj:L21                0.22     0.0
matmul:v_proj:L11                0.22     0.0
matmul:k_proj:L20                0.22     0.0
matmul:k_proj:L4                 0.22     0.0
matmul:k_proj:L3                 0.22     0.0
matmul:v_proj:L13                0.22     0.0
matmul:v_proj:L23                0.22     0.0
matmul:v_proj:L20                0.22     0.0
matmul:v_proj:L3                 0.22     0.0
matmul:v_proj:L10                0.22     0.0
matmul:v_proj:L25                0.22     0.0
matmul:v_proj:L6                 0.22     0.0
sample_phase1                    0.14     0.0
sample_phase3                    0.08     0.0
gather                           0.05     0.0
scale                            0.04     0.0
──────────────────────────────────────────────────
TOTAL                          565.89   100.0

[browser:warning] [18535.6ms][Profile] Batch decode (N=4):
[browser:warning] [18535.8ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      204.33    35.6
matmul:lm_head                  98.31    17.1
rmsnorm                          3.78     0.7
matmul:ffn_down:L21              3.50     0.6
matmul:ffn_down:L8               3.49     0.6
matmul:ffn_down:L11              3.47     0.6
sample_phase2                    3.46     0.6
matmul:ffn_down:L6               3.45     0.6
matmul:ffn_down:L13              3.42     0.6
matmul:ffn_down:L0               3.40     0.6
matmul:ffn_down:L12              3.40     0.6
matmul:ffn_down:L18              3.38     0.6
matmul:ffn_down:L25              3.38     0.6
matmul:ffn_down:L5               3.37     0.6
matmul:ffn_down:L4               3.36     0.6
matmul:ffn_down:L15              3.36     0.6
matmul:ffn_down:L22              3.36     0.6
matmul:ffn_down:L20              3.34     0.6
matmul:ffn_down:L24              3.22     0.6
matmul:ffn_down:L19              3.22     0.6
matmul:ffn_down:L16              3.21     0.6
matmul:ffn_down:L14              3.21     0.6
matmul:ffn_down:L3               3.21     0.6
matmul:ffn_down:L7               3.20     0.6
matmul:ffn_down:L2               3.20     0.6
matmul:ffn_down:L10              3.20     0.6
matmul:ffn_down:L9               3.20     0.6
matmul:ffn_down:L23              3.20     0.6
matmul:ffn_down:L1               3.20     0.6
matmul:ffn_down:L17              3.20     0.6
matmul:ffn_up:L5                 2.95     0.5
matmul:ffn_gate:L5               2.68     0.5
matmul:ffn_up:L12                2.67     0.5
matmul:ffn_up:L13                2.67     0.5
matmul:ffn_gate:L15              2.66     0.5
matmul:ffn_up:L25                2.66     0.5
matmul:ffn_gate:L22              2.66     0.5
matmul:ffn_gate:L18              2.66     0.5
matmul:ffn_up:L22                2.65     0.5
matmul:ffn_up:L11                2.65     0.5
matmul:ffn_up:L18                2.65     0.5
matmul:ffn_up:L4                 2.64     0.5
matmul:ffn_up:L20                2.64     0.5
matmul:ffn_gate:L11              2.64     0.5
matmul:ffn_gate:L20              2.63     0.5
matmul:ffn_gate:L21              2.63     0.5
matmul:ffn_up:L0                 2.63     0.5
matmul:ffn_gate:L4               2.63     0.5
matmul:ffn_up:L21                2.63     0.5
matmul:ffn_up:L8                 2.63     0.5
matmul:ffn_gate:L8               2.63     0.5
matmul:ffn_up:L15                2.63     0.5
matmul:ffn_gate:L10              2.63     0.5
matmul:ffn_gate:L24              2.61     0.5
matmul:ffn_up:L6                 2.61     0.5
matmul:ffn_gate:L9               2.61     0.5
matmul:ffn_gate:L1               2.61     0.5
matmul:ffn_up:L23                2.61     0.5
matmul:ffn_gate:L3               2.60     0.5
matmul:ffn_up:L1                 2.60     0.5
matmul:ffn_gate:L17              2.60     0.5
matmul:ffn_gate:L25              2.60     0.5
matmul:ffn_gate:L0               2.60     0.5
matmul:ffn_up:L19                2.60     0.5
matmul:ffn_up:L2                 2.60     0.5
matmul:ffn_gate:L19              2.60     0.5
matmul:ffn_gate:L12              2.60     0.5
matmul:ffn_gate:L7               2.60     0.5
matmul:ffn_gate:L16              2.60     0.5
matmul:ffn_up:L9                 2.60     0.5
matmul:ffn_gate:L2               2.60     0.5
matmul:ffn_up:L7                 2.60     0.5
matmul:ffn_up:L16                2.60     0.5
matmul:ffn_up:L10                2.60     0.5
matmul:ffn_up:L24                2.60     0.5
matmul:ffn_gate:L6               2.60     0.5
matmul:ffn_up:L14                2.60     0.5
matmul:ffn_up:L17                2.60     0.5
matmul:ffn_gate:L13              2.60     0.5
matmul:ffn_gate:L23              2.60     0.5
matmul:ffn_up:L3                 2.60     0.5
matmul:ffn_gate:L14              2.60     0.5
rope                             0.98     0.2
cast_f32_to_f16                  0.84     0.1
matmul:q_proj:L0                 0.60     0.1
matmul:q_proj:L13                0.53     0.1
matmul:q_proj:L23                0.53     0.1
matmul:q_proj:L6                 0.53     0.1
matmul:q_proj:L1                 0.53     0.1
matmul:q_proj:L7                 0.53     0.1
matmul:q_proj:L16                0.52     0.1
matmul:o_proj:L15                0.52     0.1
matmul:q_proj:L9                 0.52     0.1
matmul:q_proj:L22                0.52     0.1
matmul:o_proj:L8                 0.52     0.1
matmul:q_proj:L14                0.52     0.1
matmul:q_proj:L19                0.52     0.1
matmul:o_proj:L21                0.52     0.1
matmul:q_proj:L5                 0.52     0.1
matmul:q_proj:L20                0.52     0.1
matmul:o_proj:L4                 0.52     0.1
matmul:o_proj:L11                0.52     0.1
matmul:o_proj:L20                0.51     0.1
matmul:o_proj:L22                0.49     0.1
matmul:o_proj:L1                 0.49     0.1
matmul:q_proj:L21                0.49     0.1
matmul:q_proj:L12                0.49     0.1
matmul:q_proj:L18                0.49     0.1
matmul:o_proj:L23                0.49     0.1
matmul:q_proj:L17                0.49     0.1
matmul:q_proj:L24                0.49     0.1
matmul:q_proj:L11                0.49     0.1
matmul:o_proj:L6                 0.49     0.1
matmul:q_proj:L10                0.49     0.1
matmul:q_proj:L25                0.49     0.1
matmul:q_proj:L4                 0.49     0.1
matmul:o_proj:L14                0.49     0.1
matmul:o_proj:L2                 0.49     0.1
matmul:o_proj:L12                0.49     0.1
matmul:q_proj:L8                 0.49     0.1
matmul:o_proj:L7                 0.49     0.1
matmul:o_proj:L16                0.49     0.1
matmul:q_proj:L3                 0.48     0.1
matmul:q_proj:L15                0.48     0.1
matmul:o_proj:L0                 0.48     0.1
matmul:o_proj:L3                 0.48     0.1
matmul:o_proj:L13                0.48     0.1
matmul:o_proj:L5                 0.48     0.1
matmul:q_proj:L2                 0.48     0.1
matmul:o_proj:L18                0.48     0.1
matmul:o_proj:L10                0.48     0.1
gelu                             0.48     0.1
matmul:o_proj:L24                0.48     0.1
matmul:o_proj:L25                0.48     0.1
matmul:o_proj:L19                0.48     0.1
matmul:o_proj:L17                0.48     0.1
matmul:o_proj:L9                 0.48     0.1
matmul:k_proj:L0                 0.36     0.1
matmul:v_proj:L0                 0.36     0.1
matmul:k_proj:L22                0.30     0.1
matmul:k_proj:L16                0.29     0.1
matmul:v_proj:L22                0.29     0.1
matmul:k_proj:L9                 0.29     0.1
matmul:v_proj:L5                 0.29     0.1
matmul:v_proj:L7                 0.29     0.1
matmul:v_proj:L9                 0.29     0.1
matmul:k_proj:L6                 0.29     0.1
matmul:k_proj:L14                0.29     0.1
matmul:k_proj:L13                0.29     0.1
matmul:k_proj:L19                0.29     0.0
matmul:v_proj:L1                 0.29     0.0
matmul:k_proj:L23                0.29     0.0
matmul:v_proj:L14                0.29     0.0
matmul:k_proj:L7                 0.29     0.0
matmul:v_proj:L23                0.28     0.0
matmul:v_proj:L13                0.28     0.0
matmul:k_proj:L5                 0.28     0.0
matmul:v_proj:L16                0.28     0.0
matmul:k_proj:L1                 0.28     0.0
matmul:v_proj:L6                 0.28     0.0
matmul:v_proj:L19                0.28     0.0
matmul:v_proj:L20                0.27     0.0
matmul:v_proj:L12                0.23     0.0
matmul:k_proj:L8                 0.23     0.0
matmul:k_proj:L12                0.23     0.0
matmul:k_proj:L20                0.23     0.0
matmul:k_proj:L11                0.23     0.0
matmul:v_proj:L11                0.23     0.0
matmul:k_proj:L21                0.23     0.0
matmul:k_proj:L10                0.23     0.0
matmul:k_proj:L15                0.23     0.0
matmul:k_proj:L4                 0.23     0.0
matmul:k_proj:L24                0.23     0.0
matmul:v_proj:L25                0.23     0.0
matmul:k_proj:L17                0.23     0.0
matmul:k_proj:L25                0.23     0.0
matmul:v_proj:L4                 0.23     0.0
matmul:k_proj:L18                0.23     0.0
matmul:k_proj:L3                 0.22     0.0
matmul:v_proj:L17                0.22     0.0
matmul:v_proj:L10                0.22     0.0
matmul:k_proj:L2                 0.22     0.0
matmul:v_proj:L24                0.22     0.0
matmul:v_proj:L3                 0.22     0.0
matmul:v_proj:L8                 0.22     0.0
matmul:v_proj:L18                0.22     0.0
matmul:v_proj:L2                 0.22     0.0
matmul:v_proj:L21                0.22     0.0
matmul:v_proj:L15                0.22     0.0
sample_phase1                    0.13     0.0
sample_phase3                    0.07     0.0
gather                           0.05     0.0
scale                            0.04     0.0
──────────────────────────────────────────────────
TOTAL                          574.69   100.0

[browser:warning] [19165.9ms][Profile] Batch decode (N=4):
[browser:warning] [19166.2ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      210.76    36.4
matmul:lm_head                  94.94    16.4
rmsnorm                          3.85     0.7
matmul:ffn_down:L1               3.72     0.6
matmul:ffn_down:L8               3.60     0.6
matmul:ffn_down:L10              3.46     0.6
matmul:ffn_down:L12              3.45     0.6
matmul:ffn_down:L3               3.45     0.6
matmul:ffn_down:L25              3.43     0.6
matmul:ffn_down:L22              3.41     0.6
matmul:ffn_down:L14              3.39     0.6
matmul:ffn_down:L15              3.38     0.6
matmul:ffn_down:L24              3.38     0.6
sample_phase2                    3.38     0.6
matmul:ffn_down:L4               3.37     0.6
matmul:ffn_down:L17              3.37     0.6
matmul:ffn_down:L21              3.37     0.6
matmul:ffn_down:L16              3.35     0.6
matmul:ffn_down:L19              3.30     0.6
matmul:ffn_down:L18              3.24     0.6
matmul:ffn_down:L0               3.23     0.6
matmul:ffn_down:L20              3.21     0.6
matmul:ffn_down:L6               3.21     0.6
matmul:ffn_down:L13              3.21     0.6
matmul:ffn_down:L11              3.21     0.6
matmul:ffn_down:L7               3.21     0.6
matmul:ffn_down:L9               3.20     0.6
matmul:ffn_down:L5               3.20     0.6
matmul:ffn_down:L2               3.20     0.6
matmul:ffn_down:L23              3.20     0.6
matmul:ffn_up:L1                 2.70     0.5
matmul:ffn_up:L8                 2.69     0.5
matmul:ffn_gate:L24              2.67     0.5
matmul:ffn_up:L22                2.67     0.5
matmul:ffn_up:L15                2.66     0.5
matmul:ffn_gate:L4               2.65     0.5
matmul:ffn_up:L24                2.65     0.5
matmul:ffn_up:L11                2.65     0.5
matmul:ffn_gate:L17              2.65     0.5
matmul:ffn_up:L4                 2.64     0.5
matmul:ffn_gate:L1               2.64     0.5
matmul:ffn_up:L3                 2.64     0.5
matmul:ffn_gate:L8               2.64     0.5
matmul:ffn_gate:L14              2.64     0.5
matmul:ffn_gate:L3               2.64     0.5
matmul:ffn_gate:L10              2.64     0.5
matmul:ffn_up:L17                2.64     0.5
matmul:ffn_up:L19                2.64     0.5
matmul:ffn_up:L12                2.64     0.5
matmul:ffn_gate:L19              2.64     0.5
matmul:ffn_gate:L21              2.64     0.5
matmul:ffn_up:L10                2.64     0.5
matmul:ffn_gate:L12              2.64     0.5
matmul:ffn_up:L14                2.63     0.5
matmul:ffn_up:L21                2.63     0.5
matmul:ffn_up:L0                 2.63     0.5
matmul:ffn_up:L13                2.62     0.5
matmul:ffn_gate:L2               2.61     0.5
matmul:ffn_gate:L0               2.61     0.5
matmul:ffn_gate:L11              2.61     0.5
matmul:ffn_gate:L6               2.61     0.5
matmul:ffn_up:L2                 2.61     0.5
matmul:ffn_gate:L22              2.60     0.5
matmul:ffn_gate:L20              2.60     0.5
matmul:ffn_up:L25                2.60     0.5
matmul:ffn_gate:L15              2.60     0.5
matmul:ffn_gate:L5               2.60     0.4
matmul:ffn_up:L23                2.60     0.4
matmul:ffn_gate:L16              2.60     0.4
matmul:ffn_up:L18                2.60     0.4
matmul:ffn_up:L6                 2.60     0.4
matmul:ffn_gate:L7               2.60     0.4
matmul:ffn_gate:L18              2.60     0.4
matmul:ffn_up:L16                2.60     0.4
matmul:ffn_up:L9                 2.60     0.4
matmul:ffn_gate:L9               2.60     0.4
matmul:ffn_up:L7                 2.60     0.4
matmul:ffn_gate:L13              2.60     0.4
matmul:ffn_up:L5                 2.60     0.4
matmul:ffn_up:L20                2.60     0.4
matmul:ffn_gate:L23              2.60     0.4
matmul:ffn_gate:L25              2.60     0.4
rope                             0.92     0.2
cast_f32_to_f16                  0.80     0.1
matmul:q_proj:L0                 0.57     0.1
matmul:q_proj:L9                 0.56     0.1
matmul:q_proj:L2                 0.54     0.1
matmul:q_proj:L17                0.53     0.1
matmul:q_proj:L23                0.53     0.1
matmul:q_proj:L15                0.53     0.1
matmul:q_proj:L25                0.53     0.1
matmul:q_proj:L16                0.53     0.1
matmul:q_proj:L11                0.53     0.1
matmul:o_proj:L14                0.52     0.1
matmul:q_proj:L22                0.52     0.1
matmul:q_proj:L5                 0.52     0.1
matmul:o_proj:L12                0.52     0.1
matmul:o_proj:L17                0.52     0.1
matmul:o_proj:L3                 0.52     0.1
matmul:q_proj:L4                 0.52     0.1
matmul:o_proj:L10                0.51     0.1
matmul:o_proj:L8                 0.51     0.1
matmul:o_proj:L19                0.51     0.1
matmul:o_proj:L1                 0.51     0.1
matmul:o_proj:L21                0.51     0.1
gelu                             0.51     0.1
matmul:q_proj:L13                0.49     0.1
matmul:q_proj:L1                 0.49     0.1
matmul:q_proj:L14                0.49     0.1
matmul:q_proj:L12                0.49     0.1
matmul:q_proj:L6                 0.49     0.1
matmul:q_proj:L3                 0.49     0.1
matmul:q_proj:L7                 0.49     0.1
matmul:o_proj:L23                0.49     0.1
matmul:q_proj:L21                0.49     0.1
matmul:q_proj:L10                0.49     0.1
matmul:q_proj:L18                0.49     0.1
matmul:q_proj:L20                0.49     0.1
matmul:q_proj:L8                 0.49     0.1
matmul:q_proj:L19                0.49     0.1
matmul:o_proj:L24                0.49     0.1
matmul:o_proj:L4                 0.49     0.1
matmul:q_proj:L24                0.49     0.1
matmul:o_proj:L18                0.49     0.1
matmul:o_proj:L22                0.49     0.1
matmul:o_proj:L7                 0.49     0.1
matmul:o_proj:L0                 0.49     0.1
matmul:o_proj:L16                0.49     0.1
matmul:o_proj:L15                0.48     0.1
matmul:o_proj:L2                 0.48     0.1
matmul:o_proj:L20                0.48     0.1
matmul:o_proj:L11                0.48     0.1
matmul:o_proj:L9                 0.48     0.1
matmul:o_proj:L5                 0.48     0.1
matmul:o_proj:L6                 0.48     0.1
matmul:o_proj:L25                0.48     0.1
matmul:o_proj:L13                0.48     0.1
matmul:v_proj:L0                 0.37     0.1
matmul:k_proj:L0                 0.37     0.1
matmul:k_proj:L9                 0.35     0.1
matmul:v_proj:L9                 0.35     0.1
matmul:v_proj:L19                0.30     0.1
matmul:k_proj:L25                0.30     0.1
matmul:k_proj:L17                0.29     0.1
matmul:v_proj:L23                0.29     0.1
matmul:k_proj:L15                0.29     0.1
matmul:k_proj:L16                0.29     0.1
matmul:v_proj:L2                 0.29     0.1
matmul:v_proj:L17                0.29     0.1
matmul:k_proj:L23                0.29     0.1
matmul:v_proj:L25                0.29     0.1
matmul:k_proj:L2                 0.29     0.0
matmul:k_proj:L5                 0.29     0.0
matmul:v_proj:L15                0.29     0.0
matmul:k_proj:L22                0.29     0.0
matmul:v_proj:L16                0.28     0.0
matmul:v_proj:L22                0.28     0.0
matmul:v_proj:L5                 0.28     0.0
matmul:k_proj:L19                0.27     0.0
matmul:k_proj:L11                0.24     0.0
matmul:k_proj:L3                 0.24     0.0
matmul:k_proj:L4                 0.24     0.0
matmul:k_proj:L1                 0.23     0.0
matmul:k_proj:L6                 0.23     0.0
matmul:k_proj:L10                0.23     0.0
matmul:v_proj:L1                 0.23     0.0
matmul:v_proj:L10                0.23     0.0
matmul:v_proj:L3                 0.23     0.0
matmul:k_proj:L14                0.23     0.0
matmul:k_proj:L21                0.23     0.0
matmul:k_proj:L12                0.23     0.0
matmul:v_proj:L7                 0.23     0.0
matmul:k_proj:L8                 0.23     0.0
matmul:k_proj:L7                 0.23     0.0
matmul:k_proj:L18                0.23     0.0
matmul:v_proj:L6                 0.23     0.0
matmul:v_proj:L12                0.23     0.0
matmul:v_proj:L14                0.23     0.0
matmul:k_proj:L20                0.23     0.0
matmul:v_proj:L13                0.23     0.0
matmul:v_proj:L21                0.23     0.0
matmul:v_proj:L18                0.22     0.0
matmul:k_proj:L13                0.22     0.0
matmul:k_proj:L24                0.22     0.0
matmul:v_proj:L11                0.22     0.0
matmul:v_proj:L20                0.22     0.0
matmul:v_proj:L8                 0.22     0.0
matmul:v_proj:L24                0.22     0.0
matmul:v_proj:L4                 0.22     0.0
sample_phase1                    0.11     0.0
sample_phase3                    0.07     0.0
gather                           0.04     0.0
scale                            0.03     0.0
──────────────────────────────────────────────────
TOTAL                          578.26   100.0

[browser:warning] [19811.9ms][Profile] Batch decode (N=4):
[browser:warning] [19812.2ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      219.24    37.4
matmul:lm_head                  94.85    16.2
rmsnorm                          3.99     0.7
matmul:ffn_down:L0               3.62     0.6
matmul:ffn_down:L7               3.59     0.6
matmul:ffn_down:L10              3.57     0.6
matmul:ffn_down:L24              3.55     0.6
matmul:ffn_down:L17              3.54     0.6
matmul:ffn_down:L3               3.54     0.6
matmul:ffn_down:L14              3.50     0.6
matmul:ffn_down:L20              3.44     0.6
matmul:ffn_down:L21              3.44     0.6
sample_phase2                    3.34     0.6
matmul:ffn_down:L13              3.33     0.6
matmul:ffn_down:L16              3.21     0.5
matmul:ffn_down:L6               3.21     0.5
matmul:ffn_down:L12              3.21     0.5
matmul:ffn_down:L19              3.21     0.5
matmul:ffn_down:L18              3.21     0.5
matmul:ffn_down:L2               3.20     0.5
matmul:ffn_down:L9               3.20     0.5
matmul:ffn_down:L5               3.20     0.5
matmul:ffn_down:L4               3.20     0.5
matmul:ffn_down:L11              3.20     0.5
matmul:ffn_down:L22              3.20     0.5
matmul:ffn_down:L15              3.20     0.5
matmul:ffn_down:L1               3.20     0.5
matmul:ffn_down:L25              3.19     0.5
matmul:ffn_down:L8               3.19     0.5
matmul:ffn_down:L23              3.19     0.5
matmul:ffn_up:L10                2.76     0.5
matmul:ffn_gate:L17              2.71     0.5
matmul:ffn_up:L3                 2.69     0.5
matmul:ffn_up:L7                 2.69     0.5
matmul:ffn_up:L0                 2.69     0.5
matmul:ffn_gate:L24              2.68     0.5
matmul:ffn_gate:L0               2.68     0.5
matmul:ffn_up:L17                2.68     0.5
matmul:ffn_gate:L14              2.68     0.5
matmul:ffn_up:L14                2.67     0.5
matmul:ffn_gate:L7               2.67     0.5
matmul:ffn_up:L24                2.66     0.5
matmul:ffn_gate:L10              2.66     0.5
matmul:ffn_up:L21                2.64     0.5
matmul:ffn_gate:L3               2.64     0.4
matmul:ffn_gate:L21              2.64     0.4
matmul:ffn_up:L20                2.61     0.4
matmul:ffn_gate:L16              2.61     0.4
matmul:ffn_up:L19                2.61     0.4
matmul:ffn_up:L12                2.61     0.4
matmul:ffn_gate:L9               2.61     0.4
matmul:ffn_up:L6                 2.61     0.4
matmul:ffn_gate:L23              2.61     0.4
matmul:ffn_up:L2                 2.60     0.4
matmul:ffn_gate:L11              2.60     0.4
matmul:ffn_up:L25                2.60     0.4
matmul:ffn_up:L13                2.60     0.4
matmul:ffn_gate:L18              2.60     0.4
matmul:ffn_gate:L15              2.60     0.4
matmul:ffn_up:L4                 2.60     0.4
matmul:ffn_up:L15                2.60     0.4
matmul:ffn_gate:L2               2.60     0.4
matmul:ffn_up:L9                 2.60     0.4
matmul:ffn_up:L18                2.60     0.4
matmul:ffn_up:L11                2.60     0.4
matmul:ffn_gate:L12              2.60     0.4
matmul:ffn_gate:L5               2.60     0.4
matmul:ffn_gate:L20              2.60     0.4
matmul:ffn_gate:L19              2.60     0.4
matmul:ffn_up:L8                 2.60     0.4
matmul:ffn_gate:L6               2.60     0.4
matmul:ffn_gate:L8               2.60     0.4
matmul:ffn_gate:L25              2.60     0.4
matmul:ffn_up:L1                 2.60     0.4
matmul:ffn_up:L23                2.60     0.4
matmul:ffn_gate:L4               2.60     0.4
matmul:ffn_gate:L13              2.60     0.4
matmul:ffn_up:L5                 2.60     0.4
matmul:ffn_up:L16                2.60     0.4
matmul:ffn_gate:L22              2.60     0.4
matmul:ffn_gate:L1               2.59     0.4
matmul:ffn_up:L22                2.59     0.4
rope                             0.91     0.2
cast_f32_to_f16                  0.79     0.1
matmul:q_proj:L1                 0.58     0.1
matmul:q_proj:L0                 0.58     0.1
matmul:o_proj:L24                0.58     0.1
matmul:q_proj:L18                0.56     0.1
matmul:o_proj:L3                 0.56     0.1
matmul:q_proj:L4                 0.56     0.1
matmul:q_proj:L11                0.56     0.1
matmul:o_proj:L7                 0.56     0.1
matmul:q_proj:L25                0.56     0.1
matmul:o_proj:L14                0.55     0.1
matmul:q_proj:L8                 0.55     0.1
matmul:o_proj:L0                 0.55     0.1
matmul:q_proj:L21                0.53     0.1
matmul:o_proj:L21                0.52     0.1
matmul:o_proj:L17                0.52     0.1
gelu                             0.52     0.1
matmul:q_proj:L15                0.52     0.1
matmul:q_proj:L10                0.49     0.1
matmul:q_proj:L22                0.49     0.1
matmul:q_proj:L13                0.49     0.1
matmul:o_proj:L8                 0.49     0.1
matmul:q_proj:L7                 0.49     0.1
matmul:q_proj:L20                0.49     0.1
matmul:q_proj:L14                0.49     0.1
matmul:q_proj:L17                0.49     0.1
matmul:q_proj:L6                 0.49     0.1
matmul:o_proj:L6                 0.49     0.1
matmul:q_proj:L23                0.49     0.1
matmul:q_proj:L24                0.49     0.1
matmul:o_proj:L19                0.49     0.1
matmul:q_proj:L12                0.49     0.1
matmul:q_proj:L16                0.49     0.1
matmul:o_proj:L4                 0.49     0.1
matmul:o_proj:L20                0.49     0.1
matmul:q_proj:L19                0.49     0.1
matmul:o_proj:L18                0.49     0.1
matmul:o_proj:L15                0.49     0.1
matmul:q_proj:L3                 0.49     0.1
matmul:o_proj:L22                0.49     0.1
matmul:q_proj:L5                 0.49     0.1
matmul:o_proj:L1                 0.49     0.1
matmul:o_proj:L11                0.48     0.1
matmul:o_proj:L13                0.48     0.1
matmul:o_proj:L23                0.48     0.1
matmul:q_proj:L9                 0.48     0.1
matmul:o_proj:L25                0.48     0.1
matmul:q_proj:L2                 0.48     0.1
matmul:o_proj:L9                 0.48     0.1
matmul:o_proj:L16                0.48     0.1
matmul:o_proj:L5                 0.48     0.1
matmul:o_proj:L12                0.48     0.1
matmul:o_proj:L10                0.48     0.1
matmul:o_proj:L2                 0.48     0.1
matmul:v_proj:L0                 0.37     0.1
matmul:k_proj:L0                 0.36     0.1
matmul:k_proj:L18                0.35     0.1
matmul:k_proj:L25                0.35     0.1
matmul:v_proj:L11                0.35     0.1
matmul:k_proj:L11                0.35     0.1
matmul:k_proj:L4                 0.34     0.1
matmul:v_proj:L4                 0.34     0.1
matmul:v_proj:L18                0.34     0.1
matmul:v_proj:L25                0.34     0.1
matmul:k_proj:L1                 0.30     0.1
matmul:k_proj:L8                 0.30     0.1
matmul:v_proj:L21                0.30     0.1
matmul:k_proj:L21                0.30     0.1
matmul:v_proj:L1                 0.29     0.0
matmul:v_proj:L8                 0.29     0.0
matmul:k_proj:L15                0.24     0.0
matmul:k_proj:L6                 0.23     0.0
matmul:k_proj:L13                0.23     0.0
matmul:v_proj:L7                 0.23     0.0
matmul:k_proj:L14                0.23     0.0
matmul:k_proj:L7                 0.23     0.0
matmul:k_proj:L5                 0.23     0.0
matmul:k_proj:L17                0.23     0.0
matmul:v_proj:L14                0.23     0.0
matmul:k_proj:L22                0.23     0.0
matmul:v_proj:L22                0.23     0.0
matmul:k_proj:L20                0.23     0.0
matmul:k_proj:L23                0.23     0.0
matmul:k_proj:L10                0.23     0.0
matmul:k_proj:L24                0.23     0.0
matmul:v_proj:L3                 0.23     0.0
matmul:k_proj:L19                0.23     0.0
matmul:v_proj:L10                0.23     0.0
matmul:v_proj:L20                0.22     0.0
matmul:v_proj:L2                 0.22     0.0
matmul:k_proj:L16                0.22     0.0
matmul:k_proj:L3                 0.22     0.0
matmul:k_proj:L12                0.22     0.0
matmul:v_proj:L13                0.22     0.0
matmul:k_proj:L9                 0.22     0.0
matmul:v_proj:L17                0.22     0.0
matmul:v_proj:L23                0.22     0.0
matmul:v_proj:L9                 0.22     0.0
matmul:v_proj:L24                0.22     0.0
matmul:k_proj:L2                 0.22     0.0
matmul:v_proj:L6                 0.22     0.0
matmul:v_proj:L16                0.22     0.0
matmul:v_proj:L5                 0.22     0.0
matmul:v_proj:L19                0.22     0.0
matmul:v_proj:L15                0.22     0.0
matmul:v_proj:L12                0.22     0.0
sample_phase1                    0.10     0.0
sample_phase3                    0.07     0.0
gather                           0.04     0.0
scale                            0.03     0.0
──────────────────────────────────────────────────
TOTAL                          586.40   100.0

[browser:warning] [20450.4ms][Profile] Batch decode (N=4):
[browser:warning] [20450.5ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      225.53    37.8
matmul:lm_head                  94.84    15.9
rmsnorm                          4.52     0.8
matmul:ffn_down:L4               3.85     0.6
matmul:ffn_down:L7               3.75     0.6
matmul:ffn_down:L14              3.62     0.6
matmul:ffn_down:L0               3.61     0.6
matmul:ffn_down:L13              3.58     0.6
sample_phase2                    3.48     0.6
matmul:ffn_down:L3               3.47     0.6
matmul:ffn_down:L16              3.47     0.6
matmul:ffn_down:L24              3.44     0.6
matmul:ffn_down:L11              3.44     0.6
matmul:ffn_down:L17              3.41     0.6
matmul:ffn_down:L20              3.39     0.6
matmul:ffn_down:L21              3.36     0.6
matmul:ffn_down:L23              3.36     0.6
matmul:ffn_down:L9               3.34     0.6
matmul:ffn_down:L10              3.23     0.5
matmul:ffn_down:L6               3.21     0.5
matmul:ffn_down:L18              3.21     0.5
matmul:ffn_down:L19              3.20     0.5
matmul:ffn_down:L1               3.20     0.5
matmul:ffn_down:L12              3.20     0.5
matmul:ffn_down:L22              3.20     0.5
matmul:ffn_down:L2               3.20     0.5
matmul:ffn_down:L8               3.20     0.5
matmul:ffn_down:L25              3.20     0.5
matmul:ffn_down:L15              3.19     0.5
matmul:ffn_down:L5               3.19     0.5
matmul:ffn_up:L12                3.10     0.5
matmul:ffn_gate:L17              2.69     0.5
matmul:ffn_gate:L14              2.68     0.4
matmul:ffn_up:L4                 2.67     0.4
matmul:ffn_gate:L0               2.67     0.4
matmul:ffn_up:L20                2.66     0.4
matmul:ffn_gate:L23              2.66     0.4
matmul:ffn_gate:L7               2.66     0.4
matmul:ffn_up:L13                2.65     0.4
matmul:ffn_up:L23                2.65     0.4
matmul:ffn_gate:L21              2.65     0.4
matmul:ffn_up:L0                 2.65     0.4
matmul:ffn_up:L14                2.65     0.4
matmul:ffn_up:L7                 2.64     0.4
matmul:ffn_gate:L11              2.64     0.4
matmul:ffn_gate:L12              2.64     0.4
matmul:ffn_gate:L13              2.64     0.4
matmul:ffn_up:L11                2.64     0.4
matmul:ffn_up:L3                 2.63     0.4
matmul:ffn_gate:L4               2.63     0.4
matmul:ffn_gate:L3               2.63     0.4
matmul:ffn_up:L21                2.63     0.4
matmul:ffn_up:L19                2.61     0.4
matmul:ffn_up:L5                 2.61     0.4
matmul:ffn_gate:L9               2.60     0.4
matmul:ffn_gate:L2               2.60     0.4
matmul:ffn_gate:L15              2.60     0.4
matmul:ffn_up:L15                2.60     0.4
matmul:ffn_gate:L16              2.60     0.4
matmul:ffn_gate:L24              2.60     0.4
matmul:ffn_up:L16                2.60     0.4
matmul:ffn_gate:L18              2.60     0.4
matmul:ffn_gate:L5               2.60     0.4
matmul:ffn_up:L6                 2.60     0.4
matmul:ffn_gate:L25              2.60     0.4
matmul:ffn_gate:L10              2.60     0.4
matmul:ffn_gate:L1               2.60     0.4
matmul:ffn_up:L8                 2.60     0.4
matmul:ffn_up:L1                 2.60     0.4
matmul:ffn_up:L25                2.60     0.4
matmul:ffn_gate:L20              2.60     0.4
matmul:ffn_up:L2                 2.60     0.4
matmul:ffn_up:L17                2.60     0.4
matmul:ffn_up:L24                2.60     0.4
matmul:ffn_gate:L8               2.60     0.4
matmul:ffn_gate:L22              2.60     0.4
matmul:ffn_up:L9                 2.60     0.4
matmul:ffn_gate:L19              2.60     0.4
matmul:ffn_gate:L6               2.60     0.4
matmul:ffn_up:L10                2.60     0.4
matmul:ffn_up:L18                2.60     0.4
matmul:ffn_up:L22                2.59     0.4
rope                             0.99     0.2
cast_f32_to_f16                  0.84     0.1
matmul:o_proj:L17                0.76     0.1
matmul:k_proj:L11                0.74     0.1
matmul:q_proj:L8                 0.66     0.1
matmul:q_proj:L0                 0.59     0.1
matmul:q_proj:L5                 0.56     0.1
matmul:o_proj:L21                0.56     0.1
matmul:q_proj:L1                 0.55     0.1
matmul:o_proj:L11                0.54     0.1
matmul:q_proj:L14                0.53     0.1
matmul:o_proj:L7                 0.53     0.1
matmul:q_proj:L4                 0.53     0.1
matmul:q_proj:L12                0.53     0.1
matmul:q_proj:L22                0.53     0.1
matmul:q_proj:L15                0.53     0.1
matmul:q_proj:L17                0.53     0.1
matmul:q_proj:L11                0.53     0.1
matmul:q_proj:L18                0.52     0.1
matmul:q_proj:L21                0.52     0.1
matmul:o_proj:L3                 0.52     0.1
matmul:q_proj:L24                0.52     0.1
matmul:o_proj:L13                0.52     0.1
matmul:q_proj:L10                0.52     0.1
matmul:q_proj:L25                0.52     0.1
matmul:o_proj:L4                 0.51     0.1
matmul:o_proj:L10                0.49     0.1
matmul:q_proj:L23                0.49     0.1
matmul:q_proj:L2                 0.49     0.1
matmul:o_proj:L20                0.49     0.1
matmul:q_proj:L20                0.49     0.1
matmul:o_proj:L6                 0.49     0.1
matmul:q_proj:L7                 0.49     0.1
matmul:q_proj:L13                0.49     0.1
matmul:o_proj:L22                0.49     0.1
matmul:o_proj:L14                0.49     0.1
matmul:q_proj:L16                0.49     0.1
matmul:o_proj:L8                 0.49     0.1
gelu                             0.49     0.1
matmul:o_proj:L25                0.49     0.1
matmul:o_proj:L0                 0.49     0.1
matmul:o_proj:L1                 0.49     0.1
matmul:q_proj:L9                 0.49     0.1
matmul:q_proj:L3                 0.49     0.1
matmul:q_proj:L6                 0.49     0.1
matmul:o_proj:L23                0.49     0.1
matmul:o_proj:L2                 0.49     0.1
matmul:q_proj:L19                0.49     0.1
matmul:o_proj:L18                0.48     0.1
matmul:o_proj:L15                0.48     0.1
matmul:o_proj:L19                0.48     0.1
matmul:o_proj:L5                 0.48     0.1
matmul:o_proj:L9                 0.48     0.1
matmul:o_proj:L12                0.48     0.1
matmul:o_proj:L24                0.48     0.1
matmul:o_proj:L16                0.48     0.1
matmul:v_proj:L0                 0.42     0.1
matmul:k_proj:L0                 0.40     0.1
matmul:k_proj:L12                0.38     0.1
matmul:k_proj:L8                 0.37     0.1
matmul:v_proj:L8                 0.35     0.1
matmul:k_proj:L1                 0.35     0.1
matmul:v_proj:L1                 0.34     0.1
matmul:k_proj:L17                0.30     0.1
matmul:v_proj:L12                0.30     0.0
matmul:v_proj:L17                0.29     0.0
matmul:k_proj:L14                0.29     0.0
matmul:k_proj:L5                 0.29     0.0
matmul:k_proj:L22                0.29     0.0
matmul:k_proj:L15                0.29     0.0
matmul:k_proj:L21                0.29     0.0
matmul:v_proj:L22                0.29     0.0
matmul:v_proj:L14                0.29     0.0
matmul:k_proj:L24                0.28     0.0
matmul:v_proj:L25                0.28     0.0
matmul:v_proj:L24                0.28     0.0
matmul:k_proj:L18                0.28     0.0
matmul:k_proj:L25                0.28     0.0
matmul:v_proj:L15                0.28     0.0
matmul:k_proj:L10                0.28     0.0
matmul:v_proj:L21                0.28     0.0
matmul:v_proj:L10                0.28     0.0
matmul:v_proj:L18                0.28     0.0
matmul:k_proj:L4                 0.28     0.0
matmul:v_proj:L11                0.23     0.0
matmul:k_proj:L19                0.23     0.0
matmul:k_proj:L9                 0.23     0.0
matmul:v_proj:L5                 0.23     0.0
matmul:k_proj:L7                 0.23     0.0
matmul:k_proj:L6                 0.23     0.0
matmul:k_proj:L2                 0.23     0.0
matmul:k_proj:L3                 0.23     0.0
matmul:k_proj:L16                0.23     0.0
matmul:v_proj:L4                 0.23     0.0
matmul:k_proj:L13                0.23     0.0
matmul:k_proj:L20                0.23     0.0
matmul:k_proj:L23                0.23     0.0
matmul:v_proj:L3                 0.22     0.0
matmul:v_proj:L13                0.22     0.0
matmul:v_proj:L2                 0.22     0.0
matmul:v_proj:L23                0.22     0.0
matmul:v_proj:L7                 0.22     0.0
matmul:v_proj:L20                0.22     0.0
matmul:v_proj:L16                0.22     0.0
matmul:v_proj:L6                 0.22     0.0
matmul:v_proj:L9                 0.22     0.0
matmul:v_proj:L19                0.22     0.0
sample_phase1                    0.11     0.0
sample_phase3                    0.07     0.0
gather                           0.04     0.0
scale                            0.03     0.0
──────────────────────────────────────────────────
TOTAL                          596.50   100.0

[browser:warning] [21094.8ms][Profile] Batch decode (N=4):
[browser:warning] [21095.1ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      233.18    38.7
matmul:lm_head                  97.11    16.1
rmsnorm                          3.90     0.6
matmul:ffn_down:L16              3.48     0.6
sample_phase2                    3.46     0.6
matmul:ffn_down:L12              3.45     0.6
matmul:ffn_down:L7               3.44     0.6
matmul:ffn_down:L20              3.43     0.6
matmul:ffn_down:L22              3.43     0.6
matmul:ffn_down:L13              3.41     0.6
matmul:ffn_down:L18              3.41     0.6
matmul:ffn_down:L21              3.40     0.6
matmul:ffn_down:L1               3.38     0.6
matmul:ffn_down:L14              3.38     0.6
matmul:ffn_down:L2               3.38     0.6
matmul:ffn_down:L6               3.37     0.6
matmul:ffn_down:L9               3.37     0.6
matmul:ffn_down:L25              3.37     0.6
matmul:ffn_down:L5               3.37     0.6
matmul:ffn_down:L4               3.23     0.5
matmul:ffn_down:L11              3.21     0.5
matmul:ffn_down:L24              3.21     0.5
matmul:ffn_down:L10              3.20     0.5
matmul:ffn_down:L17              3.20     0.5
matmul:ffn_down:L19              3.20     0.5
matmul:ffn_down:L3               3.20     0.5
matmul:ffn_down:L15              3.20     0.5
matmul:ffn_down:L0               3.20     0.5
matmul:ffn_down:L8               3.20     0.5
matmul:ffn_down:L23              3.19     0.5
matmul:ffn_gate:L9               2.68     0.4
matmul:ffn_gate:L21              2.68     0.4
matmul:ffn_up:L2                 2.67     0.4
matmul:ffn_gate:L25              2.66     0.4
matmul:ffn_up:L6                 2.66     0.4
matmul:ffn_up:L13                2.65     0.4
matmul:ffn_up:L25                2.65     0.4
matmul:ffn_gate:L14              2.65     0.4
matmul:ffn_up:L5                 2.64     0.4
matmul:ffn_gate:L16              2.64     0.4
matmul:ffn_up:L18                2.64     0.4
matmul:ffn_up:L21                2.64     0.4
matmul:ffn_up:L1                 2.64     0.4
matmul:ffn_gate:L12              2.64     0.4
matmul:ffn_up:L12                2.64     0.4
matmul:ffn_gate:L13              2.63     0.4
matmul:ffn_gate:L1               2.63     0.4
matmul:ffn_gate:L5               2.63     0.4
matmul:ffn_gate:L20              2.63     0.4
matmul:ffn_up:L16                2.63     0.4
matmul:ffn_up:L14                2.63     0.4
matmul:ffn_up:L20                2.63     0.4
matmul:ffn_up:L9                 2.63     0.4
matmul:ffn_gate:L7               2.61     0.4
matmul:ffn_up:L11                2.60     0.4
matmul:ffn_gate:L17              2.60     0.4
matmul:ffn_up:L24                2.60     0.4
matmul:ffn_up:L10                2.60     0.4
matmul:ffn_gate:L6               2.60     0.4
matmul:ffn_gate:L11              2.60     0.4
matmul:ffn_up:L19                2.60     0.4
matmul:ffn_up:L22                2.60     0.4
matmul:ffn_gate:L3               2.60     0.4
matmul:ffn_up:L3                 2.60     0.4
matmul:ffn_gate:L2               2.60     0.4
matmul:ffn_gate:L24              2.60     0.4
matmul:ffn_gate:L8               2.60     0.4
matmul:ffn_gate:L15              2.60     0.4
matmul:ffn_gate:L23              2.60     0.4
matmul:ffn_up:L8                 2.60     0.4
matmul:ffn_up:L4                 2.60     0.4
matmul:ffn_up:L23                2.60     0.4
matmul:ffn_gate:L22              2.60     0.4
matmul:ffn_gate:L18              2.60     0.4
matmul:ffn_gate:L19              2.60     0.4
matmul:ffn_up:L15                2.60     0.4
matmul:ffn_up:L7                 2.60     0.4
matmul:ffn_gate:L4               2.60     0.4
matmul:ffn_gate:L0               2.60     0.4
matmul:ffn_up:L0                 2.60     0.4
matmul:ffn_gate:L10              2.60     0.4
matmul:ffn_up:L17                2.60     0.4
rope                             0.91     0.2
cast_f32_to_f16                  0.80     0.1
matmul:q_proj:L0                 0.60     0.1
matmul:q_proj:L13                0.55     0.1
matmul:q_proj:L6                 0.55     0.1
matmul:o_proj:L9                 0.55     0.1
matmul:o_proj:L14                0.55     0.1
matmul:q_proj:L21                0.53     0.1
matmul:q_proj:L22                0.53     0.1
matmul:q_proj:L3                 0.53     0.1
matmul:q_proj:L14                0.52     0.1
matmul:q_proj:L8                 0.52     0.1
matmul:o_proj:L20                0.52     0.1
matmul:q_proj:L23                0.52     0.1
matmul:q_proj:L19                0.52     0.1
matmul:o_proj:L12                0.52     0.1
matmul:o_proj:L21                0.52     0.1
matmul:q_proj:L15                0.52     0.1
matmul:q_proj:L7                 0.52     0.1
matmul:o_proj:L13                0.52     0.1
matmul:o_proj:L5                 0.52     0.1
matmul:q_proj:L10                0.52     0.1
matmul:o_proj:L16                0.52     0.1
matmul:o_proj:L1                 0.52     0.1
matmul:o_proj:L7                 0.49     0.1
gelu                             0.49     0.1
matmul:q_proj:L2                 0.49     0.1
matmul:q_proj:L17                0.49     0.1
matmul:o_proj:L25                0.49     0.1
matmul:o_proj:L18                0.49     0.1
matmul:o_proj:L4                 0.49     0.1
matmul:q_proj:L16                0.49     0.1
matmul:q_proj:L12                0.49     0.1
matmul:q_proj:L20                0.49     0.1
matmul:q_proj:L1                 0.49     0.1
matmul:q_proj:L25                0.49     0.1
matmul:q_proj:L4                 0.49     0.1
matmul:q_proj:L5                 0.49     0.1
matmul:q_proj:L24                0.49     0.1
matmul:q_proj:L18                0.49     0.1
matmul:o_proj:L6                 0.48     0.1
matmul:o_proj:L3                 0.48     0.1
matmul:q_proj:L11                0.48     0.1
matmul:o_proj:L23                0.48     0.1
matmul:q_proj:L9                 0.48     0.1
matmul:o_proj:L0                 0.48     0.1
matmul:o_proj:L22                0.48     0.1
matmul:o_proj:L19                0.48     0.1
matmul:o_proj:L24                0.48     0.1
matmul:o_proj:L17                0.48     0.1
matmul:o_proj:L2                 0.48     0.1
matmul:o_proj:L8                 0.48     0.1
matmul:o_proj:L11                0.48     0.1
matmul:o_proj:L10                0.48     0.1
matmul:o_proj:L15                0.48     0.1
matmul:v_proj:L0                 0.42     0.1
matmul:k_proj:L0                 0.37     0.1
matmul:v_proj:L6                 0.30     0.1
matmul:v_proj:L22                0.29     0.0
matmul:k_proj:L21                0.29     0.0
matmul:k_proj:L6                 0.29     0.0
matmul:k_proj:L22                0.29     0.0
matmul:v_proj:L21                0.29     0.0
matmul:k_proj:L10                0.29     0.0
matmul:k_proj:L7                 0.29     0.0
matmul:k_proj:L14                0.29     0.0
matmul:k_proj:L19                0.29     0.0
matmul:v_proj:L8                 0.29     0.0
matmul:k_proj:L23                0.29     0.0
matmul:v_proj:L7                 0.28     0.0
matmul:k_proj:L8                 0.28     0.0
matmul:k_proj:L15                0.28     0.0
matmul:k_proj:L3                 0.28     0.0
matmul:v_proj:L10                0.28     0.0
matmul:v_proj:L15                0.28     0.0
matmul:v_proj:L19                0.28     0.0
matmul:v_proj:L3                 0.28     0.0
matmul:v_proj:L14                0.28     0.0
matmul:v_proj:L23                0.28     0.0
matmul:k_proj:L13                0.25     0.0
matmul:v_proj:L16                0.23     0.0
matmul:k_proj:L25                0.23     0.0
matmul:k_proj:L24                0.23     0.0
matmul:k_proj:L16                0.23     0.0
matmul:k_proj:L5                 0.23     0.0
matmul:k_proj:L17                0.23     0.0
matmul:v_proj:L13                0.23     0.0
matmul:k_proj:L4                 0.23     0.0
matmul:v_proj:L1                 0.23     0.0
matmul:k_proj:L12                0.23     0.0
matmul:k_proj:L9                 0.23     0.0
matmul:k_proj:L1                 0.23     0.0
matmul:k_proj:L20                0.23     0.0
matmul:k_proj:L18                0.23     0.0
matmul:k_proj:L11                0.23     0.0
matmul:v_proj:L12                0.23     0.0
matmul:v_proj:L2                 0.23     0.0
matmul:k_proj:L2                 0.22     0.0
matmul:v_proj:L4                 0.22     0.0
matmul:v_proj:L9                 0.22     0.0
matmul:v_proj:L17                0.22     0.0
matmul:v_proj:L18                0.22     0.0
matmul:v_proj:L5                 0.22     0.0
matmul:v_proj:L11                0.22     0.0
matmul:v_proj:L20                0.22     0.0
matmul:v_proj:L24                0.22     0.0
matmul:v_proj:L25                0.22     0.0
sample_phase1                    0.13     0.0
sample_phase3                    0.08     0.0
gather                           0.06     0.0
scale                            0.04     0.0
──────────────────────────────────────────────────
TOTAL                          602.45   100.0

[browser:warning] [21745.8ms][Profile] Batch decode (N=4):
[browser:warning] [21746.0ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      239.75    39.5
matmul:lm_head                  94.93    15.6
rmsnorm                          3.97     0.7
matmul:ffn_down:L24              3.63     0.6
matmul:ffn_down:L4               3.62     0.6
matmul:ffn_down:L17              3.54     0.6
matmul:ffn_down:L13              3.49     0.6
matmul:ffn_down:L20              3.48     0.6
matmul:ffn_down:L8               3.46     0.6
matmul:ffn_down:L22              3.44     0.6
matmul:ffn_down:L2               3.43     0.6
matmul:ffn_down:L11              3.42     0.6
sample_phase2                    3.40     0.6
matmul:ffn_down:L10              3.40     0.6
matmul:ffn_down:L6               3.37     0.6
matmul:ffn_down:L15              3.37     0.6
matmul:ffn_down:L18              3.21     0.5
matmul:ffn_down:L16              3.21     0.5
matmul:ffn_down:L9               3.21     0.5
matmul:ffn_down:L3               3.21     0.5
matmul:ffn_down:L14              3.21     0.5
matmul:ffn_down:L7               3.20     0.5
matmul:ffn_down:L25              3.20     0.5
matmul:ffn_down:L1               3.20     0.5
matmul:ffn_down:L12              3.20     0.5
matmul:ffn_down:L23              3.20     0.5
matmul:ffn_down:L19              3.20     0.5
matmul:ffn_down:L21              3.20     0.5
matmul:ffn_down:L5               3.20     0.5
matmul:ffn_down:L0               3.19     0.5
matmul:ffn_gate:L24              2.72     0.4
matmul:ffn_gate:L22              2.72     0.4
matmul:ffn_up:L17                2.71     0.4
matmul:ffn_up:L4                 2.69     0.4
matmul:ffn_gate:L4               2.68     0.4
matmul:ffn_up:L10                2.68     0.4
matmul:ffn_up:L6                 2.67     0.4
matmul:ffn_up:L24                2.67     0.4
matmul:ffn_gate:L6               2.67     0.4
matmul:ffn_gate:L17              2.67     0.4
matmul:ffn_up:L15                2.66     0.4
matmul:ffn_up:L11                2.64     0.4
matmul:ffn_gate:L11              2.64     0.4
matmul:ffn_up:L22                2.64     0.4
matmul:ffn_up:L13                2.64     0.4
matmul:ffn_up:L20                2.64     0.4
matmul:ffn_gate:L2               2.64     0.4
matmul:ffn_up:L2                 2.64     0.4
matmul:ffn_gate:L20              2.63     0.4
matmul:ffn_gate:L13              2.63     0.4
matmul:ffn_gate:L14              2.63     0.4
matmul:ffn_up:L21                2.62     0.4
matmul:ffn_up:L14                2.61     0.4
matmul:ffn_gate:L10              2.61     0.4
matmul:ffn_up:L0                 2.61     0.4
matmul:ffn_up:L1                 2.61     0.4
matmul:ffn_up:L3                 2.61     0.4
matmul:ffn_up:L25                2.61     0.4
matmul:ffn_up:L8                 2.61     0.4
matmul:ffn_gate:L21              2.61     0.4
matmul:ffn_gate:L5               2.60     0.4
matmul:ffn_up:L19                2.60     0.4
matmul:ffn_gate:L7               2.60     0.4
matmul:ffn_gate:L0               2.60     0.4
matmul:ffn_up:L7                 2.60     0.4
matmul:ffn_gate:L8               2.60     0.4
matmul:ffn_gate:L23              2.60     0.4
matmul:ffn_gate:L18              2.60     0.4
matmul:ffn_gate:L1               2.60     0.4
matmul:ffn_up:L23                2.60     0.4
matmul:ffn_gate:L12              2.60     0.4
matmul:ffn_up:L9                 2.60     0.4
matmul:ffn_gate:L16              2.60     0.4
matmul:ffn_gate:L3               2.60     0.4
matmul:ffn_gate:L9               2.60     0.4
matmul:ffn_up:L18                2.60     0.4
matmul:ffn_gate:L19              2.60     0.4
matmul:ffn_gate:L25              2.60     0.4
matmul:ffn_gate:L15              2.60     0.4
matmul:ffn_up:L16                2.60     0.4
matmul:ffn_up:L12                2.59     0.4
matmul:ffn_up:L5                 2.59     0.4
rope                             0.97     0.2
cast_f32_to_f16                  0.84     0.1
matmul:q_proj:L0                 0.66     0.1
matmul:q_proj:L25                0.56     0.1
matmul:q_proj:L18                0.56     0.1
matmul:q_proj:L5                 0.56     0.1
matmul:q_proj:L16                0.53     0.1
matmul:q_proj:L11                0.53     0.1
matmul:q_proj:L14                0.53     0.1
matmul:q_proj:L12                0.53     0.1
matmul:o_proj:L22                0.53     0.1
matmul:q_proj:L9                 0.52     0.1
matmul:q_proj:L3                 0.52     0.1
matmul:q_proj:L7                 0.52     0.1
matmul:o_proj:L13                0.52     0.1
matmul:o_proj:L2                 0.52     0.1
matmul:o_proj:L4                 0.52     0.1
matmul:o_proj:L24                0.52     0.1
matmul:o_proj:L11                0.52     0.1
matmul:q_proj:L23                0.51     0.1
matmul:o_proj:L20                0.51     0.1
matmul:q_proj:L20                0.50     0.1
matmul:o_proj:L21                0.49     0.1
matmul:q_proj:L21                0.49     0.1
matmul:o_proj:L9                 0.49     0.1
matmul:q_proj:L22                0.49     0.1
matmul:q_proj:L17                0.49     0.1
matmul:q_proj:L13                0.49     0.1
matmul:q_proj:L10                0.49     0.1
matmul:q_proj:L1                 0.49     0.1
matmul:q_proj:L6                 0.49     0.1
matmul:q_proj:L24                0.49     0.1
matmul:o_proj:L5                 0.49     0.1
matmul:q_proj:L4                 0.49     0.1
matmul:q_proj:L19                0.49     0.1
matmul:o_proj:L3                 0.49     0.1
matmul:o_proj:L15                0.49     0.1
matmul:o_proj:L17                0.49     0.1
matmul:q_proj:L8                 0.49     0.1
matmul:o_proj:L14                0.49     0.1
matmul:o_proj:L12                0.49     0.1
matmul:o_proj:L23                0.49     0.1
matmul:o_proj:L18                0.49     0.1
gelu                             0.48     0.1
matmul:q_proj:L2                 0.48     0.1
matmul:o_proj:L16                0.48     0.1
matmul:o_proj:L7                 0.48     0.1
matmul:q_proj:L15                0.48     0.1
matmul:o_proj:L1                 0.48     0.1
matmul:o_proj:L6                 0.48     0.1
matmul:o_proj:L10                0.48     0.1
matmul:o_proj:L0                 0.48     0.1
matmul:o_proj:L25                0.48     0.1
matmul:o_proj:L19                0.48     0.1
matmul:o_proj:L8                 0.48     0.1
matmul:v_proj:L0                 0.41     0.1
matmul:k_proj:L0                 0.40     0.1
matmul:k_proj:L25                0.36     0.1
matmul:k_proj:L5                 0.35     0.1
matmul:v_proj:L25                0.35     0.1
matmul:v_proj:L5                 0.35     0.1
matmul:k_proj:L18                0.35     0.1
matmul:v_proj:L18                0.34     0.1
matmul:v_proj:L9                 0.33     0.1
matmul:k_proj:L12                0.30     0.0
matmul:v_proj:L12                0.30     0.0
matmul:k_proj:L9                 0.29     0.0
matmul:v_proj:L3                 0.29     0.0
matmul:k_proj:L16                0.29     0.0
matmul:k_proj:L3                 0.29     0.0
matmul:k_proj:L14                0.29     0.0
matmul:v_proj:L16                0.29     0.0
matmul:k_proj:L11                0.29     0.0
matmul:v_proj:L14                0.29     0.0
matmul:v_proj:L11                0.28     0.0
matmul:v_proj:L7                 0.28     0.0
matmul:k_proj:L7                 0.28     0.0
matmul:k_proj:L21                0.24     0.0
matmul:k_proj:L23                0.23     0.0
matmul:k_proj:L20                0.23     0.0
matmul:k_proj:L1                 0.23     0.0
matmul:k_proj:L15                0.23     0.0
matmul:k_proj:L8                 0.23     0.0
matmul:v_proj:L13                0.23     0.0
matmul:v_proj:L4                 0.23     0.0
matmul:k_proj:L4                 0.23     0.0
matmul:k_proj:L17                0.23     0.0
matmul:k_proj:L2                 0.23     0.0
matmul:k_proj:L13                0.23     0.0
matmul:k_proj:L10                0.23     0.0
matmul:k_proj:L24                0.23     0.0
matmul:k_proj:L19                0.23     0.0
matmul:v_proj:L10                0.23     0.0
matmul:k_proj:L22                0.23     0.0
matmul:k_proj:L6                 0.22     0.0
matmul:v_proj:L20                0.22     0.0
matmul:v_proj:L6                 0.22     0.0
matmul:v_proj:L22                0.22     0.0
matmul:v_proj:L21                0.22     0.0
matmul:v_proj:L23                0.22     0.0
matmul:v_proj:L8                 0.22     0.0
matmul:v_proj:L19                0.22     0.0
matmul:v_proj:L24                0.22     0.0
matmul:v_proj:L1                 0.22     0.0
matmul:v_proj:L15                0.22     0.0
matmul:v_proj:L17                0.22     0.0
matmul:v_proj:L2                 0.22     0.0
sample_phase1                    0.10     0.0
sample_phase3                    0.07     0.0
gather                           0.05     0.0
scale                            0.04     0.0
──────────────────────────────────────────────────
TOTAL                          607.72   100.0

[browser:warning] [22406.7ms][Profile] Batch decode (N=4):
[browser:warning] [22406.8ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      250.17    40.5
matmul:lm_head                  95.61    15.5
rmsnorm                          3.78     0.6
matmul:ffn_down:L20              3.47     0.6
matmul:ffn_down:L23              3.46     0.6
matmul:ffn_down:L7               3.45     0.6
matmul:ffn_down:L22              3.45     0.6
matmul:ffn_down:L19              3.44     0.6
matmul:ffn_down:L4               3.44     0.6
sample_phase2                    3.43     0.6
matmul:ffn_down:L17              3.43     0.6
matmul:ffn_down:L6               3.42     0.6
matmul:ffn_down:L10              3.42     0.6
matmul:ffn_down:L13              3.39     0.5
matmul:ffn_down:L0               3.38     0.5
matmul:ffn_down:L2               3.38     0.5
matmul:ffn_down:L12              3.38     0.5
matmul:ffn_down:L15              3.36     0.5
matmul:ffn_down:L9               3.31     0.5
matmul:ffn_down:L18              3.22     0.5
matmul:ffn_down:L16              3.21     0.5
matmul:ffn_down:L24              3.21     0.5
matmul:ffn_down:L1               3.21     0.5
matmul:ffn_down:L3               3.20     0.5
matmul:ffn_down:L25              3.20     0.5
matmul:ffn_down:L14              3.20     0.5
matmul:ffn_down:L11              3.20     0.5
matmul:ffn_down:L5               3.19     0.5
matmul:ffn_down:L21              3.19     0.5
matmul:ffn_down:L8               3.19     0.5
matmul:ffn_gate:L12              2.66     0.4
matmul:ffn_up:L13                2.66     0.4
matmul:ffn_up:L20                2.65     0.4
matmul:ffn_up:L12                2.65     0.4
matmul:ffn_up:L15                2.65     0.4
matmul:ffn_up:L9                 2.64     0.4
matmul:ffn_gate:L15              2.64     0.4
matmul:ffn_up:L19                2.64     0.4
matmul:ffn_up:L6                 2.64     0.4
matmul:ffn_up:L7                 2.64     0.4
matmul:ffn_gate:L20              2.64     0.4
matmul:ffn_gate:L4               2.64     0.4
matmul:ffn_up:L4                 2.64     0.4
matmul:ffn_gate:L19              2.64     0.4
matmul:ffn_gate:L9               2.64     0.4
matmul:ffn_gate:L22              2.64     0.4
matmul:ffn_gate:L7               2.63     0.4
matmul:ffn_up:L22                2.63     0.4
matmul:ffn_gate:L0               2.63     0.4
matmul:ffn_gate:L6               2.63     0.4
matmul:ffn_gate:L2               2.63     0.4
matmul:ffn_up:L2                 2.63     0.4
matmul:ffn_up:L0                 2.63     0.4
matmul:ffn_up:L10                2.61     0.4
matmul:ffn_up:L25                2.61     0.4
matmul:ffn_gate:L24              2.61     0.4
matmul:ffn_up:L1                 2.61     0.4
matmul:ffn_gate:L11              2.61     0.4
matmul:ffn_up:L21                2.60     0.4
matmul:ffn_up:L16                2.60     0.4
matmul:ffn_gate:L17              2.60     0.4
matmul:ffn_up:L11                2.60     0.4
matmul:ffn_gate:L25              2.60     0.4
matmul:ffn_up:L5                 2.60     0.4
matmul:ffn_up:L3                 2.60     0.4
matmul:ffn_gate:L18              2.60     0.4
matmul:ffn_gate:L5               2.60     0.4
matmul:ffn_up:L17                2.60     0.4
matmul:ffn_gate:L1               2.60     0.4
matmul:ffn_gate:L21              2.60     0.4
matmul:ffn_gate:L8               2.60     0.4
matmul:ffn_gate:L13              2.60     0.4
matmul:ffn_up:L14                2.60     0.4
matmul:ffn_gate:L10              2.60     0.4
matmul:ffn_gate:L14              2.60     0.4
matmul:ffn_up:L23                2.60     0.4
matmul:ffn_gate:L3               2.60     0.4
matmul:ffn_up:L18                2.60     0.4
matmul:ffn_gate:L23              2.60     0.4
matmul:ffn_gate:L16              2.60     0.4
matmul:ffn_up:L8                 2.60     0.4
matmul:ffn_up:L24                2.59     0.4
rope                             0.89     0.1
cast_f32_to_f16                  0.79     0.1
matmul:q_proj:L0                 0.62     0.1
matmul:o_proj:L22                0.54     0.1
matmul:q_proj:L18                0.53     0.1
matmul:q_proj:L13                0.53     0.1
matmul:o_proj:L4                 0.53     0.1
matmul:q_proj:L16                0.53     0.1
matmul:q_proj:L1                 0.52     0.1
matmul:q_proj:L21                0.52     0.1
matmul:q_proj:L5                 0.52     0.1
matmul:q_proj:L11                0.52     0.1
matmul:q_proj:L14                0.52     0.1
matmul:o_proj:L6                 0.52     0.1
matmul:q_proj:L24                0.52     0.1
matmul:o_proj:L0                 0.52     0.1
matmul:q_proj:L23                0.52     0.1
matmul:o_proj:L19                0.52     0.1
matmul:o_proj:L20                0.52     0.1
matmul:q_proj:L3                 0.52     0.1
matmul:o_proj:L9                 0.52     0.1
matmul:o_proj:L7                 0.51     0.1
matmul:o_proj:L2                 0.51     0.1
matmul:q_proj:L8                 0.49     0.1
matmul:q_proj:L7                 0.49     0.1
matmul:q_proj:L17                0.49     0.1
matmul:q_proj:L19                0.49     0.1
matmul:q_proj:L20                0.49     0.1
matmul:q_proj:L10                0.49     0.1
matmul:q_proj:L6                 0.49     0.1
matmul:o_proj:L3                 0.49     0.1
matmul:o_proj:L15                0.49     0.1
matmul:q_proj:L12                0.49     0.1
matmul:o_proj:L25                0.49     0.1
matmul:q_proj:L2                 0.49     0.1
matmul:q_proj:L22                0.49     0.1
matmul:q_proj:L4                 0.49     0.1
matmul:q_proj:L25                0.49     0.1
matmul:o_proj:L17                0.48     0.1
matmul:o_proj:L13                0.48     0.1
matmul:q_proj:L9                 0.48     0.1
matmul:o_proj:L8                 0.48     0.1
matmul:o_proj:L12                0.48     0.1
matmul:o_proj:L14                0.48     0.1
matmul:q_proj:L15                0.48     0.1
matmul:o_proj:L11                0.48     0.1
matmul:o_proj:L23                0.48     0.1
matmul:o_proj:L1                 0.48     0.1
matmul:o_proj:L18                0.48     0.1
matmul:o_proj:L5                 0.48     0.1
matmul:o_proj:L16                0.48     0.1
matmul:o_proj:L24                0.48     0.1
matmul:o_proj:L10                0.48     0.1
matmul:o_proj:L21                0.48     0.1
gelu                             0.46     0.1
matmul:k_proj:L0                 0.43     0.1
matmul:v_proj:L0                 0.41     0.1
matmul:v_proj:L24                0.30     0.0
matmul:k_proj:L23                0.29     0.0
matmul:v_proj:L1                 0.29     0.0
matmul:k_proj:L16                0.29     0.0
matmul:k_proj:L21                0.29     0.0
matmul:v_proj:L3                 0.29     0.0
matmul:k_proj:L5                 0.29     0.0
matmul:v_proj:L5                 0.29     0.0
matmul:k_proj:L1                 0.29     0.0
matmul:k_proj:L24                0.29     0.0
matmul:v_proj:L18                0.29     0.0
matmul:k_proj:L11                0.29     0.0
matmul:v_proj:L21                0.29     0.0
matmul:k_proj:L13                0.29     0.0
matmul:k_proj:L3                 0.28     0.0
matmul:k_proj:L18                0.28     0.0
matmul:v_proj:L13                0.28     0.0
matmul:v_proj:L11                0.28     0.0
matmul:v_proj:L14                0.28     0.0
matmul:k_proj:L14                0.28     0.0
matmul:v_proj:L16                0.28     0.0
matmul:v_proj:L23                0.28     0.0
matmul:k_proj:L7                 0.23     0.0
matmul:k_proj:L17                0.23     0.0
matmul:k_proj:L25                0.23     0.0
matmul:k_proj:L8                 0.23     0.0
matmul:v_proj:L22                0.23     0.0
matmul:k_proj:L4                 0.23     0.0
matmul:k_proj:L12                0.23     0.0
matmul:k_proj:L10                0.23     0.0
matmul:k_proj:L6                 0.23     0.0
matmul:k_proj:L19                0.23     0.0
matmul:k_proj:L22                0.23     0.0
matmul:v_proj:L7                 0.23     0.0
matmul:v_proj:L9                 0.23     0.0
matmul:k_proj:L20                0.22     0.0
matmul:k_proj:L9                 0.22     0.0
matmul:k_proj:L15                0.22     0.0
matmul:v_proj:L8                 0.22     0.0
matmul:v_proj:L6                 0.22     0.0
matmul:v_proj:L12                0.22     0.0
matmul:v_proj:L25                0.22     0.0
matmul:k_proj:L2                 0.22     0.0
matmul:v_proj:L17                0.22     0.0
matmul:v_proj:L4                 0.22     0.0
matmul:v_proj:L20                0.22     0.0
matmul:v_proj:L2                 0.22     0.0
matmul:v_proj:L19                0.22     0.0
matmul:v_proj:L10                0.22     0.0
matmul:v_proj:L15                0.22     0.0
sample_phase1                    0.14     0.0
sample_phase3                    0.09     0.0
gather                           0.05     0.0
scale                            0.04     0.0
──────────────────────────────────────────────────
TOTAL                          617.56   100.0

[browser:warning] [23074.3ms][Profile] Batch decode (N=4):
[browser:warning] [23074.5ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      255.76    40.9
matmul:lm_head                  96.06    15.4
rmsnorm                          3.85     0.6
matmul:ffn_up:L14                3.77     0.6
sample_phase2                    3.50     0.6
matmul:ffn_down:L8               3.49     0.6
matmul:ffn_down:L16              3.47     0.6
matmul:ffn_down:L11              3.46     0.6
matmul:ffn_down:L9               3.45     0.6
matmul:ffn_down:L3               3.45     0.6
matmul:ffn_down:L6               3.44     0.5
matmul:ffn_down:L4               3.38     0.5
matmul:ffn_down:L21              3.38     0.5
matmul:ffn_down:L25              3.37     0.5
matmul:ffn_down:L22              3.37     0.5
matmul:ffn_down:L17              3.37     0.5
matmul:ffn_down:L12              3.36     0.5
matmul:ffn_down:L1               3.28     0.5
matmul:ffn_down:L24              3.24     0.5
matmul:ffn_down:L14              3.23     0.5
matmul:ffn_down:L19              3.23     0.5
matmul:ffn_down:L18              3.22     0.5
matmul:ffn_down:L13              3.22     0.5
matmul:ffn_down:L23              3.21     0.5
matmul:ffn_down:L2               3.21     0.5
matmul:ffn_down:L20              3.20     0.5
matmul:ffn_down:L10              3.20     0.5
matmul:ffn_down:L15              3.20     0.5
matmul:ffn_down:L7               3.20     0.5
matmul:ffn_down:L0               3.20     0.5
matmul:ffn_down:L5               3.19     0.5
matmul:ffn_gate:L12              2.67     0.4
matmul:ffn_up:L25                2.66     0.4
matmul:ffn_up:L12                2.66     0.4
matmul:ffn_gate:L22              2.66     0.4
matmul:ffn_up:L4                 2.66     0.4
matmul:ffn_up:L22                2.65     0.4
matmul:ffn_gate:L17              2.65     0.4
matmul:ffn_gate:L24              2.65     0.4
matmul:ffn_up:L19                2.64     0.4
matmul:ffn_gate:L14              2.64     0.4
matmul:ffn_up:L8                 2.64     0.4
matmul:ffn_up:L11                2.64     0.4
matmul:ffn_gate:L8               2.64     0.4
matmul:ffn_up:L17                2.64     0.4
matmul:ffn_gate:L16              2.64     0.4
matmul:ffn_up:L6                 2.64     0.4
matmul:ffn_gate:L11              2.64     0.4
matmul:ffn_up:L21                2.64     0.4
matmul:ffn_gate:L6               2.64     0.4
matmul:ffn_gate:L21              2.64     0.4
matmul:ffn_gate:L3               2.64     0.4
matmul:ffn_up:L16                2.63     0.4
matmul:ffn_gate:L19              2.63     0.4
matmul:ffn_up:L3                 2.63     0.4
matmul:ffn_up:L24                2.63     0.4
matmul:ffn_up:L23                2.63     0.4
matmul:ffn_gate:L15              2.63     0.4
matmul:ffn_up:L20                2.61     0.4
matmul:ffn_up:L7                 2.61     0.4
matmul:ffn_gate:L0               2.61     0.4
matmul:ffn_gate:L18              2.61     0.4
matmul:ffn_gate:L10              2.60     0.4
matmul:ffn_gate:L2               2.60     0.4
matmul:ffn_gate:L5               2.60     0.4
matmul:ffn_gate:L25              2.60     0.4
matmul:ffn_up:L0                 2.60     0.4
matmul:ffn_gate:L4               2.60     0.4
matmul:ffn_up:L13                2.60     0.4
matmul:ffn_up:L15                2.60     0.4
matmul:ffn_up:L1                 2.60     0.4
matmul:ffn_up:L5                 2.60     0.4
matmul:ffn_gate:L20              2.60     0.4
matmul:ffn_up:L18                2.60     0.4
matmul:ffn_gate:L13              2.60     0.4
matmul:ffn_gate:L7               2.60     0.4
matmul:ffn_gate:L9               2.60     0.4
matmul:ffn_up:L9                 2.60     0.4
matmul:ffn_gate:L1               2.60     0.4
matmul:ffn_up:L2                 2.60     0.4
matmul:ffn_gate:L23              2.60     0.4
matmul:ffn_up:L10                2.60     0.4
rope                             0.92     0.1
cast_f32_to_f16                  0.78     0.1
matmul:q_proj:L0                 0.62     0.1
matmul:q_proj:L22                0.55     0.1
matmul:o_proj:L16                0.54     0.1
matmul:q_proj:L2                 0.53     0.1
matmul:q_proj:L5                 0.53     0.1
matmul:o_proj:L8                 0.53     0.1
matmul:q_proj:L12                0.53     0.1
matmul:q_proj:L23                0.53     0.1
matmul:q_proj:L18                0.53     0.1
matmul:o_proj:L6                 0.53     0.1
matmul:q_proj:L7                 0.53     0.1
matmul:q_proj:L10                0.53     0.1
matmul:q_proj:L13                0.52     0.1
matmul:q_proj:L9                 0.52     0.1
matmul:q_proj:L4                 0.52     0.1
matmul:q_proj:L17                0.52     0.1
matmul:o_proj:L3                 0.52     0.1
matmul:o_proj:L15                0.52     0.1
matmul:o_proj:L11                0.52     0.1
matmul:o_proj:L19                0.52     0.1
matmul:o_proj:L21                0.51     0.1
matmul:o_proj:L24                0.51     0.1
gelu                             0.51     0.1
matmul:q_proj:L25                0.49     0.1
matmul:o_proj:L23                0.49     0.1
matmul:o_proj:L22                0.49     0.1
matmul:q_proj:L21                0.49     0.1
matmul:q_proj:L19                0.49     0.1
matmul:q_proj:L24                0.49     0.1
matmul:q_proj:L14                0.49     0.1
matmul:q_proj:L6                 0.49     0.1
matmul:o_proj:L12                0.49     0.1
matmul:o_proj:L20                0.49     0.1
matmul:o_proj:L17                0.49     0.1
matmul:o_proj:L0                 0.49     0.1
matmul:q_proj:L8                 0.49     0.1
matmul:q_proj:L16                0.49     0.1
matmul:o_proj:L18                0.49     0.1
matmul:q_proj:L15                0.49     0.1
matmul:q_proj:L20                0.49     0.1
matmul:q_proj:L11                0.49     0.1
matmul:q_proj:L1                 0.49     0.1
matmul:o_proj:L14                0.49     0.1
matmul:q_proj:L3                 0.49     0.1
matmul:o_proj:L10                0.48     0.1
matmul:o_proj:L2                 0.48     0.1
matmul:o_proj:L25                0.48     0.1
matmul:o_proj:L1                 0.48     0.1
matmul:o_proj:L7                 0.48     0.1
matmul:o_proj:L13                0.48     0.1
matmul:o_proj:L5                 0.48     0.1
matmul:o_proj:L9                 0.48     0.1
matmul:o_proj:L4                 0.48     0.1
matmul:k_proj:L0                 0.43     0.1
matmul:v_proj:L0                 0.41     0.1
matmul:v_proj:L15                0.30     0.0
matmul:v_proj:L9                 0.29     0.0
matmul:k_proj:L4                 0.29     0.0
matmul:k_proj:L7                 0.29     0.0
matmul:v_proj:L4                 0.29     0.0
matmul:k_proj:L17                0.29     0.0
matmul:v_proj:L22                0.29     0.0
matmul:k_proj:L9                 0.29     0.0
matmul:v_proj:L5                 0.29     0.0
matmul:v_proj:L7                 0.29     0.0
matmul:k_proj:L10                0.29     0.0
matmul:v_proj:L13                0.29     0.0
matmul:k_proj:L23                0.29     0.0
matmul:k_proj:L13                0.29     0.0
matmul:v_proj:L17                0.29     0.0
matmul:k_proj:L5                 0.28     0.0
matmul:v_proj:L23                0.28     0.0
matmul:k_proj:L18                0.28     0.0
matmul:v_proj:L18                0.28     0.0
matmul:k_proj:L22                0.28     0.0
matmul:v_proj:L10                0.28     0.0
matmul:v_proj:L2                 0.28     0.0
matmul:k_proj:L2                 0.28     0.0
matmul:k_proj:L15                0.27     0.0
matmul:k_proj:L12                0.23     0.0
matmul:k_proj:L19                0.23     0.0
matmul:k_proj:L24                0.23     0.0
matmul:k_proj:L21                0.23     0.0
matmul:k_proj:L1                 0.23     0.0
matmul:k_proj:L11                0.23     0.0
matmul:v_proj:L11                0.23     0.0
matmul:v_proj:L24                0.23     0.0
matmul:k_proj:L16                0.23     0.0
matmul:k_proj:L20                0.23     0.0
matmul:k_proj:L14                0.23     0.0
matmul:v_proj:L19                0.23     0.0
matmul:v_proj:L12                0.22     0.0
matmul:k_proj:L25                0.22     0.0
matmul:k_proj:L6                 0.22     0.0
matmul:k_proj:L3                 0.22     0.0
matmul:k_proj:L8                 0.22     0.0
matmul:v_proj:L25                0.22     0.0
matmul:v_proj:L3                 0.22     0.0
matmul:v_proj:L1                 0.22     0.0
matmul:v_proj:L14                0.22     0.0
matmul:v_proj:L6                 0.22     0.0
matmul:v_proj:L8                 0.22     0.0
matmul:v_proj:L16                0.22     0.0
matmul:v_proj:L20                0.22     0.0
matmul:v_proj:L21                0.22     0.0
sample_phase1                    0.19     0.0
sample_phase3                    0.08     0.0
gather                           0.05     0.0
scale                            0.04     0.0
──────────────────────────────────────────────────
TOTAL                          625.17   100.0

[browser:warning] [23746.5ms][Profile] Batch decode (N=4):
[browser:warning] [23746.7ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      262.30    41.7
matmul:lm_head                  94.56    15.0
rmsnorm                          3.85     0.6
matmul:ffn_down:L23              3.47     0.6
matmul:ffn_down:L4               3.46     0.6
matmul:ffn_down:L22              3.45     0.5
matmul:ffn_down:L18              3.44     0.5
matmul:ffn_down:L15              3.43     0.5
matmul:ffn_down:L3               3.41     0.5
sample_phase2                    3.40     0.5
matmul:ffn_down:L9               3.39     0.5
matmul:ffn_down:L11              3.38     0.5
matmul:ffn_down:L14              3.38     0.5
matmul:ffn_down:L5               3.38     0.5
matmul:ffn_down:L24              3.37     0.5
matmul:ffn_down:L10              3.37     0.5
matmul:ffn_down:L1               3.36     0.5
matmul:ffn_down:L7               3.34     0.5
matmul:ffn_down:L16              3.22     0.5
matmul:ffn_down:L6               3.22     0.5
matmul:ffn_down:L20              3.22     0.5
matmul:ffn_down:L13              3.21     0.5
matmul:ffn_down:L17              3.20     0.5
matmul:ffn_down:L19              3.20     0.5
matmul:ffn_down:L25              3.20     0.5
matmul:ffn_down:L2               3.20     0.5
matmul:ffn_down:L0               3.20     0.5
matmul:ffn_down:L21              3.20     0.5
matmul:ffn_down:L8               3.19     0.5
matmul:ffn_down:L12              3.19     0.5
matmul:ffn_gate:L1               2.70     0.4
matmul:ffn_gate:L10              2.68     0.4
matmul:ffn_gate:L22              2.68     0.4
matmul:ffn_up:L11                2.66     0.4
matmul:ffn_up:L1                 2.65     0.4
matmul:ffn_gate:L24              2.65     0.4
matmul:ffn_gate:L14              2.65     0.4
matmul:ffn_up:L22                2.64     0.4
matmul:ffn_gate:L18              2.64     0.4
matmul:ffn_up:L10                2.64     0.4
matmul:ffn_gate:L4               2.64     0.4
matmul:ffn_up:L0                 2.64     0.4
matmul:ffn_up:L4                 2.64     0.4
matmul:ffn_up:L3                 2.64     0.4
matmul:ffn_up:L9                 2.64     0.4
matmul:ffn_gate:L9               2.64     0.4
matmul:ffn_up:L5                 2.63     0.4
matmul:ffn_up:L14                2.63     0.4
matmul:ffn_gate:L3               2.63     0.4
matmul:ffn_up:L24                2.63     0.4
matmul:ffn_gate:L5               2.63     0.4
matmul:ffn_gate:L23              2.63     0.4
matmul:ffn_up:L23                2.63     0.4
matmul:ffn_up:L18                2.63     0.4
matmul:ffn_up:L6                 2.61     0.4
matmul:ffn_gate:L17              2.61     0.4
matmul:ffn_gate:L11              2.61     0.4
matmul:ffn_up:L13                2.61     0.4
matmul:ffn_up:L16                2.61     0.4
matmul:ffn_up:L20                2.60     0.4
matmul:ffn_up:L19                2.60     0.4
matmul:ffn_up:L15                2.60     0.4
matmul:ffn_gate:L16              2.60     0.4
matmul:ffn_gate:L8               2.60     0.4
matmul:ffn_up:L12                2.60     0.4
matmul:ffn_up:L17                2.60     0.4
matmul:ffn_gate:L20              2.60     0.4
matmul:ffn_up:L21                2.60     0.4
matmul:ffn_up:L25                2.60     0.4
matmul:ffn_gate:L25              2.60     0.4
matmul:ffn_gate:L0               2.60     0.4
matmul:ffn_gate:L6               2.60     0.4
matmul:ffn_up:L2                 2.60     0.4
matmul:ffn_up:L8                 2.60     0.4
matmul:ffn_gate:L21              2.60     0.4
matmul:ffn_gate:L2               2.60     0.4
matmul:ffn_gate:L15              2.60     0.4
matmul:ffn_gate:L7               2.60     0.4
matmul:ffn_gate:L12              2.60     0.4
matmul:ffn_gate:L19              2.60     0.4
matmul:ffn_gate:L13              2.60     0.4
matmul:ffn_up:L7                 2.60     0.4
rope                             0.93     0.1
cast_f32_to_f16                  0.81     0.1
matmul:q_proj:L0                 0.61     0.1
matmul:q_proj:L17                0.56     0.1
matmul:q_proj:L25                0.55     0.1
matmul:q_proj:L21                0.55     0.1
matmul:o_proj:L4                 0.53     0.1
matmul:q_proj:L10                0.53     0.1
matmul:q_proj:L23                0.53     0.1
matmul:q_proj:L11                0.53     0.1
matmul:q_proj:L6                 0.53     0.1
matmul:q_proj:L16                0.52     0.1
matmul:o_proj:L22                0.52     0.1
matmul:q_proj:L2                 0.52     0.1
matmul:q_proj:L15                0.52     0.1
matmul:q_proj:L8                 0.52     0.1
matmul:q_proj:L5                 0.52     0.1
matmul:q_proj:L19                0.52     0.1
matmul:o_proj:L3                 0.52     0.1
matmul:q_proj:L24                0.52     0.1
matmul:o_proj:L24                0.52     0.1
matmul:o_proj:L9                 0.52     0.1
matmul:o_proj:L14                0.52     0.1
matmul:q_proj:L12                0.52     0.1
matmul:o_proj:L5                 0.52     0.1
matmul:o_proj:L23                0.52     0.1
matmul:o_proj:L18                0.51     0.1
matmul:q_proj:L18                0.49     0.1
matmul:q_proj:L4                 0.49     0.1
matmul:q_proj:L14                0.49     0.1
matmul:q_proj:L7                 0.49     0.1
matmul:q_proj:L13                0.49     0.1
matmul:q_proj:L22                0.49     0.1
matmul:o_proj:L25                0.49     0.1
matmul:q_proj:L20                0.49     0.1
matmul:o_proj:L10                0.49     0.1
matmul:o_proj:L1                 0.49     0.1
matmul:o_proj:L17                0.49     0.1
matmul:q_proj:L3                 0.49     0.1
matmul:q_proj:L1                 0.49     0.1
matmul:o_proj:L11                0.49     0.1
matmul:o_proj:L21                0.48     0.1
matmul:o_proj:L12                0.48     0.1
matmul:o_proj:L0                 0.48     0.1
matmul:o_proj:L20                0.48     0.1
matmul:q_proj:L9                 0.48     0.1
gelu                             0.48     0.1
matmul:o_proj:L7                 0.48     0.1
matmul:o_proj:L16                0.48     0.1
matmul:o_proj:L19                0.48     0.1
matmul:o_proj:L15                0.48     0.1
matmul:o_proj:L6                 0.48     0.1
matmul:o_proj:L8                 0.48     0.1
matmul:o_proj:L2                 0.48     0.1
matmul:o_proj:L13                0.48     0.1
matmul:k_proj:L0                 0.42     0.1
matmul:v_proj:L0                 0.42     0.1
matmul:k_proj:L6                 0.30     0.0
matmul:v_proj:L6                 0.30     0.0
matmul:k_proj:L5                 0.30     0.0
matmul:k_proj:L15                0.29     0.0
matmul:k_proj:L11                0.29     0.0
matmul:k_proj:L10                0.29     0.0
matmul:v_proj:L25                0.29     0.0
matmul:k_proj:L16                0.29     0.0
matmul:v_proj:L10                0.29     0.0
matmul:k_proj:L2                 0.29     0.0
matmul:v_proj:L2                 0.29     0.0
matmul:v_proj:L15                0.29     0.0
matmul:v_proj:L5                 0.29     0.0
matmul:k_proj:L21                0.28     0.0
matmul:v_proj:L11                0.28     0.0
matmul:k_proj:L12                0.28     0.0
matmul:v_proj:L12                0.28     0.0
matmul:k_proj:L25                0.28     0.0
matmul:k_proj:L17                0.28     0.0
matmul:v_proj:L16                0.28     0.0
matmul:v_proj:L8                 0.28     0.0
matmul:k_proj:L8                 0.28     0.0
matmul:v_proj:L21                0.27     0.0
matmul:k_proj:L19                0.26     0.0
matmul:k_proj:L23                0.25     0.0
matmul:v_proj:L17                0.24     0.0
matmul:k_proj:L24                0.24     0.0
matmul:k_proj:L3                 0.23     0.0
matmul:k_proj:L14                0.23     0.0
matmul:k_proj:L7                 0.23     0.0
matmul:k_proj:L18                0.23     0.0
matmul:k_proj:L22                0.23     0.0
matmul:k_proj:L4                 0.23     0.0
matmul:k_proj:L13                0.23     0.0
matmul:v_proj:L22                0.23     0.0
matmul:v_proj:L4                 0.23     0.0
matmul:v_proj:L19                0.23     0.0
matmul:v_proj:L23                0.23     0.0
matmul:k_proj:L20                0.22     0.0
matmul:v_proj:L3                 0.22     0.0
matmul:k_proj:L9                 0.22     0.0
matmul:v_proj:L7                 0.22     0.0
matmul:k_proj:L1                 0.22     0.0
matmul:v_proj:L24                0.22     0.0
matmul:v_proj:L20                0.22     0.0
matmul:v_proj:L14                0.22     0.0
matmul:v_proj:L1                 0.22     0.0
matmul:v_proj:L9                 0.22     0.0
matmul:v_proj:L13                0.22     0.0
matmul:v_proj:L18                0.22     0.0
sample_phase1                    0.11     0.0
sample_phase3                    0.07     0.0
gather                           0.05     0.0
scale                            0.04     0.0
──────────────────────────────────────────────────
TOTAL                          628.97   100.0

[browser:warning] [24427.3ms][Profile] Batch decode (N=4):
[browser:warning] [24427.4ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      269.59    42.2
matmul:lm_head                  96.99    15.2
rmsnorm                          3.83     0.6
matmul:ffn_down:L13              3.70     0.6
matmul:ffn_down:L20              3.47     0.5
sample_phase2                    3.47     0.5
matmul:ffn_down:L21              3.46     0.5
matmul:ffn_down:L1               3.45     0.5
matmul:ffn_down:L25              3.43     0.5
matmul:ffn_down:L14              3.41     0.5
matmul:ffn_down:L8               3.40     0.5
matmul:ffn_down:L0               3.40     0.5
matmul:ffn_down:L19              3.38     0.5
matmul:ffn_down:L7               3.37     0.5
matmul:ffn_down:L9               3.37     0.5
matmul:ffn_down:L15              3.36     0.5
matmul:ffn_down:L2               3.33     0.5
matmul:ffn_down:L6               3.23     0.5
matmul:ffn_down:L18              3.22     0.5
matmul:ffn_down:L24              3.21     0.5
matmul:ffn_down:L12              3.21     0.5
matmul:ffn_down:L4               3.20     0.5
matmul:ffn_down:L16              3.20     0.5
matmul:ffn_down:L17              3.20     0.5
matmul:ffn_down:L3               3.20     0.5
matmul:ffn_down:L10              3.20     0.5
matmul:ffn_down:L11              3.20     0.5
matmul:ffn_down:L23              3.19     0.5
matmul:ffn_down:L22              3.19     0.5
matmul:ffn_down:L5               3.19     0.5
matmul:ffn_up:L21                2.71     0.4
matmul:ffn_gate:L19              2.67     0.4
matmul:ffn_up:L14                2.66     0.4
matmul:ffn_up:L19                2.66     0.4
matmul:ffn_up:L0                 2.64     0.4
matmul:ffn_up:L13                2.64     0.4
matmul:ffn_gate:L13              2.64     0.4
matmul:ffn_gate:L2               2.64     0.4
matmul:ffn_gate:L8               2.64     0.4
matmul:ffn_gate:L21              2.64     0.4
matmul:ffn_gate:L20              2.64     0.4
matmul:ffn_up:L2                 2.64     0.4
matmul:ffn_up:L8                 2.64     0.4
matmul:ffn_gate:L9               2.64     0.4
matmul:ffn_gate:L1               2.64     0.4
matmul:ffn_up:L9                 2.64     0.4
matmul:ffn_up:L1                 2.64     0.4
matmul:ffn_gate:L15              2.64     0.4
matmul:ffn_up:L20                2.63     0.4
matmul:ffn_up:L15                2.63     0.4
matmul:ffn_gate:L7               2.63     0.4
matmul:ffn_up:L7                 2.63     0.4
matmul:ffn_gate:L0               2.63     0.4
matmul:ffn_up:L25                2.61     0.4
matmul:ffn_gate:L14              2.61     0.4
matmul:ffn_gate:L18              2.61     0.4
matmul:ffn_up:L6                 2.61     0.4
matmul:ffn_up:L10                2.61     0.4
matmul:ffn_up:L5                 2.60     0.4
matmul:ffn_up:L12                2.60     0.4
matmul:ffn_gate:L11              2.60     0.4
matmul:ffn_up:L22                2.60     0.4
matmul:ffn_up:L11                2.60     0.4
matmul:ffn_gate:L6               2.60     0.4
matmul:ffn_up:L23                2.60     0.4
matmul:ffn_gate:L24              2.60     0.4
matmul:ffn_up:L16                2.60     0.4
matmul:ffn_gate:L3               2.60     0.4
matmul:ffn_gate:L22              2.60     0.4
matmul:ffn_gate:L12              2.60     0.4
matmul:ffn_up:L24                2.60     0.4
matmul:ffn_gate:L25              2.60     0.4
matmul:ffn_gate:L16              2.60     0.4
matmul:ffn_up:L4                 2.60     0.4
matmul:ffn_up:L18                2.60     0.4
matmul:ffn_up:L3                 2.60     0.4
matmul:ffn_gate:L5               2.60     0.4
matmul:ffn_up:L17                2.60     0.4
matmul:ffn_gate:L4               2.60     0.4
matmul:ffn_gate:L23              2.60     0.4
matmul:ffn_gate:L17              2.60     0.4
matmul:ffn_gate:L10              2.59     0.4
rope                             0.92     0.1
cast_f32_to_f16                  0.80     0.1
matmul:o_proj:L0                 0.60     0.1
matmul:q_proj:L7                 0.57     0.1
matmul:q_proj:L0                 0.56     0.1
matmul:q_proj:L14                0.56     0.1
matmul:o_proj:L13                0.53     0.1
matmul:q_proj:L20                0.53     0.1
matmul:o_proj:L20                0.53     0.1
matmul:q_proj:L16                0.53     0.1
matmul:q_proj:L1                 0.52     0.1
matmul:q_proj:L8                 0.52     0.1
matmul:q_proj:L22                0.52     0.1
matmul:q_proj:L15                0.52     0.1
matmul:q_proj:L10                0.52     0.1
matmul:o_proj:L9                 0.52     0.1
matmul:q_proj:L9                 0.52     0.1
matmul:q_proj:L21                0.52     0.1
matmul:o_proj:L7                 0.52     0.1
matmul:o_proj:L1                 0.52     0.1
matmul:o_proj:L21                0.52     0.1
matmul:q_proj:L2                 0.52     0.1
matmul:o_proj:L2                 0.52     0.1
matmul:o_proj:L15                0.52     0.1
matmul:o_proj:L8                 0.51     0.1
gelu                             0.49     0.1
matmul:q_proj:L23                0.49     0.1
matmul:q_proj:L4                 0.49     0.1
matmul:o_proj:L3                 0.49     0.1
matmul:q_proj:L11                0.49     0.1
matmul:q_proj:L25                0.49     0.1
matmul:o_proj:L4                 0.49     0.1
matmul:o_proj:L24                0.49     0.1
matmul:q_proj:L17                0.49     0.1
matmul:q_proj:L3                 0.49     0.1
matmul:q_proj:L6                 0.49     0.1
matmul:q_proj:L12                0.49     0.1
matmul:o_proj:L5                 0.49     0.1
matmul:q_proj:L13                0.49     0.1
matmul:o_proj:L25                0.49     0.1
matmul:q_proj:L19                0.49     0.1
matmul:o_proj:L19                0.49     0.1
matmul:o_proj:L22                0.49     0.1
matmul:q_proj:L24                0.49     0.1
matmul:o_proj:L17                0.49     0.1
matmul:o_proj:L23                0.49     0.1
matmul:o_proj:L11                0.48     0.1
matmul:o_proj:L6                 0.48     0.1
matmul:o_proj:L16                0.48     0.1
matmul:q_proj:L18                0.48     0.1
matmul:q_proj:L5                 0.48     0.1
matmul:o_proj:L14                0.48     0.1
matmul:o_proj:L18                0.48     0.1
matmul:o_proj:L12                0.48     0.1
matmul:o_proj:L10                0.48     0.1
matmul:v_proj:L0                 0.37     0.1
matmul:k_proj:L0                 0.36     0.1
matmul:k_proj:L14                0.35     0.1
matmul:v_proj:L14                0.34     0.1
matmul:v_proj:L3                 0.30     0.0
matmul:k_proj:L16                0.30     0.0
matmul:k_proj:L2                 0.29     0.0
matmul:k_proj:L8                 0.29     0.0
matmul:k_proj:L22                0.29     0.0
matmul:k_proj:L7                 0.29     0.0
matmul:k_proj:L1                 0.29     0.0
matmul:v_proj:L2                 0.29     0.0
matmul:k_proj:L10                0.29     0.0
matmul:v_proj:L20                0.29     0.0
matmul:k_proj:L20                0.29     0.0
matmul:v_proj:L7                 0.29     0.0
matmul:k_proj:L15                0.29     0.0
matmul:v_proj:L1                 0.28     0.0
matmul:v_proj:L16                0.28     0.0
matmul:v_proj:L15                0.28     0.0
matmul:v_proj:L22                0.28     0.0
matmul:k_proj:L9                 0.28     0.0
matmul:v_proj:L8                 0.28     0.0
matmul:v_proj:L9                 0.28     0.0
matmul:v_proj:L10                0.28     0.0
matmul:k_proj:L3                 0.28     0.0
matmul:k_proj:L21                0.24     0.0
matmul:k_proj:L23                0.23     0.0
matmul:k_proj:L6                 0.23     0.0
matmul:k_proj:L24                0.23     0.0
matmul:k_proj:L12                0.23     0.0
matmul:k_proj:L19                0.23     0.0
matmul:k_proj:L18                0.23     0.0
matmul:v_proj:L21                0.23     0.0
matmul:k_proj:L5                 0.23     0.0
matmul:k_proj:L11                0.23     0.0
matmul:k_proj:L25                0.23     0.0
matmul:v_proj:L11                0.23     0.0
matmul:k_proj:L13                0.23     0.0
matmul:k_proj:L4                 0.23     0.0
matmul:k_proj:L17                0.22     0.0
matmul:v_proj:L23                0.22     0.0
matmul:v_proj:L4                 0.22     0.0
matmul:v_proj:L13                0.22     0.0
matmul:v_proj:L12                0.22     0.0
matmul:v_proj:L25                0.22     0.0
matmul:v_proj:L6                 0.22     0.0
matmul:v_proj:L19                0.22     0.0
matmul:v_proj:L24                0.22     0.0
matmul:v_proj:L17                0.22     0.0
matmul:v_proj:L5                 0.22     0.0
matmul:v_proj:L18                0.22     0.0
sample_phase1                    0.12     0.0
sample_phase3                    0.07     0.0
gather                           0.04     0.0
scale                            0.03     0.0
──────────────────────────────────────────────────
TOTAL                          638.66   100.0

[browser:warning] [25114.7ms][Profile] Batch decode (N=4):
[browser:warning] [25114.8ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      279.01    43.2
matmul:lm_head                  94.40    14.6
rmsnorm                          3.89     0.6
matmul:ffn_down:L17              3.66     0.6
matmul:ffn_down:L5               3.63     0.6
matmul:ffn_down:L23              3.61     0.6
matmul:ffn_down:L11              3.57     0.6
sample_phase2                    3.55     0.5
matmul:ffn_down:L4               3.49     0.5
matmul:ffn_down:L24              3.44     0.5
matmul:ffn_down:L16              3.40     0.5
matmul:ffn_down:L10              3.38     0.5
matmul:ffn_down:L22              3.21     0.5
matmul:ffn_down:L18              3.21     0.5
matmul:ffn_down:L14              3.21     0.5
matmul:ffn_down:L9               3.21     0.5
matmul:ffn_down:L3               3.21     0.5
matmul:ffn_down:L6               3.21     0.5
matmul:ffn_down:L13              3.21     0.5
matmul:ffn_down:L12              3.20     0.5
matmul:ffn_down:L15              3.20     0.5
matmul:ffn_down:L2               3.20     0.5
matmul:ffn_down:L7               3.20     0.5
matmul:ffn_down:L1               3.20     0.5
matmul:ffn_down:L8               3.20     0.5
matmul:ffn_down:L20              3.20     0.5
matmul:ffn_down:L19              3.20     0.5
matmul:ffn_down:L0               3.19     0.5
matmul:ffn_down:L21              3.19     0.5
matmul:ffn_down:L25              3.19     0.5
matmul:ffn_gate:L17              2.72     0.4
matmul:ffn_up:L17                2.68     0.4
matmul:ffn_gate:L11              2.68     0.4
matmul:ffn_up:L11                2.67     0.4
matmul:ffn_up:L4                 2.67     0.4
matmul:ffn_gate:L5               2.67     0.4
matmul:ffn_up:L5                 2.67     0.4
matmul:ffn_up:L16                2.66     0.4
matmul:ffn_gate:L24              2.64     0.4
matmul:ffn_gate:L4               2.64     0.4
matmul:ffn_gate:L10              2.64     0.4
matmul:ffn_gate:L23              2.64     0.4
matmul:ffn_up:L23                2.64     0.4
matmul:ffn_up:L24                2.64     0.4
matmul:ffn_up:L10                2.63     0.4
matmul:ffn_up:L14                2.61     0.4
matmul:ffn_up:L2                 2.61     0.4
matmul:ffn_gate:L6               2.61     0.4
matmul:ffn_up:L13                2.61     0.4
matmul:ffn_up:L12                2.61     0.4
matmul:ffn_up:L3                 2.60     0.4
matmul:ffn_up:L19                2.60     0.4
matmul:ffn_up:L21                2.60     0.4
matmul:ffn_gate:L16              2.60     0.4
matmul:ffn_up:L6                 2.60     0.4
matmul:ffn_gate:L9               2.60     0.4
matmul:ffn_gate:L25              2.60     0.4
matmul:ffn_up:L20                2.60     0.4
matmul:ffn_up:L7                 2.60     0.4
matmul:ffn_gate:L18              2.60     0.4
matmul:ffn_gate:L8               2.60     0.4
matmul:ffn_up:L15                2.60     0.4
matmul:ffn_gate:L7               2.60     0.4
matmul:ffn_up:L25                2.60     0.4
matmul:ffn_gate:L22              2.60     0.4
matmul:ffn_gate:L21              2.60     0.4
matmul:ffn_up:L22                2.60     0.4
matmul:ffn_gate:L14              2.60     0.4
matmul:ffn_gate:L0               2.60     0.4
matmul:ffn_gate:L12              2.60     0.4
matmul:ffn_up:L9                 2.60     0.4
matmul:ffn_gate:L20              2.60     0.4
matmul:ffn_up:L8                 2.60     0.4
matmul:ffn_gate:L3               2.60     0.4
matmul:ffn_up:L1                 2.60     0.4
matmul:ffn_gate:L1               2.60     0.4
matmul:ffn_up:L18                2.60     0.4
matmul:ffn_up:L0                 2.60     0.4
matmul:ffn_gate:L2               2.60     0.4
matmul:ffn_gate:L15              2.60     0.4
matmul:ffn_gate:L19              2.60     0.4
matmul:ffn_gate:L13              2.59     0.4
rope                             0.97     0.1
cast_f32_to_f16                  0.83     0.1
matmul:q_proj:L0                 0.63     0.1
matmul:q_proj:L18                0.61     0.1
matmul:q_proj:L24                0.57     0.1
matmul:o_proj:L5                 0.57     0.1
matmul:q_proj:L23                0.56     0.1
matmul:q_proj:L12                0.56     0.1
matmul:q_proj:L6                 0.56     0.1
matmul:o_proj:L10                0.55     0.1
matmul:o_proj:L11                0.55     0.1
matmul:o_proj:L24                0.54     0.1
matmul:o_proj:L17                0.53     0.1
matmul:q_proj:L25                0.53     0.1
matmul:q_proj:L5                 0.53     0.1
matmul:q_proj:L11                0.53     0.1
matmul:q_proj:L17                0.53     0.1
matmul:o_proj:L23                0.52     0.1
matmul:o_proj:L4                 0.52     0.1
matmul:q_proj:L19                0.49     0.1
matmul:q_proj:L14                0.49     0.1
matmul:q_proj:L7                 0.49     0.1
matmul:q_proj:L16                0.49     0.1
matmul:q_proj:L4                 0.49     0.1
matmul:o_proj:L6                 0.49     0.1
matmul:q_proj:L2                 0.49     0.1
matmul:q_proj:L10                0.49     0.1
matmul:q_proj:L22                0.49     0.1
matmul:o_proj:L14                0.49     0.1
matmul:q_proj:L13                0.49     0.1
matmul:q_proj:L3                 0.49     0.1
matmul:o_proj:L16                0.49     0.1
matmul:o_proj:L3                 0.49     0.1
matmul:o_proj:L15                0.48     0.1
matmul:o_proj:L1                 0.48     0.1
matmul:q_proj:L21                0.48     0.1
matmul:o_proj:L18                0.48     0.1
matmul:q_proj:L8                 0.48     0.1
matmul:q_proj:L1                 0.48     0.1
matmul:o_proj:L12                0.48     0.1
matmul:q_proj:L15                0.48     0.1
matmul:o_proj:L22                0.48     0.1
matmul:o_proj:L9                 0.48     0.1
matmul:o_proj:L0                 0.48     0.1
matmul:q_proj:L20                0.48     0.1
matmul:o_proj:L13                0.48     0.1
matmul:o_proj:L7                 0.48     0.1
matmul:q_proj:L9                 0.48     0.1
matmul:o_proj:L19                0.48     0.1
matmul:o_proj:L2                 0.48     0.1
matmul:o_proj:L20                0.48     0.1
matmul:o_proj:L25                0.48     0.1
matmul:o_proj:L21                0.48     0.1
matmul:o_proj:L8                 0.48     0.1
gelu                             0.46     0.1
matmul:k_proj:L0                 0.42     0.1
matmul:k_proj:L18                0.42     0.1
matmul:v_proj:L0                 0.40     0.1
matmul:v_proj:L18                0.37     0.1
matmul:v_proj:L6                 0.36     0.1
matmul:k_proj:L6                 0.35     0.1
matmul:k_proj:L24                0.35     0.1
matmul:k_proj:L12                0.35     0.1
matmul:v_proj:L24                0.34     0.1
matmul:v_proj:L12                0.33     0.1
matmul:v_proj:L11                0.30     0.0
matmul:v_proj:L25                0.29     0.0
matmul:k_proj:L11                0.29     0.0
matmul:v_proj:L23                0.29     0.0
matmul:v_proj:L17                0.29     0.0
matmul:k_proj:L5                 0.29     0.0
matmul:k_proj:L23                0.29     0.0
matmul:k_proj:L17                0.29     0.0
matmul:v_proj:L5                 0.28     0.0
matmul:k_proj:L25                0.26     0.0
matmul:k_proj:L4                 0.23     0.0
matmul:v_proj:L4                 0.23     0.0
matmul:k_proj:L10                0.23     0.0
matmul:v_proj:L22                0.23     0.0
matmul:k_proj:L15                0.23     0.0
matmul:k_proj:L21                0.23     0.0
matmul:k_proj:L8                 0.23     0.0
matmul:k_proj:L16                0.23     0.0
matmul:k_proj:L7                 0.23     0.0
matmul:v_proj:L8                 0.23     0.0
matmul:k_proj:L9                 0.23     0.0
matmul:k_proj:L22                0.23     0.0
matmul:k_proj:L3                 0.23     0.0
matmul:k_proj:L19                0.23     0.0
matmul:v_proj:L1                 0.22     0.0
matmul:v_proj:L9                 0.22     0.0
matmul:k_proj:L20                0.22     0.0
matmul:v_proj:L7                 0.22     0.0
matmul:k_proj:L13                0.22     0.0
matmul:v_proj:L10                0.22     0.0
matmul:k_proj:L14                0.22     0.0
matmul:v_proj:L3                 0.22     0.0
matmul:k_proj:L1                 0.22     0.0
matmul:v_proj:L2                 0.22     0.0
matmul:v_proj:L19                0.22     0.0
matmul:v_proj:L16                0.22     0.0
matmul:k_proj:L2                 0.22     0.0
matmul:v_proj:L13                0.22     0.0
matmul:v_proj:L15                0.22     0.0
matmul:v_proj:L20                0.22     0.0
matmul:v_proj:L14                0.22     0.0
matmul:v_proj:L21                0.22     0.0
sample_phase1                    0.13     0.0
sample_phase3                    0.09     0.0
gather                           0.06     0.0
scale                            0.04     0.0
──────────────────────────────────────────────────
TOTAL                          645.43   100.0

[browser:warning] [25809.9ms][Profile] Batch decode (N=4):
[browser:warning] [25810.1ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      286.76    43.9
matmul:lm_head                  94.98    14.5
matmul:ffn_down:L6               3.87     0.6
matmul:ffn_down:L0               3.77     0.6
rmsnorm                          3.77     0.6
matmul:ffn_down:L12              3.73     0.6
matmul:ffn_down:L25              3.61     0.6
matmul:ffn_down:L19              3.50     0.5
matmul:ffn_down:L24              3.40     0.5
matmul:ffn_down:L7               3.39     0.5
matmul:ffn_down:L18              3.38     0.5
sample_phase2                    3.26     0.5
matmul:ffn_down:L16              3.21     0.5
matmul:ffn_down:L11              3.21     0.5
matmul:ffn_down:L17              3.21     0.5
matmul:ffn_down:L13              3.21     0.5
matmul:ffn_down:L5               3.20     0.5
matmul:ffn_down:L14              3.20     0.5
matmul:ffn_down:L4               3.20     0.5
matmul:ffn_down:L23              3.20     0.5
matmul:ffn_down:L1               3.20     0.5
matmul:ffn_down:L9               3.20     0.5
matmul:ffn_down:L20              3.20     0.5
matmul:ffn_down:L8               3.20     0.5
matmul:ffn_down:L15              3.20     0.5
matmul:ffn_down:L10              3.20     0.5
matmul:ffn_down:L2               3.20     0.5
matmul:ffn_down:L3               3.19     0.5
matmul:ffn_down:L21              3.19     0.5
matmul:ffn_down:L22              3.19     0.5
matmul:ffn_up:L0                 2.78     0.4
matmul:ffn_up:L12                2.72     0.4
matmul:ffn_up:L25                2.71     0.4
matmul:ffn_gate:L25              2.71     0.4
matmul:ffn_gate:L19              2.71     0.4
matmul:ffn_gate:L0               2.68     0.4
matmul:ffn_up:L19                2.68     0.4
matmul:ffn_gate:L6               2.67     0.4
matmul:ffn_gate:L18              2.66     0.4
matmul:ffn_gate:L12              2.65     0.4
matmul:ffn_up:L6                 2.65     0.4
matmul:ffn_up:L18                2.65     0.4
matmul:ffn_up:L7                 2.64     0.4
matmul:ffn_gate:L7               2.63     0.4
matmul:ffn_up:L3                 2.61     0.4
matmul:ffn_up:L11                2.61     0.4
matmul:ffn_up:L14                2.61     0.4
matmul:ffn_gate:L10              2.61     0.4
matmul:ffn_gate:L8               2.60     0.4
matmul:ffn_gate:L17              2.60     0.4
matmul:ffn_up:L20                2.60     0.4
matmul:ffn_up:L9                 2.60     0.4
matmul:ffn_gate:L24              2.60     0.4
matmul:ffn_up:L13                2.60     0.4
matmul:ffn_gate:L11              2.60     0.4
matmul:ffn_gate:L14              2.60     0.4
matmul:ffn_up:L4                 2.60     0.4
matmul:ffn_up:L17                2.60     0.4
matmul:ffn_gate:L22              2.60     0.4
matmul:ffn_up:L22                2.60     0.4
matmul:ffn_gate:L16              2.60     0.4
matmul:ffn_up:L24                2.60     0.4
matmul:ffn_up:L2                 2.60     0.4
matmul:ffn_up:L5                 2.60     0.4
matmul:ffn_up:L1                 2.60     0.4
matmul:ffn_up:L10                2.60     0.4
matmul:ffn_gate:L23              2.60     0.4
matmul:ffn_up:L8                 2.60     0.4
matmul:ffn_up:L16                2.60     0.4
matmul:ffn_gate:L9               2.60     0.4
matmul:ffn_gate:L5               2.60     0.4
matmul:ffn_up:L23                2.60     0.4
matmul:ffn_gate:L15              2.60     0.4
matmul:ffn_gate:L2               2.60     0.4
matmul:ffn_up:L21                2.60     0.4
matmul:ffn_up:L15                2.60     0.4
matmul:ffn_gate:L13              2.60     0.4
matmul:ffn_gate:L20              2.60     0.4
matmul:ffn_gate:L4               2.60     0.4
matmul:ffn_gate:L21              2.60     0.4
matmul:ffn_gate:L3               2.59     0.4
matmul:ffn_gate:L1               2.59     0.4
rope                             0.88     0.1
cast_f32_to_f16                  0.76     0.1
matmul:q_proj:L13                0.67     0.1
matmul:q_proj:L7                 0.61     0.1
matmul:q_proj:L1                 0.60     0.1
matmul:o_proj:L19                0.59     0.1
matmul:o_proj:L25                0.58     0.1
matmul:o_proj:L0                 0.55     0.1
matmul:q_proj:L19                0.53     0.1
matmul:q_proj:L25                0.52     0.1
matmul:q_proj:L20                0.52     0.1
matmul:o_proj:L7                 0.52     0.1
gelu                             0.51     0.1
matmul:q_proj:L0                 0.50     0.1
matmul:q_proj:L24                0.49     0.1
matmul:q_proj:L12                0.49     0.1
matmul:o_proj:L13                0.49     0.1
matmul:q_proj:L18                0.49     0.1
matmul:q_proj:L8                 0.49     0.1
matmul:q_proj:L6                 0.49     0.1
matmul:o_proj:L3                 0.49     0.1
matmul:q_proj:L22                0.49     0.1
matmul:o_proj:L18                0.49     0.1
matmul:q_proj:L23                0.49     0.1
matmul:q_proj:L14                0.49     0.1
matmul:q_proj:L17                0.49     0.1
matmul:o_proj:L4                 0.49     0.1
matmul:q_proj:L10                0.49     0.1
matmul:q_proj:L16                0.49     0.1
matmul:q_proj:L5                 0.49     0.1
matmul:o_proj:L15                0.49     0.1
matmul:o_proj:L1                 0.48     0.1
matmul:q_proj:L15                0.48     0.1
matmul:o_proj:L12                0.48     0.1
matmul:q_proj:L21                0.48     0.1
matmul:o_proj:L24                0.48     0.1
matmul:o_proj:L11                0.48     0.1
matmul:o_proj:L9                 0.48     0.1
matmul:q_proj:L3                 0.48     0.1
matmul:q_proj:L4                 0.48     0.1
matmul:o_proj:L8                 0.48     0.1
matmul:o_proj:L23                0.48     0.1
matmul:q_proj:L11                0.48     0.1
matmul:o_proj:L21                0.48     0.1
matmul:q_proj:L2                 0.48     0.1
matmul:o_proj:L16                0.48     0.1
matmul:q_proj:L9                 0.48     0.1
matmul:o_proj:L6                 0.48     0.1
matmul:o_proj:L5                 0.48     0.1
matmul:o_proj:L10                0.48     0.1
matmul:o_proj:L22                0.48     0.1
matmul:o_proj:L17                0.48     0.1
matmul:o_proj:L20                0.48     0.1
matmul:o_proj:L2                 0.48     0.1
matmul:o_proj:L14                0.48     0.1
matmul:k_proj:L13                0.45     0.1
matmul:v_proj:L13                0.45     0.1
matmul:v_proj:L7                 0.42     0.1
matmul:k_proj:L1                 0.40     0.1
matmul:k_proj:L7                 0.40     0.1
matmul:v_proj:L1                 0.40     0.1
matmul:k_proj:L20                0.29     0.0
matmul:k_proj:L19                0.29     0.0
matmul:v_proj:L19                0.29     0.0
matmul:v_proj:L25                0.29     0.0
matmul:k_proj:L25                0.29     0.0
matmul:v_proj:L20                0.27     0.0
matmul:k_proj:L0                 0.24     0.0
matmul:v_proj:L0                 0.23     0.0
matmul:k_proj:L10                0.23     0.0
matmul:k_proj:L22                0.23     0.0
matmul:k_proj:L18                0.23     0.0
matmul:k_proj:L6                 0.23     0.0
matmul:k_proj:L16                0.23     0.0
matmul:k_proj:L23                0.23     0.0
matmul:v_proj:L22                0.23     0.0
matmul:k_proj:L24                0.23     0.0
matmul:k_proj:L12                0.23     0.0
matmul:v_proj:L24                0.23     0.0
matmul:k_proj:L21                0.23     0.0
matmul:k_proj:L3                 0.23     0.0
matmul:v_proj:L12                0.23     0.0
matmul:v_proj:L18                0.23     0.0
matmul:v_proj:L11                0.23     0.0
matmul:k_proj:L5                 0.23     0.0
matmul:k_proj:L17                0.23     0.0
matmul:k_proj:L11                0.22     0.0
matmul:v_proj:L6                 0.22     0.0
matmul:k_proj:L14                0.22     0.0
matmul:v_proj:L5                 0.22     0.0
matmul:v_proj:L14                0.22     0.0
matmul:k_proj:L8                 0.22     0.0
matmul:k_proj:L15                0.22     0.0
matmul:k_proj:L4                 0.22     0.0
matmul:v_proj:L15                0.22     0.0
matmul:k_proj:L9                 0.22     0.0
matmul:k_proj:L2                 0.22     0.0
matmul:v_proj:L8                 0.22     0.0
matmul:v_proj:L4                 0.22     0.0
matmul:v_proj:L21                0.22     0.0
matmul:v_proj:L10                0.22     0.0
matmul:v_proj:L16                0.22     0.0
matmul:v_proj:L17                0.22     0.0
matmul:v_proj:L9                 0.22     0.0
matmul:v_proj:L3                 0.22     0.0
matmul:v_proj:L23                0.22     0.0
matmul:v_proj:L2                 0.22     0.0
sample_phase1                    0.07     0.0
sample_phase3                    0.04     0.0
gather                           0.01     0.0
scale                            0.01     0.0
──────────────────────────────────────────────────
TOTAL                          652.97   100.0

[browser:warning] [26513.3ms][Profile] Batch decode (N=4):
[browser:warning] [26513.4ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      292.63    44.4
matmul:lm_head                  94.26    14.3
matmul:ffn_down:L6               4.00     0.6
matmul:ffn_down:L0               3.92     0.6
rmsnorm                          3.91     0.6
matmul:ffn_down:L18              3.65     0.6
matmul:ffn_down:L24              3.64     0.6
matmul:ffn_down:L12              3.63     0.6
matmul:ffn_down:L25              3.44     0.5
matmul:ffn_down:L19              3.29     0.5
sample_phase2                    3.28     0.5
matmul:ffn_down:L17              3.22     0.5
matmul:ffn_down:L14              3.21     0.5
matmul:ffn_down:L13              3.21     0.5
matmul:ffn_down:L11              3.21     0.5
matmul:ffn_down:L5               3.20     0.5
matmul:ffn_down:L16              3.20     0.5
matmul:ffn_down:L4               3.20     0.5
matmul:ffn_down:L9               3.20     0.5
matmul:ffn_down:L15              3.20     0.5
matmul:ffn_down:L2               3.20     0.5
matmul:ffn_down:L10              3.20     0.5
matmul:ffn_down:L23              3.20     0.5
matmul:ffn_down:L8               3.20     0.5
matmul:ffn_down:L3               3.20     0.5
matmul:ffn_down:L7               3.19     0.5
matmul:ffn_down:L1               3.19     0.5
matmul:ffn_down:L20              3.19     0.5
matmul:ffn_down:L21              3.19     0.5
matmul:ffn_down:L22              3.19     0.5
matmul:ffn_up:L0                 2.87     0.4
matmul:ffn_up:L6                 2.76     0.4
matmul:ffn_gate:L0               2.70     0.4
matmul:ffn_up:L12                2.70     0.4
matmul:ffn_gate:L6               2.70     0.4
matmul:ffn_up:L25                2.65     0.4
matmul:ffn_gate:L25              2.65     0.4
matmul:ffn_up:L24                2.64     0.4
matmul:ffn_gate:L24              2.64     0.4
matmul:ffn_gate:L19              2.64     0.4
matmul:ffn_gate:L13              2.64     0.4
matmul:ffn_gate:L12              2.64     0.4
matmul:ffn_up:L18                2.64     0.4
matmul:ffn_up:L19                2.64     0.4
matmul:ffn_gate:L18              2.64     0.4
matmul:ffn_up:L13                2.62     0.4
matmul:ffn_gate:L10              2.61     0.4
matmul:ffn_up:L1                 2.61     0.4
matmul:ffn_up:L16                2.61     0.4
matmul:ffn_up:L2                 2.61     0.4
matmul:ffn_up:L14                2.61     0.4
matmul:ffn_up:L4                 2.61     0.4
matmul:ffn_up:L3                 2.61     0.4
matmul:ffn_gate:L4               2.61     0.4
matmul:ffn_gate:L16              2.60     0.4
matmul:ffn_up:L20                2.60     0.4
matmul:ffn_gate:L1               2.60     0.4
matmul:ffn_gate:L5               2.60     0.4
matmul:ffn_up:L22                2.60     0.4
matmul:ffn_up:L8                 2.60     0.4
matmul:ffn_up:L17                2.60     0.4
matmul:ffn_gate:L22              2.60     0.4
matmul:ffn_up:L9                 2.60     0.4
matmul:ffn_gate:L2               2.60     0.4
matmul:ffn_gate:L17              2.60     0.4
matmul:ffn_up:L21                2.60     0.4
matmul:ffn_gate:L23              2.60     0.4
matmul:ffn_up:L5                 2.60     0.4
matmul:ffn_gate:L11              2.60     0.4
matmul:ffn_up:L11                2.60     0.4
matmul:ffn_gate:L21              2.60     0.4
matmul:ffn_gate:L14              2.60     0.4
matmul:ffn_up:L15                2.60     0.4
matmul:ffn_gate:L7               2.60     0.4
matmul:ffn_gate:L3               2.60     0.4
matmul:ffn_gate:L20              2.60     0.4
matmul:ffn_gate:L8               2.60     0.4
matmul:ffn_gate:L9               2.60     0.4
matmul:ffn_up:L23                2.60     0.4
matmul:ffn_up:L7                 2.60     0.4
matmul:ffn_gate:L15              2.60     0.4
matmul:ffn_up:L10                2.59     0.4
rope                             0.99     0.1
cast_f32_to_f16                  0.83     0.1
matmul:q_proj:L1                 0.64     0.1
matmul:q_proj:L7                 0.64     0.1
matmul:q_proj:L25                0.62     0.1
matmul:q_proj:L13                0.61     0.1
matmul:q_proj:L19                0.57     0.1
matmul:o_proj:L24                0.53     0.1
matmul:o_proj:L19                0.53     0.1
matmul:o_proj:L13                0.52     0.1
matmul:o_proj:L25                0.52     0.1
matmul:o_proj:L6                 0.52     0.1
matmul:o_proj:L12                0.52     0.1
matmul:o_proj:L0                 0.51     0.1
matmul:o_proj:L18                0.51     0.1
matmul:q_proj:L0                 0.50     0.1
matmul:q_proj:L6                 0.49     0.1
matmul:o_proj:L1                 0.49     0.1
matmul:q_proj:L18                0.49     0.1
matmul:q_proj:L24                0.49     0.1
matmul:o_proj:L2                 0.49     0.1
matmul:q_proj:L23                0.49     0.1
matmul:o_proj:L9                 0.49     0.1
gelu                             0.49     0.1
matmul:q_proj:L12                0.49     0.1
matmul:o_proj:L7                 0.49     0.1
matmul:q_proj:L20                0.49     0.1
matmul:o_proj:L22                0.49     0.1
matmul:q_proj:L14                0.49     0.1
matmul:q_proj:L17                0.49     0.1
matmul:o_proj:L10                0.49     0.1
matmul:q_proj:L10                0.49     0.1
matmul:q_proj:L16                0.49     0.1
matmul:o_proj:L16                0.49     0.1
matmul:q_proj:L11                0.48     0.1
matmul:q_proj:L5                 0.48     0.1
matmul:q_proj:L4                 0.48     0.1
matmul:q_proj:L8                 0.48     0.1
matmul:q_proj:L21                0.48     0.1
matmul:q_proj:L22                0.48     0.1
matmul:q_proj:L2                 0.48     0.1
matmul:q_proj:L3                 0.48     0.1
matmul:o_proj:L4                 0.48     0.1
matmul:q_proj:L15                0.48     0.1
matmul:q_proj:L9                 0.48     0.1
matmul:o_proj:L15                0.48     0.1
matmul:o_proj:L23                0.48     0.1
matmul:o_proj:L11                0.48     0.1
matmul:v_proj:L7                 0.48     0.1
matmul:o_proj:L14                0.48     0.1
matmul:o_proj:L5                 0.48     0.1
matmul:o_proj:L17                0.48     0.1
matmul:o_proj:L21                0.48     0.1
matmul:o_proj:L8                 0.48     0.1
matmul:o_proj:L3                 0.48     0.1
matmul:o_proj:L20                0.48     0.1
matmul:v_proj:L1                 0.47     0.1
matmul:k_proj:L7                 0.46     0.1
matmul:k_proj:L1                 0.46     0.1
matmul:v_proj:L19                0.42     0.1
matmul:k_proj:L13                0.41     0.1
matmul:v_proj:L13                0.40     0.1
matmul:k_proj:L25                0.40     0.1
matmul:v_proj:L25                0.40     0.1
matmul:k_proj:L19                0.38     0.1
matmul:k_proj:L0                 0.23     0.0
matmul:k_proj:L6                 0.23     0.0
matmul:k_proj:L17                0.23     0.0
matmul:v_proj:L0                 0.23     0.0
matmul:v_proj:L6                 0.23     0.0
matmul:k_proj:L22                0.23     0.0
matmul:k_proj:L24                0.23     0.0
matmul:k_proj:L10                0.23     0.0
matmul:k_proj:L11                0.23     0.0
matmul:k_proj:L16                0.23     0.0
matmul:k_proj:L12                0.23     0.0
matmul:k_proj:L2                 0.23     0.0
matmul:k_proj:L5                 0.23     0.0
matmul:k_proj:L15                0.23     0.0
matmul:v_proj:L12                0.23     0.0
matmul:k_proj:L3                 0.23     0.0
matmul:k_proj:L18                0.23     0.0
matmul:k_proj:L8                 0.23     0.0
matmul:k_proj:L21                0.23     0.0
matmul:k_proj:L23                0.22     0.0
matmul:v_proj:L3                 0.22     0.0
matmul:k_proj:L14                0.22     0.0
matmul:v_proj:L18                0.22     0.0
matmul:v_proj:L10                0.22     0.0
matmul:k_proj:L20                0.22     0.0
matmul:v_proj:L24                0.22     0.0
matmul:v_proj:L22                0.22     0.0
matmul:k_proj:L4                 0.22     0.0
matmul:v_proj:L8                 0.22     0.0
matmul:v_proj:L4                 0.22     0.0
matmul:k_proj:L9                 0.22     0.0
matmul:v_proj:L11                0.22     0.0
matmul:v_proj:L20                0.22     0.0
matmul:v_proj:L23                0.22     0.0
matmul:v_proj:L16                0.22     0.0
matmul:v_proj:L14                0.22     0.0
matmul:v_proj:L21                0.22     0.0
matmul:v_proj:L17                0.22     0.0
matmul:v_proj:L9                 0.22     0.0
matmul:v_proj:L5                 0.22     0.0
matmul:v_proj:L15                0.22     0.0
matmul:v_proj:L2                 0.22     0.0
sample_phase1                    0.07     0.0
sample_phase3                    0.05     0.0
gather                           0.01     0.0
scale                            0.01     0.0
──────────────────────────────────────────────────
TOTAL                          659.17   100.0

[browser:warning] [27220.7ms][Profile] Batch decode (N=4):
[browser:warning] [27220.8ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      298.40    44.8
matmul:lm_head                  94.02    14.1
rmsnorm                          3.93     0.6
matmul:ffn_down:L5               3.66     0.5
matmul:ffn_down:L23              3.64     0.5
matmul:ffn_down:L11              3.58     0.5
matmul:ffn_down:L17              3.50     0.5
sample_phase2                    3.45     0.5
matmul:ffn_down:L18              3.45     0.5
matmul:ffn_down:L12              3.45     0.5
matmul:ffn_down:L6               3.44     0.5
matmul:ffn_down:L24              3.38     0.5
matmul:ffn_down:L0               3.38     0.5
matmul:ffn_down:L8               3.27     0.5
matmul:ffn_down:L16              3.21     0.5
matmul:ffn_down:L22              3.21     0.5
matmul:ffn_down:L13              3.21     0.5
matmul:ffn_down:L10              3.21     0.5
matmul:ffn_down:L4               3.21     0.5
matmul:ffn_down:L1               3.21     0.5
matmul:ffn_down:L14              3.20     0.5
matmul:ffn_down:L25              3.20     0.5
matmul:ffn_down:L3               3.20     0.5
matmul:ffn_down:L19              3.20     0.5
matmul:ffn_down:L21              3.20     0.5
matmul:ffn_down:L15              3.20     0.5
matmul:ffn_down:L2               3.20     0.5
matmul:ffn_down:L20              3.20     0.5
matmul:ffn_down:L9               3.20     0.5
matmul:ffn_down:L7               3.19     0.5
matmul:ffn_up:L15                3.09     0.5
matmul:ffn_up:L23                2.71     0.4
matmul:ffn_up:L11                2.69     0.4
matmul:ffn_up:L5                 2.69     0.4
matmul:ffn_up:L6                 2.67     0.4
matmul:ffn_gate:L6               2.67     0.4
matmul:ffn_gate:L12              2.66     0.4
matmul:ffn_gate:L23              2.66     0.4
matmul:ffn_up:L12                2.65     0.4
matmul:ffn_gate:L15              2.64     0.4
matmul:ffn_gate:L5               2.64     0.4
matmul:ffn_gate:L11              2.64     0.4
matmul:ffn_gate:L0               2.64     0.4
matmul:ffn_gate:L17              2.64     0.4
matmul:ffn_up:L17                2.64     0.4
matmul:ffn_up:L24                2.64     0.4
matmul:ffn_gate:L24              2.63     0.4
matmul:ffn_up:L0                 2.63     0.4
matmul:ffn_gate:L18              2.62     0.4
matmul:ffn_up:L1                 2.61     0.4
matmul:ffn_up:L14                2.61     0.4
matmul:ffn_up:L20                2.61     0.4
matmul:ffn_gate:L21              2.61     0.4
matmul:ffn_up:L19                2.61     0.4
matmul:ffn_gate:L25              2.60     0.4
matmul:ffn_up:L13                2.60     0.4
matmul:ffn_gate:L10              2.60     0.4
matmul:ffn_up:L21                2.60     0.4
matmul:ffn_up:L22                2.60     0.4
matmul:ffn_gate:L8               2.60     0.4
matmul:ffn_up:L4                 2.60     0.4
matmul:ffn_up:L25                2.60     0.4
matmul:ffn_up:L10                2.60     0.4
matmul:ffn_up:L18                2.60     0.4
matmul:ffn_gate:L2               2.60     0.4
matmul:ffn_gate:L4               2.60     0.4
matmul:ffn_gate:L14              2.60     0.4
matmul:ffn_up:L9                 2.60     0.4
matmul:ffn_up:L2                 2.60     0.4
matmul:ffn_gate:L22              2.60     0.4
matmul:ffn_up:L16                2.60     0.4
matmul:ffn_up:L7                 2.60     0.4
matmul:ffn_gate:L16              2.60     0.4
matmul:ffn_gate:L9               2.60     0.4
matmul:ffn_up:L3                 2.60     0.4
matmul:ffn_gate:L7               2.60     0.4
matmul:ffn_gate:L20              2.60     0.4
matmul:ffn_gate:L1               2.60     0.4
matmul:ffn_gate:L19              2.60     0.4
matmul:ffn_gate:L13              2.60     0.4
matmul:ffn_up:L8                 2.60     0.4
matmul:ffn_gate:L3               2.59     0.4
rope                             0.94     0.1
matmul:o_proj:L18                0.92     0.1
cast_f32_to_f16                  0.82     0.1
matmul:q_proj:L18                0.60     0.1
matmul:q_proj:L0                 0.57     0.1
matmul:q_proj:L12                0.57     0.1
matmul:q_proj:L24                0.57     0.1
matmul:q_proj:L6                 0.56     0.1
matmul:o_proj:L6                 0.56     0.1
matmul:o_proj:L12                0.55     0.1
matmul:q_proj:L7                 0.55     0.1
matmul:o_proj:L17                0.54     0.1
matmul:o_proj:L24                0.53     0.1
matmul:q_proj:L25                0.53     0.1
matmul:q_proj:L13                0.52     0.1
matmul:q_proj:L19                0.52     0.1
matmul:o_proj:L11                0.52     0.1
matmul:q_proj:L1                 0.52     0.1
matmul:o_proj:L5                 0.52     0.1
matmul:o_proj:L23                0.52     0.1
matmul:o_proj:L0                 0.52     0.1
matmul:q_proj:L15                0.49     0.1
matmul:o_proj:L3                 0.49     0.1
matmul:q_proj:L17                0.49     0.1
matmul:o_proj:L7                 0.49     0.1
matmul:q_proj:L20                0.49     0.1
matmul:o_proj:L1                 0.49     0.1
matmul:q_proj:L11                0.49     0.1
matmul:q_proj:L23                0.49     0.1
matmul:q_proj:L2                 0.49     0.1
matmul:q_proj:L5                 0.49     0.1
matmul:q_proj:L16                0.49     0.1
matmul:q_proj:L14                0.49     0.1
matmul:o_proj:L2                 0.49     0.1
matmul:q_proj:L22                0.49     0.1
matmul:q_proj:L4                 0.49     0.1
matmul:o_proj:L21                0.49     0.1
matmul:o_proj:L19                0.49     0.1
matmul:q_proj:L21                0.49     0.1
matmul:q_proj:L9                 0.49     0.1
matmul:q_proj:L8                 0.48     0.1
matmul:q_proj:L3                 0.48     0.1
matmul:o_proj:L16                0.48     0.1
matmul:q_proj:L10                0.48     0.1
matmul:o_proj:L10                0.48     0.1
matmul:o_proj:L8                 0.48     0.1
matmul:o_proj:L22                0.48     0.1
matmul:o_proj:L20                0.48     0.1
matmul:o_proj:L14                0.48     0.1
matmul:o_proj:L4                 0.48     0.1
matmul:o_proj:L13                0.48     0.1
matmul:o_proj:L25                0.48     0.1
matmul:o_proj:L9                 0.48     0.1
matmul:o_proj:L15                0.48     0.1
gelu                             0.47     0.1
matmul:k_proj:L0                 0.44     0.1
matmul:v_proj:L0                 0.42     0.1
matmul:v_proj:L18                0.42     0.1
matmul:k_proj:L18                0.39     0.1
matmul:v_proj:L24                0.39     0.1
matmul:k_proj:L24                0.36     0.1
matmul:k_proj:L12                0.36     0.1
matmul:v_proj:L12                0.35     0.1
matmul:k_proj:L6                 0.33     0.0
matmul:v_proj:L1                 0.29     0.0
matmul:v_proj:L13                0.29     0.0
matmul:k_proj:L19                0.29     0.0
matmul:k_proj:L13                0.29     0.0
matmul:k_proj:L25                0.29     0.0
matmul:v_proj:L6                 0.29     0.0
matmul:v_proj:L7                 0.29     0.0
matmul:k_proj:L7                 0.29     0.0
matmul:k_proj:L1                 0.29     0.0
matmul:v_proj:L25                0.28     0.0
matmul:v_proj:L19                0.28     0.0
matmul:k_proj:L22                0.23     0.0
matmul:k_proj:L17                0.23     0.0
matmul:k_proj:L16                0.23     0.0
matmul:k_proj:L5                 0.23     0.0
matmul:k_proj:L23                0.23     0.0
matmul:k_proj:L21                0.23     0.0
matmul:v_proj:L11                0.23     0.0
matmul:k_proj:L10                0.23     0.0
matmul:k_proj:L11                0.23     0.0
matmul:v_proj:L5                 0.23     0.0
matmul:k_proj:L4                 0.23     0.0
matmul:k_proj:L8                 0.23     0.0
matmul:k_proj:L14                0.23     0.0
matmul:v_proj:L23                0.23     0.0
matmul:k_proj:L3                 0.22     0.0
matmul:v_proj:L22                0.22     0.0
matmul:v_proj:L17                0.22     0.0
matmul:k_proj:L9                 0.22     0.0
matmul:k_proj:L2                 0.22     0.0
matmul:v_proj:L9                 0.22     0.0
matmul:k_proj:L15                0.22     0.0
matmul:v_proj:L16                0.22     0.0
matmul:v_proj:L4                 0.22     0.0
matmul:v_proj:L2                 0.22     0.0
matmul:v_proj:L3                 0.22     0.0
matmul:k_proj:L20                0.22     0.0
matmul:v_proj:L20                0.22     0.0
matmul:v_proj:L8                 0.22     0.0
matmul:v_proj:L14                0.22     0.0
matmul:v_proj:L10                0.22     0.0
matmul:v_proj:L15                0.22     0.0
matmul:v_proj:L21                0.22     0.0
sample_phase1                    0.09     0.0
sample_phase3                    0.07     0.0
gather                           0.04     0.0
scale                            0.03     0.0
──────────────────────────────────────────────────
TOTAL                          665.44   100.0

[browser:warning] [27937.7ms][Profile] Batch decode (N=4):
[browser:warning] [27937.8ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      306.63    45.5
matmul:lm_head                  95.23    14.1
rmsnorm                          3.88     0.6
matmul:ffn_down:L22              3.69     0.5
sample_phase2                    3.59     0.5
matmul:ffn_down:L16              3.53     0.5
matmul:ffn_down:L21              3.48     0.5
matmul:ffn_down:L20              3.45     0.5
matmul:ffn_down:L14              3.43     0.5
matmul:ffn_down:L10              3.41     0.5
matmul:ffn_down:L2               3.38     0.5
matmul:ffn_down:L15              3.37     0.5
matmul:ffn_down:L9               3.37     0.5
matmul:ffn_down:L8               3.37     0.5
matmul:ffn_down:L3               3.37     0.5
matmul:ffn_down:L4               3.35     0.5
matmul:ffn_down:L5               3.34     0.5
matmul:ffn_down:L18              3.22     0.5
matmul:ffn_down:L13              3.21     0.5
matmul:ffn_down:L19              3.20     0.5
matmul:ffn_down:L25              3.20     0.5
matmul:ffn_down:L7               3.20     0.5
matmul:ffn_down:L24              3.20     0.5
matmul:ffn_down:L11              3.20     0.5
matmul:ffn_down:L6               3.20     0.5
matmul:ffn_down:L12              3.20     0.5
matmul:ffn_down:L1               3.20     0.5
matmul:ffn_down:L0               3.19     0.5
matmul:ffn_down:L17              3.19     0.5
matmul:ffn_down:L23              3.19     0.5
matmul:ffn_gate:L3               2.67     0.4
matmul:ffn_gate:L9               2.66     0.4
matmul:ffn_up:L9                 2.66     0.4
matmul:ffn_gate:L5               2.65     0.4
matmul:ffn_gate:L22              2.65     0.4
matmul:ffn_gate:L20              2.64     0.4
matmul:ffn_up:L2                 2.64     0.4
matmul:ffn_up:L22                2.64     0.4
matmul:ffn_up:L20                2.64     0.4
matmul:ffn_gate:L16              2.64     0.4
matmul:ffn_up:L8                 2.64     0.4
matmul:ffn_gate:L15              2.64     0.4
matmul:ffn_up:L3                 2.64     0.4
matmul:ffn_gate:L14              2.64     0.4
matmul:ffn_up:L5                 2.64     0.4
matmul:ffn_gate:L21              2.64     0.4
matmul:ffn_up:L14                2.64     0.4
matmul:ffn_up:L15                2.64     0.4
matmul:ffn_up:L10                2.64     0.4
matmul:ffn_gate:L8               2.63     0.4
matmul:ffn_gate:L10              2.63     0.4
matmul:ffn_up:L16                2.63     0.4
matmul:ffn_up:L21                2.63     0.4
matmul:ffn_gate:L0               2.61     0.4
matmul:ffn_gate:L13              2.61     0.4
matmul:ffn_up:L6                 2.61     0.4
matmul:ffn_gate:L17              2.61     0.4
matmul:ffn_gate:L24              2.60     0.4
matmul:ffn_up:L11                2.60     0.4
matmul:ffn_gate:L18              2.60     0.4
matmul:ffn_gate:L2               2.60     0.4
matmul:ffn_up:L19                2.60     0.4
matmul:ffn_up:L13                2.60     0.4
matmul:ffn_gate:L6               2.60     0.4
matmul:ffn_gate:L12              2.60     0.4
matmul:ffn_up:L17                2.60     0.4
matmul:ffn_up:L18                2.60     0.4
matmul:ffn_gate:L4               2.60     0.4
matmul:ffn_gate:L1               2.60     0.4
matmul:ffn_up:L25                2.60     0.4
matmul:ffn_up:L0                 2.60     0.4
matmul:ffn_up:L4                 2.60     0.4
matmul:ffn_gate:L7               2.60     0.4
matmul:ffn_up:L7                 2.60     0.4
matmul:ffn_gate:L11              2.60     0.4
matmul:ffn_up:L23                2.60     0.4
matmul:ffn_gate:L23              2.60     0.4
matmul:ffn_up:L12                2.60     0.4
matmul:ffn_up:L1                 2.60     0.4
matmul:ffn_gate:L25              2.60     0.4
matmul:ffn_gate:L19              2.60     0.4
matmul:ffn_up:L24                2.60     0.4
rope                             0.95     0.1
cast_f32_to_f16                  0.83     0.1
matmul:q_proj:L0                 0.60     0.1
matmul:q_proj:L17                0.56     0.1
matmul:q_proj:L23                0.54     0.1
matmul:o_proj:L16                0.53     0.1
matmul:q_proj:L3                 0.53     0.1
matmul:q_proj:L10                0.53     0.1
matmul:q_proj:L16                0.53     0.1
matmul:q_proj:L4                 0.53     0.1
matmul:q_proj:L11                0.53     0.1
matmul:o_proj:L22                0.53     0.1
matmul:o_proj:L20                0.53     0.1
matmul:q_proj:L9                 0.53     0.1
matmul:q_proj:L22                0.52     0.1
matmul:q_proj:L21                0.52     0.1
matmul:q_proj:L5                 0.52     0.1
matmul:o_proj:L21                0.52     0.1
matmul:o_proj:L5                 0.52     0.1
matmul:q_proj:L15                0.52     0.1
matmul:o_proj:L10                0.52     0.1
matmul:o_proj:L14                0.52     0.1
matmul:o_proj:L15                0.51     0.1
matmul:o_proj:L8                 0.51     0.1
matmul:q_proj:L6                 0.49     0.1
matmul:q_proj:L8                 0.49     0.1
matmul:o_proj:L2                 0.49     0.1
matmul:q_proj:L2                 0.49     0.1
matmul:o_proj:L17                0.49     0.1
matmul:q_proj:L14                0.49     0.1
matmul:q_proj:L20                0.49     0.1
matmul:q_proj:L7                 0.49     0.1
matmul:o_proj:L4                 0.49     0.1
matmul:q_proj:L25                0.49     0.1
matmul:o_proj:L6                 0.49     0.1
matmul:o_proj:L11                0.49     0.1
matmul:q_proj:L19                0.49     0.1
matmul:q_proj:L24                0.49     0.1
matmul:q_proj:L12                0.49     0.1
matmul:o_proj:L12                0.49     0.1
matmul:o_proj:L7                 0.49     0.1
matmul:q_proj:L13                0.48     0.1
matmul:o_proj:L9                 0.48     0.1
matmul:q_proj:L18                0.48     0.1
matmul:o_proj:L23                0.48     0.1
matmul:o_proj:L3                 0.48     0.1
matmul:o_proj:L25                0.48     0.1
matmul:o_proj:L13                0.48     0.1
matmul:o_proj:L1                 0.48     0.1
matmul:q_proj:L1                 0.48     0.1
matmul:o_proj:L19                0.48     0.1
matmul:o_proj:L0                 0.48     0.1
matmul:o_proj:L24                0.48     0.1
matmul:o_proj:L18                0.48     0.1
gelu                             0.48     0.1
matmul:v_proj:L0                 0.42     0.1
matmul:k_proj:L0                 0.41     0.1
matmul:k_proj:L11                0.36     0.1
matmul:v_proj:L11                0.36     0.1
matmul:k_proj:L17                0.35     0.1
matmul:v_proj:L17                0.34     0.1
matmul:k_proj:L21                0.30     0.0
matmul:v_proj:L22                0.30     0.0
matmul:k_proj:L22                0.29     0.0
matmul:k_proj:L23                0.29     0.0
matmul:k_proj:L15                0.29     0.0
matmul:v_proj:L15                0.29     0.0
matmul:k_proj:L5                 0.29     0.0
matmul:k_proj:L16                0.29     0.0
matmul:k_proj:L4                 0.29     0.0
matmul:v_proj:L23                0.29     0.0
matmul:v_proj:L4                 0.29     0.0
matmul:v_proj:L10                0.29     0.0
matmul:k_proj:L9                 0.29     0.0
matmul:v_proj:L16                0.29     0.0
matmul:k_proj:L10                0.28     0.0
matmul:v_proj:L21                0.28     0.0
matmul:k_proj:L3                 0.28     0.0
matmul:v_proj:L3                 0.28     0.0
matmul:v_proj:L5                 0.28     0.0
matmul:v_proj:L9                 0.28     0.0
matmul:k_proj:L18                0.23     0.0
matmul:k_proj:L6                 0.23     0.0
matmul:k_proj:L14                0.23     0.0
matmul:k_proj:L12                0.23     0.0
matmul:k_proj:L24                0.23     0.0
matmul:v_proj:L7                 0.23     0.0
matmul:k_proj:L7                 0.23     0.0
matmul:k_proj:L1                 0.23     0.0
matmul:k_proj:L20                0.23     0.0
matmul:k_proj:L8                 0.23     0.0
matmul:v_proj:L13                0.22     0.0
matmul:k_proj:L2                 0.22     0.0
matmul:v_proj:L2                 0.22     0.0
matmul:v_proj:L8                 0.22     0.0
matmul:k_proj:L19                0.22     0.0
matmul:k_proj:L25                0.22     0.0
matmul:k_proj:L13                0.22     0.0
matmul:v_proj:L14                0.22     0.0
matmul:v_proj:L19                0.22     0.0
matmul:v_proj:L20                0.22     0.0
matmul:v_proj:L25                0.22     0.0
matmul:v_proj:L6                 0.22     0.0
matmul:v_proj:L1                 0.22     0.0
matmul:v_proj:L24                0.22     0.0
matmul:v_proj:L12                0.22     0.0
matmul:v_proj:L18                0.22     0.0
sample_phase1                    0.11     0.0
sample_phase3                    0.08     0.0
gather                           0.06     0.0
scale                            0.04     0.0
──────────────────────────────────────────────────
TOTAL                          674.26   100.0

[browser:warning] [28661.2ms][Profile] Batch decode (N=4):
[browser:warning] [28661.3ms][Profile] GPU Profile Report
──────────────────────────────────────────────────
Kernel                      Time (ms)       %
──────────────────────────────────────────────────
attention                      313.75    46.1
matmul:lm_head                  95.57    14.0
rmsnorm                          3.90     0.6
sample_phase2                    3.49     0.5
matmul:ffn_down:L0               3.48     0.5
matmul:ffn_down:L6               3.46     0.5
matmul:ffn_down:L19              3.44     0.5
matmul:ffn_down:L11              3.44     0.5
matmul:ffn_down:L5               3.41     0.5
matmul:ffn_down:L4               3.40     0.5
matmul:ffn_down:L18              3.39     0.5
matmul:ffn_down:L17              3.39     0.5
matmul:ffn_down:L13              3.38     0.5
matmul:ffn_down:L24              3.38     0.5
matmul:ffn_down:L12              3.38     0.5
matmul:ffn_down:L10              3.37     0.5
matmul:ffn_down:L25              3.36     0.5
matmul:ffn_down:L2               3.33     0.5
matmul:ffn_down:L22              3.32     0.5
matmul:ffn_down:L23              3.24     0.5
matmul:ffn_down:L7               3.22     0.5
matmul:ffn_down:L16              3.21     0.5
matmul:ffn_down:L20              3.21     0.5
matmul:ffn_down:L14              3.21     0.5
matmul:ffn_down:L3               3.20     0.5
matmul:ffn_down:L21              3.20     0.5
matmul:ffn_down:L1               3.20     0.5
matmul:ffn_down:L9               3.20     0.5
matmul:ffn_down:L8               3.20     0.5
matmul:ffn_down:L15              3.19     0.5
matmul:ffn_up:L19                2.70     0.4
matmul:ffn_gate:L12              2.66     0.4
matmul:ffn_up:L5                 2.66     0.4
matmul:ffn_gate:L11              2.65     0.4
matmul:ffn_up:L11                2.65     0.4
matmul:ffn_up:L12                2.64     0.4
matmul:ffn_up:L2                 2.64     0.4
matmul:ffn_gate:L2               2.64     0.4
matmul:ffn_gate:L24              2.64     0.4
matmul:ffn_up:L24                2.64     0.4
matmul:ffn_gate:L25              2.64     0.4
matmul:ffn_gate:L4               2.64     0.4
matmul:ffn_up:L18                2.64     0.4
matmul:ffn_gate:L17              2.64     0.4
matmul:ffn_up:L17                2.64     0.4
matmul:ffn_gate:L23              2.64     0.4
matmul:ffn_up:L25                2.64     0.4
matmul:ffn_up:L10                2.64     0.4
matmul:ffn_up:L23                2.64     0.4
matmul:ffn_gate:L18              2.63     0.4
matmul:ffn_up:L4                 2.63     0.4
matmul:ffn_gate:L10              2.63     0.4
matmul:ffn_up:L22                2.63     0.4
matmul:ffn_gate:L16              2.61     0.4
matmul:ffn_gate:L22              2.61     0.4
matmul:ffn_gate:L5               2.61     0.4
matmul:ffn_up:L14                2.61     0.4
matmul:ffn_up:L13                2.60     0.4
matmul:ffn_up:L8                 2.60     0.4
matmul:ffn_gate:L0               2.60     0.4
matmul:ffn_gate:L9               2.60     0.4
matmul:ffn_gate:L21              2.60     0.4
matmul:ffn_up:L6                 2.60     0.4
matmul:ffn_gate:L20              2.60     0.4
matmul:ffn_up:L3                 2.60     0.4
matmul:ffn_up:L0                 2.60     0.4
matmul:ffn_up:L1                 2.60     0.4
matmul:ffn_gate:L3               2.60     0.4
matmul:ffn_gate:L8               2.60     0.4
matmul:ffn_up:L16                2.60     0.4
matmul:ffn_up:L15                2.60     0.4
matmul:ffn_up:L21                2.60     0.4
matmul:ffn_up:L9                 2.60     0.4
matmul:ffn_gate:L19              2.60     0.4
matmul:ffn_gate:L6               2.60     0.4
matmul:ffn_up:L7                 2.60     0.4
matmul:ffn_gate:L1               2.60     0.4
matmul:ffn_gate:L14              2.60     0.4
matmul:ffn_gate:L15              2.60     0.4
matmul:ffn_gate:L7               2.60     0.4
matmul:ffn_up:L20                2.60     0.4
matmul:ffn_gate:L13              2.59     0.4
rope                             0.91     0.1
cast_f32_to_f16                  0.79     0.1
matmul:q_proj:L0                 0.58     0.1
matmul:q_proj:L19                0.54     0.1
matmul:q_proj:L11                0.54     0.1
matmul:q_proj:L14                0.53     0.1
matmul:q_proj:L5                 0.53     0.1
matmul:q_proj:L6                 0.53     0.1
matmul:q_proj:L18                0.53     0.1
matmul:q_proj:L1                 0.52     0.1
matmul:o_proj:L18                0.52     0.1
matmul:q_proj:L12                0.52     0.1
matmul:q_proj:L13                0.52     0.1
matmul:o_proj:L16                0.52     0.1
matmul:q_proj:L7                 0.52     0.1
matmul:o_proj:L23                0.52     0.1
matmul:o_proj:L24                0.52     0.1
matmul:o_proj:L4                 0.52     0.1
matmul:q_proj:L20                0.52     0.1
matmul:o_proj:L17                0.52     0.1
matmul:o_proj:L10                0.52     0.1
matmul:o_proj:L25                0.52     0.1
matmul:o_proj:L2                 0.52     0.1
matmul:o_proj:L22                0.51     0.1
matmul:o_proj:L11                0.51     0.1
matmul:q_proj:L8                 0.50     0.1
matmul:q_proj:L16                0.49     0.1
matmul:q_proj:L23                0.49     0.1
matmul:q_proj:L25                0.49     0.1
matmul:o_proj:L19                0.49     0.1
matmul:q_proj:L3                 0.49     0.1
matmul:q_proj:L17                0.49     0.1
matmul:q_proj:L21                0.49     0.1
matmul:q_proj:L4                 0.49     0.1
matmul:q_proj:L10                0.49     0.1
matmul:o_proj:L6                 0.49     0.1
matmul:q_proj:L24                0.49     0.1
matmul:o_proj:L0                 0.49     0.1
matmul:q_proj:L22                0.49     0.1
matmul:o_proj:L12                0.49     0.1
matmul:o_proj:L14                0.49     0.1
matmul:q_proj:L2                 0.49     0.1
matmul:o_proj:L20                0.48     0.1
matmul:q_proj:L9                 0.48     0.1
matmul:o_proj:L1                 0.48     0.1
matmul:q_proj:L15                0.48     0.1
matmul:o_proj:L8                 0.48     0.1
matmul:o_proj:L5                 0.48     0.1
matmul:o_proj:L7                 0.48     0.1
matmul:o_proj:L15                0.48     0.1
matmul:o_proj:L13                0.48     0.1
matmul:o_proj:L3                 0.48     0.1
matmul:o_proj:L9                 0.48     0.1
matmul:o_proj:L21                0.48     0.1
gelu                             0.47     0.1
matmul:k_proj:L0                 0.36     0.1
matmul:v_proj:L0                 0.35     0.1
matmul:k_proj:L8                 0.30     0.0
matmul:k_proj:L5                 0.30     0.0
matmul:k_proj:L12                0.30     0.0
matmul:v_proj:L11                0.30     0.0
matmul:k_proj:L18                0.29     0.0
matmul:v_proj:L12                0.29     0.0
matmul:v_proj:L19                0.29     0.0
matmul:k_proj:L13                0.29     0.0
matmul:k_proj:L11                0.29     0.0
matmul:k_proj:L7                 0.29     0.0
matmul:k_proj:L14                0.29     0.0
matmul:v_proj:L13                0.29     0.0
matmul:k_proj:L19                0.29     0.0
matmul:v_proj:L5                 0.29     0.0
matmul:v_proj:L14                0.29     0.0
matmul:v_proj:L6                 0.29     0.0
matmul:k_proj:L20                0.29     0.0
matmul:k_proj:L1                 0.28     0.0
matmul:k_proj:L6                 0.28     0.0
matmul:v_proj:L20                0.28     0.0
matmul:v_proj:L1                 0.28     0.0
matmul:v_proj:L18                0.28     0.0
matmul:v_proj:L7                 0.28     0.0
matmul:v_proj:L8                 0.27     0.0
matmul:k_proj:L16                0.23     0.0
matmul:v_proj:L9                 0.23     0.0
matmul:k_proj:L23                0.23     0.0
matmul:k_proj:L17                0.23     0.0
matmul:k_proj:L9                 0.23     0.0
matmul:k_proj:L22                0.23     0.0
matmul:k_proj:L24                0.23     0.0
matmul:k_proj:L21                0.23     0.0
matmul:v_proj:L23                0.23     0.0
matmul:k_proj:L10                0.23     0.0
matmul:v_proj:L25                0.23     0.0
matmul:k_proj:L2                 0.23     0.0
matmul:v_proj:L16                0.23     0.0
matmul:k_proj:L4                 0.23     0.0
matmul:k_proj:L25                0.23     0.0
matmul:k_proj:L15                0.22     0.0
matmul:v_proj:L22                0.22     0.0
matmul:v_proj:L4                 0.22     0.0
matmul:k_proj:L3                 0.22     0.0
matmul:v_proj:L10                0.22     0.0
matmul:v_proj:L3                 0.22     0.0
matmul:v_proj:L17                0.22     0.0
matmul:v_proj:L24                0.22     0.0
matmul:v_proj:L2                 0.22     0.0
matmul:v_proj:L21                0.22     0.0
matmul:v_proj:L15                0.22     0.0
sample_phase1                    0.12     0.0
sample_phase3                    0.07     0.0
gather                           0.04     0.0
scale                            0.03     0.0
──────────────────────────────────────────────────
TOTAL                          681.22   100.0

[browser:log] [28661.5ms][Perf] TTFT: 297ms | Prefill: 177ms | Decode: 24945ms (165 tokens @ 6.6 tok/s)
[browser:log] [28661.9ms][Pipeline] Unloaded
[ok] debug model=gemma-3-1b-it passed=1 failed=0 duration=28455.1ms
[metrics] prompt="Summarize this input in one sentence."
[metrics] load=3211.8ms prefillTokens=9 decodeTokens=166 maxTokens=256
[metrics] ttft=296.8ms prefill=177.1ms decode=24945.4ms total=25242.6ms
[metrics] tok/s total=6.58 prefill=50.82 decode=6.65
